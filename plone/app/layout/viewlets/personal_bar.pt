<div xmlns="http://www.w3.org/1999/xhtml"
     xmlns:i18n="http://xml.zope.org/namespaces/i18n"
     xmlns:tal="http://xml.zope.org/namespaces/tal"
     id="portal-personaltools-wrapper"
     i18n:domain="plone">

<h5 class="hiddenStructure" i18n:translate="heading_personal_tools">Personal tools</h5>

<dl class="actionMenu" id="portal-personaltools"
    tal:condition="python:view.user_actions or not view.anonymous">
  <tal:block condition="not: view/anonymous"> <!-- TODO: Can we nest these in a better way? -->
  <dt class="actionMenuHeader">
    <!-- The following a-tag needs to be clicked to dropdown the menu -->
    <a id="user-name"
       tal:attributes="href view/homelink_url"
       tal:content="view/user_name">
                John
    </a>
  </dt>
  <dd class="actionMenuContent">
    <tal:actions repeat="action view/user_actions">
        <li tal:define="icon action/icon|nothing;
                        icon python:icon is not None and icon or view.getIconFor(action['category'], action['id'], None);
                        class_name string:visualIcon actionicon-${action/category}-${action/id};
                        class_name python:icon is not None and class_name or nothing;"
            tal:attributes="class class_name">
            <a href=""
               tal:attributes="href action/url;
                               class python:icon is not None and 'visualIconPadding' or nothing;"
               tal:content="action/title"
               i18n:translate="">
                action title
            </a>
        </li>
    </tal:actions>
  </dd>
  </tal:block>
</dl>

<dl class="actionMenu" id="portal-personaltools"
    tal:condition="view/anonymous">
  <dt>
    <a href=""
       tal:attributes="href string:${view/navigation_root_url}/login">Log in</a>
  </dt>
</dl>

</div>
