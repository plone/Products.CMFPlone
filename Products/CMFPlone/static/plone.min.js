/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.1.11 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

/*!
 * jQuery JavaScript Library v1.8.3
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: Tue Nov 13 2012 08:20:33 GMT-0500 (Eastern Standard Time)
 */

/*!
 * Sizzle CSS Selector Engine
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://sizzlejs.com/
 */

// Patterns
//
// Author: Rok Garbas
// Contact: rok@garbas.si
// Version: 1.0
// Depends: jquery.js
//
// Description:
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

/*
Copyright 2012 Igor Vaynberg

Version: 3.4.5 Timestamp: Mon Nov  4 08:22:42 PST 2013

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL Licesnse is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.
*/

/*! 
 * jquery.event.drag - v 2.2
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */

/*! 
 * jquery.event.drop - v 2.2
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */

/* Select2 pattern.
 *
 * Options:
 *    separator(string): Analagous to the separator constructor parameter from Select2. Defines a custom separator used to distinguish the tag values. Ex: a value of ";" will allow tags and initialValues to have values separated by ";" instead of the default ",". (',')
 *    initialValues(string): This can be a json encoded string, or a list of id:text values. Ex: Red:The Color Red,Orange:The Color Orange  This is used inside the initSelection method, if AJAX options are NOT set. (null)
 *    vocabularyUrl(string): This is a URL to a JSON-formatted file used to populate the list (null)
 *    OTHER OPTIONS(): For more options on select2 go to http://ivaynberg.github.io/select2/#documentation ()
 *
 * Documentation:
 *    # Autocomplete with search (single select)
 *
 *    {{ example-1 }}
 *
 *    # Tagging
 *
 *    {{ example-2 }}
 *
 *    # Orderable tags
 *
 *    {{ example-3 }}
 *
 *    # AJAX tags
 *
 *    {{ example-4 }}
 *
 * Example: example-1
 *    <select class="pat-select2" data-pat-select2="width:20em">
 *      <option value="Acholi">Acholi</option>
 *      <option value="Afrikaans">Afrikaans</option>
 *      <option value="Akan">Akan</option>
 *      <option value="Albanian">Albanian</option>
 *      <option value="Amharic">Amharic</option>
 *      <option value="Arabic">Arabic</option>
 *      <option value="Ashante">Ashante</option>
 *      <option value="Asl">Asl</option>
 *      <option value="Assyrian">Assyrian</option>
 *      <option value="Azerbaijani">Azerbaijani</option>
 *      <option value="Azeri">Azeri</option>
 *    </select>
 *
 * Example: example-2
 *    <input type="text" class="pat-select2"
 *           data-pat-select2="separator:,;
 *                             tags:Red,Yellow,Green,Orange,Purple;
 *                             width:20em;
 *                             initialValues:Red:The Color Red,Orange:The Color Orange"
 *           value="Red,Orange"/>
 *
 * Example: example-3
 *    <input type="text" class="pat-select2"
 *           data-pat-select2="orderable:true;
 *                             tags:Red,Yellow,Green;
 *                             width:20em" />
 * Example: example-4
 *    <input type="hidden" class="pat-select2"
 *           data-pat-select2="placeholder:Search for a Value;
 *                             vocabularyUrl:select2-test.json;
 *                             width:20em" />
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/*!
 * pickadate.js v3.3.2, 2013/12/28
 * By Amsul, http://amsul.ca
 * Hosted on http://amsul.github.io/pickadate.js
 * Licensed under MIT
 */

/*!
 * Date picker for pickadate.js v3.3.2
 * http://amsul.github.io/pickadate.js/date.htm
 */

/*!
 * Time picker for pickadate.js v3.3.2
 * http://amsul.github.io/pickadate.js/time.htm
 */

/* PickADate pattern.
 *
 * Options:
 *    date(object): Date widget options described here. If false is selected date picker wont be shown. ({{selectYears: true, selectMonths: true })
 *    time(object): Time widget options described here. If false is selected time picker wont be shown. ({})
 *    separator(string): Separator between date and time if both are enabled.
 *    (' ')
 *    classClearName(string): Class name of element that is generated by pattern. ('pattern-pickadate-clear')
 *    classDateName(string): Class applied to date input. ('pattern-pickadate-date')
 *    classDateWrapperName(string): Class applied to extra wrapper div around date input. ('pattern-pickadate-date-wrapper')
 *    classSeparatorName(string): Class applied to separator. ('pattern-pickadate-separator')
 *    classTimeName(string): Class applied to time input. ('pattern-pickadate-time')
 *    classTimeWrapperName(string): Class applied to wrapper div around time input. ('pattern-pickadate-time-wrapper')
 *    classWrapperName(string): Class name of element that is generated by pattern. ('pattern-pickadate-wrapper')
 *
 * Documentation:
 *    # Date and Time
 *
 *    {{ example-1 }}
 *
 *    # Date and Time with initial data
 *
 *    {{ example-2 }}
 *
 *    # Date
 *
 *    {{ example-3 }}
 *
 *    # Date with initial date
 *
 *    {{ example-4 }}
 *
 *    # Time
 *
 *    {{ example-5 }}
 *
 *    # Time with initial time
 *
 *    {{ example-6 }}
 *
 * Example: example-1
 *    <input class="pat-pickadate"/>
 *
 * Example: example-2
 *    <input class="pat-pickadate" value="2010-12-31 00:45" />
 *
 * Example: example-3
 *    <input class="pat-pickadate" data-pat-pickadate="time:false"/>
 *
 * Example: example-4
 *    <input class="pat-pickadate" value="2010-12-31" data-pat-pickadate="time:false"/>
 *
 * Example: example-5
 *    <input class="pat-pickadate" data-pat-pickadate="date:false"/>
 *
 * Example: example-6
 *    <input class="pat-pickadate" value="00:00" data-pat-pickadate="date:false"/>
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/**
 * @license
 * Lo-Dash 2.4.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash underscore exports="amd,commonjs,global,node" -o ./dist/lodash.underscore.js`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <http://lodash.com/license>
 */

// utils.
//
// Author: Nathan Van Gheem
// Contact: nathan@vangheem.us
// Version: 1.0
// Depends: jquery.js
//
// Description:
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

/*
Copyright 2013 Marco Braak

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

/*
  Copyright 2013 Marco Braak
  
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
  
      http://www.apache.org/licenses/LICENSE-2.0
  
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
  */

/* Tree pattern.
 *
 * Options:
 *    data(jSON): load data structure directly into tree (undefined)
 *    dataUrl(jSON): Load data from remote url (undefined)
 *    autoOpen(boolean): auto open tree contents (false)
 *    dragAndDrop(boolean): node drag and drop support (false)
 *    selectable(boolean): if nodes can be selectable (true)
 *    keyboardSupport(boolean): if keyboard naviation is allowed (true)
 *
 * Documentation:
 *    # JSON node data
 *
 *    {{ example-1 }}
 *
 *    # Remote data URL
 *
 *    {{ example-2 }}
 *
 *    # Drag and drop
 *
 *    {{ example-3 }}
 *
 * Example: example-1
 *    <div class="pat-tree" data-pat-tree='data:[
 *      {"label": "node1",
 *       "children": [{
 *         "label": "child1"
 *        },{
 *         "label": "child2"
 *        }]
 *      },{
 *       "label": "node2",
 *       "children": [{
 *         "label": "child3"
 *        }]
 *      }];'>
 *    </div>
 *
 * Example: example-2
 *    <div class="pat-tree"
 *        data-pat-tree="dataUrl:/tests/json/fileTree.json;autoOpen:true"></div>  
 *
 * Example: example-3
 *    <div class="pat-tree" data-pat-tree="dataUrl:/tests/json/fileTree.json; dragAndDrop: true; autoOpen: true"></div>
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/* Related items pattern.
 *
 * Options:
 *    vocabularyUrl(string): This is a URL to a JSON-formatted file used to populate the list (null)
 *    attributes(array): This list is passed to the server during an AJAX request to specify the attributes which should be included on each item. (['UID', 'Title', 'Type', 'path'])
 *    basePath(string): If this is set the widget will start in "Browse" mode and will pass the path to the server to filter the results. ('/')
 *    breadCrumbTemplate(string): Template to use for a single item in the breadcrumbs. ('/<a href="<%= path %>"><%= text %></a>')
 *    breadCrumbTemplateSelector(string): Select an element from the DOM from which to grab the breadCrumbTemplate. (null)
 *    breadCrumbsTemplate(string): Template for element to which breadCrumbs will be appended. ('<span><span class="pattern-relateditems-path-label"><%= searchText %></span><a class="icon-home" href="/"></a><%= items %></span>')
 *    breadCrumbsTemplateSelector(string): Select an element from the DOM from which to grab the breadCrumbsTemplate. (null)
 *    cache(boolean): Whether or not results from the server should be
 *    cached. (true)
 *    closeOnSelect(boolean): Select2 option. Whether or not the drop down should be closed when an item is selected. (false)
 *    dropdownCssClass(string): Select2 option. CSS class to add to the drop down element. ('pattern-relateditems-dropdown')
 *    folderTypes(array): Types which should be considered browsable. (["Folder"])
 *    homeText(string): Text to display in the initial breadcrumb item. (home)
 *    maximumSelectionSize(integer): The maximum number of items that can be selected in a multi-select control. If this number is less than 1 selection is not limited. (-1)
 *    multiple(boolean): Do not change this option. (true)
 *    orderable(boolean): Whether or not items should be drag-and-drop sortable. (true)
 *    resultTemplate(string): Template for an item in the in the list of results. Refer to source for default. (Refer to source)
 *    resultTemplateSelector(string): Select an element from the DOM from which to grab the resultTemplate. (null)
 *    searchText(string): Text which will be inserted to the left of the
 *    path. (Search)
 *    searchAllText(string): Displays next to the path when the path is set to the root. (All)
 *    selectableTypes(array): If the value is null all types are selectable. Otherwise, provide a list of strings to match item types that are selectable. (null)
 *    selectionTemplate(string): Template for element that will be used to construct a selected item. (Refer to source)
 *    selectionTemplateSelector(string): Select an element from the DOM from which to grab the selectionTemplate. (null)
 *    separator(string): Select2 option. String which separates multiple items. (',')
 *    tokenSeparators(array): Select2 option, refer to select2 documentation.
 *    ([",", " "])
 *    width(string): Specify a width for the widget. ('300px')
 *
 * Documentation:
 *    The Related Items pattern is based on Select2 so many of the same options will work here as well.
 *
 *    # Default
 *
 *    {{ example-1 }}
 *
 *    # Existing values, some bad
 *
 *    {{ example-2 }}
 *
 *    # Selectable Types
 *
 *    {{ example-3 }}
 *
 *    # Select a single item
 *
 *    {{ example-4 }}
 *
 * Example: example-1
 *    <input type="text" class="pat-relateditems"
 *           data-pat-relateditems="width:30em;
 *                                  vocabularyUrl:/relateditems-test.json" />
 *
 * Example: example-2
 *    <input type="text" class="pat-relateditems"
 *           value="asdf1234gsad,sdfbsfdh345,asdlfkjasdlfkjasdf,kokpoius98"
 *           data-pat-relateditems="width:30em; vocabularyUrl:/relateditems-test.json" />
 *
 * Example: example-3
 *    <input type="text" class="pat-relateditems"
             data-pat-relateditems='{"selectableTypes": ["Document"], "vocabularyUrl": "/relateditems-test.json"}' />
 *
 * Example: example-4
 *    <input type="text" class="pat-relateditems"
             data-pat-relateditems='{"selectableTypes": ["Document"], "vocabularyUrl": "/relateditems-test.json", "maximumSelectionSize": 1}' />
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/* Querystring pattern.
 *
 * Options:
 *    criteria(object): options to pass into criteria ({})
 *    indexOptionsUrl(string): URL to grab index option data from. Must contain "sortable_indexes" and "indexes" data in JSON object. (null)
 *    previewURL(string): URL used to pass in a plone.app.querystring-formatted HTTP querystring and get an HTML list of results ('portal_factory/@@querybuilder_html_results')
 *    previewCountURL(string): URL used to pass in a plone.app.querystring-formatted HTTP querystring and get an HTML string of the total number of records found with the query ('portal_factory/@@querybuildernumberofresults')
 *    sorttxt(string): Text to use to label the sort dropdown ('Sort On')
 *    reversetxt(string): Text to use to label the sort order checkbox ('Reversed Order')
 *    previewTitle(string): Title for the preview area ('Preview')
 *    previewDescription(string): Description for the preview area ('Preview of at most 10 items')
 *    classWrapperName(string): CSS class to apply to the wrapper element ('querystring-wrapper')
 *    classSortLabelName(string): CSS class to apply to the sort on label ('querystring-sort-label')
 *    classSortReverseName(string): CSS class to apply to the sort order label and checkbox container ('querystring-sortreverse')
 *    classSortReverseLabelName(string): CSS class to apply to the sort order label ('querystring-sortreverse-label')
 *    classPreviewCountWrapperName(string): TODO ('querystring-previewcount-wrapper')
 *    classPreviewResultsWrapperName(string): CSS class to apply to the results wrapper ('querystring-previewresults-wrapper')
 *    classPreviewWrapperName(string): CSS class to apply to the preview wrapper ('querystring-preview-wrapper')
 *    classPreviewName(string): CSS class to apply to the preview pane ('querystring-preview')
 *    classPreviewTitleName(string): CSS class to apply to the preview title ('querystring-preview-title')
 *    classPreviewDescriptionName(string): CSS class to apply to the preview description ('querystring-preview-description')
 *    classSortWrapperName(string): CSS class to apply to the sort order and sort on wrapper ('querystring-sort-wrapper')
 *    showPreviews(boolean): Should previews be shown? (true)
 *
 * Documentation:
 *    # Default
 *
 *    {{ example-1 }}
 *
 *    # Without Previews
 *    
 *    {{ example-2 }}
 *
 * Example: example-1
 *    <input class="pat-querystring"
 *           data-pat-querystring="indexOptionsUrl: /tests/json/queryStringCriteria.json" />
 *
 * Example: example-2
 *    <input class="pat-querystring"
 *           data-pat-querystring="indexOptionsUrl: /tests/json/queryStringCriteria.json;
 *                                 showPreviews: false;" />
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/* Backdrop pattern.
 *
 * Options:
 *    zIndex(integer): z-index of backdrop element. (null)
 *    opacity(float): opacity level of backdrop element. (0.8)
 *    className(string): class name of backdrop element. ('backdrop')
 *    classActiveName(string): class name when backdrop is active. ('backdrop-active')
 *    closeOnEsc(boolean): should backdrop close when ESC key is pressed. (true)
 *    closeOnClick(boolean): should backdrop close when clicked on it. (true)
 *
 * Documentation:
 *    # TODO: we need example or this is not pattern :)
 *
 * Example: example-1
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

//     (c) 2010-2011 Jeremy Ashkenas, DocumentCloud Inc.
//     (c) 2011-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

// pattern router.
//
// Author: Ryan Foster
// Contact: ryan@rynamic.com
// Version: 1.0
// Depends: jquery.js
//
// Description:
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

/*!
 * jQuery Form Plugin
 * version: 3.46.0-2013.11.21
 * Requires jQuery v1.5 or later
 * Copyright (c) 2013 M. Alsup
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses.
 * https://github.com/malsup/form#copyright-and-license
 */

/* Modal pattern.
 *
 * Options:
 *    height(string): Set the height of the modal, for example: 250px ('')
 *    width(string): Set the width of the modal, for example: 80% or 500px. ('')
 *    margin(function or integer): A function, Integer or String which will be used to set the margin of the modal in pixels. If a function is passed it must return an Integer. (20)
 *    position(string): Position the modal relative to the window with the format: "<horizontal> <vertical>" -- allowed values: top, bottom, left, right, center, middle. ('center middle')
 *    triggers(array): Add event listeners to elements on the page which will open the modal when triggered. Pass an Array of strings with the format ["&lt;event&gt; &lt;selector&gt;"] or ["&lt;event&gt;"]. For example, ["click .someButton"]. If you pass in only an event such as, ["change"], the event listener will be added to the element on which the modal was initiated, usually a link or button. ([])
 *    title(string): A string to place in the modal header. If title is provided, titleSelector is not used. (null)
 *    titleSelector(string): Selector for an element to extract from the content provided to the modal and place in the modal header. ('h1:first')
 *    content(string): Selector for an element within the content provided to the modal to use as the modal body. ('#content')
 *    prependContent(string): Selector for elements within the content provided to the modal which will be collected and inserted, by default above, the modal content. This is useful for extracting things like alerts or status messages on forms and displaying them to the user after an AJAX response. ('.portalMessage') 
 *    backdrop(string): Selector for the element upon which the Backdrop pattern should be initiated. The Backdrop is a full width mask that will be apply above the content behind the modal which is useful for highlighting the modal dialog to the user. ('body')
 *    backdropOptions(object): Look at options at backdrop pattern. ({ zIndex: "1040", opacity: "0.8", className: "backdrop", classActiveName: "backdrop-active", closeOnEsc: true, closeOnClick: true })
 *    buttons(string): Selector for matching elements, usually buttons, inputs or links, from the modal content to place in the modal footer. The original elements in the content will be hidden. ('.formControls > input[type="submit"]')
 *    automaticallyAddButtonActions(boolean): Automatically create actions for elements matched with the buttons selector. They will use the options provided in actionOptions. (true)
 *    loadLinksWithinModal(boolean): Automatically load links inside of the modal using AJAX. (true)
 *    actions(object): A hash of selector to options. Where options can include any of the defaults from actionOptions. Allows for the binding of events to elements in the content and provides options for handling ajax requests and displaying them in the modal. ({})
 *
 *
 * Documentation:
 *    # Example
 *
 *    {{ example-basic }}
 *
 *    {{ example-long }}
 *
 *    {{ example-tinymce }}
 *
 *
 * Example: example-basic
 *    <a href="#modal1" class="btn btn-large btn-primary pat-modal"
 *                      data-pat-modal="width: 400">Modal basic</a>
 *    <div id="modal1" style="display: none">
 *      <h1>Basic modal!</h1>
 *      <p>Indeed. Whoa whoa whoa whoa. Wait.</p>
 *    </div>
 *
 * Example: example-long
 *    <a href="#modal2" class="btn btn-large btn-primary pat-modal"
 *                      data-pat-modal="width: 500">Modal long scrolling</a>
 *    <div id="modal2" style="display: none">
 *      <h1>Basic with scrolling</h1>
 *      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua</p>
 *      <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
 *      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua</p>
 *      <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
 *      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua</p>
 *      <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
 *      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua</p>
 *      <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
 *      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua</p>
 *      <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
 *      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua</p>
 *    </div>
 *
 *
 * Example: example-tinymce
 *    <a href="#modaltinymce" class="btn btn-large btn-primary pat-modal"
 *       data-pat-modal="height: 600px;
 *                       width: 80%">
 *       Modal with TinyMCE</a>
 *    <div id="modaltinymce" style="display:none">
 *      <textarea class="pat-tinymce"></textarea>
 *    </div>
 *
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/* Autotoc pattern.
 *
 * Options:
 *    IDPrefix(string): Prefix used to generate ID. ('autotoc-item-')
 *    classActiveName(string): Class used for active level. ('active')
 *    classLevelPrefixName(string): Class prefix used for the TOC levels. ('autotoc-level-')
 *    classSectionName(string): Class used for section in TOC. ('autotoc-section')
 *    classTOCName(string): Class used for the TOC. ('autotoc-nav')
 *    levels(string): Selectors used to find levels. ('h1,h2,h3')
 *    scrollDuration(string): Speed of scrolling. ('slow')
 *    scrollEasing(string): Easing to use while scrolling. ('swing')
 *    section(string): Tag type to use for TOC. ('section')
 *
 * Documentation:
 *    # TOC
 *    {{ example-1 }}
 *
 *    # Tabs
 *    {{ example-2-tabs }}
 *
 * Example: example-1
 *    <div class="pat-autotoc"
 *          data-pat-autotoc="scrollDuration:slow;levels:h4,h5,h6;">
 *      <h4>Title 1</h4>
 *      <p>Mr. Zuckerkorn, you've been warned about touching. You said
 *         spanking. It walked on my pillow! How about a turtle? I've always
 *         loved those leathery little snappy faces.</p>
 *      <h5>Title 1.1</h5>
 *      <p>Ah coodle doodle do Caw ca caw, caw ca caw. Butterscotch!</p>
 *      <h6>Title 1.1.1</h6>
 *      <p>Want a lick? Okay, Lindsay, are you forgetting that I was
 *         a professional twice over - an analyst and a therapist.</p>
 *      <h4>Title 2</h4>
 *      <p>You boys know how to shovel coal? Don't worry, these young
 *      beauties have been nowhere near the bananas. I thought the two of
 *      us could talk man-on-man.</p>
 *    </div>
 *
 * Example: example-2-tabs
 *    <div class="pat-autotoc autotabs"
 *          data-pat-autotoc="section:fieldset;levels:legend;">
 *        <fieldset>
 *          <legend>Tab 1</legend>
 *          <div>
 *            Lorem ipsum dolor sit amet, ex nam odio ceteros fastidii,
 *            id porro lorem pro, homero facilisis in cum.
 *            At doming voluptua indoctum mel, natum noster similique ne mel.
 *          </div>
 *        </fieldset>
 *        <fieldset>
 *          <legend>Tab 2</legend>
 *          <div>
 *            Reque repudiare eum et. Prompta expetendis percipitur eu eam,
 *            et graece mandamus pro, eu vim harum audire tractatos.
 *            Ad perpetua salutandi mea, soluta delicata aliquando eam ne.
 *            Qui nostrum lucilius perpetua ut, eum suas stet oblique ut.
 *          </div>
 *        </fieldset>
 *        <fieldset>
 *          <legend>Tab 3</legend>
 *          <div>
 *            Vis mazim harum deterruisset ex, duo nemore nostro civibus ad,
 *            eros vituperata id cum. Vim at erat solet soleat,
 *            eum et iuvaret luptatum, pro an esse dolorum maiestatis.
 *          </div>
 *        </fieldset>
 *    </div>
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/*
#
# More info at [www.dropzonejs.com](http://www.dropzonejs.com)
# 
# Copyright (c) 2012, Matias Meno  
# 
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
# 
# The above copyright notice and this permission notice shall be included in
# all copies or substantial portions of the Software.
# 
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
# THE SOFTWARE.
#
*/

/* Dropzone pattern.
 *
 * Options:
 *    url(string): If not used with a form, this option must provide the URL to submit to (null)
 *    clickable(boolean): If you can click on container to also upload (false)
 *    className(string): value for class attribute in the form element ('dropzone')
 *    paramName(string): value for name attribute in the file input element ('file')
 *    uploadMultiple(boolean): condition value for multiple attribute in the file input element. If the value is 'true' and paramName is file, 'multiple=multiple' and 'name=file[]' will be added in the file input. (false)
 *    wrap(boolean): true or false for wrapping this element using the value of wrapperTemplate. If the value is 'inner', this element will wrap the wrapperTemplate value. (false)
 *    wrapperTemplate(string): HTML template for wrapping around with this element. ('<div class="dropzone-container"/>')
 *    resultTemplate(string): HTML template for the element that will contain file information. ('<div class="dz-notice"><p>Drop files here...</p></div><div class="dropzone-previews"/>')
 *    autoCleanResults(boolean): condition value for the file preview in div element to fadeout after file upload is completed. (false)
 *    previewsContainer(selector): JavaScript selector for file preview in div element. (.dropzone-previews)
 *
 * Documentation:
 *    # On a form element
 *
 *    {{ example-1 }}
 *
 *    # On a div element
 *
 *    {{ example-2 }}
 *
 *    # With custom style
 *
 *    {{ example-3 }}
 *
 * Example: example-1
 *    <form method="post" action="/upload" enctype="multipart/form-data"
 *          class="pat-dropzone" data-pat-dropzone="clickable:true">
 *    </form>
 *
 * Example: example-2
 *    <div class="pat-dropzone" data-pat-dropzone="url: /upload">
 *      <div>
 *        <p>Something here that is useful</p>
 *        <p>Something else here that is useful</p>
 *        <p>Another thing here that is useful</p>
 *      </div>
 *    </div>
 *
 * Example: example-3
 *    <style>
 *      .mydropzone{
 *        width: 400px;
 *        height: 100px;
 *        background-color: gray;
 *      }
 *      .mydropzone.dz-drag-hover{
 *        background-color: red;
 *      }
 *    </style>
 *    <div class="pat-dropzone"
 *         data-pat-dropzone="url: /upload; className: mydropzone">
 *      Drop here...
 *    </div>
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

// Author: Nathan Van Gheem
// Contact: nathan@vangheem.us
// Version: 1.0
//
// Description:
//    TinyMCE pattern (for now its depening on Plone's integration)
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

/* TinyMCE pattern.
 *
 * Options:
 *    relatedItems(object): Related items pattern options. ({ attributes: ["UID", "Title", "Description", "getURL", "Type", "path", "ModificationDate"], batchSize: 20, basePath: "/", vocabularyUrl: null, width: 500, maximumSelectionSize: 1, placeholder: "Search for item on site..." })
 *    text(object): Translation strings ({ insertBtn: "Insert", cancelBtn: "Cancel", insertHeading: "Insert link", title: "Title", internal: "Internal", external: "External", email: "Email", anchor: "Anchor", subject: "Subject" image: "Image", imageAlign: "Align", scale: "Size", alt: "Alternative Text", externalImage: "External Image URI"})
 *    scales(string): TODO: is this even used ('Listing (16x16):listing,Icon (32x32):icon,Tile (64x64):tile,Thumb (128x128):thumb,Mini (200x200):mini,Preview (400x400):preview,Large (768x768):large')
 *    targetList(array): TODO ([ {text: "Open in this window / frame", value: ""}, {text: "Open in new window", value: "_blank"}, {text: "Open in parent window / frame", value: "_parent"}, {text: "Open in top frame (replaces all frames)", value: "_top"}])
 * imageTypes(string): TODO ('Image')
 *    folderTypes(string): TODO ('Folder,Plone Site')
 *    linkableTypes(string): TODO ('Document,Event,File,Folder,Image,News Item,Topic')
 *    tiny(object): TODO ({ plugins: [ "advlist autolink lists charmap print preview anchor ploneupload", "usearchreplace visualblocks code fullscreen autoresize", "insertdatetime media table contextmenu paste plonelink ploneimage" ], menubar: "edit table format tools view insert",
toolbar: "undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | unlink plonelink ploneimage | ploneupload", autoresize_max_height: 1500 })
 *    rel_upload_path(string): To provide upload support. (null)
 *    folder_url(string): Base url to provide upload url off of. (null)
 *    prependToUrl(string): Text to prepend to generated internal urls. ('')
 *    appendToUrl(string): Text to append to generated internal urls. ('')
 *    prependToScalePart(string): Text to prepend to generated image scale url part. ('/imagescale/')
 *    appendToScalePart(string): Text to append to generated image scale url part. ('')
 *    linkAttribute(string): Ajax response data attribute to use for url. ('path')
 *
 * Documentation:
 *    # Default
 *
 *    {{ example-1 }}
 *
 *    # With dropzone
 *
 *    {{ example-2 }}
 *
 * Example: example-1
 *    <form>
 *      <textarea class="pat-tinymce"
 *          data-pat-tinymce='{"relatedItems": {
 *                                "vocabularyUrl": "/relateditems-test.json"
 *                                }}'></textarea>
 *    </form>
 *
 * Example: example-2
 *    <form>
 *      <textarea class="pat-tinymce"
 *          data-pat-tinymce='{"relatedItems": {"vocabularyUrl": "/relateditems-test.json" },
 *                             "rel_upload_path": "upload",
 *                             "folder_url": "http://localhost:8000/"}'></textarea>
 *    </form>
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/* Toggle pattern.
 *
 * Options:
 *    target(string): selector of the target elements to toggle ('undefied')
 *    targetScope(string): selector of a target scope element in anchestors ('global')
 *    attribute(string): element attribute which will be toggeled ('class')
 *    event(string): event which will trigger toggling ('click')
 *
 * Documentation:
 *    # Toggle itself
 *
 *    {{ example-1 }}
 *
 *    # Toggle all targets (global scope)
 *
 *    {{ example-2 }}
 *
 *    # Toggle specific target inside a target scope
 *
 *    {{ example-3 }}
 *
 *    # Toggle more than one target inside a specific target scope
 *
 *    {{ example-4 }}
 *
 *    # Toggle an element by hover event
 *
 *    {{ example-5 }}
 *
 *    # Toggle another element than class, like 'rel'
 *
 *    {{ example-6 }}
 *
 *    # Build a collapsable with toggle
 *
 *    {{ example-7 }}
 *
 * Example: example-1
 *    <button type="button"
 *            class="btn btn-default pat-toggle"
 *            data-pat-toggle="value:btn-lg;">This button goes bigger/smaller!</button>
 *
 * Example: example-2
 *    <div class="wrapper">
 *      <button type="button"
 *              class="btn btn-default pat-toggle"
 *              data-pat-toggle="value:label-success;target:.targetElement">This button is toggling the background of a element.</button><br />
 *      <p class="targetElement label label-default">Hello World</p>
 *    </div>
 *
 * Example: example-3
 *    <div class="wrapper">
 *      <div class="myScope">
 *        <button type="button"
 *                class="btn btn-default pat-toggle"
 *                data-pat-toggle="value:label-success;target:.targetElement;targetScope:.myScope;">toggle</button><br />
 *        <p class="targetElement label label-default">Hello World</p>
 *      </div>
 *      <div class="myScope">
 *        <button type="button"
 *                class="btn btn-default pat-toggle"
 *                data-pat-toggle="value:label-success;target:.targetElement;targetScope:.myScope;">toggle</button><br />
 *        <p class="targetElement label label-default">Hello World</p>
 *      </div>
 *    </div>
 *    
 * Example: example-4
 *    <div class="wrapper">
 *      <div class="myScope">
 *        <button type="button"
 *                class="btn btn-default pat-toggle"
 *                data-pat-toggle="value:label-success;target:.targetElement;targetScope:.myScope;">toggle</button><br />
 *        <p class="targetElement label label-default">Hello World</p>
 *        <p class="targetElement label label-default">Hello again</p>
 *      </div>
 *      <div class="myScope">
 *        <button type="button"
 *                class="btn btn-default pat-toggle"
 *                data-pat-toggle="value:label-success;target:.targetElement;targetScope:.myScope;">toggle</button><br />
 *        <p class="targetElement label label-default">Hello World</p>
 *      </div>
 *    </div>
 *    
 * Example: example-5
 *    <div class="wrapper">
 *      <div class="myScope">
 *        <button type="button"
 *                class="btn btn-default pat-toggle"
 *                data-pat-toggle="event:hover;value:label-success;target:.targetElement;targetScope:.myScope;">toggle</button><br />
 *        <p class="targetElement label label-default">Hello World</p>
 *      </div>
 *    </div>
 *    
 * Example: example-6
 *    <div class="wrapper">
 *      <div class="myScope">
 *        <button type="button"
 *                class="btn btn-default pat-toggle"
 *                data-pat-toggle="attribute:rel; value:myRel; target:.targetElement; targetScope:.myScope">toggle</button><br />
 *        <p class="targetElement label label-default">Hello World</p>
 *      </div>
 *    </div>
 *    
 * Example: example-7
 *    <div class="panel panel-default">
 *      <div class="panel-heading">
 *        <a class="btn btn-default pat-toggle"
 *           data-pat-toggle="value:in; target:.collapse; targetScope:.panel">toggle</a>
 *      </div>
 *      <div>
 *        <ul class="collapse in">
 *          <li>We use toggle for</li>
 *          <li>toggling collapsable CSS classes</li>
 *          <li>this is awesome</li>
 *        </ul>
 *      </div>
 *    </div>
 *    
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/* Livesearch pattern.
 *
 * Options:
 *    url(string): The server-side url that will be queried. (null)
 *    delay(integer): Delay in ms after user types before searching. (200)
 *    highlight(string): CSS class that will be used to highlight items on keyboard navigation. ('pattern-livesearch-highlight')
 *    minimumInputLength(integer): Number of characters user must type before search begins. (3)
 *    input(string): Selector for element that will be used for the livesearch input. ('.pattern-livesearch-input')
 *    toggleTarget(string): Selector for element that will be shown when results are found. ('.pattern-livesearch-container')
 *    toggleClass(string): CSS class that will be added to target toggle element when results are found. ('show')
 *    positionToggleWithInput(boolean): Whether or not the toggle element should be positioned relative to the input element. If set to false setPosition() will not be called. (true)
 *    setPosition(function): Function which will be used to set the position of the toggle element. (look at source)
 *    resultsTarget(string): Selector for element where results from the server will be inserted. ('.pattern-livesearch-results')
 *    resultsContainerTemplate(string): Template for the element that will contain results. If resultContainerTemplateSelector is set, this will not be used. ('<ul></ul>')
 *    resultsContainerTemplateSelector(string): Selector for an element in the DOM to use in place of resultContainerTemplate. (null)
 *    resultsAppendTo(string): Selector for element within results to append to ('ul')
 *    resultSelector(string): Will be used to select result items from within the result container. ('.pattern-livesearch-result')
 *    resultTemplate(string): Will be used to select result items from within the result container. ('<li class="pat-livesearch-result pat-livesearch-type-<%= Type %>"><a class="pat-livesearch-result-title" href="<%= getURL %>"><%= Title %></a><p class="pat-livesearch-result-desc"><%= Description %></p></li>')
 *    resultTemplateSelector(string): Selector for element to be used in place of resultTemplate. (null)
 *    helpTemplate(string): Template for the element that will contain help messages, such as 'No results found.' or 'Type 3 more characters to search.' ('<div class="pattern-livesearch-help"><%= help %></div>')
 *    helpTemplateSelector(string): Element in the DOM to be used instead of helpTemplate. (null)
 *    typeMoreTemplate(string): Template for message which is displayed if the current input length is less than minimumInputLength. ('Type <%= more %> more character<%= more === 1 ? "" : "s" %> to search.')
 *    typeMoreTemplateSelector(string): Element in the DOM to be used instead of typeMoreTemplate. (null)
 *    noResultsTemplate(string): Template for message that is displayed after a search when no results were found. ('No results found.')
 *    noResultsTemplateSelector(string): Element in the DOM to be used instead of noResultsTemplate. (null)
 *    searchingTemplate(string): Template for message which will be displayed after a search has started and before it has ended. ('Searching...')
 *    searchingTemplateSelector(string): Element in the DOM to be used instead of searchingTemplate. (null)
 *
 * Documentation:
 *    # Example
 *
 *    {{ example-1 }}
 *
 * Example: example-1
 *    <div class="pat-livesearch"
 *         data-pat-livesearch="url: /search.json;">
 *      <input type="text" class="pat-livesearch-input" placeholder="Search" />
 *      <div class="pat-livesearch-container">
 *        <div class="pat-livesearch-results"></div>
 *      </div>
 *    </div>
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/*!
 * jQuery Cookie Plugin v1.4.0
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */

/* Pattern which provides accessibility support
 *
 * Options:
 *    smallbtn(string):	Selector used to activate small text on click. (null)
 *    normalbtn(string): Selector used to activate normal text on click. (null)
 *    largebtn(string):	Selector used to activate large text on click. (null)
 *
 * Documentation:
 *    # Example
 *
 *    {{ example-1 }}
 *
 * Example: example-1
 *    <ul id="textAdjust"
 *        class="pat-accessibility"
 *        data-pat-accessibility="smallbtn:.decrease-text;
 *                                normalbtn:.normal-text;
 *                                largebtn:.increase-text;">
 *      <li>
 *        <a href="." class="decrease-text">
 *          <i class="icon-minus-sign"></i>
 *          Decrease Text Size
 *        </a>
 *      </li>
 *      <li>
 *        <a href="." class="normal-text">
 *          <i class="icon-circle"></i>
 *          Normal Text Size
 *        </a>
 *      </li>
 *      <li>
 *        <a href="." class="increase-text">
 *          <i class="icon-plus-sign"></i>
 *          Increase Text Size
 *        </a>
 *      </li>
 *    </ul>
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/* Formunloadalert pattern.
 *
 * Options:
 *    changingEvents(string): Events on which to check for changes (space-separated). ('change keyup paste')
 *    changingFields(string): Fields on which to check for changes (comma-separated). ('input,select,textarea,fileupload')
 *    message(string): Confirmation message to display when dirty form is being unloaded. (Discard changes? If you click OK, any changes you have made will be lost.)
 *
 * Documentation:
 *    # Example 
 *
 *    {{ example-1 }}
 *
 * Example: example-1
 *    <form class="pat-formunloadalert" onsubmit="javascript:return false;">
 *      <input type="text" value="" />
 *      <select>
 *        <option value="1">value 1</option>
 *        <option value="2">value 2</option>
 *      </select>
 *      <input
 *        class="btn btn-large btn-primary"
 *        type="submit" value="Submit" />
 *      <br />
 *      <a href="/">Click here to go somewhere else</a>
 *    </form>
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/* PreventDoubleSubmit pattern.
 *
 * Options:
 *    guardClassName(string): Class applied to submit button after it is clicked once. ('submitting')
 *    optOutClassName(string): Class used to opt-out a submit button from double-submit prevention. ('allowMultiSubmit')
 *    message(string): Message to be displayed when "opt-out" submit button is clicked a second time. ('You already clicked the submit button. Do you really want to submit this form again?')
 *
 * Documentation:
 *    # Example
 *
 *    {{ example-1 }}
 *
 * Example: example-1
 *    <form class="pat-preventdoublesubmit" onsubmit="javascript:return false;">
 *      <input type="text" value="submit this value please!" />
 *      <input class="btn btn-large btn-primary" type="submit" value="Single submit" />
 *      <input class="btn btn-large btn-primary allowMultiSubmit" type="submit" value="Multi submit" />
 *    </form>
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/* Formautofocus pattern.
 *
 * Options:
 *    condition(string): TODO ('div.error')
 *    target(string): TODO ("div.error :input:not(.formTabs):visible:first')
 *    always(string): TODO (:input:not(.formTabs):visible:first')
 *
 * Documentation:
 *    # TODO
 *
 * Example: example-1
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

// Author: Ryan Foster
// Contact: ryan@rynamic.com
// Version: 1.0
//
// Description:
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

/* ========================================================================
 * Bootstrap: tooltip.js v3.1.0
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

// Author: Nathan Van Gheem
// Contact: nathan@vangheem.us
// Version: 1.0
//
// Description:
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

/* ========================================================================
 * Bootstrap: dropdown.js v3.1.0
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* Sortable pattern.
 *
 * Options:
 *    selector(string): Selector to use to draggable items in pattern ('li')
 *    dragClass(string): Class to apply to original item that is being dragged. ('item-dragging')
 *    cloneClass(string): Class to apply to cloned item that is dragged. ('dragging')
 *    drop(function): callback function for when item is dropped (null)
 *
 * Documentation:
 *    # Default
 *
 *    {{ example-1 }}
 *
 *    # Table
 *
 *    {{ example-2 }}
 *
 * Example: example-1
 *    <ul class="pat-sortable">
 *      <li>One</li>
 *      <li>Two</li>
 *      <li>Three</li>
 *    </ul>
 *
 * Example: example-2
 *    <table class="table table-stripped pat-sortable"
 *           data-pat-sortable="selector:tr;">
 *      <tbody>
 *        <tr>
 *          <td>One One</td>
 *          <td>One Two</td>
 *        </tr>
 *        <tr>
 *          <td>Two One</td>
 *          <td>Two Two</td>
 *        </tr>
 *        <tr>
 *          <td>Three One</td>
 *          <td>Three Two</td>
 *        </tr>
 *      </tbody>
 *    </table>
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

//! moment.js
//! version : 2.5.0
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

/* Moment pattern.
 *
 * Options:
 *    selector(string): selector to use to look for dates to format (null)
 *    format(string): Format to use to render date. Also available is "relative" and "calendar" formats. (MMMM Do YYYY, h:mm:ss a)
 *
 * Documentation:
 *    # Defaults
 *
 *    {{ example-1 }}
 *
 *    # Relative format
 *
 *    {{ example-2 }}
 *
 *    # Calendar format
 *
 *    {{ example-3 }}
 *
 *    # Custom format
 *
 *    {{ example-4 }}
 *
 *    # Setting date by attribute
 *
 *    {{ example-5 }}
 *
 * Example: example-1
 *    <ul class="pat-moment" data-pat-moment="selector:li">
 *      <li>2013-10-01T10:00:00-05:00</li>
 *      <li>2013-01-01T22:10:00-05:00</li>
 *      <li>2013-01-05T04:34:00-05:00</li>
 *      <li>2013-02-14T16:55:00-05:00</li>
 *    </ul>
 *
 * Example: example-2
 *    <ul class="pat-moment"
 *        data-pat-moment="selector:li;format:relative;">
 *      <li>2013-10-01T10:00:00-05:00</li>
 *      <li>2013-01-01T22:10:00-05:00</li>
 *      <li>2013-01-05T04:34:00-05:00</li>
 *      <li>2013-02-14T16:55:00-05:00</li>
 *    </ul>
 *
 * Example: example-3
 *    <ul class="pat-moment"
 *        data-pat-moment="selector:li;format:calendar;">
 *      <li>2013-10-01T10:00:00-05:00</li>
 *      <li>2013-10-02T22:10:00-05:00</li>
 *      <li>2013-10-05T04:34:00-05:00</li>
 *      <li>2013-10-03T16:55:00-05:00</li>
 *    </ul>
 *
 * Example: example-4
 *    <ul class="pat-moment"
 *        data-pat-moment="selector:li;format:MMM Do, YYYY h:m a;">
 *      <li>2013-10-01T10:00:00-05:00</li>
 *      <li>2013-01-01T22:10:00-05:00</li>
 *      <li>2013-01-05T04:34:00-05:00</li>
 *      <li>2013-02-14T16:55:00-05:00</li>
 *    </ul>
 *
 * Example: example-5
 *    <ul class="pat-moment"
 *        data-pat-moment="selector:li;format:MMM Do, YYYY h:m a;">
 *      <li data-date="2013-10-01T10:00:00-05:00"></li>
 *      <li data-date="2013-01-01T22:10:00-05:00"></li>
 *      <li data-date="2013-01-05T04:34:00-05:00"></li>
 *      <li data-date="2013-02-14T16:55:00-05:00"></li>
 *    </ul>
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/* Structure pattern.
 *
 * Options:
 *    vocabularyUrl(string): Url to return query results (null)
 *    tagsVocabularyUrl(string): Url to return tags query results (null)
 *    usersVocabularyUrl(string): Url to query users (null)
 *    indexOptionsUrl(string): Url to configure querystring widget with (null)
 *    uploadUrl(string): For setting up dropzone (null)
 *    moveUrl(string): For supporting drag drop reordering (null)
 *    contextInfoUrl(string): For supporting add menu (null)
 *
 * Documentation:
 *    # Example
 *
 *    {{ example-1 }}
 *
 * Example: example-1
 *    <div class="pat-structure"
 *         data-pat-structure="vocabularyUrl:/relateditems-test.json;
 *                             uploadUrl:/upload;
 *                             moveUrl:/moveitem;
 *                             tagsVocabularyUrl:/select2-test.json;
 *                             usersVocabularyUrl:/tests/json/users.json;
 *                             indexOptionsUrl:/tests/json/queryStringCriteria.json;
 *                             contextInfoUrl:/tests/json/contextInfo.json;"></div>
 *
 * License:
 *    Copyright (C) 2010 Plone Foundation
 *
 *    This program is free software; you can redistribute it and/or modify it
 *    under the terms of the GNU General Public License as published by the
 *    Free Software Foundation; either version 2 of the License.
 *
 *    This program is distributed in the hope that it will be useful, but
 *    WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
 *    Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License along
 *    with this program; if not, write to the Free Software Foundation, Inc.,
 *    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

/* ========================================================================
 * Bootstrap: collapse.js v3.1.0
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

// Author: Rok Garbas
// Contact: rok@garbas.si
// Version: 1.0
// Description:
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

var requirejs,require,define;(function(global){function isFunction(e){return ostring.call(e)==="[object Function]"}function isArray(e){return ostring.call(e)==="[object Array]"}function each(e,t){if(e){var n;for(n=0;n<e.length;n+=1)if(e[n]&&t(e[n],n,e))break}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1;n-=1)if(e[n]&&t(e[n],n,e))break}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,r){return t&&eachProp(t,function(t,i){if(n||!hasProp(e,i))r&&typeof t=="object"&&t&&!isArray(t)&&!isFunction(t)&&!(t instanceof RegExp)?(e[i]||(e[i]={}),mixin(e[i],t,n,r)):e[i]=t}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,r){var i=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return i.requireType=e,i.requireModules=r,n&&(i.originalError=n),i}function newContext(e){function m(e){var t,n,r=e.length;for(t=0;t<r;t++){n=e[t];if(n===".")e.splice(t,1),t-=1;else if(n===".."){if(t===1&&(e[2]===".."||e[0]===".."))break;t>0&&(e.splice(t-1,2),t-=2)}}}function g(e,t,n){var r,i,s,u,a,f,l,c,h,p,d,v=t&&t.split("/"),g=v,y=o.map,b=y&&y["*"];e&&e.charAt(0)==="."&&(t?(g=v.slice(0,v.length-1),e=e.split("/"),l=e.length-1,o.nodeIdCompat&&jsSuffixRegExp.test(e[l])&&(e[l]=e[l].replace(jsSuffixRegExp,"")),e=g.concat(e),m(e),e=e.join("/")):e.indexOf("./")===0&&(e=e.substring(2)));if(n&&y&&(v||b)){s=e.split("/");e:for(u=s.length;u>0;u-=1){f=s.slice(0,u).join("/");if(v)for(a=v.length;a>0;a-=1){i=getOwn(y,v.slice(0,a).join("/"));if(i){i=getOwn(i,f);if(i){c=i,h=u;break e}}}!p&&b&&getOwn(b,f)&&(p=getOwn(b,f),d=u)}!c&&p&&(c=p,h=d),c&&(s.splice(0,h,c),e=s.join("/"))}return r=getOwn(o.pkgs,e),r?r:e}function y(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===r.contextName)return t.parentNode.removeChild(t),!0})}function b(e){var t=getOwn(o.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),r.require.undef(e),r.require([e]),!0}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e,t,n,i){var s,o,u,a,f=null,l=t?t.name:null,h=e,p=!0,m="";return e||(p=!1,e="_@r"+(d+=1)),a=w(e),f=a[0],e=a[1],f&&(f=g(f,l,i),o=getOwn(c,f)),e&&(f?o&&o.normalize?m=o.normalize(e,function(e){return g(e,l,i)}):m=g(e,l,i):(m=g(e,l,i),a=w(m),f=a[0],m=a[1],n=!0,s=r.nameToUrl(m))),u=f&&!o&&!n?"_unnormalized"+(v+=1):"",{prefix:f,name:m,parentMap:t,unnormalized:!!u,url:s,originalName:h,isDefine:p,id:(f?f+"!"+m:m)+u}}function S(e){var t=e.id,n=getOwn(u,t);return n||(n=u[t]=new r.Module(e)),n}function x(e,t,n){var r=e.id,i=getOwn(u,r);hasProp(c,r)&&(!i||i.defineEmitComplete)?t==="defined"&&n(c[r]):(i=S(e),i.error&&t==="error"?n(i.error):i.on(t,n))}function T(e,t){var n=e.requireModules,r=!1;t?t(e):(each(n,function(t){var n=getOwn(u,t);n&&(n.error=e,n.events.error&&(r=!0,n.emit("error",e)))}),r||req.onError(e))}function N(){globalDefQueue.length&&(apsp.apply(l,[l.length,0].concat(globalDefQueue)),globalDefQueue=[])}function C(e){delete u[e],delete a[e]}function k(e,t,n){var r=e.map.id;e.error?e.emit("error",e.error):(t[r]=!0,each(e.depMaps,function(r,i){var s=r.id,o=getOwn(u,s);o&&!e.depMatched[i]&&!n[s]&&(getOwn(t,s)?(e.defineDep(i,c[s]),e.check()):k(o,t,n))}),n[r]=!0)}function L(){var e,n,i=o.waitSeconds*1e3,u=i&&r.startTime+i<(new Date).getTime(),f=[],l=[],c=!1,h=!0;if(t)return;t=!0,eachProp(a,function(e){var t=e.map,r=t.id;if(!e.enabled)return;t.isDefine||l.push(e);if(!e.error)if(!e.inited&&u)b(r)?(n=!0,c=!0):(f.push(r),y(r));else if(!e.inited&&e.fetched&&t.isDefine){c=!0;if(!t.prefix)return h=!1}});if(u&&f.length)return e=makeError("timeout","Load timeout for modules: "+f,null,f),e.contextName=r.contextName,T(e);h&&each(l,function(e){k(e,{},{})}),(!u||n)&&c&&(isBrowser||isWebWorker)&&!s&&(s=setTimeout(function(){s=0,L()},50)),t=!1}function A(e){hasProp(c,e[0])||S(E(e[0],null,!0)).init(e[1],e[2])}function O(e,t,n,r){e.detachEvent&&!isOpera?r&&e.detachEvent(r,t):e.removeEventListener(n,t,!1)}function M(e){var t=e.currentTarget||e.srcElement;return O(t,r.onScriptLoad,"load","onreadystatechange"),O(t,r.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function _(){var e;N();while(l.length){e=l.shift();if(e[0]===null)return T(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));A(e)}}var t,n,r,i,s,o={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},u={},a={},f={},l=[],c={},h={},p={},d=1,v=1;return i={require:function(e){return e.require?e.require:e.require=r.makeRequire(e.map)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports?c[e.map.id]=e.exports:e.exports=c[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(o.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},n=function(e){this.events=getOwn(f,e.id)||{},this.map=e,this.shim=getOwn(o.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},n.prototype={init:function(e,t,n,r){r=r||{};if(this.inited)return;this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check()},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(this.fetched)return;this.fetched=!0,r.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();r.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()}))},load:function(){var e=this.map.url;h[e]||(h[e]=!0,r.load(this.map.id,e))},check:function(){if(!this.enabled||this.enabling)return;var e,t,n=this.map.id,i=this.depExports,s=this.exports,o=this.factory;if(!this.inited)this.fetch();else if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{s=r.execCb(n,o,i,s)}catch(u){e=u}else s=r.execCb(n,o,i,s);this.map.isDefine&&s===undefined&&(t=this.module,t?s=t.exports:this.usingExports&&(s=this.exports));if(e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",T(this.error=e)}else s=o;this.exports=s,this.map.isDefine&&!this.ignore&&(c[n]=s,req.onResourceLoad&&req.onResourceLoad(r,this.map,this.depMaps)),C(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}},callPlugin:function(){var e=this.map,t=e.id,n=E(e.prefix);this.depMaps.push(n),x(n,"defined",bind(this,function(n){var i,s,a,f=getOwn(p,this.map.id),l=this.map.name,c=this.map.parentMap?this.map.parentMap.name:null,h=r.makeRequire(e.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){n.normalize&&(l=n.normalize(l,function(e){return g(e,c,!0)})||""),s=E(e.prefix+"!"+l,this.map.parentMap),x(s,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),a=getOwn(u,s.id),a&&(this.depMaps.push(s),this.events.error&&a.on("error",bind(this,function(e){this.emit("error",e)})),a.enable());return}if(f){this.map.url=r.nameToUrl(f),this.load();return}i=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),i.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(u,function(e){e.map.id.indexOf(t+"_unnormalized")===0&&C(e.map.id)}),T(e)}),i.fromText=bind(this,function(n,s){var u=e.name,a=E(u),f=useInteractive;s&&(n=s),f&&(useInteractive=!1),S(a),hasProp(o.config,t)&&(o.config[u]=o.config[t]);try{req.exec(n)}catch(l){return T(makeError("fromtexteval","fromText eval for "+t+" failed: "+l,l,[t]))}f&&(useInteractive=!0),this.depMaps.push(a),r.completeLoad(u),h([u],i)}),n.load(e.name,h,i,o)})),r.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){a[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,s,o;if(typeof e=="string"){e=E(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,o=getOwn(i,e.id);if(o){this.depExports[t]=o(this);return}this.depCount+=1,x(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&x(e,"error",bind(this,this.errback))}n=e.id,s=u[n],!hasProp(i,n)&&s&&!s.enabled&&r.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(u,e.id);t&&!t.enabled&&r.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),e==="error"&&delete this.events[e]}},r={config:o,contextName:e,registry:u,defined:c,urlFetched:h,defQueue:l,Module:n,makeModuleMap:E,nextTick:req.nextTick,onError:T,configure:function(e){e.baseUrl&&e.baseUrl.charAt(e.baseUrl.length-1)!=="/"&&(e.baseUrl+="/");var t=o.shim,n={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){n[t]?(o[t]||(o[t]={}),mixin(o[t],e,!0,!0)):o[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(p[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,n){isArray(e)&&(e={deps:e}),(e.exports||e.init)&&!e.exportsFn&&(e.exportsFn=r.makeShimExports(e)),t[n]=e}),o.shim=t),e.packages&&each(e.packages,function(e){var t,n;e=typeof e=="string"?{name:e}:e,n=e.name,t=e.location,t&&(o.paths[n]=e.location),o.pkgs[n]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(u,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=E(t))}),(e.deps||e.callback)&&r.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,n){function s(o,a,f){var l,h,p;return n.enableBuildCallback&&a&&isFunction(a)&&(a.__requireJsBuild=!0),typeof o=="string"?isFunction(a)?T(makeError("requireargs","Invalid require call"),f):t&&hasProp(i,o)?i[o](u[t.id]):req.get?req.get(r,o,t,s):(h=E(o,t,!1,!0),l=h.id,hasProp(c,l)?c[l]:T(makeError("notloaded",'Module name "'+l+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(_(),r.nextTick(function(){_(),p=S(E(null,t)),p.skipMap=n.skipMap,p.init(o,a,f,{enabled:!0}),L()}),s)}return n=n||{},mixin(s,{isBrowser:isBrowser,toUrl:function(e){var n,i=e.lastIndexOf("."),s=e.split("/")[0],o=s==="."||s==="..";return i!==-1&&(!o||i>1)&&(n=e.substring(i,e.length),e=e.substring(0,i)),r.nameToUrl(g(e,t&&t.id,!0),n,!0)},defined:function(e){return hasProp(c,E(e,t,!1,!0).id)},specified:function(e){return e=E(e,t,!1,!0).id,hasProp(c,e)||hasProp(u,e)}}),t||(s.undef=function(e){N();var n=E(e,t,!0),r=getOwn(u,e);y(e),delete c[e],delete h[n.url],delete f[e],eachReverse(l,function(t,n){t[0]===e&&l.splice(n,1)}),r&&(r.events.defined&&(f[e]=r.events),C(e))}),s},enable:function(e){var t=getOwn(u,e.id);t&&S(e).enable()},completeLoad:function(e){var t,n,r,i=getOwn(o.shim,e)||{},s=i.exports;N();while(l.length){n=l.shift();if(n[0]===null){n[0]=e;if(t)break;t=!0}else n[0]===e&&(t=!0);A(n)}r=getOwn(u,e);if(!t&&!hasProp(c,e)&&r&&!r.inited){if(o.enforceDefine&&(!s||!getGlobal(s))){if(b(e))return;return T(makeError("nodefine","No define call for "+e,null,[e]))}A([e,i.deps||[],i.exportsFn])}L()},nameToUrl:function(e,t,n){var i,s,u,a,f,l,c,h=getOwn(o.pkgs,e);h&&(e=h),c=getOwn(p,e);if(c)return r.nameToUrl(c,t,n);if(req.jsExtRegExp.test(e))f=e+(t||"");else{i=o.paths,s=e.split("/");for(u=s.length;u>0;u-=1){a=s.slice(0,u).join("/"),l=getOwn(i,a);if(l){isArray(l)&&(l=l[0]),s.splice(0,u,l);break}}f=s.join("/"),f+=t||(/^data\:|\?/.test(f)||n?"":".js"),f=(f.charAt(0)==="/"||f.match(/^[\w\+\.\-]+:/)?"":o.baseUrl)+f}return o.urlArgs?f+((f.indexOf("?")===-1?"?":"&")+o.urlArgs):f},load:function(e,t){req.load(r,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if(e.type==="load"||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=M(e);r.completeLoad(t.id)}},onScriptError:function(e){var t=M(e);if(!b(t.id))return T(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},r.require=r.makeRequire(),r}function getInteractiveScript(){return interactiveScript&&interactiveScript.readyState==="interactive"?interactiveScript:(eachReverse(scripts(),function(e){if(e.readyState==="interactive")return interactiveScript=e}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.11",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=typeof window!="undefined"&&typeof navigator!="undefined"&&!!window.document,isWebWorker=!isBrowser&&typeof importScripts!="undefined",readyRegExp=isBrowser&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera=typeof opera!="undefined"&&opera.toString()==="[object Opera]",contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(typeof define!="undefined")return;if(typeof requirejs!="undefined"){if(isFunction(requirejs))return;cfg=requirejs,requirejs=undefined}typeof require!="undefined"&&!isFunction(require)&&(cfg=require,require=undefined),req=requirejs=function(e,t,n,r){var i,s,o=defContextName;return!isArray(e)&&typeof e!="string"&&(s=e,isArray(t)?(e=t,t=n,n=r):e=[]),s&&s.context&&(o=s.context),i=getOwn(contexts,o),i||(i=contexts[o]=req.s.newContext(o)),s&&i.configure(s),i.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick=typeof setTimeout!="undefined"?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,n){var r=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return r.type=e.scriptType||"text/javascript",r.charset="utf-8",r.async=!0,r},req.load=function(e,t,n){var r=e&&e.config||{},i;if(isBrowser)return i=req.createNode(r,t,n),i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),i.attachEvent&&!(i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0)&&!isOpera?(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)):(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{importScripts(n),e.completeLoad(t)}catch(s){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,s,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){head||(head=e.parentNode),dataMain=e.getAttribute("data-main");if(dataMain)return mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(e,t,n){var r,i;typeof e!="string"&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(n.length===1?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(r=currentlyAddingScript||getInteractiveScript(),r&&(e||(e=r.getAttribute("data-requiremodule")),i=contexts[r.getAttribute("data-requirecontext")])),(i?i.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)})(this),define("node_modules/requirejs/require.js",function(){}),function(e,t){function _(e){var t=M[e]={};return v.each(e.split(y),function(e,n){t[n]=!0}),t}function H(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(P,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:D.test(r)?v.parseJSON(r):r}catch(s){}v.data(e,n,r)}else r=t}return r}function B(e){var t;for(t in e){if(t==="data"&&v.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function et(){return!1}function tt(){return!0}function ut(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function at(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function ft(e,t,n){t=t||0;if(v.isFunction(t))return v.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return v.grep(e,function(e,r){return e===t===n});if(typeof t=="string"){var r=v.grep(e,function(e){return e.nodeType===1});if(it.test(t))return v.filter(t,r,!n);t=v.filter(t,r)}return v.grep(e,function(e,r){return v.inArray(e,t)>=0===n})}function lt(e){var t=ct.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function At(e,t){if(t.nodeType!==1||!v.hasData(e))return;var n,r,i,s=v._data(e),o=v._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)v.event.add(t,n,u[n][r])}o.data&&(o.data=v.extend({},o.data))}function Ot(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),v.support.html5Clone&&e.innerHTML&&!v.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Et.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(v.expando)}function Mt(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function _t(e){Et.test(e.type)&&(e.defaultChecked=e.checked)}function Qt(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Jt.length;while(i--){t=Jt[i]+n;if(t in e)return t}return r}function Gt(e,t){return e=t||e,v.css(e,"display")==="none"||!v.contains(e.ownerDocument,e)}function Yt(e,t){var n,r,i=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style)continue;i[s]=v._data(n,"olddisplay"),t?(!i[s]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&Gt(n)&&(i[s]=v._data(n,"olddisplay",nn(n.nodeName)))):(r=Dt(n,"display"),!i[s]&&r!=="none"&&v._data(n,"olddisplay",r))}for(s=0;s<o;s++){n=e[s];if(!n.style)continue;if(!t||n.style.display==="none"||n.style.display==="")n.style.display=t?i[s]||"":"none"}return e}function Zt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function en(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,s=0;for(;i<4;i+=2)n==="margin"&&(s+=v.css(e,n+$t[i],!0)),r?(n==="content"&&(s-=parseFloat(Dt(e,"padding"+$t[i]))||0),n!=="margin"&&(s-=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0)):(s+=parseFloat(Dt(e,"padding"+$t[i]))||0,n!=="padding"&&(s+=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0));return s}function tn(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,s=v.support.boxSizing&&v.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=Dt(e,t);if(r<0||r==null)r=e.style[t];if(Ut.test(r))return r;i=s&&(v.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+en(e,t,n||(s?"border":"content"),i)+"px"}function nn(e){if(Wt[e])return Wt[e];var t=v("<"+e+">").appendTo(i.body),n=t.css("display");t.remove();if(n==="none"||n===""){Pt=i.body.appendChild(Pt||v.extend(i.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!Ht||!Pt.createElement)Ht=(Pt.contentWindow||Pt.contentDocument).document,Ht.write("<!doctype html><html><body>"),Ht.close();t=Ht.body.appendChild(Ht.createElement(e)),n=Dt(t,"display"),i.body.removeChild(Pt)}return Wt[e]=n,n}function fn(e,t,n,r){var i;if(v.isArray(t))v.each(t,function(t,i){n||sn.test(e)?r(e,i):fn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&v.type(t)==="object")for(i in t)fn(e+"["+i+"]",t[i],n,r);else r(e,t)}function Cn(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i,s,o=t.toLowerCase().split(y),u=0,a=o.length;if(v.isFunction(n))for(;u<a;u++)r=o[u],s=/^\+/.test(r),s&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[s?"unshift":"push"](n)}}function kn(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u,a=e[s],f=0,l=a?a.length:0,c=e===Sn;for(;f<l&&(c||!u);f++)u=a[f](n,r,i),typeof u=="string"&&(!c||o[u]?u=t:(n.dataTypes.unshift(u),u=kn(e,n,r,i,u,o)));return(c||!u)&&!o["*"]&&(u=kn(e,n,r,i,"*",o)),u}function Ln(e,n){var r,i,s=v.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r]);i&&v.extend(!0,e,i)}function An(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l)s in r&&(n[l[s]]=r[s]);while(f[0]==="*")f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){f.unshift(s);break}if(f[0]in r)o=f[0];else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}if(o)return o!==f[0]&&f.unshift(o),r[o]}function On(e,t){var n,r,i,s,o=e.dataTypes.slice(),u=o[0],a={},f=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(o[1])for(n in e.converters)a[n.toLowerCase()]=e.converters[n];for(;i=o[++f];)if(i!=="*"){if(u!=="*"&&u!==i){n=a[u+" "+i]||a["* "+i];if(!n)for(r in a){s=r.split(" ");if(s[1]===i){n=a[u+" "+s[0]]||a["* "+s[0]];if(n){n===!0?n=a[r]:a[r]!==!0&&(i=s[0],o.splice(f--,0,i));break}}}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+u+" to "+i}}}u=i}return{state:"success",data:t}}function Fn(){try{return new e.XMLHttpRequest}catch(t){}}function In(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function $n(){return setTimeout(function(){qn=t},0),qn=v.now()}function Jn(e,t){v.each(t,function(t,n){var r=(Vn[t]||[]).concat(Vn["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function Kn(e,t,n){var r,i=0,s=0,o=Xn.length,u=v.Deferred().always(function(){delete a.elem}),a=function(){var t=qn||$n(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,i=1-r,s=0,o=f.tweens.length;for(;s<o;s++)f.tweens[s].run(i);return u.notifyWith(e,[f,i,n]),i<1&&o?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:v.extend({},t),opts:v.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:qn||$n(),duration:n.duration,tweens:[],createTween:function(t,n,r){var i=v.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(i),i},stop:function(t){var n=0,r=t?f.tweens.length:0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;Qn(l,f.opts.specialEasing);for(;i<o;i++){r=Xn[i].call(f,e,l,f.opts);if(r)return r}return Jn(f,l),v.isFunction(f.opts.start)&&f.opts.start.call(e,f),v.fx.timer(v.extend(a,{anim:f,queue:f.opts.queue,elem:e})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Qn(e,t){var n,r,i,s,o;for(n in e){r=v.camelCase(n),i=t[r],s=e[n],v.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=v.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function Gn(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},m=[],g=e.nodeType&&Gt(e);n.queue||(l=v._queueHooks(e,"fx"),l.unqueued==null&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,v.queue(e,"fx").length||l.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],v.css(e,"display")==="inline"&&v.css(e,"float")==="none"&&(!v.support.inlineBlockNeedsLayout||nn(e.nodeName)==="inline"?p.display="inline-block":p.zoom=1)),n.overflow&&(p.overflow="hidden",v.support.shrinkWrapBlocks||h.done(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t){s=t[r];if(Un.exec(s)){delete t[r],a=a||s==="toggle";if(s===(g?"hide":"show"))continue;m.push(r)}}o=m.length;if(o){u=v._data(e,"fxshow")||v._data(e,"fxshow",{}),"hidden"in u&&(g=u.hidden),a&&(u.hidden=!g),g?v(e).show():h.done(function(){v(e).hide()}),h.done(function(){var t;v.removeData(e,"fxshow",!0);for(t in d)v.style(e,t,d[t])});for(r=0;r<o;r++)i=m[r],f=h.createTween(i,g?u[i]:0),d[i]=u[i]||v.style(e,i),i in u||(u[i]=f.start,g&&(f.end=f.start,f.start=i==="width"||i==="height"?1:0))}}function Yn(e,t,n,r,i){return new Yn.prototype.init(e,t,n,r,i)}function Zn(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=$t[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function tr(e){return v.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n,r,i=e.document,s=e.location,o=e.navigator,u=e.jQuery,a=e.$,f=Array.prototype.push,l=Array.prototype.slice,c=Array.prototype.indexOf,h=Object.prototype.toString,p=Object.prototype.hasOwnProperty,d=String.prototype.trim,v=function(e,t){return new v.fn.init(e,t,n)},m=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,g=/\S/,y=/\s+/,b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,w=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,S=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,T=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,N=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,C=/^-ms-/,k=/-([\da-z])/gi,L=function(e,t){return(t+"").toUpperCase()},A=function(){i.addEventListener?(i.removeEventListener("DOMContentLoaded",A,!1),v.ready()):i.readyState==="complete"&&(i.detachEvent("onreadystatechange",A),v.ready())},O={};v.fn=v.prototype={constructor:v,init:function(e,n,r){var s,o,u,a;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?s=[null,e,null]:s=w.exec(e);if(s&&(s[1]||!n)){if(s[1])return n=n instanceof v?n[0]:n,a=n&&n.nodeType?n.ownerDocument||n:i,e=v.parseHTML(s[1],a,!0),E.test(s[1])&&v.isPlainObject(n)&&this.attr.call(e,n,!0),v.merge(this,e);o=i.getElementById(s[2]);if(o&&o.parentNode){if(o.id!==s[2])return r.find(e);this.length=1,this[0]=o}return this.context=i,this.selector=e,this}return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return v.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),v.makeArray(e,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return l.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=v.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return v.each(this,e,t)},ready:function(e){return v.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(l.apply(this,arguments),"slice",l.call(arguments).join(","))},map:function(e){return this.pushStack(v.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:[].sort,splice:[].splice},v.fn.init.prototype=v.fn,v.extend=v.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!v.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((e=arguments[a])!=null)for(n in e){r=u[n],i=e[n];if(u===i)continue;l&&i&&(v.isPlainObject(i)||(s=v.isArray(i)))?(s?(s=!1,o=r&&v.isArray(r)?r:[]):o=r&&v.isPlainObject(r)?r:{},u[n]=v.extend(l,o,i)):i!==t&&(u[n]=i)}return u},v.extend({noConflict:function(t){return e.$===v&&(e.$=a),t&&e.jQuery===v&&(e.jQuery=u),v},isReady:!1,readyWait:1,holdReady:function(e){e?v.readyWait++:v.ready(!0)},ready:function(e){if(e===!0?--v.readyWait:v.isReady)return;if(!i.body)return setTimeout(v.ready,1);v.isReady=!0;if(e!==!0&&--v.readyWait>0)return;r.resolveWith(i,[v]),v.fn.trigger&&v(i).trigger("ready").off("ready")},isFunction:function(e){return v.type(e)==="function"},isArray:Array.isArray||function(e){return v.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):O[h.call(e)]||"object"},isPlainObject:function(e){if(!e||v.type(e)!=="object"||e.nodeType||v.isWindow(e))return!1;try{if(e.constructor&&!p.call(e,"constructor")&&!p.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||p.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return!e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||i,(r=E.exec(e))?[t.createElement(r[1])]:(r=v.buildFragment([e],t,n?null:[]),v.merge([],(r.cacheable?v.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(t){if(!t||typeof t!="string")return null;t=v.trim(t);if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(S.test(t.replace(T,"@").replace(N,"]").replace(x,"")))return(new Function("return "+t))();v.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string")return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&v.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&g.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(C,"ms-").replace(k,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,s=0,o=e.length,u=o===t||v.isFunction(e);if(r){if(u){for(i in e)if(n.apply(e[i],r)===!1)break}else for(;s<o;)if(n.apply(e[s++],r)===!1)break}else if(u){for(i in e)if(n.call(e[i],i,e[i])===!1)break}else for(;s<o;)if(n.call(e[s],s,e[s++])===!1)break;return e},trim:d&&!d.call("")?function(e){return e==null?"":d.call(e)}:function(e){return e==null?"":(e+"").replace(b,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=v.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||v.isWindow(e)?f.call(r,e):v.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(c)return c.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number")for(;s<r;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,n,r){var i,s,o=[],u=0,a=e.length,f=e instanceof v||a!==t&&typeof a=="number"&&(a>0&&e[0]&&e[a-1]||a===0||v.isArray(e));if(f)for(;u<a;u++)i=n(e[u],u,r),i!=null&&(o[o.length]=i);else for(s in e)i=n(e[s],s,r),i!=null&&(o[o.length]=i);return o.concat.apply([],o)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(r=e[n],n=e,e=r),v.isFunction(e)?(i=l.call(arguments,2),s=function(){return e.apply(n,i.concat(l.call(arguments)))},s.guid=e.guid=e.guid||v.guid++,s):t},access:function(e,n,r,i,s,o,u){var a,f=r==null,l=0,c=e.length;if(r&&typeof r=="object"){for(l in r)v.access(e,n,l,r[l],1,o,i);s=1}else if(i!==t){a=u===t&&v.isFunction(i),f&&(a?(a=n,n=function(e,t,n){return a.call(v(e),n)}):(n.call(e,i),n=null));if(n)for(;l<c;l++)n(e[l],r,a?i.call(e[l],l,n(e[l],r)):i,u);s=1}return s?e:f?n.call(e):c?n(e[0],r):o},now:function(){return(new Date).getTime()}}),v.ready.promise=function(t){if(!r){r=v.Deferred();if(i.readyState==="complete")setTimeout(v.ready,1);else if(i.addEventListener)i.addEventListener("DOMContentLoaded",A,!1),e.addEventListener("load",v.ready,!1);else{i.attachEvent("onreadystatechange",A),e.attachEvent("onload",v.ready);var n=!1;try{n=e.frameElement==null&&i.documentElement}catch(s){}n&&n.doScroll&&function o(){if(!v.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}v.ready()}}()}}return r.promise(t)},v.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){O["[object "+t+"]"]=t.toLowerCase()}),n=v(i);var M={};v.Callbacks=function(e){e=typeof e=="string"?M[e]||_(e):v.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){n=e.memory&&t,r=!0,u=s||0,s=0,o=a.length,i=!0;for(;a&&u<o;u++)if(a[u].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}i=!1,a&&(f?f.length&&l(f.shift()):n?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function r(t){v.each(t,function(t,n){var i=v.type(n);i==="function"?(!e.unique||!c.has(n))&&a.push(n):n&&n.length&&i!=="string"&&r(n)})})(arguments),i?o=a.length:n&&(s=t,l(n))}return this},remove:function(){return a&&v.each(arguments,function(e,t){var n;while((n=v.inArray(t,a,n))>-1)a.splice(n,1),i&&(n<=o&&o--,n<=u&&u--)}),this},has:function(e){return v.inArray(e,a)>-1},empty:function(){return a=[],this},disable:function(){return a=f=n=t,this},disabled:function(){return!a},lock:function(){return f=t,n||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],a&&(!r||f)&&(i?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},v.extend({Deferred:function(e){var t=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return v.Deferred(function(n){v.each(t,function(t,r){var s=r[0],o=e[t];i[r[1]](v.isFunction(o)?function(){var e=o.apply(this,arguments);e&&v.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return e!=null?v.extend(e,r):r}},i={};return r.pipe=r.then,v.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=o.fire,i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=l.call(arguments),r=n.length,i=r!==1||e&&v.isFunction(e.promise)?r:0,s=i===1?e:v.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?l.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&v.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),v.support=function(){var t,n,r,s,o,u,a,f,l,c,h,p=i.createElement("div");p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0];if(!n||!r||!n.length)return{};s=i.createElement("select"),o=s.appendChild(i.createElement("option")),u=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:u.value==="on",optSelected:o.selected,getSetAttribute:p.className!=="t",enctype:!!i.createElement("form").enctype,html5Clone:i.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:i.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},u.checked=!0,t.noCloneChecked=u.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",h=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",h)),u=i.createElement("input"),u.value="t",u.setAttribute("type","radio"),t.radioValue=u.value==="t",u.setAttribute("checked","checked"),u.setAttribute("name","t"),p.appendChild(u),a=i.createDocumentFragment(),a.appendChild(p.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=u.checked,a.removeChild(u),a.appendChild(p);if(p.attachEvent)for(l in{submit:!0,change:!0,focusin:!0})f="on"+l,c=f in p,c||(p.setAttribute(f,"return;"),c=typeof p[f]=="function"),t[l+"Bubbles"]=c;return v(function(){var n,r,s,o,u="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=i.getElementsByTagName("body")[0];if(!a)return;n=i.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(n,a.firstChild),r=i.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=r.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=s[0].offsetHeight===0,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&s[0].offsetHeight===0,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=r.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=a.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(r,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(r,null)||{width:"4px"}).width==="4px",o=i.createElement("div"),o.style.cssText=r.style.cssText=u,o.style.marginRight=o.style.width="0",r.style.width="1px",r.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),typeof r.style.zoom!="undefined"&&(r.innerHTML="",r.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=r.offsetWidth===3,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=r.offsetWidth!==3,n.style.zoom=1),a.removeChild(n),n=r=s=o=null}),a.removeChild(p),n=r=s=o=u=a=p=null,t}();var D=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;v.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(v.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?v.cache[e[v.expando]]:e[v.expando],!!e&&!B(e)},data:function(e,n,r,i){if(!v.acceptData(e))return;var s,o,u=v.expando,a=typeof n=="string",f=e.nodeType,l=f?v.cache:e,c=f?e[u]:e[u]&&u;if((!c||!l[c]||!i&&!l[c].data)&&a&&r===t)return;c||(f?e[u]=c=v.deletedIds.pop()||v.guid++:c=u),l[c]||(l[c]={},f||(l[c].toJSON=v.noop));if(typeof n=="object"||typeof n=="function")i?l[c]=v.extend(l[c],n):l[c].data=v.extend(l[c].data,n);return s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[v.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[v.camelCase(n)])):o=s,o},removeData:function(e,t,n){if(!v.acceptData(e))return;var r,i,s,o=e.nodeType,u=o?v.cache:e,a=o?e[v.expando]:v.expando;if(!u[a])return;if(t){r=n?u[a]:u[a].data;if(r){v.isArray(t)||(t in r?t=[t]:(t=v.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,s=t.length;i<s;i++)delete r[t[i]];if(!(n?B:v.isEmptyObject)(r))return}}if(!n){delete u[a].data;if(!B(u[a]))return}o?v.cleanData([e],!0):v.support.deleteExpando||u!=u.window?delete u[a]:u[a]=null},_data:function(e,t,n){return v.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&v.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),v.fn.extend({data:function(e,n){var r,i,s,o,u,a=this[0],f=0,l=null;if(e===t){if(this.length){l=v.data(a);if(a.nodeType===1&&!v._data(a,"parsedAttrs")){s=a.attributes;for(u=s.length;f<u;f++)o=s[f].name,o.indexOf("data-")||(o=v.camelCase(o.substring(5)),H(a,o,l[o]));v._data(a,"parsedAttrs",!0)}}return l}return typeof e=="object"?this.each(function(){v.data(this,e)}):(r=e.split(".",2),r[1]=r[1]?"."+r[1]:"",i=r[1]+"!",v.access(this,function(n){if(n===t)return l=this.triggerHandler("getData"+i,[r[0]]),l===t&&a&&(l=v.data(a,e),l=H(a,e,l)),l===t&&r[1]?this.data(r[0]):l;r[1]=n,this.each(function(){var t=v(this);t.triggerHandler("setData"+i,r),v.data(this,e,n),t.triggerHandler("changeData"+i,r)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){v.removeData(this,e)})}}),v.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=v._data(e,t),n&&(!r||v.isArray(n)?r=v._data(e,t,v.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=v.queue(e,t),r=n.length,i=n.shift(),s=v._queueHooks(e,t),o=function(){v.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return v._data(e,n)||v._data(e,n,{empty:v.Callbacks("once memory").add(function(){v.removeData(e,t+"queue",!0),v.removeData(e,n,!0)})})}}),v.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?v.queue(this[0],e):n===t?this:this.each(function(){var t=v.queue(this,e,n);v._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&v.dequeue(this,e)})},dequeue:function(e){return this.each(function(){v.dequeue(this,e)})},delay:function(e,t){return e=v.fx?v.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=v.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--)r=v._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var j,F,I,q=/[\t\r\n]/g,R=/\r/g,U=/^(?:button|input)$/i,z=/^(?:button|input|object|select|textarea)$/i,W=/^a(?:rea|)$/i,X=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,V=v.support.getSetAttribute;v.fn.extend({attr:function(e,t){return v.access(this,v.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){v.removeAttr(this,e)})},prop:function(e,t){return v.access(this,v.prop,e,t,arguments.length>1)},removeProp:function(e){return e=v.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o,u;if(v.isFunction(e))return this.each(function(t){v(this).addClass(e.call(this,t,this.className))});if(e&&typeof e=="string"){t=e.split(y);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&t.length===1)i.className=e;else{s=" "+i.className+" ";for(o=0,u=t.length;o<u;o++)s.indexOf(" "+t[o]+" ")<0&&(s+=t[o]+" ");i.className=v.trim(s)}}}return this},removeClass:function(e){var n,r,i,s,o,u,a;if(v.isFunction(e))return this.each(function(t){v(this).removeClass(e.call(this,t,this.className))});if(e&&typeof e=="string"||e===t){n=(e||"").split(y);for(u=0,a=this.length;u<a;u++){i=this[u];if(i.nodeType===1&&i.className){r=(" "+i.className+" ").replace(q," ");for(s=0,o=n.length;s<o;s++)while(r.indexOf(" "+n[s]+" ")>=0)r=r.replace(" "+n[s]+" "," ");i.className=e?v.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return v.isFunction(e)?this.each(function(n){v(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=v(this),u=t,a=e.split(y);while(i=a[s++])u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}else if(n==="undefined"||n==="boolean")this.className&&v._data(this,"__className__",this.className),this.className=this.className||e===!1?"":v._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(q," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s)return n=v.valHooks[s.type]||v.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,typeof r=="string"?r.replace(R,""):r==null?"":r);return}return i=v.isFunction(e),this.each(function(r){var s,o=v(this);if(this.nodeType!==1)return;i?s=e.call(this,r,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":v.isArray(s)&&(s=v.map(s,function(e){return e==null?"":e+""})),n=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,s,"value")===t)this.value=s})}}),v.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(v.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!v.nodeName(n.parentNode,"optgroup"))){t=v(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n=v.makeArray(t);return v(e).find("option").each(function(){this.selected=v.inArray(v(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;if(i&&v.isFunction(v.fn[n]))return v(e)[n](r);if(typeof e.getAttribute=="undefined")return v.prop(e,n,r);u=a!==1||!v.isXMLDoc(e),u&&(n=n.toLowerCase(),o=v.attrHooks[n]||(X.test(n)?F:j));if(r!==t){if(r===null){v.removeAttr(e,n);return}return o&&"set"in o&&u&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r)}return o&&"get"in o&&u&&(s=o.get(e,n))!==null?s:(s=e.getAttribute(n),s===null?t:s)},removeAttr:function(e,t){var n,r,i,s,o=0;if(t&&e.nodeType===1){r=t.split(y);for(;o<r.length;o++)i=r[o],i&&(n=v.propFix[i]||i,s=X.test(i),s||v.attr(e,i,""),e.removeAttribute(V?i:n),s&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(U.test(e.nodeName)&&e.parentNode)v.error("type property can't be changed");else if(!v.support.radioValue&&t==="radio"&&v.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return j&&v.nodeName(e,"button")?j.get(e,t):t in e?e.value:null},set:function(e,t,n){if(j&&v.nodeName(e,"button"))return j.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;return o=u!==1||!v.isXMLDoc(e),o&&(n=v.propFix[n]||n,s=v.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):z.test(e.nodeName)||W.test(e.nodeName)&&e.href?0:t}}}}),F={get:function(e,n){var r,i=v.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?v.removeAttr(e,n):(r=v.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},V||(I={name:!0,id:!0,coords:!0},j=v.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(I[n]?r.value!=="":r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=i.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},v.each(["width","height"],function(e,t){v.attrHooks[t]=v.extend(v.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})}),v.attrHooks.contenteditable={get:j.get,set:function(e,t,n){t===""&&(t="false"),j.set(e,t,n)}}),v.support.hrefNormalized||v.each(["href","src","width","height"],function(e,n){v.attrHooks[n]=v.extend(v.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),v.support.style||(v.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),v.support.optSelected||(v.propHooks.selected=v.extend(v.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),v.support.enctype||(v.propFix.enctype="encoding"),v.support.checkOn||v.each(["radio","checkbox"],function(){v.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]=v.extend(v.valHooks[this],{set:function(e,t){if(v.isArray(t))return e.checked=v.inArray(v(e).val(),t)>=0}})});var $=/^(?:textarea|input|select)$/i,J=/^([^\.]*|)(?:\.(.+)|)$/,K=/(?:^|\s)hover(\.\S+|)\b/,Q=/^key/,G=/^(?:mouse|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=function(e){return v.event.special.hover?e:e.replace(K,"mouseenter$1 mouseleave$1")};v.event={add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,m,g;if(e.nodeType===3||e.nodeType===8||!n||!r||!(o=v._data(e)))return;r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=v.guid++),a=o.events,a||(o.events=a={}),u=o.handle,u||(o.handle=u=function(e){return typeof v=="undefined"||!!e&&v.event.triggered===e.type?t:v.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=v.trim(Z(n)).split(" ");for(f=0;f<n.length;f++){l=J.exec(n[f])||[],c=l[1],h=(l[2]||"").split(".").sort(),g=v.event.special[c]||{},c=(s?g.delegateType:g.bindType)||c,g=v.event.special[c]||{},p=v.extend({type:c,origType:l[1],data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&v.expr.match.needsContext.test(s),namespace:h.join(".")},d),m=a[c];if(!m){m=a[c]=[],m.delegateCount=0;if(!g.setup||g.setup.call(e,i,h,u)===!1)e.addEventListener?e.addEventListener(c,u,!1):e.attachEvent&&e.attachEvent("on"+c,u)}g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),s?m.splice(m.delegateCount++,0,p):m.push(p),v.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,m,g=v.hasData(e)&&v._data(e);if(!g||!(h=g.events))return;t=v.trim(Z(t||"")).split(" ");for(s=0;s<t.length;s++){o=J.exec(t[s])||[],u=a=o[1],f=o[2];if(!u){for(u in h)v.event.remove(e,u+t[s],n,r,!0);continue}p=v.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,d=h[u]||[],l=d.length,f=f?new RegExp("(^|\\.)"+f.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(c=0;c<d.length;c++)m=d[c],(i||a===m.origType)&&(!n||n.guid===m.guid)&&(!f||f.test(m.namespace))&&(!r||r===m.selector||r==="**"&&m.selector)&&(d.splice(c--,1),m.selector&&d.delegateCount--,p.remove&&p.remove.call(e,m));d.length===0&&l!==d.length&&((!p.teardown||p.teardown.call(e,f,g.handle)===!1)&&v.removeEvent(e,u,g.handle),delete h[u])}v.isEmptyObject(h)&&(delete g.handle,v.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,s,o){if(!s||s.nodeType!==3&&s.nodeType!==8){var u,a,f,l,c,h,p,d,m,g,y=n.type||n,b=[];if(Y.test(y+v.event.triggered))return;y.indexOf("!")>=0&&(y=y.slice(0,-1),a=!0),y.indexOf(".")>=0&&(b=y.split("."),y=b.shift(),b.sort());if((!s||v.event.customEvent[y])&&!v.event.global[y])return;n=typeof n=="object"?n[v.expando]?n:new v.Event(y,n):new v.Event(y),n.type=y,n.isTrigger=!0,n.exclusive=a,n.namespace=b.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=y.indexOf(":")<0?"on"+y:"";if(!s){u=v.cache;for(f in u)u[f].events&&u[f].events[y]&&v.event.trigger(n,r,u[f].handle.elem,!0);return}n.result=t,n.target||(n.target=s),r=r!=null?v.makeArray(r):[],r.unshift(n),p=v.event.special[y]||{};if(p.trigger&&p.trigger.apply(s,r)===!1)return;m=[[s,p.bindType||y]];if(!o&&!p.noBubble&&!v.isWindow(s)){g=p.delegateType||y,l=Y.test(g+y)?s:s.parentNode;for(c=s;l;l=l.parentNode)m.push([l,g]),c=l;c===(s.ownerDocument||i)&&m.push([c.defaultView||c.parentWindow||e,g])}for(f=0;f<m.length&&!n.isPropagationStopped();f++)l=m[f][0],n.type=m[f][1],d=(v._data(l,"events")||{})[n.type]&&v._data(l,"handle"),d&&d.apply(l,r),d=h&&l[h],d&&v.acceptData(l)&&d.apply&&d.apply(l,r)===!1&&n.preventDefault();return n.type=y,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(s.ownerDocument,r)===!1)&&(y!=="click"||!v.nodeName(s,"a"))&&v.acceptData(s)&&h&&s[y]&&(y!=="focus"&&y!=="blur"||n.target.offsetWidth!==0)&&!v.isWindow(s)&&(c=s[h],c&&(s[h]=null),v.event.triggered=y,s[y](),v.event.triggered=t,c&&(s[h]=c)),n.result}return},dispatch:function(n){n=v.event.fix(n||e.event);var r,i,s,o,u,a,f,c,h,p,d=(v._data(this,"events")||{})[n.type]||[],m=d.delegateCount,g=l.call(arguments),y=!n.exclusive&&!n.namespace,b=v.event.special[n.type]||{},w=[];g[0]=n,n.delegateTarget=this;if(b.preDispatch&&b.preDispatch.call(this,n)===!1)return;if(m&&(!n.button||n.type!=="click"))for(s=n.target;s!=this;s=s.parentNode||this)if(s.disabled!==!0||n.type!=="click"){u={},f=[];for(r=0;r<m;r++)c=d[r],h=c.selector,u[h]===t&&(u[h]=c.needsContext?v(h,this).index(s)>=0:v.find(h,this,null,[s]).length),u[h]&&f.push(c);f.length&&w.push({elem:s,matches:f})}d.length>m&&w.push({elem:this,matches:d.slice(m)});for(r=0;r<w.length&&!n.isPropagationStopped();r++){a=w[r],n.currentTarget=a.elem;for(i=0;i<a.matches.length&&!n.isImmediatePropagationStopped();i++){c=a.matches[i];if(y||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace))n.data=c.data,n.handleObj=c,o=((v.event.special[c.origType]||{}).handle||c.handler).apply(a.elem,g),o!==t&&(n.result=o,o===!1&&(n.preventDefault(),n.stopPropagation()))}}return b.postDispatch&&b.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,s,o,u=n.button,a=n.fromElement;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||i,s=r.documentElement,o=r.body,e.pageX=n.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},fix:function(e){if(e[v.expando])return e;var t,n,r=e,s=v.event.fixHooks[e.type]||{},o=s.props?this.props.concat(s.props):this.props;e=v.Event(r);for(t=o.length;t;)n=o[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||i),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){v.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=v.extend(new v.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?v.event.trigger(i,null,t):v.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},v.event.handle=v.event.dispatch,v.removeEvent=i.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},v.Event=function(e,t){if(!(this instanceof v.Event))return new v.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?tt:et):this.type=e,t&&v.extend(this,t),this.timeStamp=e&&e.timeStamp||v.now(),this[v.expando]=!0},v.Event.prototype={preventDefault:function(){this.isDefaultPrevented=tt;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=tt;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=tt,this.stopPropagation()},isDefaultPrevented:et,isPropagationStopped:et,isImmediatePropagationStopped:et},v.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){v.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj,o=s.selector;if(!i||i!==r&&!v.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),v.support.submitBubbles||(v.event.special.submit={setup:function(){if(v.nodeName(this,"form"))return!1;v.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=v.nodeName(n,"input")||v.nodeName(n,"button")?n.form:t;r&&!v._data(r,"_submit_attached")&&(v.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),v._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&v.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(v.nodeName(this,"form"))return!1;v.event.remove(this,"._submit")}}),v.support.changeBubbles||(v.event.special.change={setup:function(){if($.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")v.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),v.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),v.event.simulate("change",this,e,!0)});return!1}v.event.add(this,"beforeactivate._change",function(e){var t=e.target;$.test(t.nodeName)&&!v._data(t,"_change_attached")&&(v.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&v.event.simulate("change",this.parentNode,e,!0)}),v._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return v.event.remove(this,"._change"),!$.test(this.nodeName)}}),v.support.focusinBubbles||v.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){v.event.simulate(t,e.target,v.event.fix(e),!0)};v.event.special[t]={setup:function(){n++===0&&i.addEventListener(e,r,!0)},teardown:function(){--n===0&&i.removeEventListener(e,r,!0)}}}),v.fn.extend({on:function(e,n,r,i,s){var o,u;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(u in e)this.on(u,n,r,e[u],s);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=et;else if(!i)return this;return s===1&&(o=i,i=function(e){return v().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=v.guid++)),this.each(function(){v.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,v(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof e=="object"){for(s in e)this.off(s,n,e[s]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=et),this.each(function(){v.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return v(this.context).on(e,this.selector,t,n),this},die:function(e,t){return v(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){v.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return v.event.trigger(e,t,this[0],!0)},toggle:function(e){var t=arguments,n=e.guid||v.guid++,r=0,i=function(n){var i=(v._data(this,"lastToggle"+e.guid)||0)%r;return v._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){v.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Q.test(t)&&(v.event.fixHooks[t]=v.event.keyHooks),G.test(t)&&(v.event.fixHooks[t]=v.event.mouseHooks)}),function(e,t){function nt(e,t,n,r){n=n||[],t=t||g;var i,s,a,f,l=t.nodeType;if(!e||typeof e!="string")return n;if(l!==1&&l!==9)return[];a=o(t);if(!a&&!r)if(i=R.exec(e))if(f=i[1]){if(l===9){s=t.getElementById(f);if(!s||!s.parentNode)return n;if(s.id===f)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(f))&&u(t,s)&&s.id===f)return n.push(s),n}else{if(i[2])return S.apply(n,x.call(t.getElementsByTagName(e),0)),n;if((f=i[3])&&Z&&t.getElementsByClassName)return S.apply(n,x.call(t.getElementsByClassName(f),0)),n}return vt(e.replace(j,"$1"),t,n,r,a)}function rt(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function it(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function st(e){return N(function(t){return t=+t,N(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function ot(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}function ut(e,t){var n,r,s,o,u,a,f,l=L[d][e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){if(!n||(r=F.exec(u)))r&&(u=u.slice(r[0].length)||u),a.push(s=[]);n=!1;if(r=I.exec(u))s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=r[0].replace(j," ");for(o in i.filter)(r=J[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=o,n.matches=r);if(!n)break}return t?u.length:u?nt.error(e):L(e,a).slice(0)}function at(e,t,r){var i=t.dir,s=r&&t.dir==="parentNode",o=w++;return t.first?function(t,n,r){while(t=t[i])if(s||t.nodeType===1)return e(t,n,r)}:function(t,r,u){if(!u){var a,f=b+" "+o+" ",l=f+n;while(t=t[i])if(s||t.nodeType===1){if((a=t[d])===l)return t.sizset;if(typeof a=="string"&&a.indexOf(f)===0){if(t.sizset)return t}else{t[d]=l;if(e(t,r,u))return t.sizset=!0,t;t.sizset=!1}}}else while(t=t[i])if(s||t.nodeType===1)if(e(t,r,u))return t}}function ft(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function lt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function ct(e,t,n,r,i,s){return r&&!r[d]&&(r=ct(r)),i&&!i[d]&&(i=ct(i,s)),N(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||dt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?lt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=lt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?T.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=lt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):S.apply(o,g)})}function ht(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,f=at(function(e){return e===t},u,!0),l=at(function(e){return T.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==c)||((t=n).nodeType?f(e,n,r):l(e,n,r))}];for(;a<s;a++)if(n=i.relative[e[a].type])h=[at(ft(h),n)];else{n=i.filter[e[a].type].apply(null,e[a].matches);if(n[d]){r=++a;for(;r<s;r++)if(i.relative[e[r].type])break;return ct(a>1&&ft(h),a>1&&e.slice(0,a-1).join("").replace(j,"$1"),n,a<r&&ht(e.slice(a,r)),r<s&&ht(e=e.slice(r)),r<s&&e.join(""))}h.push(n)}return ft(h)}function pt(e,t){var r=t.length>0,s=e.length>0,o=function(u,a,f,l,h){var p,d,v,m=[],y=0,w="0",x=u&&[],T=h!=null,N=c,C=u||s&&i.find.TAG("*",h&&a.parentNode||a),k=b+=N==null?1:Math.E;T&&(c=a!==g&&a,n=o.el);for(;(p=C[w])!=null;w++){if(s&&p){for(d=0;v=e[d];d++)if(v(p,a,f)){l.push(p);break}T&&(b=k,n=++o.el)}r&&((p=!v&&p)&&y--,u&&x.push(p))}y+=w;if(r&&w!==y){for(d=0;v=t[d];d++)v(x,m,a,f);if(u){if(y>0)while(w--)!x[w]&&!m[w]&&(m[w]=E.call(l));m=lt(m)}S.apply(l,m),T&&!u&&m.length>0&&y+t.length>1&&nt.uniqueSort(l)}return T&&(b=k,c=N),x};return o.el=0,r?N(o):o}function dt(e,t,n){var r=0,i=t.length;for(;r<i;r++)nt(e,t[r],n);return n}function vt(e,t,n,r,s){var o,u,f,l,c,h=ut(e),p=h.length;if(!r&&h.length===1){u=h[0]=h[0].slice(0);if(u.length>2&&(f=u[0]).type==="ID"&&t.nodeType===9&&!s&&i.relative[u[1].type]){t=i.find.ID(f.matches[0].replace($,""),t,s)[0];if(!t)return n;e=e.slice(u.shift().length)}for(o=J.POS.test(e)?-1:u.length-1;o>=0;o--){f=u[o];if(i.relative[l=f.type])break;if(c=i.find[l])if(r=c(f.matches[0].replace($,""),z.test(u[0].type)&&t.parentNode||t,s)){u.splice(o,1),e=r.length&&u.join("");if(!e)return S.apply(n,x.call(r,0)),n;break}}}return a(e,h)(r,t,s,n,z.test(e)),n}function mt(){}var n,r,i,s,o,u,a,f,l,c,h=!0,p="undefined",d=("sizcache"+Math.random()).replace(".",""),m=String,g=e.document,y=g.documentElement,b=0,w=0,E=[].pop,S=[].push,x=[].slice,T=[].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},N=function(e,t){return e[d]=t==null||t,e},C=function(){var e={},t=[];return N(function(n,r){return t.push(n)>i.cacheLength&&delete e[t.shift()],e[n+" "]=r},e)},k=C(),L=C(),A=C(),O="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",_=M.replace("w","w#"),D="([*^$|!~]?=)",P="\\["+O+"*("+M+")"+O+"*(?:"+D+O+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+_+")|)|)"+O+"*\\]",H=":("+M+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+P+")|[^:]|\\\\.)*|.*))\\)|)",B=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)",j=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),F=new RegExp("^"+O+"*,"+O+"*"),I=new RegExp("^"+O+"*([\\x20\\t\\r\\n\\f>+~])"+O+"*"),q=new RegExp(H),R=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,U=/^:not/,z=/[\x20\t\r\n\f]*[+~]/,W=/:not\($/,X=/h\d/i,V=/input|select|textarea|button/i,$=/\\(?!\\)/g,J={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),NAME:new RegExp("^\\[name=['\"]?("+M+")['\"]?\\]"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+H),POS:new RegExp(B,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),needsContext:new RegExp("^"+O+"*[>+~]|"+B,"i")},K=function(e){var t=g.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},Q=K(function(e){return e.appendChild(g.createComment("")),!e.getElementsByTagName("*").length}),G=K(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==p&&e.firstChild.getAttribute("href")==="#"}),Y=K(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),Z=K(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),et=K(function(e){e.id=d+0,e.innerHTML="<a name='"+d+"'></a><div name='"+d+"'></div>",y.insertBefore(e,y.firstChild);var t=g.getElementsByName&&g.getElementsByName(d).length===2+g.getElementsByName(d+0).length;return r=!g.getElementById(d),y.removeChild(e),t});try{x.call(y.childNodes,0)[0].nodeType}catch(tt){x=function(e){var t,n=[];for(;t=this[e];e++)n.push(t);return n}}nt.matches=function(e,t){return nt(e,null,null,t)},nt.matchesSelector=function(e,t){return nt(t,null,null,[e]).length>0},s=nt.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(i===3||i===4)return e.nodeValue}else for(;t=e[r];r++)n+=s(t);return n},o=nt.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},u=nt.contains=y.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:y.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode)if(t===e)return!0;return!1},nt.attr=function(e,t){var n,r=o(e);return r||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):r||Y?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},i=nt.selectors={cacheLength:50,createPseudo:N,match:J,attrHandle:G?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:r?function(e,t,n){if(typeof t.getElementById!==p&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==p&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==p&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:Q?function(e,t){if(typeof t.getElementsByTagName!==p)return t.getElementsByTagName(e)}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],s=0;for(;r=n[s];s++)r.nodeType===1&&i.push(r);return i}return n},NAME:et&&function(e,t){if(typeof t.getElementsByName!==p)return t.getElementsByName(name)},CLASS:Z&&function(e,t,n){if(typeof t.getElementsByClassName!==p&&!n)return t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace($,""),e[3]=(e[4]||e[5]||"").replace($,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||nt.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&nt.error(e[0]),e},PSEUDO:function(e){var t,n;if(J.CHILD.test(e[0]))return null;if(e[3])e[2]=e[3];else if(t=e[4])q.test(t)&&(n=ut(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t;return e.slice(0,3)}},filter:{ID:r?function(e){return e=e.replace($,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace($,""),function(t){var n=typeof t.getAttributeNode!==p&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return e==="*"?function(){return!0}:(e=e.replace($,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[d][e+" "];return t||(t=new RegExp("(^|"+O+")"+e+"("+O+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==p&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r,i){var s=nt.attr(r,e);return s==null?t==="!=":t?(s+="",t==="="?s===n:t==="!="?s!==n:t==="^="?n&&s.indexOf(n)===0:t==="*="?n&&s.indexOf(n)>-1:t==="$="?n&&s.substr(s.length-n.length)===n:t==="~="?(" "+s+" ").indexOf(n)>-1:t==="|="?s===n||s.substr(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r){return e==="nth"?function(e){var t,i,s=e.parentNode;if(n===1&&r===0)return!0;if(s){i=0;for(t=s.firstChild;t;t=t.nextSibling)if(t.nodeType===1){i++;if(e===t)break}}return i-=r,i===n||i%n===0&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":while(n=n.previousSibling)if(n.nodeType===1)return!1;if(e==="first")return!0;n=t;case"last":while(n=n.nextSibling)if(n.nodeType===1)return!1;return!0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||nt.error("unsupported pseudo: "+e);return r[d]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?N(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=T.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:N(function(e){var t=[],n=[],r=a(e.replace(j,"$1"));return r[d]?N(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:N(function(e){return function(t){return nt(e,t).length>0}}),contains:N(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!i.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4)return!1;e=e.nextSibling}return!0},header:function(e){return X.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:rt("radio"),checkbox:rt("checkbox"),file:rt("file"),password:rt("password"),image:rt("image"),submit:it("submit"),reset:it("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return V.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},active:function(e){return e===e.ownerDocument.activeElement},first:st(function(){return[0]}),last:st(function(e,t){return[t-1]}),eq:st(function(e,t,n){return[n<0?n+t:n]}),even:st(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:st(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:st(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:st(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},f=y.compareDocumentPosition?function(e,t){return e===t?(l=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t)return l=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],s=[],o=e.parentNode,u=t.parentNode,a=o;if(o===u)return ot(e,t);if(!o)return-1;if(!u)return 1;while(a)i.unshift(a),a=a.parentNode;a=u;while(a)s.unshift(a),a=a.parentNode;n=i.length,r=s.length;for(var f=0;f<n&&f<r;f++)if(i[f]!==s[f])return ot(i[f],s[f]);return f===n?ot(e,s[f],-1):ot(i[f],t,1)},[0,0].sort(f),h=!l,nt.uniqueSort=function(e){var t,n=[],r=1,i=0;l=h,e.sort(f);if(l){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e},nt.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},a=nt.compile=function(e,t){var n,r=[],i=[],s=A[d][e+" "];if(!s){t||(t=ut(e)),n=t.length;while(n--)s=ht(t[n]),s[d]?r.push(s):i.push(s);s=A(e,pt(i,r))}return s},g.querySelectorAll&&function(){var e,t=vt,n=/'|\\/g,r=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,i=[":focus"],s=[":active"],u=y.matchesSelector||y.mozMatchesSelector||y.webkitMatchesSelector||y.oMatchesSelector||y.msMatchesSelector;K(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||i.push("\\["+O+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||i.push(":checked")}),K(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&i.push("[*^$]="+O+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||i.push(":enabled",":disabled")}),i=new RegExp(i.join("|")),vt=function(e,r,s,o,u){if(!o&&!u&&!i.test(e)){var a,f,l=!0,c=d,h=r,p=r.nodeType===9&&e;if(r.nodeType===1&&r.nodeName.toLowerCase()!=="object"){a=ut(e),(l=r.getAttribute("id"))?c=l.replace(n,"\\$&"):r.setAttribute("id",c),c="[id='"+c+"'] ",f=a.length;while(f--)a[f]=c+a[f].join("");h=z.test(e)&&r.parentNode||r,p=a.join(",")}if(p)try{return S.apply(s,x.call(h.querySelectorAll(p),0)),s}catch(v){}finally{l||r.removeAttribute("id")}}return t(e,r,s,o,u)},u&&(K(function(t){e=u.call(t,"div");try{u.call(t,"[test!='']:sizzle"),s.push("!=",H)}catch(n){}}),s=new RegExp(s.join("|")),nt.matchesSelector=function(t,n){n=n.replace(r,"='$1']");if(!o(t)&&!s.test(n)&&!i.test(n))try{var a=u.call(t,n);if(a||e||t.document&&t.document.nodeType!==11)return a}catch(f){}return nt(n,null,null,[t]).length>0})}(),i.pseudos.nth=i.pseudos.eq,i.filters=mt.prototype=i.pseudos,i.setFilters=new mt,nt.attr=v.attr,v.find=nt,v.expr=nt.selectors,v.expr[":"]=v.expr.pseudos,v.unique=nt.uniqueSort,v.text=nt.getText,v.isXMLDoc=nt.isXML,v.contains=nt.contains}(e);var nt=/Until$/,rt=/^(?:parents|prev(?:Until|All))/,it=/^.[^:#\[\.,]*$/,st=v.expr.match.needsContext,ot={children:!0,contents:!0,next:!0,prev:!0};v.fn.extend({find:function(e){var t,n,r,i,s,o,u=this;if(typeof e!="string")return v(e).filter(function(){for(t=0,n=u.length;t<n;t++)if(v.contains(u[t],this))return!0});o=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=o.length,v.find(e,this[t],o);if(t>0)for(i=r;i<o.length;i++)for(s=0;s<r;s++)if(o[s]===o[i]){o.splice(i--,1);break}}return o},has:function(e){var t,n=v(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(v.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1),"not",e)},filter:function(e){return this.pushStack(ft(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?st.test(e)?v(e,this.context).index(this[0])>=0:v.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=st.test(e)||typeof e!="string"?v(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:v.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return s=s.length>1?v.unique(s):s,this.pushStack(s,"closest",e)},index:function(e){return e?typeof e=="string"?v.inArray(this[0],v(e)):v.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?v(e,t):v.makeArray(e&&e.nodeType?[e]:e),r=v.merge(this.get(),n);return this.pushStack(ut(n[0])||ut(r[0])?r:v.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),v.fn.andSelf=v.fn.addBack,v.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return v.dir(e,"parentNode")},parentsUntil:function(e,t,n){return v.dir(e,"parentNode",n)},next:function(e){return at(e,"nextSibling")},prev:function(e){return at(e,"previousSibling")},nextAll:function(e){return v.dir(e,"nextSibling")},prevAll:function(e){return v.dir(e,"previousSibling")},nextUntil:function(e,t,n){return v.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return v.dir(e,"previousSibling",n)},siblings:function(e){return v.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return v.sibling(e.firstChild)},contents:function(e){return v.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:v.merge([],e.childNodes)}},function(e,t){v.fn[e]=function(n,r){var i=v.map(this,t,n);return nt.test(e)||(r=n),r&&typeof r=="string"&&(i=v.filter(r,i)),i=this.length>1&&!ot[e]?v.unique(i):i,this.length>1&&rt.test(e)&&(i=i.reverse()),this.pushStack(i,e,l.call(arguments).join(","))}}),v.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?v.find.matchesSelector(t[0],e)?[t[0]]:[]:v.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!v(s).is(r)))s.nodeType===1&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var ct="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ht=/ jQuery\d+="(?:null|\d+)"/g,pt=/^\s+/,dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,vt=/<([\w:]+)/,mt=/<tbody/i,gt=/<|&#?\w+;/,yt=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,wt=new RegExp("<(?:"+ct+")[\\s/>]","i"),Et=/^(?:checkbox|radio)$/,St=/checked\s*(?:[^=]|=\s*.checked.)/i,xt=/\/(java|ecma)script/i,Tt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Nt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ct=lt(i),kt=Ct.appendChild(i.createElement("div"));Nt.optgroup=Nt.option,Nt.tbody=Nt.tfoot=Nt.colgroup=Nt.caption=Nt.thead,Nt.th=Nt.td,v.support.htmlSerialize||(Nt._default=[1,"X<div>","</div>"]),v.fn.extend({text:function(e){return v.access(this,function(e){return e===t?v.text(this):this.empty().append((this[0]&&this[0].ownerDocument||i).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(v.isFunction(e))return this.each(function(t){v(this).wrapAll(e.call(this,t))});if(this[0]){var t=v(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return v.isFunction(e)?this.each(function(t){v(this).wrapInner(e.call(this,t))}):this.each(function(){var t=v(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=v.isFunction(e);return this.each(function(n){v(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(e,this),"before",this.selector)}},after:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++)if(!e||v.filter(e,[n]).length)!t&&n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),v.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n);return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&v.cleanData(e.getElementsByTagName("*"));while(e.firstChild)e.removeChild(e.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return v.clone(this,e,t)})},html:function(e){return v.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(ht,""):t;if(typeof e=="string"&&!yt.test(e)&&(v.support.htmlSerialize||!wt.test(e))&&(v.support.leadingWhitespace||!pt.test(e))&&!Nt[(vt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(dt,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return ut(this[0])?this.length?this.pushStack(v(v.isFunction(e)?e():e),"replaceWith",e):this:v.isFunction(e)?this.each(function(t){var n=v(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=v(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;v(this).remove(),t?v(t).before(e):v(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,s,o,u,a=0,f=e[0],l=[],c=this.length;if(!v.support.checkClone&&c>1&&typeof f=="string"&&St.test(f))return this.each(function(){v(this).domManip(e,n,r)});if(v.isFunction(f))return this.each(function(i){var s=v(this);e[0]=f.call(this,i,n?s.html():t),s.domManip(e,n,r)});if(this[0]){i=v.buildFragment(e,this,l),o=i.fragment,s=o.firstChild,o.childNodes.length===1&&(o=s);if(s){n=n&&v.nodeName(s,"tr");for(u=i.cacheable||c-1;a<c;a++)r.call(n&&v.nodeName(this[a],"table")?Lt(this[a],"tbody"):this[a],a===u?o:v.clone(o,!0,!0))}o=s=null,l.length&&v.each(l,function(e,t){t.src?v.ajax?v.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):v.error("no ajax"):v.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Tt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),v.buildFragment=function(e,n,r){var s,o,u,a=e[0];return n=n||i,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,e.length===1&&typeof a=="string"&&a.length<512&&n===i&&a.charAt(0)==="<"&&!bt.test(a)&&(v.support.checkClone||!St.test(a))&&(v.support.html5Clone||!wt.test(a))&&(o=!0,s=v.fragments[a],u=s!==t),s||(s=n.createDocumentFragment(),v.clean(e,n,s,r),o&&(v.fragments[a]=u&&s)),{fragment:s,cacheable:o}},v.fragments={},v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){v.fn[e]=function(n){var r,i=0,s=[],o=v(n),u=o.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&u===1)return o[t](this[0]),this;for(;i<u;i++)r=(i>0?this.clone(!0):this).get(),v(o[i])[t](r),s=s.concat(r);return this.pushStack(s,e,o.selector)}}),v.extend({clone:function(e,t,n){var r,i,s,o;v.support.html5Clone||v.isXMLDoc(e)||!wt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(kt.innerHTML=e.outerHTML,kt.removeChild(o=kt.firstChild));if((!v.support.noCloneEvent||!v.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!v.isXMLDoc(e)){Ot(e,o),r=Mt(e),i=Mt(o);for(s=0;r[s];++s)i[s]&&Ot(r[s],i[s])}if(t){At(e,o);if(n){r=Mt(e),i=Mt(o);for(s=0;r[s];++s)At(r[s],i[s])}}return r=i=null,o},clean:function(e,t,n,r){var s,o,u,a,f,l,c,h,p,d,m,g,y=t===i&&Ct,b=[];if(!t||typeof t.createDocumentFragment=="undefined")t=i;for(s=0;(u=e[s])!=null;s++){typeof u=="number"&&(u+="");if(!u)continue;if(typeof u=="string")if(!gt.test(u))u=t.createTextNode(u);else{y=y||lt(t),c=t.createElement("div"),y.appendChild(c),u=u.replace(dt,"<$1></$2>"),a=(vt.exec(u)||["",""])[1].toLowerCase(),f=Nt[a]||Nt._default,l=f[0],c.innerHTML=f[1]+u+f[2];while(l--)c=c.lastChild;if(!v.support.tbody){h=mt.test(u),p=a==="table"&&!h?c.firstChild&&c.firstChild.childNodes:f[1]==="<table>"&&!h?c.childNodes:[];for(o=p.length-1;o>=0;--o)v.nodeName(p[o],"tbody")&&!p[o].childNodes.length&&p[o].parentNode.removeChild(p[o])}!v.support.leadingWhitespace&&pt.test(u)&&c.insertBefore(t.createTextNode(pt.exec(u)[0]),c.firstChild),u=c.childNodes,c.parentNode.removeChild(c)}u.nodeType?b.push(u):v.merge(b,u)}c&&(u=c=y=null);if(!v.support.appendChecked)for(s=0;(u=b[s])!=null;s++)v.nodeName(u,"input")?_t(u):typeof u.getElementsByTagName!="undefined"&&v.grep(u.getElementsByTagName("input"),_t);if(n){m=function(e){if(!e.type||xt.test(e.type))return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)};for(s=0;(u=b[s])!=null;s++)if(!v.nodeName(u,"script")||!m(u))n.appendChild(u),typeof u.getElementsByTagName!="undefined"&&(g=v.grep(v.merge([],u.getElementsByTagName("script")),m),b.splice.apply(b,[s+1,0].concat(g)),s+=g.length)}return b},cleanData:function(e,t){var n,r,i,s,o=0,u=v.expando,a=v.cache,f=v.support.deleteExpando,l=v.event.special;for(;(i=e[o])!=null;o++)if(t||v.acceptData(i)){r=i[u],n=r&&a[r];if(n){if(n.events)for(s in n.events)l[s]?v.event.remove(i,s):v.removeEvent(i,s,n.handle);a[r]&&(delete a[r],f?delete i[u]:i.removeAttribute?i.removeAttribute(u):i[u]=null,v.deletedIds.push(r))}}}}),function(){var e,t;v.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=v.uaMatch(o.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),v.browser=t,v.sub=function(){function e(t,n){return new e.fn.init(t,n)}v.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,i){return i&&i instanceof v&&!(i instanceof e)&&(i=e(i)),v.fn.init.call(this,r,i,t)},e.fn.init.prototype=e.fn;var t=e(i);return e}}();var Dt,Pt,Ht,Bt=/alpha\([^)]*\)/i,jt=/opacity=([^)]*)/,Ft=/^(top|right|bottom|left)$/,It=/^(none|table(?!-c[ea]).+)/,qt=/^margin/,Rt=new RegExp("^("+m+")(.*)$","i"),Ut=new RegExp("^("+m+")(?!px)[a-z%]+$","i"),zt=new RegExp("^([-+])=("+m+")","i"),Wt={BODY:"block"},Xt={position:"absolute",visibility:"hidden",display:"block"},Vt={letterSpacing:0,fontWeight:400},$t=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"],Kt=v.fn.toggle;v.fn.extend({css:function(e,n){return v.access(this,function(e,n,r){return r!==t?v.style(e,n,r):v.css(e,n)},e,n,arguments.length>1)},show:function(){return Yt(this,!0)},hide:function(){return Yt(this)},toggle:function(e,t){var n=typeof e=="boolean";return v.isFunction(e)&&v.isFunction(t)?Kt.apply(this,arguments):this.each(function(){(n?e:Gt(this))?v(this).show():v(this).hide()})}}),v.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Dt(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":v.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var s,o,u,a=v.camelCase(n),f=e.style;n=v.cssProps[a]||(v.cssProps[a]=Qt(f,a)),u=v.cssHooks[n]||v.cssHooks[a];if(r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];o=typeof r,o==="string"&&(s=zt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(v.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r))return;o==="number"&&!v.cssNumber[a]&&(r+="px");if(!u||!("set"in u)||(r=u.set(e,r,i))!==t)try{f[n]=r}catch(l){}},css:function(e,n,r,i){var s,o,u,a=v.camelCase(n);return n=v.cssProps[a]||(v.cssProps[a]=Qt(e.style,a)),u=v.cssHooks[n]||v.cssHooks[a],u&&"get"in u&&(s=u.get(e,!0,i)),s===t&&(s=Dt(e,n)),s==="normal"&&n in Vt&&(s=Vt[n]),r||i!==t?(o=parseFloat(s),r||v.isNumeric(o)?o||0:s):s},swap:function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=s[i];return r}}),e.getComputedStyle?Dt=function(t,n){var r,i,s,o,u=e.getComputedStyle(t,null),a=t.style;return u&&(r=u.getPropertyValue(n)||u[n],r===""&&!v.contains(t.ownerDocument,t)&&(r=v.style(t,n)),Ut.test(r)&&qt.test(n)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=u.width,a.width=i,a.minWidth=s,a.maxWidth=o)),r}:i.documentElement.currentStyle&&(Dt=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],s=e.style;return i==null&&s&&s[t]&&(i=s[t]),Ut.test(i)&&!Ft.test(t)&&(n=s.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),s.left=t==="fontSize"?"1em":i,i=s.pixelLeft+"px",s.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),v.each(["height","width"],function(e,t){v.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&It.test(Dt(e,"display"))?v.swap(e,Xt,function(){return tn(e,t,r)}):tn(e,t,r)},set:function(e,n,r){return Zt(e,n,r?en(e,t,r,v.support.boxSizing&&v.css(e,"boxSizing")==="border-box"):0)}}}),v.support.opacity||(v.cssHooks.opacity={get:function(e,t){return jt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=v.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&v.trim(s.replace(Bt,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=Bt.test(s)?s.replace(Bt,i):s+" "+i}}),v(function(){v.support.reliableMarginRight||(v.cssHooks.marginRight={get:function(e,t){return v.swap(e,{display:"inline-block"},function(){if(t)return Dt(e,"marginRight")})}}),!v.support.pixelPosition&&v.fn.position&&v.each(["top","left"],function(e,t){v.cssHooks[t]={get:function(e,n){if(n){var r=Dt(e,t);return Ut.test(r)?v(e).position()[t]+"px":r}}}})}),v.expr&&v.expr.filters&&(v.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!v.support.reliableHiddenOffsets&&(e.style&&e.style.display||Dt(e,"display"))==="none"},v.expr.filters.visible=function(e){return!v.expr.filters.hidden(e)}),v.each({margin:"",padding:"",border:"Width"},function(e,t){v.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++)s[e+$t[r]+t]=i[r]||i[r-2]||i[0];return s}},qt.test(e)||(v.cssHooks[e+t].set=Zt)});var rn=/%20/g,sn=/\[\]$/,on=/\r?\n/g,un=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,an=/^(?:select|textarea)/i;v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?v.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||an.test(this.nodeName)||un.test(this.type))}).map(function(e,t){var n=v(this).val();return n==null?null:v.isArray(n)?v.map(n,function(e,n){return{name:t.name,value:e.replace(on,"\r\n")}}):{name:t.name,value:n.replace(on,"\r\n")}}).get()}}),v.param=function(e,n){var r,i=[],s=function(e,t){t=v.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=v.ajaxSettings&&v.ajaxSettings.traditional);if(v.isArray(e)||e.jquery&&!v.isPlainObject(e))v.each(e,function(){s(this.name,this.value)});else for(r in e)fn(r,e[r],n,s);return i.join("&").replace(rn,"+")};var ln,cn,hn=/#.*$/,pn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,dn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,vn=/^(?:GET|HEAD)$/,mn=/^\/\//,gn=/\?/,yn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bn=/([?&])_=[^&]*/,wn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,En=v.fn.load,Sn={},xn={},Tn=["*/"]+["*"];try{cn=s.href}catch(Nn){cn=i.createElement("a"),cn.href="",cn=cn.href}ln=wn.exec(cn.toLowerCase())||[],v.fn.load=function(e,n,r){if(typeof e!="string"&&En)return En.apply(this,arguments);if(!this.length)return this;var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),v.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(s="POST"),v.ajax({url:e,type:s,dataType:"html",data:n,complete:function(e,t){r&&u.each(r,o||[e.responseText,t,e])}}).done(function(e){o=arguments,u.html(i?v("<div>").append(e.replace(yn,"")).find(i):e)}),this},v.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){v.fn[t]=function(e){return this.on(t,e)}}),v.each(["get","post"],function(e,n){v[n]=function(e,r,i,s){return v.isFunction(r)&&(s=s||i,i=r,r=t),v.ajax({type:n,url:e,data:r,success:i,dataType:s})}}),v.extend({getScript:function(e,n){return v.get(e,t,n,"script")},getJSON:function(e,t,n){return v.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?Ln(e,v.ajaxSettings):(t=e,e=v.ajaxSettings),Ln(e,t),e},ajaxSettings:{url:cn,isLocal:dn.test(ln[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Tn},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:Cn(Sn),ajaxTransport:Cn(xn),ajax:function(e,n){function T(e,n,s,a){var l,y,b,w,S,T=n;if(E===2)return;E=2,u&&clearTimeout(u),o=t,i=a||"",x.readyState=e>0?4:0,s&&(w=An(c,x,s));if(e>=200&&e<300||e===304)c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(v.lastModified[r]=S),S=x.getResponseHeader("Etag"),S&&(v.etag[r]=S)),e===304?(T="notmodified",l=!0):(l=On(c,w),T=l.state,y=l.data,b=l.error,l=!b);else{b=T;if(!T||e)T="error",e<0&&(e=0)}x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[y,T,x]):d.rejectWith(h,[x,T,b]),x.statusCode(g),g=t,f&&p.trigger("ajax"+(l?"Success":"Error"),[x,c,l?y:b]),m.fireWith(h,[x,T]),f&&(p.trigger("ajaxComplete",[x,c]),--v.active||v.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=v.ajaxSetup({},n),h=c.context||c,p=h!==c&&(h.nodeType||h instanceof v)?v(h):v.event,d=v.Deferred(),m=v.Callbacks("once memory"),g=c.statusCode||{},b={},w={},E=0,S="canceled",x={readyState:0,setRequestHeader:function(e,t){if(!E){var n=e.toLowerCase();e=w[n]=w[n]||e,b[e]=t}return this},getAllResponseHeaders:function(){return E===2?i:null},getResponseHeader:function(e){var n;if(E===2){if(!s){s={};while(n=pn.exec(i))s[n[1].toLowerCase()]=n[2]}n=s[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return E||(c.mimeType=e),this},abort:function(e){return e=e||S,o&&o.abort(e),T(0,e),this}};d.promise(x),x.success=x.done,x.error=x.fail,x.complete=m.add,x.statusCode=function(e){if(e){var t;if(E<2)for(t in e)g[t]=[g[t],e[t]];else t=e[x.status],x.always(t)}return this},c.url=((e||c.url)+"").replace(hn,"").replace(mn,ln[1]+"//"),c.dataTypes=v.trim(c.dataType||"*").toLowerCase().split(y),c.crossDomain==null&&(a=wn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===ln[1]&&a[2]===ln[2]&&(a[3]||(a[1]==="http:"?80:443))==(ln[3]||(ln[1]==="http:"?80:443)))),c.data&&c.processData&&typeof c.data!="string"&&(c.data=v.param(c.data,c.traditional)),kn(Sn,c,n,x);if(E===2)return x;f=c.global,c.type=c.type.toUpperCase(),c.hasContent=!vn.test(c.type),f&&v.active++===0&&v.event.trigger("ajaxStart");if(!c.hasContent){c.data&&(c.url+=(gn.test(c.url)?"&":"?")+c.data,delete c.data),r=c.url;if(c.cache===!1){var N=v.now(),C=c.url.replace(bn,"$1_="+N);c.url=C+(C===c.url?(gn.test(c.url)?"&":"?")+"_="+N:"")}}(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),c.ifModified&&(r=r||c.url,v.lastModified[r]&&x.setRequestHeader("If-Modified-Since",v.lastModified[r]),v.etag[r]&&x.setRequestHeader("If-None-Match",v.etag[r])),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+(c.dataTypes[0]!=="*"?", "+Tn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)x.setRequestHeader(l,c.headers[l]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&E!==2){S="abort";for(l in{success:1,error:1,complete:1})x[l](c[l]);o=kn(xn,c,n,x);if(!o)T(-1,"No Transport");else{x.readyState=1,f&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{E=1,o.send(b,T)}catch(k){if(!(E<2))throw k;T(-1,k)}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var Mn=[],_n=/\?/,Dn=/(=)\?(?=&|$)|\?\?/,Pn=v.now();v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mn.pop()||v.expando+"_"+Pn++;return this[e]=!0,e}}),v.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.data,f=n.url,l=n.jsonp!==!1,c=l&&Dn.test(f),h=l&&!c&&typeof a=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Dn.test(a);if(n.dataTypes[0]==="jsonp"||c||h)return s=n.jsonpCallback=v.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,o=e[s],c?n.url=f.replace(Dn,"$1"+s):h?n.data=a.replace(Dn,"$1"+s):l&&(n.url+=(_n.test(f)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||v.error(s+" was not called"),u[0]},n.dataTypes[0]="json",e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Mn.push(s)),u&&v.isFunction(o)&&o(u[0]),u=o=t}),"script"}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return v.globalEval(e),e}}}),v.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),v.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=i.head||i.getElementsByTagName("head")[0]||i.documentElement;return{send:function(s,o){n=i.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){if(i||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||o(200,"success")},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Hn,Bn=e.ActiveXObject?function(){for(var e in Hn)Hn[e](0,1)}:!1,jn=0;v.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&Fn()||In()}:Fn,function(e){v.extend(v.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(v.ajaxSettings.xhr()),v.support.ajax&&v.ajaxTransport(function(n){if(!n.crossDomain||v.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=v.noop,Bn&&delete Hn[o]);if(i)a.readyState!==4&&a.abort();else{u=a.status,l=a.getAllResponseHeaders(),c={},h=a.responseXML,h&&h.documentElement&&(c.xml=h);try{c.text=a.responseText}catch(p){}try{f=a.statusText}catch(p){f=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?a.readyState===4?setTimeout(r,0):(o=++jn,Bn&&(Hn||(Hn={},v(e).unload(Bn)),Hn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var qn,Rn,Un=/^(?:toggle|show|hide)$/,zn=new RegExp("^(?:([-+])=|)("+m+")([a-z%]*)$","i"),Wn=/queueHooks$/,Xn=[Gn],Vn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=zn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(v.cssNumber[e]?"":"px");if(r!=="px"&&u){u=v.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,v.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};v.Animation=v.extend(Kn,{tweener:function(e,t){v.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],Vn[n]=Vn[n]||[],Vn[n].unshift(t)},prefilter:function(e,t){t?Xn.unshift(e):Xn.push(e)}}),v.Tween=Yn,Yn.prototype={constructor:Yn,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(v.cssNumber[n]?"":"px")},cur:function(){var e=Yn.propHooks[this.prop];return e&&e.get?e.get(this):Yn.propHooks._default.get(this)},run:function(e){var t,n=Yn.propHooks[this.prop];return this.options.duration?this.pos=t=v.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yn.propHooks._default.set(this),this}},Yn.prototype.init.prototype=Yn.prototype,Yn.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=v.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){v.fx.step[e.prop]?v.fx.step[e.prop](e):e.elem.style&&(e.elem.style[v.cssProps[e.prop]]!=null||v.cssHooks[e.prop])?v.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Yn.propHooks.scrollTop=Yn.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},v.each(["toggle","show","hide"],function(e,t){var n=v.fn[t];v.fn[t]=function(r,i,s){return r==null||typeof r=="boolean"||!e&&v.isFunction(r)&&v.isFunction(i)?n.apply(this,arguments):this.animate(Zn(t,!0),r,i,s)}}),v.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Gt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=v.isEmptyObject(e),s=v.speed(t,n,r),o=function(){var t=Kn(this,v.extend({},e),s);i&&t.stop(!0)};return i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=v.timers,o=v._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Wn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&v.dequeue(this,e)})}}),v.each({slideDown:Zn("show"),slideUp:Zn("hide"),slideToggle:Zn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){v.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),v.speed=function(e,t,n){var r=e&&typeof e=="object"?v.extend({},e):{complete:n||!n&&t||v.isFunction(e)&&e,duration:e,easing:n&&t||t&&!v.isFunction(t)&&t};r.duration=v.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in v.fx.speeds?v.fx.speeds[r.duration]:v.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){v.isFunction(r.old)&&r.old.call(this),r.queue&&v.dequeue(this,r.queue)},r},v.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},v.timers=[],v.fx=Yn.prototype.init,v.fx.tick=function(){var e,n=v.timers,r=0;qn=v.now();for(;r<n.length;r++)e=n[r],!e()&&n[r]===e&&n.splice(r--,1);n.length||v.fx.stop(),qn=t},v.fx.timer=function(e){e()&&v.timers.push(e)&&!Rn&&(Rn=setInterval(v.fx.tick,v.fx.interval))},v.fx.interval=13,v.fx.stop=function(){clearInterval(Rn),Rn=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fx.step={},v.expr&&v.expr.filters&&(v.expr.filters.animated=function(e){return v.grep(v.timers,function(t){return e===t.elem}).length});var er=/^(?:body|html)$/i;v.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){v.offset.setOffset(this,e,t)});var n,r,i,s,o,u,a,f={top:0,left:0},l=this[0],c=l&&l.ownerDocument;if(!c)return;return(r=c.body)===l?v.offset.bodyOffset(l):(n=c.documentElement,v.contains(n,l)?(typeof l.getBoundingClientRect!="undefined"&&(f=l.getBoundingClientRect()),i=tr(c),s=n.clientTop||r.clientTop||0,o=n.clientLeft||r.clientLeft||0,u=i.pageYOffset||n.scrollTop,a=i.pageXOffset||n.scrollLeft,{top:f.top+u-s,left:f.left+a-o}):f)},v.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return v.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(v.css(e,"marginTop"))||0,n+=parseFloat(v.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=v.css(e,"position");r==="static"&&(e.style.position="relative");var i=v(e),s=i.offset(),o=v.css(e,"top"),u=v.css(e,"left"),a=(r==="absolute"||r==="fixed")&&v.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),v.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},v.fn.extend({position:function(){if(!this[0])return;var e=this[0],t=this.offsetParent(),n=this.offset(),r=er.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(v.css(e,"marginTop"))||0,n.left-=parseFloat(v.css(e,"marginLeft"))||0,r.top+=parseFloat(v.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(v.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||i.body;while(e&&!er.test(e.nodeName)&&v.css(e,"position")==="static")e=e.offsetParent;return e||i.body})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);v.fn[e]=function(i){return v.access(this,function(e,i,s){var o=tr(e);if(s===t)return o?n in o?o[n]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?v(o).scrollLeft():s,r?s:v(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),v.each({Height:"height",Width:"width"},function(e,n){v.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){v.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return v.access(this,function(n,r,i){var s;return v.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?v.css(n,r,i,u):v.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=v,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return v})}(window),define("mockup-registry",["jquery"],function(e,t){var n={patterns:{},warn:function(e){window.DEBUG&&window.console&&console.warn(e)},getOptions:function(t,r,i){i=i||{},t.length!==0&&!e.nodeName(t[0],"body")&&(i=n.getOptions(t.parent(),r,i));var s={};if(t.length!==0){s=t.data("pat-"+r);if(s&&typeof s=="string"){var o={};e.each(s.split(";"),function(e,t){t=t.split(":"),t.reverse();var n=t.pop();n=n.replace(/^\s+|\s+$/g,""),t.reverse();var r=t.join(":");r=r.replace(/^\s+|\s+$/g,""),o[n]=r}),s=o}}return e.extend(!0,{},i,s)},init:function(e,r,i){var s=e.data("pattern-"+r);if(s===t&&n.patterns[r]){if(window.DEBUG)s=new n.patterns[r](e,n.getOptions(e,r,i));else try{s=new n.patterns[r](e,n.getOptions(e,r,i))}catch(o){n.warn('Failed while initializing "'+r+'" pattern.')}e.data("pattern-"+r,s)}return s},scan:function(t){var r=e(t),i=[];i=e.merge(i,r.filter('[class*="pat-"]')),i=e.merge(i,e('[class*="pat-"]',r)),e.each(i,function(t,r){r=e(r),e.each(r.attr("class").split(" "),function(e,t){t.indexOf("pat-")===0&&n.init(r,t.substr(4))})})},register:function(r){if(!r.prototype.name)return n.warn("Pattern didn't specified a name."),!1;r.prototype.jqueryPlugin===t&&(r.prototype.jqueryPlugin="pattern"+r.prototype.name.charAt(0).toUpperCase()+r.prototype.name.slice(1)),e.fn[r.prototype.jqueryPlugin]=function(i,s){return e(this).each(function(){typeof i=="object"&&(s=i,i=t);var o=e(this),u=n.init(o,r.prototype.name,s);if(i){if(u[i]===t)return n.warn('Method "'+i+'" does not exists.'),!1;if(i.charAt(0)==="_")return n.warn('Method "'+i+'" is private.'),!1;u[i].apply(u,[s])}}),this},n.patterns[r.prototype.name]=r}};return n}),define("mockup-patterns-base",["jquery","mockup-registry"],function(e,t){var n=function(t,n){this.$el=t,this.options=e.extend(!0,{},this.defaults||{},n||{}),this.init(),this.trigger("init")};return n.prototype={constructor:n,on:function(e,t){this.$el.on(e+"."+this.name+".patterns",t)},trigger:function(e,t){t===undefined&&(t=[]),this.$el.trigger(e+"."+this.name+".patterns",t)}},n.extend=function(n){var r=this,i;n&&n.hasOwnProperty("constructor")?i=n.constructor:i=function(){r.apply(this,arguments)};var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,i.extend=r.extend,e.extend(!0,i.prototype,n),i.__super__=r.prototype,t.register(i),i},n}),function(e){typeof e.fn.each2=="undefined"&&e.extend(e.fn,{each2:function(t){var n=e([0]),r=-1,i=this.length;while(++r<i&&(n.context=n[0]=this[r])&&t.call(n[0],r,n)!==!1);return this}})}(jQuery),function(e,t){function p(e){var t,n,r,i;if(!e||e.length<1)return e;t="";for(n=0,r=e.length;n<r;n++)i=e.charAt(n),t+=h[i]||i;return t}function d(e,t){var n=0,r=t.length;for(;n<r;n+=1)if(m(e,t[n]))return n;return-1}function v(){var t=e(c);t.appendTo("body");var n={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),n}function m(e,n){return e===n?!0:e===t||n===t?!1:e===null||n===null?!1:e.constructor===String?e+""==n+"":n.constructor===String?n+""==e+"":!1}function g(t,n){var r,i,s;if(t===null||t.length<1)return[];r=t.split(n);for(i=0,s=r.length;i<s;i+=1)r[i]=e.trim(r[i]);return r}function y(e){return e.outerWidth(!1)-e.width()}function b(n){var r="keyup-change-value";n.on("keydown",function(){e.data(n,r)===t&&e.data(n,r,n.val())}),n.on("keyup",function(){var i=e.data(n,r);i!==t&&n.val()!==i&&(e.removeData(n,r),n.trigger("keyup-change"))})}function w(n){n.on("mousemove",function(n){var r=a;(r===t||r.x!==n.pageX||r.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function E(e,n,r){r=r||t;var i;return function(){var t=arguments;window.clearTimeout(i),i=window.setTimeout(function(){n.apply(r,t)},e)}}function S(e){var t=!1,n;return function(){return t===!1&&(n=e(),t=!0),n}}function x(e,t){var n=E(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){d(e.target,t.get())>=0&&n(e)})}function T(e){if(e[0]===document.activeElement)return;window.setTimeout(function(){var t=e[0],n=e.val().length,r;e.focus(),e.is(":visible")&&t===document.activeElement&&(t.setSelectionRange?t.setSelectionRange(n,n):t.createTextRange&&(r=t.createTextRange(),r.collapse(!1),r.select()))},0)}function N(t){t=e(t)[0];var n=0,r=0;if("selectionStart"in t)n=t.selectionStart,r=t.selectionEnd-n;else if("selection"in document){t.focus();var i=document.selection.createRange();r=document.selection.createRange().text.length,i.moveStart("character",-t.value.length),n=i.text.length-r}return{offset:n,length:r}}function C(e){e.preventDefault(),e.stopPropagation()}function k(e){e.preventDefault(),e.stopImmediatePropagation()}function L(t){if(!u){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);u=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),u.attr("class","select2-sizer"),e("body").append(u)}return u.text(t.val()),u.width()}function A(t,n,r){var i,s=[],o;i=t.attr("class"),i&&(i=""+i,e(i.split(" ")).each2(function(){this.indexOf("select2-")===0&&s.push(this)})),i=n.attr("class"),i&&(i=""+i,e(i.split(" ")).each2(function(){this.indexOf("select2-")!==0&&(o=r(this),o&&s.push(o))})),t.attr("class",s.join(" "))}function O(e,t,n,r){var i=p(e.toUpperCase()).indexOf(p(t.toUpperCase())),s=t.length;if(i<0){n.push(r(e));return}n.push(r(e.substring(0,i))),n.push("<span class='select2-match'>"),n.push(r(e.substring(i,i+s))),n.push("</span>"),n.push(r(e.substring(i+s,e.length)))}function M(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function _(n){var r,i=null,s=n.quietMillis||100,o=n.url,u=this;return function(a){window.clearTimeout(r),r=window.setTimeout(function(){var r=n.data,s=o,f=n.transport||e.fn.select2.ajaxDefaults.transport,l={type:n.type||"GET",cache:n.cache||!1,jsonpCallback:n.jsonpCallback||t,dataType:n.dataType||"json"},c=e.extend({},e.fn.select2.ajaxDefaults.params,l);r=r?r.call(u,a.term,a.page,a.context):null,s=typeof s=="function"?s.call(u,a.term,a.page,a.context):s,i&&i.abort(),n.params&&(e.isFunction(n.params)?e.extend(c,n.params.call(u)):e.extend(c,n.params)),e.extend(c,{url:s,dataType:n.dataType,data:r,success:function(e){var t=n.results(e,a.page);a.callback(t)}}),i=f.call(u,c)},s)}}function D(t){var n=t,r,i,s=function(e){return""+e.text};e.isArray(n)&&(i=n,n={results:i}),e.isFunction(n)===!1&&(i=n,n=function(){return i});var o=n();return o.text&&(s=o.text,e.isFunction(s)||(r=o.text,s=function(e){return e[r]})),function(t){var r=t.term,i={results:[]},o;if(r===""){t.callback(n());return}o=function(n,i){var u,a;n=n[0];if(n.children){u={};for(a in n)n.hasOwnProperty(a)&&(u[a]=n[a]);u.children=[],e(n.children).each2(function(e,t){o(t,u.children)}),(u.children.length||t.matcher(r,s(u),n))&&i.push(u)}else t.matcher(r,s(n),n)&&i.push(n)},e(n().results).each2(function(e,t){o(t,i.results)}),t.callback(i)}}function P(n){var r=e.isFunction(n);return function(i){var s=i.term,o={results:[]};e(r?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;(s===""||i.matcher(s,n))&&o.results.push(e?this:{id:this,text:this})}),i.callback(o)}}function H(t,n){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error(n+" must be a function or a falsy value")}function B(t){return e.isFunction(t)?t():t}function j(t){var n=0;return e.each(t,function(e,t){t.children?n+=j(t.children):n++}),n}function F(e,n,r,i){var s=e,o=!1,u,a,f,l,c;if(!i.createSearchChoice||!i.tokenSeparators||i.tokenSeparators.length<1)return t;for(;;){a=-1;for(f=0,l=i.tokenSeparators.length;f<l;f++){c=i.tokenSeparators[f],a=e.indexOf(c);if(a>=0)break}if(a<0)break;u=e.substring(0,a),e=e.substring(a+c.length);if(u.length>0){u=i.createSearchChoice.call(this,u,n);if(u!==t&&u!==null&&i.id(u)!==t&&i.id(u)!==null){o=!1;for(f=0,l=n.length;f<l;f++)if(m(i.id(u),i.id(n[f]))){o=!0;break}o||r(u)}}}if(s!==e)return e}function I(t,n){var r=function(){};return r.prototype=new t,r.prototype.constructor=r,r.prototype.parent=t.prototype,r.prototype=e.extend(r.prototype,n),r}if(window.Select2!==t)return;var n,r,i,s,o,u,a={x:0,y:0},f,l,n={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case n.LEFT:case n.RIGHT:case n.UP:case n.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case n.SHIFT:case n.CTRL:case n.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&e<=123}},c="<div class='select2-measure-scrollbar'></div>",h={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z"};f=e(document),o=function(){var e=1;return function(){return e++}}(),f.on("mousemove",function(e){a.x=e.pageX,a.y=e.pageY}),r=I(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var r,i,s=".select2-results";this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&n.element.data("select2")!==null&&n.element.data("select2").destroy(),this.container=this.createContainer(),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+o()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=S(function(){return n.element.closest("body")}),A(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",n.element.attr("style")),this.container.css(B(n.containerCss)),this.container.addClass(B(n.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",C),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),A(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(B(n.dropdownCssClass)),this.dropdown.data("select2",this),this.dropdown.on("click",C),this.results=r=this.container.find(s),this.search=i=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",C),w(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",s,this.bind(this.highlightUnderEvent)),x(80,this.results),this.dropdown.on("scroll-debounced",s,this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&r.mousewheel(function(e,t,n,i){var s=r.scrollTop();i>0&&s-i<=0?(r.scrollTop(0),C(e)):i<0&&r.get(0).scrollHeight-r.scrollTop()+i<=r.height()&&(r.scrollTop(r.get(0).scrollHeight-r.height()),C(e))}),b(i),i.on("keyup-change input paste",this.bind(this.updateResults)),i.on("focus",function(){i.addClass("select2-focused")}),i.on("blur",function(){i.removeClass("select2-focused")}),this.dropdown.on("mouseup",s,this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),n.maximumInputLength!==null&&this.search.attr("maxlength",n.maximumInputLength);var u=n.element.prop("disabled");u===t&&(u=!1),this.enable(!u);var a=n.element.prop("readonly");a===t&&(a=!1),this.readonly(a),l=l||v(),this.autofocus=n.element.prop("autofocus"),n.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.nextSearchTerm=t},destroy:function(){var e=this.opts.element,n=e.data("select2");this.close(),this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),n!==t&&(n.container.remove(),n.dropdown.remove(),e.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show())},optionToData:function(e){if(e.is("option"))return{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:m(e.attr("locked"),"locked")||m(e.data("locked"),!0)};if(e.is("optgroup"))return{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}},prepareOpts:function(n){var r,i,s,o,u=this;r=n.element,r.get(0).tagName.toLowerCase()==="select"&&(this.select=i=n.element),i&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(r,i,s){var o,a=this.opts.id;o=function(r,i,f){var l,c,h,p,d,v,m,g,y,b;r=n.sortResults(r,i,s);for(l=0,c=r.length;l<c;l+=1)h=r[l],d=h.disabled===!0,p=!d&&a(h)!==t,v=h.children&&h.children.length>0,m=e("<li></li>"),m.addClass("select2-results-dept-"+f),m.addClass("select2-result"),m.addClass(p?"select2-result-selectable":"select2-result-unselectable"),d&&m.addClass("select2-disabled"),v&&m.addClass("select2-result-with-children"),m.addClass(u.opts.formatResultCssClass(h)),g=e(document.createElement("div")),g.addClass("select2-result-label"),b=n.formatResult(h,g,s,u.opts.escapeMarkup),b!==t&&g.html(b),m.append(g),v&&(y=e("<ul></ul>"),y.addClass("select2-result-sub"),o(h.children,y,f+1),m.append(y)),m.data("select2-data",h),i.append(m)},o(i,r,0)}},e.fn.select2.defaults,n),typeof n.id!="function"&&(s=n.id,n.id=function(e){return e[s]});if(e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.data("select2Tags")}i?(n.query=this.bind(function(e){var n={results:[],more:!1},i=e.term,s,o,a;a=function(t,n){var r;t.is("option")?e.matcher(i,t.text(),t)&&n.push(u.optionToData(t)):t.is("optgroup")&&(r=u.optionToData(t),t.children().each2(function(e,t){a(t,r.children)}),r.children.length>0&&n.push(r))},s=r.children(),this.getPlaceholder()!==t&&s.length>0&&(o=this.getPlaceholderOption(),o&&(s=s.not(o))),s.each2(function(e,t){a(t,n.results)}),e.callback(n)}),n.id=function(e){return e.id},n.formatResultCssClass=function(e){return e.css}):"query"in n||("ajax"in n?(o=n.element.data("ajax-url"),o&&o.length>0&&(n.ajax.url=o),n.query=_.call(n.element,n.ajax)):"data"in n?n.query=D(n.data):"tags"in n&&(n.query=P(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(t){return{id:e.trim(t),text:e.trim(t)}}),n.initSelection===t&&(n.initSelection=function(t,r){var i=[];e(g(t.val(),n.separator)).each(function(){var t={id:this,text:this},r=n.tags;e.isFunction(r)&&(r=r()),e(r).each(function(){if(m(this.id,t.id))return t=this,!1}),i.push(t)}),r(i)})));if(typeof n.query!="function")throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){var e=this.opts.element,n,r;e.on("change.select2",this.bind(function(e){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),n=this.bind(function(){var n=e.prop("disabled");n===t&&(n=!1),this.enable(!n);var r=e.prop("readonly");r===t&&(r=!1),this.readonly(r),A(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(B(this.opts.containerCssClass)),A(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(B(this.opts.dropdownCssClass))}),e.on("propertychange.select2",n),this.mutationCallback===t&&(this.mutationCallback=function(e){e.forEach(n)}),r=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,r!==t&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new r(this.mutationCallback),this.propertyObserver.observe(e.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var n=e.Event("select2-selecting",{val:this.id(t),object:t});return this.opts.element.trigger(n),!n.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===t&&(e=!0);if(this._enabled===e)return;this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface()},disable:function(){this.enable(!1)},readonly:function(e){return e===t&&(e=!1),this._readonly===e?!1:(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface(),!0)},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t=this.dropdown,n=this.container.offset(),r=this.container.outerHeight(!1),i=this.container.outerWidth(!1),s=t.outerHeight(!1),o=e(window),u=o.width(),a=o.height(),f=o.scrollLeft()+u,c=o.scrollTop()+a,h=n.top+r,p=n.left,d=h+s<=c,v=n.top-s>=this.body().scrollTop(),m=t.outerWidth(!1),g=p+m<=f,y=t.hasClass("select2-drop-above"),b,w,E,S,x;y?(w=!0,!v&&d&&(E=!0,w=!1)):(w=!1,!d&&v&&(E=!0,w=!0)),E&&(t.hide(),n=this.container.offset(),r=this.container.outerHeight(!1),i=this.container.outerWidth(!1),s=t.outerHeight(!1),f=o.scrollLeft()+u,c=o.scrollTop()+a,h=n.top+r,p=n.left,m=t.outerWidth(!1),g=p+m<=f,t.show()),this.opts.dropdownAutoWidth?(x=e(".select2-results",t)[0],t.addClass("select2-drop-auto-width"),t.css("width",""),m=t.outerWidth(!1)+(x.scrollHeight===x.clientHeight?0:l.width),m>i?i=m:m=i,g=p+m<=f):this.container.removeClass("select2-drop-auto-width"),this.body().css("position")!=="static"&&(b=this.body().offset(),h-=b.top,p-=b.left),g||(p=n.left+i-m),S={left:p,width:i},w?(S.bottom=a-n.top,S.top="auto",this.container.addClass("select2-drop-above"),t.addClass("select2-drop-above")):(S.top=h,S.bottom="auto",this.container.removeClass("select2-drop-above"),t.removeClass("select2-drop-above")),S=e.extend(S,B(this.opts.dropdownCss)),t.css(S)},shouldOpen:function(){var t;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),!0):!1},opening:function(){var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t,s;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),s=e("#select2-drop-mask"),s.length==0&&(s=e(document.createElement("div")),s.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),s.hide(),s.appendTo(this.body()),s.on("mousedown touchstart click",function(t){var n=e("#select2-drop"),r;n.length>0&&(r=n.data("select2"),r.opts.selectOnBlur&&r.selectHighlighted({noFocus:!0}),r.close({focus:!0}),t.preventDefault(),t.stopPropagation())})),this.dropdown.prev()[0]!==s[0]&&this.dropdown.before(s),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),s.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var o=this;this.container.parents().add(window).each(function(){e(this).on(r+" "+n+" "+i,function(e){o.positionDropdown()})})},close:function(){if(!this.opened())return;var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(n).off(r).off(i)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(e.Event("select2-close"))},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return B(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t=this.results,n,r,i,s,o,u,a;r=this.highlight();if(r<0)return;if(r==0){t.scrollTop(0);return}n=this.findHighlightableChoices().find(".select2-result-label"),i=e(n[r]),s=i.offset().top+i.outerHeight(!0),r===n.length-1&&(a=t.find("li.select2-more-results"),a.length>0&&(s=a.offset().top+a.outerHeight(!0))),o=t.offset().top+t.outerHeight(!0),s>o&&t.scrollTop(t.scrollTop()+(s-o)),u=i.offset().top-t.offset().top,u<0&&i.css("display")!="none"&&t.scrollTop(t.scrollTop()+u)},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled, .select2-selected)")},moveHighlight:function(t){var n=this.findHighlightableChoices(),r=this.highlight();while(r>-1&&r<n.length){r+=t;var i=e(n[r]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")&&!i.hasClass("select2-selected")){this.highlight(r);break}}},highlight:function(t){var n=this.findHighlightableChoices(),r,i;if(arguments.length===0)return d(n.filter(".select2-highlighted")[0],n.get());t>=n.length&&(t=n.length-1),t<0&&(t=0),this.removeHighlight(),r=e(n[t]),r.addClass("select2-highlighted"),this.ensureHighlightVisible(),i=r.data("select2-data"),i&&this.opts.element.trigger({type:"select2-highlight",val:this.id(i),choice:i})},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var r=this.findHighlightableChoices();this.highlight(r.index(n))}else n.length==0&&this.removeHighlight()},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),n,r=this.resultsPage+1,i=this,s=this.search.val(),o=this.context;if(t.length===0)return;n=t.offset().top-e.offset().top-e.height(),n<=this.opts.loadMorePadding&&(t.addClass("select2-active"),this.opts.query({element:this.opts.element,term:s,page:r,context:o,matcher:this.opts.matcher,callback:this.bind(function(n){if(!i.opened())return;i.opts.populateResults.call(this,e,n.results,{term:s,page:r,context:o}),i.postprocessResults(n,!1,!1),n.more===!0?(t.detach().appendTo(e).text(i.opts.formatLoadMore(r+1)),window.setTimeout(function(){i.loadMoreIfNeeded()},10)):t.remove(),i.positionDropdown(),i.resultsPage=r,i.context=n.context,this.opts.element.trigger({type:"select2-loaded",items:n})})}))},tokenize:function(){},updateResults:function(n){function h(){r.removeClass("select2-active"),u.positionDropdown()}function p(e){i.html(e),h()}var r=this.search,i=this.results,s=this.opts,o,u=this,a,f=r.val(),l=e.data(this.container,"select2-last-term"),c;if(n!==!0&&l&&m(f,l))return;e.data(this.container,"select2-last-term",f);if(n!==!0&&(this.showSearchInput===!1||!this.opened()))return;c=++this.queryCount;var d=this.getMaximumSelectionSize();if(d>=1){o=this.data();if(e.isArray(o)&&o.length>=d&&H(s.formatSelectionTooBig,"formatSelectionTooBig")){p("<li class='select2-selection-limit'>"+s.formatSelectionTooBig(d)+"</li>");return}}if(r.val().length<s.minimumInputLength){H(s.formatInputTooShort,"formatInputTooShort")?p("<li class='select2-no-results'>"+s.formatInputTooShort(r.val(),s.minimumInputLength)+"</li>"):p(""),n&&this.showSearch&&this.showSearch(!0);return}if(s.maximumInputLength&&r.val().length>s.maximumInputLength){H(s.formatInputTooLong,"formatInputTooLong")?p("<li class='select2-no-results'>"+s.formatInputTooLong(r.val(),s.maximumInputLength)+"</li>"):p("");return}s.formatSearching&&this.findHighlightableChoices().length===0&&p("<li class='select2-searching'>"+s.formatSearching()+"</li>"),r.addClass("select2-active"),this.removeHighlight(),a=this.tokenize(),a!=t&&a!=null&&r.val(a),this.resultsPage=1,s.query({element:s.element,term:r.val(),page:this.resultsPage,context:null,matcher:s.matcher,callback:this.bind(function(o){var a;if(c!=this.queryCount)return;if(!this.opened()){this.search.removeClass("select2-active");return}this.context=o.context===t?null:o.context,this.opts.createSearchChoice&&r.val()!==""&&(a=this.opts.createSearchChoice.call(u,r.val(),o.results),a!==t&&a!==null&&u.id(a)!==t&&u.id(a)!==null&&e(o.results).filter(function(){return m(u.id(this),u.id(a))}).length===0&&o.results.unshift(a));if(o.results.length===0&&H(s.formatNoMatches,"formatNoMatches")){p("<li class='select2-no-results'>"+s.formatNoMatches(r.val())+"</li>");return}i.empty(),u.opts.populateResults.call(this,i,o.results,{term:r.val(),page:this.resultsPage,context:null}),o.more===!0&&H(s.formatLoadMore,"formatLoadMore")&&(i.append("<li class='select2-more-results'>"+u.opts.escapeMarkup(s.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){u.loadMoreIfNeeded()},10)),this.postprocessResults(o,n),h(),this.opts.element.trigger({type:"select2-loaded",items:o})})})},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){T(this.search)},selectHighlighted:function(e){var t=this.highlight(),n=this.results.find(".select2-highlighted"),r=n.closest(".select2-result").data("select2-data");r?(this.highlight(t),this.onSelect(r,e)):e&&e.noFocus&&this.close()},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var e=this.select.children("option").first();if(this.opts.placeholderOption!==t)return this.opts.placeholderOption==="first"&&e||typeof this.opts.placeholderOption=="function"&&this.opts.placeholderOption(this.select);if(e.text()===""&&e.val()==="")return e}},initContainerWidth:function(){function n(){var n,r,i,s,o,u;if(this.opts.width==="off")return null;if(this.opts.width==="element")return this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px";if(this.opts.width==="copy"||this.opts.width==="resolve"){n=this.opts.element.attr("style");if(n!==t){r=n.split(";");for(s=0,o=r.length;s<o;s+=1){u=r[s].replace(/\s/g,""),i=u.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i);if(i!==null&&i.length>=1)return i[1]}}return this.opts.width==="resolve"?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var r=n.call(this);r!==null&&this.container.css("width",r)}}),i=I(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow'><b></b></span>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var n,r,i;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.search.focus(),n=this.search.get(0),n.createTextRange?(r=n.createTextRange(),r.collapse(!1),r.select()):n.setSelectionRange&&(i=this.search.val().length,n.setSelectionRange(i,i)),this.search.val()===""&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(e){if(!this.opened())return;this.parent.close.apply(this,arguments),e=e||{focus:!0},this.focusser.removeAttr("disabled"),e.focus&&this.focusser.focus()},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var t,r=this.container,i=this.dropdown;this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=t=r.find(".select2-choice"),this.focusser=r.find(".select2-focusser"),this.focusser.attr("id","s2id_autogen"+o()),e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id")),this.focusser.attr("tabindex",this.elementTabIndex),this.search.on("keydown",this.bind(function(e){if(!this.isInterfaceEnabled())return;if(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN){C(e);return}switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1),C(e);return;case n.ENTER:this.selectHighlighted(),C(e);return;case n.TAB:this.selectHighlighted({noFocus:!0});return;case n.ESC:this.cancel(e),C(e);return}})),this.search.on("blur",this.bind(function(e){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(!this.isInterfaceEnabled())return;if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.ESC)return;if(this.opts.openOnEnter===!1&&e.which===n.ENTER){C(e);return}if(e.which==n.DOWN||e.which==n.UP||e.which==n.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;this.open(),C(e);return}if(e.which==n.DELETE||e.which==n.BACKSPACE){this.opts.allowClear&&this.clear(),C(e);return}})),b(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){e.stopPropagation();if(this.opened())return;this.open()}})),t.on("mousedown","abbr",this.bind(function(e){if(!this.isInterfaceEnabled())return;this.clear(),k(e),this.close(),this.selection.focus()})),t.on("mousedown",this.bind(function(t){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),C(t)})),i.on("mousedown",this.bind(function(){this.search.focus()})),t.on("focus",this.bind(function(e){C(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(t){var n=this.selection.data("select2-data");if(n){var r=e.Event("select2-clearing");this.opts.element.trigger(r);if(r.isDefaultPrevented())return;var i=this.getPlaceholderOption();this.opts.element.val(i?i.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),t!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}))}},initSelection:function(){var e;if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.setPlaceholder())})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()?(e=this.getPlaceholderOption())!==t&&e.prop("selected")||this.opts.element.val()===""||this.opts.element.val()===t||this.opts.element.val()===null:!1},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(e,t){var r=e.find("option").filter(function(){return this.selected});t(n.optionToData(r))}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=n.val(),s=null;t.query({matcher:function(e,n,r){var o=m(i,t.id(r));return o&&(s=r),o},callback:e.isFunction(r)?function(){r(s)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,n){var r=0,i=this,s=!0;this.findHighlightableChoices().each2(function(e,t){if(m(i.id(t.data("select2-data")),i.opts.element.val()))return r=e,!1}),n!==!1&&(t===!0&&r>=0?this.highlight(r):this.highlight(0));if(t===!0){var o=this.opts.minimumResultsForSearch;o>=0&&this.showSearch(j(e.results)>=o)}},showSearch:function(t){if(this.showSearchInput===t)return;this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t)},onSelect:function(e,t){if(!this.triggerSelect(e))return;var n=this.opts.element.val(),r=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.close(),(!t||!t.noFocus)&&this.focusser.focus(),m(n,this.id(e))||this.triggerChange({added:e,removed:r})},updateSelection:function(e){var n=this.selection.find(".select2-chosen"),r,i;this.selection.data("select2-data",e),n.empty(),e!==null&&(r=this.opts.formatSelection(e,n,this.opts.escapeMarkup)),r!==t&&n.append(r),i=this.opts.formatSelectionCssClass(e,n),i!==t&&n.addClass(i),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")},val:function(){var e,n=!1,r=null,i=this,s=this.data();if(arguments.length===0)return this.opts.element.val();e=arguments[0],arguments.length>1&&(n=arguments[1]);if(this.select)this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return r=i.optionToData(t),!1}),this.updateSelection(r),this.setPlaceholder(),n&&this.triggerChange({added:r,removed:s});else{if(!e&&e!==0){this.clear(n);return}if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),n&&i.triggerChange({added:e,removed:s})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n,r=!1;if(arguments.length===0)return n=this.selection.data("select2-data"),n==t&&(n=null),n;arguments.length>1&&(r=arguments[1]),e?(n=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),r&&this.triggerChange({added:e,removed:n})):this.clear(r)}}),s=I(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(e,t){var r=[];e.find("option").filter(function(){return this.selected}).each2(function(e,t){r.push(n.optionToData(t))}),t(r)}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=g(n.val(),t.separator),s=[];t.query({matcher:function(n,r,o){var u=e.grep(i,function(e){return m(e,t.id(o))}).length;return u&&s.push(o),u},callback:e.isFunction(r)?function(){var e=[];for(var n=0;n<i.length;n++){var o=i[n];for(var u=0;u<s.length;u++){var a=s[u];if(m(o,t.id(a))){e.push(a),s.splice(u,1);break}}}r(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");if(!t.length||!e||e[0]!=t[0])t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e))},destroy:function(){e("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var t=".select2-choices",r;this.searchContainer=this.container.find(".select2-search-field"),this.selection=r=this.container.find(t);var i=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(t){i.search[0].focus(),i.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+o()),e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){if(!this.isInterfaceEnabled())return;this.opened()||this.open()})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(!this.isInterfaceEnabled())return;++this.keydowns;var t=r.find(".select2-search-choice-focus"),i=t.prev(".select2-search-choice:not(.select2-locked)"),s=t.next(".select2-search-choice:not(.select2-locked)"),o=N(this.search);if(!(!t.length||e.which!=n.LEFT&&e.which!=n.RIGHT&&e.which!=n.BACKSPACE&&e.which!=n.DELETE&&e.which!=n.ENTER)){var u=t;e.which==n.LEFT&&i.length?u=i:e.which==n.RIGHT?u=s.length?s:null:e.which===n.BACKSPACE?(this.unselect(t.first()),this.search.width(10),u=i.length?i:s):e.which==n.DELETE?(this.unselect(t.first()),this.search.width(10),u=s.length?s:null):e.which==n.ENTER&&(u=null),this.selectChoice(u),C(e),(!u||!u.length)&&this.open();return}if((e.which===n.BACKSPACE&&this.keydowns==1||e.which==n.LEFT)&&o.offset==0&&!o.length){this.selectChoice(r.find(".select2-search-choice:not(.select2-locked)").last()),C(e);return}this.selectChoice(null);if(this.opened())switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1),C(e);return;case n.ENTER:this.selectHighlighted(),C(e);return;case n.TAB:this.selectHighlighted({noFocus:!0}),this.close();return;case n.ESC:this.cancel(e),C(e);return}if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.BACKSPACE||e.which===n.ESC)return;if(e.which===n.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN)&&C(e),e.which===n.ENTER&&C(e)})),this.search.on("keyup",this.bind(function(e){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",t,this.bind(function(t){if(!this.isInterfaceEnabled())return;if(e(t.target).closest(".select2-search-choice").length>0)return;this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()})),this.container.on("focus",t,this.bind(function(){if(!this.isInterfaceEnabled())return;this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder()})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){var e;this.opts.element.val()===""&&this.opts.element.text()===""&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||this.opts.element.val()!==""){var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==t&&e!==null&&(n.updateSelection(e),n.close(),n.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),n=this.getMaxSearchWidth();e!==t&&this.getVal().length===0&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.search.width(n>0?n:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.updateResults(!0),this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],r=[],i=this;e(t).each(function(){d(i.id(this),n)<0&&(n.push(i.id(this)),r.push(this))}),t=r,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){i.addSelectedChoice(this)}),i.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts),e!=null&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){if(!this.triggerSelect(e))return;this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(e,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),(!t||!t.noFocus)&&this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var r=!n.locked,i=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),s=e("<li class='select2-search-choice select2-locked'><div></div></li>"),o=r?i:s,u=this.id(n),a=this.getVal(),f,l;f=this.opts.formatSelection(n,o.find("div"),this.opts.escapeMarkup),f!=t&&o.find("div").replaceWith("<div>"+f+"</div>"),l=this.opts.formatSelectionCssClass(n,o.find("div")),l!=t&&o.addClass(l),r&&o.find(".select2-search-choice-close").on("mousedown",C).on("click dblclick",this.bind(function(t){if(!this.isInterfaceEnabled())return;e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),C(t)})).on("focus",this.bind(function(){if(!this.isInterfaceEnabled())return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active")})),o.data("select2-data",n),o.insertBefore(this.searchContainer),a.push(u),this.setVal(a)},unselect:function(t){var n=this.getVal(),r,i;t=t.closest(".select2-search-choice");if(t.length===0)throw"Invalid argument: "+t+". Must be .select2-search-choice";r=t.data("select2-data");if(!r)return;while((i=d(this.id(r),n))>=0)n.splice(i,1),this.setVal(n),this.select&&this.postprocessResults();var s=e.Event("select2-removing");s.val=this.id(r),s.choice=r,this.opts.element.trigger(s);if(s.isDefaultPrevented())return;t.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(r),choice:r}),this.triggerChange({removed:r})},postprocessResults:function(e,t,n){var r=this.getVal(),i=this.results.find(".select2-result"),s=this.results.find(".select2-result-with-children"),o=this;i.each2(function(e,t){var n=o.id(t.data("select2-data"));d(n,r)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),s.each2(function(e,t){!t.is(".select2-result-selectable")&&t.find(".select2-result-selectable:not(.select2-selected)").length===0&&t.addClass("select2-selected")}),this.highlight()==-1&&n!==!1&&o.highlight(0),!this.opts.createSearchChoice&&!i.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&this.results.find(".select2-no-results").length===0)&&H(o.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+o.opts.formatNoMatches(o.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-y(this.search)},resizeSearch:function(){var e,t,n,r,i,s=y(this.search);e=L(this.search)+10,t=this.search.offset().left,n=this.selection.width(),r=this.selection.offset().left,i=n-(t-r)-s,i<e&&(i=n-s),i<40&&(i=n-s),i<=0&&(i=e),this.search.width(Math.floor(i))},getVal:function(){var e;return this.select?(e=this.select.val(),e===null?[]:e):(e=this.opts.element.val(),g(e,this.opts.separator))},setVal:function(t){var n;this.select?this.select.val(t):(n=[],e(t).each(function(){d(this,n)<0&&n.push(this)}),this.opts.element.val(n.length===0?"":n.join(this.opts.separator)))},buildChangeDetails:function(e,t){var t=t.slice(0),e=e.slice(0);for(var n=0;n<t.length;n++)for(var r=0;r<e.length;r++)m(this.opts.id(t[n]),this.opts.id(e[r]))&&(t.splice(n,1),n>0&&n--,e.splice(r,1),r--);return{added:t,removed:e}},val:function(n,r){var i,s=this;if(arguments.length===0)return this.getVal();i=this.data(),i.length||(i=[]);if(!n&&n!==0){this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),r&&this.triggerChange({added:this.data(),removed:i});return}this.setVal(n);if(this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),r&&this.triggerChange(this.buildChangeDetails(i,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e.map(t,s.id);s.setVal(n),s.updateSelection(t),s.clearSearch(),r&&s.triggerChange(s.buildChangeDetails(i,s.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,n){var r=this,i,s;if(arguments.length===0)return this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get();s=this.data(),t||(t=[]),i=e.map(t,function(e){return r.opts.id(e)}),this.setVal(i),this.updateSelection(t),this.clearSearch(),n&&this.triggerChange(this.buildChangeDetails(s,this.data()))}}),e.fn.select2=function(){var n=Array.prototype.slice.call(arguments,0),r,o,u,a,f,l=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],c=["opened","isFocused","container","dropdown"],h=["val","data"],p={search:"externalSearch"};return this.each(function(){if(n.length===0||typeof n[0]=="object")r=n.length===0?{}:e.extend({},n[0]),r.element=e(this),r.element.get(0).tagName.toLowerCase()==="select"?f=r.element.prop("multiple"):(f=r.multiple||!1,"tags"in r&&(r.multiple=f=!0)),o=f?new s:new i,o.init(r);else{if(typeof n[0]!="string")throw"Invalid arguments to select2 plugin: "+n;if(d(n[0],l)<0)throw"Unknown method: "+n[0];a=t,o=e(this).data("select2");if(o===t)return;u=n[0],u==="container"?a=o.container:u==="dropdown"?a=o.dropdown:(p[u]&&(u=p[u]),a=o[u].apply(o,n.slice(1)));if(d(n[0],c)>=0||d(n[0],h)&&n.length==1)return!1}}),a===t?this:a},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,r){var i=[];return O(e.text,n.term,i,r),i.join("")},formatSelection:function(e,n,r){return e?r(e.text):t},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return t},formatSelectionCssClass:function(e,n){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(n==1?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(n==1?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(e==1?"":"s")},formatLoadMore:function(e){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return p(""+t).toUpperCase().indexOf(p(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:F,escapeMarkup:M,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null},nextSearchTerm:function(e,n){return t}},e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:_,local:D,tags:P},util:{debounce:E,markMatch:O,escapeMarkup:M,stripDiacritics:p},"class":{"abstract":r,single:i,multi:s}}}(jQuery),define("select2",function(){}),function(e){e.fn.drag=function(t,n,r){var i=typeof t=="string"?t:"",s=e.isFunction(t)?t:e.isFunction(n)?n:null;return i.indexOf("drag")!==0&&(i="drag"+i),r=(t==s?n:r)||{},s?this.bind(i,r,s):this.trigger(i)};var t=e.event,n=t.special,r=n.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(t){var n=e.data(this,r.datakey),i=t.data||{};n.related+=1,e.each(r.defaults,function(e,t){i[e]!==undefined&&(n[e]=i[e])})},remove:function(){e.data(this,r.datakey).related-=1},setup:function(){if(e.data(this,r.datakey))return;var n=e.extend({related:0},r.defaults);e.data(this,r.datakey,n),t.add(this,"touchstart mousedown",r.init,n),this.attachEvent&&this.attachEvent("ondragstart",r.dontstart)},teardown:function(){var n=e.data(this,r.datakey)||{};if(n.related)return;e.removeData(this,r.datakey),t.remove(this,"touchstart mousedown",r.init),r.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",r.dontstart)},init:function(i){if(r.touched)return;var s=i.data,o;if(i.which!=0&&s.which>0&&i.which!=s.which)return;if(e(i.target).is(s.not))return;if(s.handle&&!e(i.target).closest(s.handle,i.currentTarget).length)return;r.touched=i.type=="touchstart"?this:null,s.propagates=1,s.mousedown=this,s.interactions=[r.interaction(this,s)],s.target=i.target,s.pageX=i.pageX,s.pageY=i.pageY,s.dragging=null,o=r.hijack(i,"draginit",s);if(!s.propagates)return;o=r.flatten(o),o&&o.length&&(s.interactions=[],e.each(o,function(){s.interactions.push(r.interaction(this,s))})),s.propagates=s.interactions.length,s.drop!==!1&&n.drop&&n.drop.handler(i,s),r.textselect(!1),r.touched?t.add(r.touched,"touchmove touchend",r.handler,s):t.add(document,"mousemove mouseup",r.handler,s);if(!r.touched||s.live)return!1},interaction:function(t,n){var i=e(t)[n.relative?"position":"offset"]()||{top:0,left:0};return{drag:t,callback:new r.callback,droppable:[],offset:i}},handler:function(i){var s=i.data;switch(i.type){case!s.dragging&&"touchmove":i.preventDefault();case!s.dragging&&"mousemove":if(Math.pow(i.pageX-s.pageX,2)+Math.pow(i.pageY-s.pageY,2)<Math.pow(s.distance,2))break;i.target=s.target,r.hijack(i,"dragstart",s),s.propagates&&(s.dragging=!0);case"touchmove":i.preventDefault();case"mousemove":if(s.dragging){r.hijack(i,"drag",s);if(s.propagates){s.drop!==!1&&n.drop&&n.drop.handler(i,s);break}i.type="mouseup"};case"touchend":case"mouseup":default:r.touched?t.remove(r.touched,"touchmove touchend",r.handler):t.remove(document,"mousemove mouseup",r.handler),s.dragging&&(s.drop!==!1&&n.drop&&n.drop.handler(i,s),r.hijack(i,"dragend",s)),r.textselect(!0),s.click===!1&&s.dragging&&e.data(s.mousedown,"suppress.click",(new Date).getTime()+5),s.dragging=r.touched=!1}},hijack:function(n,i,s,o,u){if(!s)return;var a={event:n.originalEvent,type:n.type},f=i.indexOf("drop")?"drag":"drop",l,c=o||0,h,p,d,v=isNaN(o)?s.interactions.length:o;n.type=i,n.originalEvent=null,s.results=[];do if(h=s.interactions[c]){if(i!=="dragend"&&h.cancelled)continue;d=r.properties(n,s,h),h.results=[],e(u||h[f]||s.droppable).each(function(o,u){d.target=u,n.isPropagationStopped=function(){return!1},l=u?t.dispatch.call(u,n,d):null,l===!1?(f=="drag"&&(h.cancelled=!0,s.propagates-=1),i=="drop"&&(h[f][o]=null)):i=="dropinit"&&h.droppable.push(r.element(l)||u),i=="dragstart"&&(h.proxy=e(r.element(l)||h.drag)[0]),h.results.push(l),delete n.result;if(i!=="dropinit")return l}),s.results[c]=r.flatten(h.results),i=="dropinit"&&(h.droppable=r.flatten(h.droppable)),i=="dragstart"&&!h.cancelled&&d.update()}while(++c<v);return n.type=a.type,n.originalEvent=a.event,r.flatten(s.results)},properties:function(e,t,n){var i=n.callback;return i.drag=n.drag,i.proxy=n.proxy||n.drag,i.startX=t.pageX,i.startY=t.pageY,i.deltaX=e.pageX-t.pageX,i.deltaY=e.pageY-t.pageY,i.originalX=n.offset.left,i.originalY=n.offset.top,i.offsetX=i.originalX+i.deltaX,i.offsetY=i.originalY+i.deltaY,i.drop=r.flatten((n.drop||[]).slice()),i.available=r.flatten((n.droppable||[]).slice()),i},element:function(e){if(e&&(e.jquery||e.nodeType==1))return e},flatten:function(t){return e.map(t,function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?r.flatten(t):t})},textselect:function(t){e(document)[t?"unbind":"bind"]("selectstart",r.dontstart).css("MozUserSelect",t?"":"none"),document.unselectable=t?"off":"on"},dontstart:function(){return!1},callback:function(){}};r.callback.prototype={update:function(){n.drop&&this.available.length&&e.each(this.available,function(e){n.drop.locate(this,e)})}};var i=t.dispatch;t.dispatch=function(t){if(e.data(this,"suppress."+t.type)-(new Date).getTime()>0){e.removeData(this,"suppress."+t.type);return}return i.apply(this,arguments)};var s=t.fixHooks.touchstart=t.fixHooks.touchmove=t.fixHooks.touchend=t.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(t,n){if(n){var r=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0]||null;r&&e.each(s.props,function(e,n){t[n]=r[n]})}return t}};n.draginit=n.dragstart=n.dragend=r}(jQuery),define("jquery.event.drag",["jquery"],function(){}),function(e){e.fn.drop=function(t,n,r){var i=typeof t=="string"?t:"",s=e.isFunction(t)?t:e.isFunction(n)?n:null;return i.indexOf("drop")!==0&&(i="drop"+i),r=(t==s?n:r)||{},s?this.bind(i,r,s):this.trigger(i)},e.drop=function(t){t=t||{},r.multi=t.multi===!0?Infinity:t.multi===!1?1:isNaN(t.multi)?r.multi:t.multi,r.delay=t.delay||r.delay,r.tolerance=e.isFunction(t.tolerance)?t.tolerance:t.tolerance===null?null:r.tolerance,r.mode=t.mode||r.mode||"intersect"};var t=e.event,n=t.special,r=e.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(t){var n=e.data(this,r.datakey);n.related+=1},remove:function(){e.data(this,r.datakey).related-=1},setup:function(){if(e.data(this,r.datakey))return;var t={related:0,active:[],anyactive:0,winner:0,location:{}};e.data(this,r.datakey,t),r.targets.push(this)},teardown:function(){var t=e.data(this,r.datakey)||{};if(t.related)return;e.removeData(this,r.datakey);var n=this;r.targets=e.grep(r.targets,function(e){return e!==n})},handler:function(t,i){var s,o;if(!i)return;switch(t.type){case"mousedown":case"touchstart":o=e(r.targets),typeof i.drop=="string"&&(o=o.filter(i.drop)),o.each(function(){var t=e.data(this,r.datakey);t.active=[],t.anyactive=0,t.winner=0}),i.droppable=o,n.drag.hijack(t,"dropinit",i);break;case"mousemove":case"touchmove":r.event=t,r.timer||r.tolerate(i);break;case"mouseup":case"touchend":r.timer=clearTimeout(r.timer),i.propagates&&(n.drag.hijack(t,"drop",i),n.drag.hijack(t,"dropend",i))}},locate:function(t,n){var i=e.data(t,r.datakey),s=e(t),o=s.offset()||{},u=s.outerHeight(),a=s.outerWidth(),f={elem:t,width:a,height:u,top:o.top,left:o.left,right:o.left+a,bottom:o.top+u};return i&&(i.location=f,i.index=n,i.elem=t),f},contains:function(e,t){return(t[0]||t.left)>=e.left&&(t[0]||t.right)<=e.right&&(t[1]||t.top)>=e.top&&(t[1]||t.bottom)<=e.bottom},modes:{intersect:function(e,t,n){return this.contains(n,[e.pageX,e.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(e,t,n){return Math.max(0,Math.min(n.bottom,t.bottom)-Math.max(n.top,t.top))*Math.max(0,Math.min(n.right,t.right)-Math.max(n.left,t.left))},fit:function(e,t,n){return this.contains(n,t)?1:0},middle:function(e,t,n){return this.contains(n,[t.left+t.width*.5,t.top+t.height*.5])?1:0}},sort:function(e,t){return t.winner-e.winner||e.index-t.index},tolerate:function(t){var i,s,o,u,a,f,l,c=0,h,p=t.interactions.length,d=[r.event.pageX,r.event.pageY],v=r.tolerance||r.modes[r.mode];do if(h=t.interactions[c]){if(!h)return;h.drop=[],a=[],f=h.droppable.length,v&&(o=r.locate(h.proxy)),i=0;do if(l=h.droppable[i]){u=e.data(l,r.datakey),s=u.location;if(!s)continue;u.winner=v?v.call(r,r.event,o,s):r.contains(s,d)?1:0,a.push(u)}while(++i<f);a.sort(r.sort),i=0;do if(u=a[i])u.winner&&h.drop.length<r.multi?(!u.active[c]&&!u.anyactive&&(n.drag.hijack(r.event,"dropstart",t,c,u.elem)[0]!==!1?(u.active[c]=1,u.anyactive+=1):u.winner=0),u.winner&&h.drop.push(u.elem)):u.active[c]&&u.anyactive==1&&(n.drag.hijack(r.event,"dropend",t,c,u.elem),u.active[c]=0,u.anyactive-=1);while(++i<f)}while(++c<p);r.last&&d[0]==r.last.pageX&&d[1]==r.last.pageY?delete r.timer:r.timer=setTimeout(function(){r.tolerate(t)},r.delay),r.last=r.event}};n.dropinit=n.dropstart=n.dropend=r}(jQuery),define("jquery.event.drop",["jquery"],function(e){return function(){var t,n;return t||e.$.drop}}(this)),define("mockup-patterns-select2",["jquery","mockup-patterns-base","select2","jquery.event.drag","jquery.event.drop"],function(e,t){var n=t.extend({name:"select2",defaults:{separator:","},initializeValues:function(){var t=this;t.options.initialValues&&(t.options.id=function(e){return e.id},t.options.initSelection=function(n,r){var i=[],s=n.val(),o=t.options.initialValues;typeof t.options.initialValues=="string"&&t.options.initialValues!==""&&(t.options.initialValues[0]==="{"?o=JSON.parse(t.options.initialValues):(o={},e(t.options.initialValues.split(t.options.separator)).each(function(){var t=this.split(":"),n=e.trim(t[0]),r=e.trim(t[1]);o[n]=r}))),e(s.split(t.options.separator)).each(function(){var e=this;o[this]&&(e=o[this]),i.push({id:this,text:e})}),r(i)})},initializeTags:function(){var t=this;t.options.tags&&typeof t.options.tags=="string"&&(t.options.tags.substr(0,1)==="["?t.options.tags=JSON.parse(t.options.tags):t.options.tags=t.options.tags.split(t.options.separator)),t.options.tags&&!t.options.allowNewItems&&(t.options.data=e.map(t.options.tags,function(e,t){return{id:e,text:e}}),t.options.multiple=!0,delete t.options.tags)},initializeOrdering:function(){var t=this;if(t.options.orderable){var n=function(e,t){return e?e.text:undefined};t.options.formatSelection&&(n=t.options.formatSelection),t.options.formatSelection=function(r,i){return i.parents("li").drag("start",function(n,r){return e(this).addClass("select2-choice-dragging"),t.$el.select2("onSortStart"),e.drop({tolerance:function(t,n,r){var i=t.pageY>r.top+r.height/2;return e.data(r.elem,"drop+reorder",i?"insertAfter":"insertBefore"),this.contains(r,[t.pageX,t.pageY])}}),e(this).clone().addClass("dragging").css({opacity:.75,position:"absolute"}).appendTo(document.body)}).drag(function(t,n){e(n.proxy).css({top:n.offsetY,left:n.offsetX});var r=n.drop[0],i=e.data(r||{},"drop+reorder");r&&(r!=n.current||i!=n.method)&&(e(this)[i](r),n.current=r,n.method=i,n.update())}).drag("end",function(n,r){e(this).removeClass("select2-choice-dragging"),t.$el.select2("onSortEnd"),e(r.proxy).remove()}).drop("init",function(e,t){return this==t.drag?!1:!0}),n(r,i)}}},initializeSelect2:function(){var e=this;e.$el.select2(e.options),e.$select2=e.$el.parent().find(".select2-container"),e.$el.parent().off("close.modal.patterns"),e.options.orderable&&e.$select2.addClass("select2-orderable")},init:function(){var t=this;t.options.allowNewItems=t.options.hasOwnProperty("allowNewItems")?JSON.parse(t.options.allowNewItems):!0;if(t.options.ajax||t.options.vocabularyUrl){t.options.vocabularyUrl&&(t.options.multiple=!0,t.options.ajax=t.options.ajax||{},t.options.ajax.url=t.options.vocabularyUrl,t.options.initSelection=function(n,r){var i=[],s=n.val();e(s.split(t.options.separator)).each(function(){i.push({id:this,text:this})}),r(i)});var n="";t.options.ajax=e.extend({quietMillis:300,data:function(e,t){return n=e,{query:e,page_limit:10,page:t}},results:function(r,i){var s=r.results;if(t.options.vocabularyUrl){var o=[];e.each(r.results,function(e,t){o.push(t.id)}),s=[];var u=n===""||e.inArray(n,o)>=0;t.options.allowNewItems&&!u&&s.push({id:n,text:n}),(u||t.options.allowNewItems)&&e.each(r.results,function(e,t){s.push(t)})}return{results:s}}},t.options.ajax)}else if(t.options.multiple&&t.$el.is("select")){var r=t.$el.val()||[],i=e.map(t.$el.find("option"),function(t){return{text:e(t).html(),id:t.value}}),s=e('<input type="hidden" />');s.val(r.join(t.options.separator)),s.attr("class",t.$el.attr("class")),s.attr("name",t.$el.attr("name")),s.attr("id",t.$el.attr("id")),t.$orig_el=t.$el,t.$el.replaceWith(s),t.$el=s,t.options.data=i}t.initializeValues(),t.initializeTags(),t.initializeOrdering(),t.initializeSelect2()}});return n}),function(e){typeof define=="function"&&define.amd?define("picker",["jquery"],e):this.Picker=e(jQuery)}(function(e){function n(r,i,s,o){function p(){return n._.node("div",n._.node("div",n._.node("div",n._.node("div",h.component.nodes(u.open),f.box),f.wrap),f.frame),f.holder)}function d(e){e.stopPropagation(),e.type=="focus"&&h.$root.addClass(f.focused),h.open()}if(!r)return n;var u={id:Math.abs(~~(Math.random()*1e9))},a=s?e.extend(!0,{},s.defaults,o):o||{},f=e.extend({},n.klasses(),a.klass),l=e(r),c=function(){return this.start()},h=c.prototype={constructor:c,$node:l,start:function(){return u&&u.start?h:(u.methods={},u.start=!0,u.open=!1,u.type=r.type,r.autofocus=r==document.activeElement,r.type="text",r.readOnly=!a.editable,h.component=new s(h,a),h.$root=e(n._.node("div",p(),f.picker)).on({focusin:function(e){h.$root.removeClass(f.focused),e.stopPropagation()},"mousedown click":function(t){var n=t.target;n!=h.$root.children()[0]&&(t.stopPropagation(),t.type=="mousedown"&&!e(n).is(":input")&&n.nodeName!="OPTION"&&(t.preventDefault(),r.focus()))}}).on("click","[data-pick], [data-nav], [data-clear]",function(){var t=e(this),i=t.data(),s=t.hasClass(f.navDisabled)||t.hasClass(f.disabled),o=document.activeElement;o=o&&(o.type||o.href),(s||o&&!e.contains(h.$root[0],o))&&r.focus(),i.nav&&!s?h.set("highlight",h.component.item.highlight,{nav:i.nav}):n._.isInteger(i.pick)&&!s?h.set("select",i.pick).close(!0):i.clear&&h.clear().close(!0)}),a.formatSubmit&&(h._hidden=e('<input type=hidden name="'+(typeof a.hiddenPrefix=="string"?a.hiddenPrefix:"")+r.name+(typeof a.hiddenSuffix=="string"?a.hiddenSuffix:"_submit")+'"'+(l.data("value")||r.value?' value="'+n._.trigger(h.component.formats.toString,h.component,[a.formatSubmit,h.component.item.select])+'"':"")+">")[0]),l.data(i,h).addClass(f.input).val(l.data("value")?n._.trigger(h.component.formats.toString,h.component,[a.format,h.component.item.select]):r.value).after(h._hidden).on("focus.P"+u.id+" click.P"+u.id,d).on("change.P"+u.id,function(){h._hidden&&(h._hidden.value=r.value?n._.trigger(h.component.formats.toString,h.component,[a.formatSubmit,h.component.item.select]):"")}),a.editable||l.on("keydown.P"+u.id,function(e){var t=e.keyCode,n=/^(8|46)$/.test(t);if(t==27)return h.close(),!1;if(t==32||n||!u.open&&h.component.key[t])e.preventDefault(),e.stopPropagation(),n?h.clear().close():h.open()}),a.container?e(a.container).append(h.$root):l.after(h.$root),h.on({start:h.component.onStart,render:h.component.onRender,stop:h.component.onStop,open:h.component.onOpen,close:h.component.onClose,set:h.component.onSet}).on({start:a.onStart,render:a.onRender,stop:a.onStop,open:a.onOpen,close:a.onClose,set:a.onSet}),r.autofocus&&h.open(),h.trigger("start").trigger("render"))},render:function(e){return e?h.$root.html(p()):h.$root.find("."+f.box).html(h.component.nodes(u.open)),h.trigger("render")},stop:function(){return u.start?(h.close(),h._hidden&&h._hidden.parentNode.removeChild(h._hidden),h.$root.remove(),l.removeClass(f.input).removeData(i),setTimeout(function(){l.off(".P"+u.id)},0),r.type=u.type,r.readOnly=!1,h.trigger("stop"),u.methods={},u.start=!1,h):h},open:function(i){return u.open?h:(l.addClass(f.active),h.$root.addClass(f.opened),i!==!1&&(u.open=!0,l.trigger("focus"),t.on("click.P"+u.id+" focusin.P"+u.id,function(e){var t=e.target;t!=r&&t!=document&&h.close(t===h.$root.children()[0])}).on("keydown.P"+u.id,function(t){var i=t.keyCode,s=h.component.key[i],o=t.target;i==27?h.close(!0):o!=r||!s&&i!=13?e.contains(h.$root[0],o)&&i==13&&(t.preventDefault(),o.click()):(t.preventDefault(),s?n._.trigger(h.component.key.go,h,[n._.trigger(s)]):h.$root.find("."+f.highlighted).hasClass(f.disabled)||h.set("select",h.component.item.highlight).close())})),h.trigger("open"))},close:function(e){return e&&(l.off("focus.P"+u.id).trigger("focus"),setTimeout(function(){l.on("focus.P"+u.id,d)},0)),l.removeClass(f.active),h.$root.removeClass(f.opened+" "+f.focused),u.open?(u.open=!1,t.off(".P"+u.id),h.trigger("close")):h},clear:function(){return h.set("clear")},set:function(t,r,i){var s,o,u=e.isPlainObject(t),f=u?t:{};i=u&&e.isPlainObject(r)?r:i||{};if(t){u||(f[t]=r);for(s in f)o=f[s],h.component.item[s]&&h.component.set(s,o,i),(s=="select"||s=="clear")&&l.val(s=="clear"?"":n._.trigger(h.component.formats.toString,h.component,[a.format,h.component.get(s)])).trigger("change");h.render()}return i.muted?h:h.trigger("set",f)},get:function(e,t){e=e||"value";if(u[e]!=null)return u[e];if(e=="value")return r.value;if(h.component.item[e])return typeof t=="string"?n._.trigger(h.component.formats.toString,h.component,[t,h.component.get(e)]):h.component.get(e)},on:function(t,n){var r,i,s=e.isPlainObject(t),o=s?t:{};if(t){s||(o[t]=n);for(r in o)i=o[r],u.methods[r]=u.methods[r]||[],u.methods[r].push(i)}return h},trigger:function(e,t){var r=u.methods[e];return r&&r.map(function(e){n._.trigger(e,h,[t])}),h}};return new c}var t=e(document);return n.klasses=function(e){return e=e||"picker",{picker:e,opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},n._={group:function(e){var t,r="",i=n._.trigger(e.min,e);for(;i<=n._.trigger(e.max,e,[i]);i+=e.i)t=n._.trigger(e.item,e,[i]),r+=n._.node(e.node,t[0],t[1],t[2]);return r},node:function(t,n,r,i){return n?(n=e.isArray(n)?n.join(""):n,r=r?' class="'+r+'"':"",i=i?" "+i:"","<"+t+r+i+">"+n+"</"+t+">"):""},lead:function(e){return(e<10?"0":"")+e},trigger:function(e,t,n){return typeof e=="function"?e.apply(t,n||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return{}.toString.call(e).indexOf("Date")>-1&&this.isInteger(e.getDate())},isInteger:function(e){return{}.toString.call(e).indexOf("Number")>-1&&e%1===0}},n.extend=function(t,r){e.fn[t]=function(i,s){var o=this.data(t);return i=="picker"?o:o&&typeof i=="string"?(n._.trigger(o[i],o,[s]),this):this.each(function(){var s=e(this);s.data(t)||new n(this,t,r,i)})},e.fn[t].defaults=r.defaults},n}),function(e){typeof define=="function"&&define.amd?define("picker.date",["picker","jquery"],e):e(Picker,jQuery)}(function(e,t){function i(e,t){var n=this,r=e.$node[0].value,i=e.$node.data("value"),s=i||r,o=i?t.formatSubmit:t.format,u=function(){return getComputedStyle(e.$root[0]).direction==="rtl"};n.settings=t,n.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"navigate create validate",view:"create validate viewset",disable:"flipItem",enable:"flipItem"},n.item={},n.item.disable=(t.disable||[]).slice(0),n.item.enable=-function(e){return e[0]===!0?e.shift():-1}(n.item.disable),n.set("min",t.min).set("max",t.max).set("now").set("select",s||n.item.now,{format:o,data:function(e){return s&&(e.indexOf("mm")>-1||e.indexOf("m")>-1)}(n.formats.toArray(o))}),n.key={40:7,38:-7,39:function(){return u()?-1:1},37:function(){return u()?1:-1},go:function(e){n.set("highlight",[n.item.highlight.year,n.item.highlight.month,n.item.highlight.date+e],{interval:e}),this.render()}},e.on("render",function(){e.$root.find("."+t.klass.selectMonth).on("change",function(){e.set("highlight",[e.get("view").year,this.value,e.get("highlight").date]),e.$root.find("."+t.klass.selectMonth).trigger("focus")}),e.$root.find("."+t.klass.selectYear).on("change",function(){e.set("highlight",[this.value,e.get("view").month,e.get("highlight").date]),e.$root.find("."+t.klass.selectYear).trigger("focus")})}).on("open",function(){e.$root.find("button, select").attr("disabled",!1)}).on("close",function(){e.$root.find("button, select").attr("disabled",!0)})}var n=7,r=6;i.prototype.set=function(e,t,n){var r=this;return r.item[e=="enable"?"disable":e=="flip"?"enable":e]=r.queue[e].split(" ").map(function(i){return t=r[i](e,t,n)}).pop(),e=="select"?r.set("highlight",r.item.select,n):e=="highlight"?r.set("view",r.item.highlight,n):(e=="flip"||e=="min"||e=="max"||e=="disable"||e=="enable")&&r.item.select&&r.item.highlight&&r.set("select",r.item.select,n).set("highlight",r.item.highlight,n),r},i.prototype.get=function(e){return this.item[e]},i.prototype.create=function(n,r,i){var s,o=this;return r=r===undefined?n:r,r==-Infinity||r==Infinity?s=r:t.isPlainObject(r)&&e._.isInteger(r.pick)?r=r.obj:t.isArray(r)?(r=new Date(r[0],r[1],r[2]),r=e._.isDate(r)?r:o.create().obj):e._.isInteger(r)||e._.isDate(r)?r=o.normalize(new Date(r),i):r=o.now(n,r,i),{year:s||r.getFullYear(),month:s||r.getMonth(),date:s||r.getDate(),day:s||r.getDay(),obj:s||r,pick:s||r.getTime()}},i.prototype.now=function(e,t,n){return t=new Date,n&&n.rel&&t.setDate(t.getDate()+n.rel),this.normalize(t,n)},i.prototype.navigate=function(n,r,i){if(t.isPlainObject(r)){var s=new Date(r.year,r.month+(i&&i.nav?i.nav:0),1),o=s.getFullYear(),u=s.getMonth(),a=r.date;while(e._.isDate(s)&&(new Date(o,u,a)).getMonth()!==u)a-=1;r=[o,u,a]}return r},i.prototype.normalize=function(e){return e.setHours(0,0,0,0),e},i.prototype.measure=function(t,n){var r=this;return n?e._.isInteger(n)&&(n=r.now(t,n,{rel:n})):n=t=="min"?-Infinity:Infinity,n},i.prototype.viewset=function(e,t){return this.create([t.year,t.month,1])},i.prototype.validate=function(n,r,i){var s=this,o=r,u=i&&i.interval?i.interval:1,a=s.item.enable===-1,f,l,c=s.item.min,h=s.item.max,p,d,v=a&&s.item.disable.filter(function(n){if(t.isArray(n)){var i=s.create(n).pick;i<r.pick?f=!0:i>r.pick&&(l=!0)}return e._.isInteger(n)}).length;if(!i.nav)if(!a&&s.disabled(r)||a&&s.disabled(r)&&(v||f||l)||r.pick<=c.pick||r.pick>=h.pick){a&&!v&&(!l&&u>0||!f&&u<0)&&(u*=-1);while(s.disabled(r)){Math.abs(u)>1&&(r.month<o.month||r.month>o.month)&&(r=o,u=Math.abs(u)/u),r.pick<=c.pick?(p=!0,u=1):r.pick>=h.pick&&(d=!0,u=-1);if(p&&d)break;r=s.create([r.year,r.month,r.date+u])}}return r},i.prototype.disabled=function(n){var r=this,i=r.item.disable.filter(function(i){if(e._.isInteger(i))return n.day===(r.settings.firstDay?i:i-1)%7;if(t.isArray(i)||e._.isDate(i))return n.pick===r.create(i).pick});return i=i.length&&!i.filter(function(e){return t.isArray(e)&&e[3]=="inverted"}).length,r.item.enable===-1?!i:i||n.pick<r.item.min.pick||n.pick>r.item.max.pick},i.prototype.parse=function(n,r,i){var s=this,o={};if(!r||e._.isInteger(r)||t.isArray(r)||e._.isDate(r)||t.isPlainObject(r)&&e._.isInteger(r.pick))return r;if(!i||!i.format)throw"Need a formatting option to parse this..";return s.formats.toArray(i.format).map(function(t){var n=s.formats[t],i=n?e._.trigger(n,s,[r,o]):t.replace(/^!/,"").length;n&&(o[t]=r.substr(0,i)),r=r.substr(i)}),[o.yyyy||o.yy,+(o.mm||o.m)-(i.data?1:0),o.dd||o.d]},i.prototype.formats=function(){function t(e,t,n){var r=e.match(/\w+/)[0];return!n.mm&&!n.m&&(n.m=t.indexOf(r)),r.length}function n(e){return e.match(/\w+/)[0].length}return{d:function(t,n){return t?e._.digits(t):n.date},dd:function(t,n){return t?2:e._.lead(n.date)},ddd:function(e,t){return e?n(e):this.settings.weekdaysShort[t.day]},dddd:function(e,t){return e?n(e):this.settings.weekdaysFull[t.day]},m:function(t,n){return t?e._.digits(t):n.month+1},mm:function(t,n){return t?2:e._.lead(n.month+1)},mmm:function(e,n){var r=this.settings.monthsShort;return e?t(e,r,n):r[n.month]},mmmm:function(e,n){var r=this.settings.monthsFull;return e?t(e,r,n):r[n.month]},yy:function(e,t){return e?2:(""+t.year).slice(2)},yyyy:function(e,t){return e?4:t.year},toArray:function(e){return e.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(t,n){var r=this;return r.formats.toArray(t).map(function(t){return e._.trigger(r.formats[t],r,[0,n])||t.replace(/^!/,"")}).join("")}}}(),i.prototype.flipItem=function(e,n){var r=this,i=r.item.disable,s=r.item.enable===-1;return n=="flip"?r.item.enable=s?1:-1:e=="enable"&&n===!0||e=="disable"&&n===!1?(r.item.enable=1,i=[]):e=="enable"&&n===!1||e=="disable"&&n===!0?(r.item.enable=-1,i=[]):t.isArray(n)&&(s&&e=="enable"||!s&&e=="disable"?i=r.addDisabled(i,n):!s&&e=="enable"?i=r.addEnabled(i,n):s&&e=="disable"&&(i=r.removeDisabled(i,n))),i},i.prototype.addEnabled=function(n,r){var i=this;return r.map(function(r){i.filterDisabled(n,r,1).length&&(n=i.removeDisabled(n,[r]),t.isArray(r)&&n.filter(function(t){return e._.isInteger(t)&&i.create(r).day===t-1}).length&&(r=r.slice(0),r.push("inverted"),n.push(r)))}),n},i.prototype.addDisabled=function(e,n){var r=this;return n.map(function(n){r.filterDisabled(e,n).length?t.isArray(n)&&r.filterDisabled(e,n,1).length&&(e=r.removeDisabled(e,[n])):e.push(n)}),e},i.prototype.removeDisabled=function(e,t){var n=this;return t.map(function(t){e=n.filterDisabled(e,t,1)}),e},i.prototype.filterDisabled=function(n,r,i){var s=this,o=t.isArray(r)||e._.isDate(r),u=o&&s.create(r).pick;return n.filter(function(n){var a=o&&(t.isArray(n)||e._.isDate(n))?u===s.create(n).pick:r===n;return i?!a:a})},i.prototype.nodes=function(t){var i=this,s=i.settings,o=i.item.now,u=i.item.select,a=i.item.highlight,f=i.item.view,l=i.item.disable,c=i.item.min,h=i.item.max,p=function(t){return s.firstDay&&t.push(t.shift()),e._.node("thead",e._.group({min:0,max:n-1,i:1,node:"th",item:function(e){return[t[e],s.klass.weekdays]}}))}((s.showWeekdaysFull?s.weekdaysFull:s.weekdaysShort).slice(0)),d=function(t){return e._.node("div"," ",s.klass["nav"+(t?"Next":"Prev")]+(t&&f.year>=h.year&&f.month>=h.month||!t&&f.year<=c.year&&f.month<=c.month?" "+s.klass.navDisabled:""),"data-nav="+(t||-1))},v=function(n){return s.selectMonths?e._.node("select",e._.group({min:0,max:11,i:1,node:"option",item:function(e){return[n[e],0,"value="+e+(f.month==e?" selected":"")+(f.year==c.year&&e<c.month||f.year==h.year&&e>h.month?" disabled":"")]}}),s.klass.selectMonth,t?"":"disabled"):e._.node("div",n[f.month],s.klass.month)},m=function(){var n=f.year,r=s.selectYears===!0?5:~~(s.selectYears/2);if(r){var i=c.year,o=h.year,u=n-r,a=n+r;i>u&&(a+=i-u,u=i);if(o<a){var l=u-i,p=a-o;u-=l>p?p:l,a=o}return e._.node("select",e._.group({min:u,max:a,i:1,node:"option",item:function(e){return[e,0,"value="+e+(n==e?" selected":"")]}}),s.klass.selectYear,t?"":"disabled")}return e._.node("div",n,s.klass.year)};return e._.node("div",d()+d(1)+v(s.showMonthsShort?s.monthsShort:s.monthsFull)+m(),s.klass.header)+e._.node("table",p+e._.node("tbody",e._.group({min:0,max:r-1,i:1,node:"tr",item:function(t){var r=s.firstDay&&i.create([f.year,f.month,1]).day===0?-7:0;return[e._.group({min:n*t-f.day+r+1,max:function(){return this.min+n-1},i:1,node:"td",item:function(t){return t=i.create([f.year,f.month,t+(s.firstDay?1:0)]),[e._.node("div",t.date,function(e){return e.push(f.month==t.month?s.klass.infocus:s.klass.outfocus),o.pick==t.pick&&e.push(s.klass.now),u&&u.pick==t.pick&&e.push(s.klass.selected),a&&a.pick==t.pick&&e.push(s.klass.highlighted),(l&&i.disabled(t)||t.pick<c.pick||t.pick>h.pick)&&e.push(s.klass.disabled),e.join(" ")}([s.klass.day]),"data-pick="+t.pick)]}})]}})),s.klass.table)+e._.node("div",e._.node("button",s.today,s.klass.buttonToday,"type=button data-pick="+o.pick+(t?"":" disabled"))+e._.node("button",s.clear,s.klass.buttonClear,"type=button data-clear=1"+(t?"":" disabled")),s.klass.footer)},i.defaults=function(e){return{monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",format:"d mmmm, yyyy",klass:{table:e+"table",header:e+"header",navPrev:e+"nav--prev",navNext:e+"nav--next",navDisabled:e+"nav--disabled",month:e+"month",year:e+"year",selectMonth:e+"select--month",selectYear:e+"select--year",weekdays:e+"weekday",day:e+"day",disabled:e+"day--disabled",selected:e+"day--selected",highlighted:e+"day--highlighted",now:e+"day--today",infocus:e+"day--infocus",outfocus:e+"day--outfocus",footer:e+"footer",buttonClear:e+"button--clear",buttonToday:e+"button--today"}}}(e.klasses().picker+"__"),e.extend("pickadate",i)}),function(e){typeof define=="function"&&define.amd?define("picker.time",["picker","jquery"],e):e(Picker,jQuery)}(function(e,t){function o(e,t){var n=this,r=e.$node.data("value");n.settings=t,n.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"create validate",view:"create validate",disable:"flipItem",enable:"flipItem"},n.item={},n.item.interval=t.interval||30,n.item.disable=(t.disable||[]).slice(0),n.item.enable=-function(e){return e[0]===!0?e.shift():-1}(n.item.disable),n.set("min",t.min).set("max",t.max).set("now").set("select",r||e.$node[0].value||n.item.min,{format:r?t.formatSubmit:t.format}),n.key={40:1,38:-1,39:1,37:-1,go:function(e){n.set("highlight",n.item.highlight.pick+e*n.item.interval,{interval:e*n.item.interval}),this.render()}},e.on("render",function(){var n=e.$root.children(),r=n.find("."+t.klass.viewset);r.length&&(n[0].scrollTop=~~r.position().top-r[0].clientHeight*2)}).on("open",function(){e.$root.find("button").attr("disable",!1)}).on("close",function(){e.$root.find("button").attr("disable",!0)})}var n=24,r=60,i=12,s=n*r;o.prototype.set=function(e,t,n){var r=this;return r.item[e=="enable"?"disable":e=="flip"?"enable":e]=r.queue[e].split(" ").map(function(i){return t=r[i](e,t,n)}).pop(),e=="select"?r.set("highlight",r.item.select,n):e=="highlight"?r.set("view",r.item.highlight,n):e=="interval"?r.set("min",r.item.min,n).set("max",r.item.max,n):(e=="flip"||e=="min"||e=="max"||e=="disable"||e=="enable")&&r.item.select&&r.item.highlight&&(e=="min"&&r.set("max",r.item.max,n),r.set("select",r.item.select,n).set("highlight",r.item.highlight,n)),r},o.prototype.get=function(e){return this.item[e]},o.prototype.create=function(i,o,u){var a=this;return o=o===undefined?i:o,e._.isDate(o)&&(o=[o.getHours(),o.getMinutes()]),t.isPlainObject(o)&&e._.isInteger(o.pick)?o=o.pick:t.isArray(o)?o=+o[0]*r+ +o[1]:e._.isInteger(o)||(o=a.now(i,o,u)),i=="max"&&o<a.item.min.pick&&(o+=s),i!="min"&&i!="max"&&(o-a.item.min.pick)%a.item.interval!==0&&(o+=a.item.interval),o=a.normalize(i,o,u),{hour:~~(n+o/r)%n,mins:(r+o%r)%r,time:(s+o)%s,pick:o}},o.prototype.now=function(t,n){var i=new Date,s=i.getHours()*r+i.getMinutes();return s-=s%this.item.interval,e._.isInteger(n)?n+=t=="min"&&n<0&&s===0?2:1:n=1,n*this.item.interval+s},o.prototype.normalize=function(e,t){var n=this.item.interval,r=e=="min"?0:(t-this.item.min.pick)%n;return t-(r+(t<0?n:0))},o.prototype.measure=function(i,s,o){var u=this;return s?s===!0||e._.isInteger(s)?s=u.now(i,s,o):t.isPlainObject(s)&&e._.isInteger(s.pick)&&(s=u.normalize(i,s.pick,o)):s=i=="min"?[0,0]:[n-1,r-1],s},o.prototype.validate=function(e,t,n){var r=this,i=n&&n.interval?n.interval:r.item.interval;return r.disabled(t)&&(t=r.shift(t,i)),t=r.scope(t),r.disabled(t)&&(t=r.shift(t,i*-1)),t},o.prototype.disabled=function(n){var r=this,i=r.item.disable.filter(function(i){if(e._.isInteger(i))return n.hour==i;if(t.isArray(i)||e._.isDate(i))return n.pick==r.create(i).pick});return i=i.length&&!i.filter(function(e){return t.isArray(e)&&e[2]=="inverted"}).length,r.item.enable===-1?!i:i||n.pick<r.item.min.pick||n.pick>r.item.max.pick},o.prototype.shift=function(e,t){var n=this,r=n.item.min.pick,i=n.item.max.pick;t=t||n.item.interval;while(n.disabled(e)){e=n.create(e.pick+=t);if(e.pick<=r||e.pick>=i)break}return e},o.prototype.scope=function(e){var t=this.item.min.pick,n=this.item.max.pick;return this.create(e.pick>n?n:e.pick<t?t:e)},o.prototype.parse=function(n,i,s){var o=this,u={};if(!i||e._.isInteger(i)||t.isArray(i)||e._.isDate(i)||t.isPlainObject(i)&&e._.isInteger(i.pick))return i;if(!s||!s.format)throw"Need a formatting option to parse this..";return o.formats.toArray(s.format).map(function(t){var n=o.formats[t],r=n?e._.trigger(n,o,[i,u]):t.replace(/^!/,"").length;n&&(u[t]=i.substr(0,r)),i=i.substr(r)}),+u.i+r*(+(u.H||u.HH)||+(u.h||u.hh)%12+(/^p/i.test(u.A||u.a)?12:0))},o.prototype.formats={h:function(t,n){return t?e._.digits(t):n.hour%i||i},hh:function(t,n){return t?2:e._.lead(n.hour%i||i)},H:function(t,n){return t?e._.digits(t):""+n.hour%24},HH:function(t,n){return t?e._.digits(t):e._.lead(n.hour%24)},i:function(t,n){return t?2:e._.lead(n.mins)},a:function(e,t){return e?4:s/2>t.time%s?"a.m.":"p.m."},A:function(e,t){return e?2:s/2>t.time%s?"AM":"PM"},toArray:function(e){return e.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(t,n){var r=this;return r.formats.toArray(t).map(function(t){return e._.trigger(r.formats[t],r,[0,n])||t.replace(/^!/,"")}).join("")}},o.prototype.flipItem=function(e,n){var r=this,i=r.item.disable,s=r.item.enable===-1;return n=="flip"?r.item.enable=s?1:-1:e=="enable"&&n===!0||e=="disable"&&n===!1?(r.item.enable=1,i=[]):e=="enable"&&n===!1||e=="disable"&&n===!0?(r.item.enable=-1,i=[]):t.isArray(n)&&(s&&e=="enable"||!s&&e=="disable"?i=r.addDisabled(i,n):!s&&e=="enable"?i=r.addEnabled(i,n):s&&e=="disable"&&(i=r.removeDisabled(i,n))),i},o.prototype.addEnabled=function(n,r){var i=this;return r.map(function(r){i.filterDisabled(n,r,1).length&&(n=i.removeDisabled(n,[r]),t.isArray(r)&&n.filter(function(t){return e._.isInteger(t)&&i.create(r).hour===t}).length&&(r=r.slice(0),r.push("inverted"),n.push(r)))}),n},o.prototype.addDisabled=function(e,n){var r=this;return n.map(function(n){r.filterDisabled(e,n).length?t.isArray(n)&&r.filterDisabled(e,n,1).length&&(e=r.removeDisabled(e,[n])):e.push(n)}),e},o.prototype.removeDisabled=function(e,t){var n=this;return t.map(function(t){e=n.filterDisabled(e,t,1)}),e},o.prototype.filterDisabled=function(e,n,r){var i=t.isArray(n);return e.filter(function(e){var s=!i&&n===e||i&&t.isArray(e)&&n.toString()===e.toString();return r?!s:s})},o.prototype.i=function(t,n){return e._.isInteger(n)&&n>0?n:this.item.interval},o.prototype.nodes=function(t){var n=this,r=n.settings,i=n.item.select,s=n.item.highlight,o=n.item.view,u=n.item.disable;return e._.node("ul",e._.group({min:n.item.min.pick,max:n.item.max.pick,i:n.item.interval,node:"li",item:function(t){return t=n.create(t),[e._.trigger(n.formats.toString,n,[e._.trigger(r.formatLabel,n,[t])||r.format,t]),function(e,a){return i&&i.pick==a&&e.push(r.klass.selected),s&&s.pick==a&&e.push(r.klass.highlighted),o&&o.pick==a&&e.push(r.klass.viewset),u&&n.disabled(t)&&e.push(r.klass.disabled),e.join(" ")}([r.klass.listItem],t.pick),"data-pick="+t.pick]}})+e._.node("li",e._.node("button",r.clear,r.klass.buttonClear,"type=button data-clear=1"+(t?"":" disable"))),r.klass.list)},o.defaults=function(e){return{clear:"Clear",format:"h:i A",interval:30,klass:{picker:e+" "+e+"--time",holder:e+"__holder",list:e+"__list",listItem:e+"__list-item",disabled:e+"__list-item--disabled",selected:e+"__list-item--selected",highlighted:e+"__list-item--highlighted",viewset:e+"__list-item--viewset",now:e+"__list-item--now",buttonClear:e+"__button--clear"}}}(e.klasses().picker),e.extend("pickatime",o)}),define("mockup-patterns-pickadate",["jquery","mockup-patterns-base","picker","picker.date","picker.time"],function(e,t){var n=t.extend({name:"pickadate",defaults:{separator:" ",date:{selectYears:!0,selectMonths:!0},time:{},classWrapperName:"pattern-pickadate-wrapper",classSeparatorName:"pattern-pickadate-separator",classDateName:"pattern-pickadate-date",classDateWrapperName:"pattern-pickadate-date-wrapper",classTimeName:"pattern-pickadate-time",classTimeWrapperName:"pattern-pickadate-time-wrapper",classClearName:"pattern-pickadate-clear",placeholderDate:"Enter date...",placeholderTime:"Enter time..."},isFalse:function(e){return typeof e=="string"&&e==="false"?!1:e},init:function(){var t=this,n=t.$el.val().split(" "),r=n[0]||"",i=n[1]||"";t.options.date=t.isFalse(t.options.date),t.options.time=t.isFalse(t.options.time),t.options.date===!1&&(i=n[0]),t.$el.hide(),t.$wrapper=e("<div/>").addClass(t.options.classWrapperName).insertAfter(t.$el),t.options.date!==!1&&(t.options.date.formatSubmit="yyyy-mm-dd",t.$date=e('<input type="text"/>').attr("placeholder",t.options.placeholderDate).attr("data-value",r).addClass(t.options.classDateName).appendTo(e("<div/>").addClass(t.options.classDateWrapperName).appendTo(t.$wrapper)).pickadate(e.extend(!0,{},t.options.date,{onSet:function(e){e.select!==undefined&&(t.$date.attr("data-value",e.select),(t.options.time===!1||t.$time.attr("data-value")!=="")&&t.updateValue.call(t)),e.hasOwnProperty("clear")&&(t.$el.removeAttr("value"),t.$date.attr("data-value",""))}}))),t.options.date!==!1&&t.options.time!==!1&&(t.$separator=e("<span/>").addClass(t.options.classSeparatorName).html(t.options.separator===" "?"&nbsp;":t.options.separator).appendTo(t.$wrapper)),t.options.time!==!1&&(t.options.time.formatSubmit="HH:i",t.$time=e('<input type="text"/>').attr("placeholder",t.options.placeholderTime).attr("data-value",i).addClass(t.options.classTimeName).appendTo(e("<div/>").addClass(t.options.classTimeWrapperName).appendTo(t.$wrapper)).pickatime(e.extend(!0,{},t.options.time,{onSet:function(e){e.select!==undefined&&(t.$time.attr("data-value",e.select),(t.options.date===!1||t.$date.attr("data-value")!=="")&&t.updateValue.call(t)),e.hasOwnProperty("clear")&&(t.$el.removeAttr("value"),t.$time.attr("data-value",""))}})),typeof i=="string"&&i.substring(0,2)==="00"&&(t.$time.pickatime("picker").set("select",i.split(":")),t.$time.attr("data-value",i))),t.$clear=e("<div/>").addClass(t.options.classClearName).appendTo(t.$wrapper)},updateValue:function(){var e=this,t="";if(e.options.date!==!1){var n=e.$date.data("pickadate").component,r=e.$date.data("pickadate").get("select"),i=n.formats.toString;t+=i.apply(n,["yyyy-mm-dd",r])}e.options.date!==!1&&e.options.time!==!1&&(t+=" ");if(e.options.time!==!1){var s=e.$time.data("pickatime").component,o=e.$time.data("pickatime").get("select"),u=s.formats.toString;t+=u.apply(s,["HH:i",o])}e.$el.attr("value",t),e.trigger("updated")}});return n}),function(){function x(e,t,n){var r=(n||0)-1,i=e?e.length:0;while(++r<i)if(e[r]===t)return r;return-1}function T(e,t){var n=e.criteria,r=t.criteria,i=-1,s=n.length;while(++i<s){var o=n[i],u=r[i];if(o!==u){if(o>u||typeof o=="undefined")return 1;if(o<u||typeof u=="undefined")return-1}}return e.index-t.index}function N(e){return"\\"+g[e]}function C(e,t,n){t||(t=0),typeof n=="undefined"&&(n=e?e.length:0);var r=-1,i=n-t||0,s=Array(i<0?0:i);while(++r<i)s[r]=e[t+r];return s}function X(e){return e instanceof X?e:new V(e)}function V(e,t){this.__chain__=!!t,this.__wrapped__=e}function J(e){function i(){if(n){var e=C(n);H.apply(e,arguments)}if(this instanceof i){var s=K(t.prototype),o=t.apply(s,e||arguments);return _t(o)?o:s}return t.apply(r,e||arguments)}var t=e[0],n=e[2],r=e[4];return i}function K(e,t){return _t(e)?j(e):{}}function Q(e,t,n){if(typeof e!="function")return Vn;if(typeof t!="undefined"&&"prototype"in e){switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return Dn(e,t)}return e}function G(e){function h(){var e=u?s:this;if(r){var p=C(r);H.apply(p,arguments)}if(i||f){p||(p=C(arguments)),i&&H.apply(p,i);if(f&&p.length<o)return n|=16,G([t,l?n:n&-4,p,null,s,o])}p||(p=arguments),a&&(t=e[c]);if(this instanceof h){e=K(t.prototype);var d=t.apply(e,p);return _t(d)?d:e}return t.apply(e,p)}var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=n&1,a=n&2,f=n&4,l=n&8,c=t;return h}function Y(e,t){var n=-1,r=ot(),i=e?e.length:0,s=[];while(++n<i){var o=e[n];r(t,o)<0&&s.push(o)}return s}function Z(e,t,n,r){var i=(r||0)-1,s=e?e.length:0,o=[];while(++i<s){var u=e[i];if(u&&typeof u=="object"&&typeof u.length=="number"&&(lt(u)||ft(u))){t||(u=Z(u,t,n));var a=-1,f=u.length,l=o.length;o.length+=f;while(++a<f)o[l++]=u[a]}else n||o.push(u)}return o}function et(e,t,r,i){if(e===t)return e!==0||1/e==1/t;var s=typeof e,o=typeof t;if(e===e&&(!e||!m[s])&&(!t||!m[o]))return!1;if(e==null||t==null)return e===t;var u=O.call(e),c=O.call(t);if(u!=c)return!1;switch(u){case f:case l:return+e==+t;case h:return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case d:case v:return e==String(t)}var g=u==a;if(!g){var y=e instanceof X,b=t instanceof X;if(y||b)return et(y?e.__wrapped__:e,b?t.__wrapped__:t,r,i);if(u!=p)return!1;var w=e.constructor,E=t.constructor;if(w!=E&&!(Mt(w)&&w instanceof w&&Mt(E)&&E instanceof E)&&"constructor"in e&&"constructor"in t)return!1}r||(r=[]),i||(i=[]);var S=r.length;while(S--)if(r[S]==e)return i[S]==t;var x=!0,T=0;r.push(e),i.push(t);if(g){T=t.length,x=T==e.length;if(x)while(T--)if(!(x=et(e[T],t[T],r,i)))break}else wt(t,function(t,s,o){if(P.call(o,s))return T++,!(x=P.call(e,s)&&et(e[s],t,r,i))&&n}),x&&wt(e,function(e,t,r){if(P.call(r,t))return!(x=--T>-1)&&n});return r.pop(),i.pop(),x}function tt(e,t){return e+D(W()*(t-e+1))}function nt(e,t,n){var r=-1,i=ot(),s=e?e.length:0,o=[],u=n?[]:o;while(++r<s){var a=e[r],f=n?n(a,r,e):a;if(t?!r||u[u.length-1]!==f:i(u,f)<0)n&&u.push(f),o.push(a)}return o}function rt(e){return function(t,n,r){var i={};n=Wn(n,r,3);var s=-1,o=t?t.length:0;if(typeof o=="number")while(++s<o){var u=t[s];e(i,u,n(u,s,t),t)}else Et(t,function(t,r,s){e(i,t,n(t,r,s),s)});return i}}function it(e,t,n,r,i,s){var o=t&1,u=t&2,a=t&4,f=t&8,l=t&16,c=t&32;if(!u&&!Mt(e))throw new TypeError;l&&!n.length&&(t&=-17,l=n=!1),c&&!r.length&&(t&=-33,c=r=!1);var h=t==1||t===17?J:G;return h([e,t,n,r,i,s])}function st(e){return pt[e]}function ot(){var e=(e=X.indexOf)===bn?x:e;return e}function ut(e){return typeof e=="function"&&M.test(e)}function at(e){return dt[e]}function ft(e){return e&&typeof e=="object"&&typeof e.length=="number"&&O.call(e)==u||!1}function gt(e){if(!e)return e;for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t];if(r)for(var i in r)e[i]=r[i]}return e}function yt(e){return _t(e)?lt(e)?C(e):gt({},e):e}function bt(e){if(!e)return e;for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t];if(r)for(var i in r)typeof e[i]=="undefined"&&(e[i]=r[i])}return e}function St(e){var t=[];return wt(e,function(e,n){Mt(e)&&t.push(n)}),t.sort()}function xt(e,t){return e?P.call(e,t):!1}function Tt(e){var t=-1,n=ht(e),r=n.length,i={};while(++t<r){var s=n[t];i[e[s]]=s}return i}function Nt(e){return e===!0||e===!1||e&&typeof e=="object"&&O.call(e)==f||!1}function Ct(e){return e&&typeof e=="object"&&O.call(e)==l||!1}function kt(e){return e&&e.nodeType===1||!1}function Lt(e){if(!e)return!0;if(lt(e)||jt(e))return!e.length;for(var t in e)if(P.call(e,t))return!1;return!0}function At(e,t){return et(e,t)}function Ot(e){return I(e)&&!q(parseFloat(e))}function Mt(e){return typeof e=="function"}function _t(e){return!!e&&!!m[typeof e]}function Dt(e){return Ht(e)&&e!=+e}function Pt(e){return e===null}function Ht(e){return typeof e=="number"||e&&typeof e=="object"&&O.call(e)==h||!1}function Bt(e){return e&&m[typeof e]&&O.call(e)==d||!1}function jt(e){return typeof e=="string"||e&&typeof e=="object"&&O.call(e)==v||!1}function Ft(e){return typeof e=="undefined"}function It(e){var t=[];wt(e,function(e,n){t.push(n)}),t=Y(t,Z(arguments,!0,!1,1));var n=-1,r=t.length,i={};while(++n<r){var s=t[n];i[s]=e[s]}return i}function qt(e){var t=-1,n=ht(e),r=n.length,i=Array(r);while(++t<r){var s=n[t];i[t]=[s,e[s]]}return i}function Rt(e){var t=-1,n=Z(arguments,!0,!1,1),r=n.length,i={};while(++t<r){var s=n[t];s in e&&(i[s]=e[s])}return i}function Ut(e){var t=-1,n=ht(e),r=n.length,i=Array(r);while(++t<r)i[t]=e[n[t]];return i}function zt(e,t){var r=ot(),i=e?e.length:0,s=!1;return i&&typeof i=="number"?s=r(e,t)>-1:Et(e,function(e){return(s=e===t)&&n}),s}function Xt(e,t,r){var i=!0;t=Wn(t,r,3);var s=-1,o=e?e.length:0;if(typeof o=="number"){while(++s<o)if(!(i=!!t(e[s],s,e)))break}else Et(e,function(e,r,s){return!(i=!!t(e,r,s))&&n});return i}function Vt(e,t,n){var r=[];t=Wn(t,n,3);var i=-1,s=e?e.length:0;if(typeof s=="number")while(++i<s){var o=e[i];t(o,i,e)&&r.push(o)}else Et(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function $t(e,t,r){t=Wn(t,r,3);var i=-1,s=e?e.length:0;if(typeof s!="number"){var u;return Et(e,function(e,r,i){if(t(e,r,i))return u=e,n}),u}while(++i<s){var o=e[i];if(t(o,i,e))return o}}function Jt(e,t){return dn(e,t,!0)}function Kt(e,t,r){var i=-1,s=e?e.length:0;t=t&&typeof r=="undefined"?t:Q(t,r,3);if(typeof s=="number"){while(++i<s)if(t(e[i],i,e)===n)break}else Et(e,t)}function Qt(e,t){var r=e?e.length:0;if(typeof r=="number"){while(r--)if(t(e[r],r,e)===!1)break}else{var i=ht(e);r=i.length,Et(e,function(e,s,o){return s=i?i[--r]:--r,t(o[s],s,o)===!1&&n})}}function Zt(e,t){var n=C(arguments,2),r=-1,i=typeof t=="function",s=e?e.length:0,o=Array(typeof s=="number"?s:0);return Kt(e,function(e){o[++r]=(i?t:e[t]).apply(e,n)}),o}function en(e,t,n){var r=-1,i=e?e.length:0;t=Wn(t,n,3);if(typeof i=="number"){var s=Array(i);while(++r<i)s[r]=t(e[r],r,e)}else s=[],Et(e,function(e,n,i){s[++r]=t(e,n,i)});return s}function tn(e,t,n){var r=-Infinity,i=r;typeof t!="function"&&n&&n[t]===e&&(t=null);var s=-1,o=e?e.length:0;if(t==null&&typeof o=="number")while(++s<o){var u=e[s];u>i&&(i=u)}else t=Wn(t,n,3),Kt(e,function(e,n,s){var o=t(e,n,s);o>r&&(r=o,i=e)});return i}function nn(e,t,n){var r=Infinity,i=r;typeof t!="function"&&n&&n[t]===e&&(t=null);var s=-1,o=e?e.length:0;if(t==null&&typeof o=="number")while(++s<o){var u=e[s];u<i&&(i=u)}else t=Wn(t,n,3),Kt(e,function(e,n,s){var o=t(e,n,s);o<r&&(r=o,i=e)});return i}function sn(e,t,n,r){if(!e)return n;var i=arguments.length<3;t=Wn(t,r,4);var s=-1,o=e.length;if(typeof o=="number"){i&&(n=e[++s]);while(++s<o)n=t(n,e[s],s,e)}else Et(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)});return n}function on(e,t,n,r){var i=arguments.length<3;return t=Wn(t,r,4),Qt(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)}),n}function un(e,t,n){return t=Wn(t,n,3),Vt(e,function(e,n,r){return!t(e,n,r)})}function an(t,n,r){t&&typeof t.length!="number"&&(t=Ut(t));if(n==null||r)return t?t[tt(0,t.length-1)]:e;var i=fn(t);return i.length=z(U(0,n),i.length),i}function fn(e){var t=-1,n=e?e.length:0,r=Array(typeof n=="number"?n:0);return Kt(e,function(e){var n=tt(0,++t);r[t]=r[n],r[n]=e}),r}function ln(e){var t=e?e.length:0;return typeof t=="number"?t:ht(e).length}function cn(e,t,r){var i;t=Wn(t,r,3);var s=-1,o=e?e.length:0;if(typeof o=="number"){while(++s<o)if(i=t(e[s],s,e))break}else Et(e,function(e,r,s){return(i=t(e,r,s))&&n});return!!i}function hn(e,t,n){var r=-1,i=e?e.length:0,s=Array(typeof i=="number"?i:0);t=Wn(t,n,3),Kt(e,function(e,n,i){s[++r]={criteria:[t(e,n,i)],index:r,value:e}}),i=s.length,s.sort(T);while(i--)s[i]=s[i].value;return s}function pn(e){return lt(e)?C(e):e&&typeof e.length=="number"?en(e):Ut(e)}function dn(t,n,r){return r&&Lt(n)?e:(r?$t:Vt)(t,n)}function vn(e){var t=-1,n=e?e.length:0,r=[];while(++t<n){var i=e[t];i&&r.push(i)}return r}function mn(e){return Y(e,Z(arguments,!0,!0,1))}function gn(t,n,r){var i=0,s=t?t.length:0;if(typeof n!="number"&&n!=null){var o=-1;n=Wn(n,r,3);while(++o<s&&n(t[o],o,t))i++}else{i=n;if(i==null||r)return t?t[0]:e}return C(t,0,z(U(0,i),s))}function yn(e,t){return Z(e,t)}function bn(e,t,n){if(typeof n=="number"){var r=e?e.length:0;n=n<0?U(0,r+n):n||0}else if(n){var i=Cn(e,t);return e[i]===t?i:-1}return x(e,t,n)}function wn(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&t!=null){var s=i;t=Wn(t,n,3);while(s--&&t(e[s],s,e))r++}else r=t==null||n?1:t||r;return C(e,0,z(U(0,i-r),i))}function En(){var e=[],t=-1,n=arguments.length;while(++t<n){var r=arguments[t];(lt(r)||ft(r))&&e.push(r)}var i=e[0],s=-1,o=ot(),u=i?i.length:0,a=[];e:while(++s<u){r=i[s];if(o(a,r)<0){var t=n;while(--t)if(o(e[t],r)<0)continue e;a.push(r)}}return a}function Sn(t,n,r){var i=0,s=t?t.length:0;if(typeof n!="number"&&n!=null){var o=s;n=Wn(n,r,3);while(o--&&n(t[o],o,t))i++}else{i=n;if(i==null||r)return t?t[s-1]:e}return C(t,U(0,s-i))}function xn(e,t,n){var r=e?e.length:0;typeof n=="number"&&(r=(n<0?U(0,r+n):z(n,r-1))+1);while(r--)if(e[r]===t)return r;return-1}function Tn(e,t,n){e=+e||0,n=+n||1,t==null&&(t=e,e=0);var r=-1,i=U(0,_((t-e)/n)),s=Array(i);while(++r<i)s[r]=e,e+=n;return s}function Nn(e,t,n){if(typeof t!="number"&&t!=null){var r=0,i=-1,s=e?e.length:0;t=Wn(t,n,3);while(++i<s&&t(e[i],i,e))r++}else r=t==null||n?1:U(0,t);return C(e,r)}function Cn(e,t,n,r){var i=0,s=e?e.length:i;n=n?Wn(n,r,1):Vn,t=n(t);while(i<s){var o=i+s>>>1;n(e[o])<t?i=o+1:s=o}return i}function kn(){return nt(Z(arguments,!0,!0))}function Ln(e,t,n,r){return typeof t!="boolean"&&t!=null&&(r=n,n=typeof t!="function"&&r&&r[t]===e?null:t,t=!1),n!=null&&(n=Wn(n,r,3)),nt(e,t,n)}function An(e){return Y(e,C(arguments,1))}function On(){var e=-1,t=tn(rn(arguments,"length")),n=Array(t<0?0:t);while(++e<t)n[e]=rn(arguments,e);return n}function Mn(e,t){var n=-1,r=e?e.length:0,i={};!t&&r&&!lt(e[0])&&(t=[]);while(++n<r){var s=e[n];t?i[s]=t[n]:s&&(i[s[0]]=s[1])}return i}function _n(e,t){if(!Mt(t))throw new TypeError;return function(){if(--e<1)return t.apply(this,arguments)}}function Dn(e,t){return arguments.length>2?it(e,17,C(arguments,2),null,t):it(e,1,null,null,t)}function Pn(e){var t=arguments.length>1?Z(arguments,!0,!1,1):St(e),n=-1,r=t.length;while(++n<r){var i=t[n];e[i]=it(e[i],1,null,null,e)}return e}function Hn(){var e=arguments,t=e.length;while(t--)if(!Mt(e[t]))throw new TypeError;return function(){var t=arguments,n=e.length;while(n--)t=[e[n].apply(this,t)];return t[0]}}function Bn(t,n,r){var i,s,o,u,a,f,l,c=0,h=!1,p=!0;if(!Mt(t))throw new TypeError;n=U(0,n)||0;if(r===!0){var d=!0;p=!1}else _t(r)&&(d=r.leading,h="maxWait"in r&&(U(n,r.maxWait)||0),p="trailing"in r?r.trailing:p);var v=function(){var r=n-(Qn()-u);if(r<=0){s&&clearTimeout(s);var h=l;s=f=l=e,h&&(c=Qn(),o=t.apply(a,i),!f&&!s&&(i=a=null))}else f=setTimeout(v,r)},m=function(){f&&clearTimeout(f),s=f=l=e;if(p||h!==n)c=Qn(),o=t.apply(a,i),!f&&!s&&(i=a=null)};return function(){i=arguments,u=Qn(),a=this,l=p&&(f||!d);if(h===!1)var e=d&&!f;else{!s&&!d&&(c=u);var r=h-(u-c),g=r<=0;g?(s&&(s=clearTimeout(s)),c=u,o=t.apply(a,i)):s||(s=setTimeout(m,r))}return g&&f?f=clearTimeout(f):!f&&n!==h&&(f=setTimeout(v,n)),e&&(g=!0,o=t.apply(a,i)),g&&!f&&!s&&(i=a=null),o}}function jn(t){if(!Mt(t))throw new TypeError;var n=C(arguments,1);return setTimeout(function(){t.apply(e,n)},1)}function Fn(t,n){if(!Mt(t))throw new TypeError;var r=C(arguments,2);return setTimeout(function(){t.apply(e,r)},n)}function In(e,t){var n={};return function(){var i=t?t.apply(this,arguments):r+arguments[0];return P.call(n,i)?n[i]:n[i]=e.apply(this,arguments)}}function qn(e){var t,n;if(!Mt(e))throw new TypeError;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function Rn(e){return it(e,16,C(arguments,1))}function Un(e,t,n){var r=!0,i=!0;if(!Mt(e))throw new TypeError;return n===!1?r=!1:_t(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),n={},n.leading=r,n.maxWait=t,n.trailing=i,Bn(e,t,n)}function zn(e,t){return it(t,16,[e])}function Wn(e,t,n){var r=typeof e;if(e==null||r=="function")return Q(e,t,n);if(r!="object")return Gn(e);var i=ht(e);return function(t){var n=i.length,r=!1;while(n--)if(!(r=t[i[n]]===e[i[n]]))break;return r}}function Xn(e){return e==null?"":String(e).replace(mt,st)}function Vn(e){return e}function $n(e){Kt(St(e),function(t){var n=X[t]=e[t];X.prototype[t]=function(){var e=[this.__wrapped__];H.apply(e,arguments);var t=n.apply(X,e);return this.__chain__?new V(t,!0):t}})}function Jn(){return y._=A,this}function Kn(){}function Gn(e){return function(t){return t[e]}}function Yn(e,t){return e==null&&t==null&&(t=1),e=+e||0,t==null?(t=e,e=0):t=+t||0,e+D(W()*(t-e+1))}function Zn(e,t){if(e){var n=e[t];return Mt(n)?e[t]():n}}function er(e,t,n){var r=X,i=r.templateSettings;e=String(e||""),n=bt({},n,i);var u=0,a="__p += '",f=n.variable,l=RegExp((n.escape||s).source+"|"+(n.interpolate||s).source+"|"+(n.evaluate||s).source+"|$","g");e.replace(l,function(t,n,r,i,s){return a+=e.slice(u,s).replace(o,N),n&&(a+="' +\n_.escape("+n+") +\n'"),i&&(a+="';\n"+i+";\n__p += '"),r&&(a+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=s+t.length,t}),a+="';\n",f||(f="obj",a="with ("+f+" || {}) {\n"+a+"\n}\n"),a="function("+f+") {\n"+"var __t, __p = '', __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n"+a+"return __p\n}";try{var c=Function("_","return "+a)(r)}catch(h){throw h.source=a,h}return t?c(t):(c.source=a,c)}function tr(e,t,n){e=(e=+e)>-1?e:0;var r=-1,i=Array(e);t=Q(t,n,1);while(++r<e)i[r]=t(r);return i}function nr(e){return e==null?"":String(e).replace(vt,at)}function rr(e){var n=++t+"";return e?e+n:n}function ir(e){return e=new V(e),e.__chain__=!0,e}function sr(e,t){return t(e),e}function or(){return this.__chain__=!0,this}function ur(){return this.__wrapped__}var e,t=0,n={},r=+(new Date)+"",i=/<%=([\s\S]+?)%>/g,s=/($^)/,o=/['\n\r\t\u2028\u2029\\]/g,u="[object Arguments]",a="[object Array]",f="[object Boolean]",l="[object Date]",c="[object Function]",h="[object Number]",p="[object Object]",d="[object RegExp]",v="[object String]",m={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},g={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},y=m[typeof window]&&window||this,b=m[typeof exports]&&exports&&!exports.nodeType&&exports,w=m[typeof module]&&module&&!module.nodeType&&module,E=w&&w.exports===b&&b,S=m[typeof global]&&global;S&&(S.global===S||S.window===S)&&(y=S);var k=[],L=Object.prototype,A=y._,O=L.toString,M=RegExp("^"+String(O).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),_=Math.ceil,D=Math.floor,P=L.hasOwnProperty,H=k.push,B=L.propertyIsEnumerable,j=ut(j=Object.create)&&j,F=ut(F=Array.isArray)&&F,I=y.isFinite,q=y.isNaN,R=ut(R=Object.keys)&&R,U=Math.max,z=Math.min,W=Math.random;V.prototype=X.prototype;var $={};(function(){var e={0:1,length:1};$.spliceObjects=(k.splice.call(e,0,1),!e[0])})(1),X.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:i,variable:""},j||(K=function(){function e(){}return function(t){if(_t(t)){e.prototype=t;var n=new e;e.prototype=null}return n||y.Object()}}()),ft(arguments)||(ft=function(e){return e&&typeof e=="object"&&typeof e.length=="number"&&P.call(e,"callee")&&!B.call(e,"callee")||!1});var lt=F||function(e){return e&&typeof e=="object"&&typeof e.length=="number"&&O.call(e)==a||!1},ct=function(e){var t,n=e,r=[];if(!n)return r;if(!m[typeof e])return r;for(t in n)P.call(n,t)&&r.push(t);return r},ht=R?function(e){return _t(e)?R(e):[]}:ct,pt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},dt=Tt(pt),vt=RegExp("("+ht(dt).join("|")+")","g"),mt=RegExp("["+ht(pt).join("")+"]","g"),wt=function(e,t){var r,i=e,s=i;if(!i)return s;if(!m[typeof i])return s;for(r in i)if(t(i[r],r,e)===n)return s;return s},Et=function(e,t){var r,i=e,s=i;if(!i)return s;if(!m[typeof i])return s;for(r in i)if(P.call(i,r)&&t(i[r],r,e)===n)return s;return s};Mt(/x/)&&(Mt=function(e){return typeof e=="function"&&O.call(e)==c});var Wt=rt(function(e,t,n){P.call(e,n)?e[n]++:e[n]=1}),Gt=rt(function(e,t,n){(P.call(e,n)?e[n]:e[n]=[]).push(t)}),Yt=rt(function(e,t,n){e[n]=t}),rn=en,Qn=ut(Qn=Date.now)&&Qn||function(){return(new Date).getTime()};X.after=_n,X.bind=Dn,X.bindAll=Pn,X.chain=ir,X.compact=vn,X.compose=Hn,X.countBy=Wt,X.debounce=Bn,X.defaults=bt,X.defer=jn,X.delay=Fn,X.difference=mn,X.filter=Vt,X.flatten=yn,X.forEach=Kt,X.functions=St,X.groupBy=Gt,X.indexBy=Yt,X.initial=wn,X.intersection=En,X.invert=Tt,X.invoke=Zt,X.keys=ht,X.map=en,X.max=tn,X.memoize=In,X.min=nn,X.omit=It,X.once=qn,X.pairs=qt,X.partial=Rn,X.pick=Rt,X.pluck=rn,X.range=Tn,X.reject=un,X.rest=Nn,X.shuffle=fn,X.sortBy=hn,X.tap=sr,X.throttle=Un,X.times=tr,X.toArray=pn,X.union=kn,X.uniq=Ln,X.values=Ut,X.where=dn,X.without=An,X.wrap=zn,X.zip=On,X.collect=en,X.drop=Nn,X.each=Kt,X.extend=gt,X.methods=St,X.object=Mn,X.select=Vt,X.tail=Nn,X.unique=Ln,X.clone=yt,X.contains=zt,X.escape=Xn,X.every=Xt,X.find=$t,X.has=xt,X.identity=Vn,X.indexOf=bn,X.isArguments=ft,X.isArray=lt,X.isBoolean=Nt,X.isDate=Ct,X.isElement=kt,X.isEmpty=Lt,X.isEqual=At,X.isFinite=Ot,X.isFunction=Mt,X.isNaN=Dt,X.isNull=Pt,X.isNumber=Ht,X.isObject=_t,X.isRegExp=Bt,X.isString=jt,X.isUndefined=Ft,X.lastIndexOf=xn,X.mixin=$n,X.noConflict=Jn,X.random=Yn,X.reduce=sn,X.reduceRight=on,X.result=Zn,X.size=ln,X.some=cn,X.sortedIndex=Cn,X.template=er,X.unescape=nr,X.uniqueId=rr,X.all=Xt,X.any=cn,X.detect=$t,X.findWhere=Jt,X.foldl=sn,X.foldr=on,X.include=zt,X.inject=sn,X.first=gn,X.last=Sn,X.sample=an,X.take=gn,X.head=gn,$n(X),X.VERSION="2.4.1",X.prototype.chain=or,X.prototype.value=ur,Kt(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=k[e];X.prototype[e]=function(){var e=this.__wrapped__;return t.apply(e,arguments),!$.spliceObjects&&e.length===0&&delete e[0],this}}),Kt(["concat","join","slice"],function(e){var t=k[e];X.prototype[e]=function(){var e=this.__wrapped__,n=t.apply(e,arguments);return this.__chain__&&(n=new V(n),n.__chain__=!0),n}}),typeof define=="function"&&typeof define.amd=="object"&&define.amd?(y._=X,define("underscore",[],function(){return X})):b&&w?E?(w.exports=X)._=X:b._=X:y._=X}.call(this),define("mockup-utils",["jquery"],function(e){var t=function(t){var n=this,r={pattern:null,vocabularyUrl:null,searchParam:"SearchableText",attributes:["UID","Title","Description","getURL","Type"],batchSize:10,baseCriteria:[],pathDepth:1};n.options=e.extend({},r,t),n.pattern=n.options.pattern;if(n.pattern===undefined||n.pattern===null)n.pattern={browsing:!1,basePath:"/"};return n.options.url&&!n.options.vocabularyUrl?n.options.vocabularyUrl=n.options.url:n.pattern.vocabularyUrl&&(n.options.vocabularyUrl=n.pattern.vocabularyUrl),n.options.vocabularyUrl!==undefined&&n.options.vocabularyUrl!==null?n.valid=!0:n.valid=!1,n.getCurrentPath=function(){var e=n.pattern,t;n.currentPath?t=n.currentPath:t=e.currentPath,typeof t=="function"&&(t=t());var r=t;return r||(e.basePath?r=e.basePath:e.options.basePath?r=e.options.basePath:r="/"),r},n.getCriterias=function(t,r){r===undefined&&(r={}),r=e.extend({},{useBaseCriteria:!0,additionalCriterias:[]},r);var i=[];return r.useBaseCriteria&&(i=n.options.baseCriteria.slice(0)),t&&(t+="*",i.push({i:n.options.searchParam,o:"plone.app.querystring.operation.string.contains",v:t})),n.pattern.browsing&&i.push({i:"path",o:"plone.app.querystring.operation.string.path",v:n.getCurrentPath()+"::"+n.options.pathDepth}),i=i.concat(r.additionalCriterias),i},n.getBatch=function(e){return e||(e=1),{page:e,size:n.options.batchSize}},n.selectAjax=function(){return{url:n.options.vocabularyUrl,dataType:"JSON",quietMillis:100,data:function(e,t){return n.getQueryData(e,t)},results:function(e,t){var n=t*10<e.total;return{results:e.results,more:n}}}},n.getUrl=function(){var t=n.options.vocabularyUrl;return t.indexOf("?")===-1?t+="?":t+="&",t+e.param(n.getQueryData())},n.getQueryData=function(e,t){var r={query:JSON.stringify({criteria:n.getCriterias(e)}),attributes:JSON.stringify(n.options.attributes)};return t&&(r.batch=JSON.stringify(n.getBatch(t))),r},n.search=function(t,r,i,s,o){o===undefined&&(o=!0);var u=[];o&&(u=n.options.baseCriteria.slice(0)),u.push({i:t,o:r,v:i});var a={query:JSON.stringify({criteria:u}),attributes:JSON.stringify(n.options.attributes)};e.ajax({url:n.options.vocabularyUrl,dataType:"JSON",data:a,success:s})},n},n=function(t){var n=this,r={className:"progress-indicator",container:null,backdrop:null,wrapper:null,zIndex:10005};return t||(t={}),n.options=e.extend({},r,t),n.options.container===null&&(n.options.container=e("body")),n.$loading=e("> ."+n.options.className,n.options.container),n.$loading.size()===0&&(n.$loading=e("<div/>").hide().addClass(n.options.className).appendTo(n.options.container)),n.$wrapper=n.options.wrapper,n.$wrapper===null&&(n.$wrapper=n.options.container),n.show=function(e){e===undefined&&(e=!0),n.options.backdrop&&(n.options.backdrop.closeOnClick=e,n.options.backdrop.closeOnEsc=e,n.options.backdrop.init()),n.$wrapper.parent().css("overflow","hidden"),n.$wrapper.show(),n.options.backdrop&&n.options.backdrop.show(),n.$loading.show(),n.position()},n.position=function(){n.$loading.css({"margin-left":n.$wrapper.width()/2-n.$loading.width()/2,"margin-top":n.$wrapper.height()/2-n.$loading.height()/2,position:"absolute",bottom:"0",left:"0",right:"0",top:"0"});var e=n.options.zIndex;typeof e=="function"&&(e=e()),n.$loading.css("zIndex",e)},n.hide=function(){n.$loading.hide(),n.$wrapper.parent().css("overflow","")},n};return{parseBodyTag:function(t){return e(/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(t)[0].replace("<body","<div").replace("</body>","</div>")).eq(0).html()},setId:function(e,t){t===undefined&&(t="id");var n=e.attr("id");return n===undefined?n=t+Math.floor((1+Math.random())*65536).toString(16).substring(1):n=n.replace(/\./g,"-"),e.attr("id",n),n},bool:function(t){return typeof t=="string"&&(t=e.trim(t).toLowerCase()),["true",!0,1].indexOf(t)!==-1},QueryHelper:t,ProgressIndicator:n}}),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L=[].slice,A={}.hasOwnProperty,O=function(e,t){function r(){this.constructor=e}for(var n in t)A.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};e=this.jQuery,m=function(){function t(t,n){this.$el=e(t),this.options=e.extend({},this.defaults,n)}return t.prototype.defaults={},t.prototype.destroy=function(){return this._deinit()},t.prototype._init=function(){return null},t.prototype._deinit=function(){return null},t.register=function(n,r){var i,s,o,u;return u=function(){return"simple_widget_"+r},s=function(t,r){var i,s,o,a,f;i=u();for(a=0,f=t.length;a<f;a++)s=t[a],o=new n(s,r),e.data(s,i)||e.data(s,i,o),o._init();return t},o=function(n){var r,i,s,o,a,f;r=u(),f=[];for(o=0,a=n.length;o<a;o++)i=n[o],s=e.data(i,r),s&&s instanceof t&&s.destroy(),f.push(e.removeData(i,r));return f},i=function(n,r,i){var s,o,a,f,l,c;o=null;for(l=0,c=n.length;l<c;l++)s=n[l],a=e.data(s,u()),a&&a instanceof t&&(f=a[r],f&&typeof f=="function"&&(o=f.apply(a,i)));return o},e.fn[r]=function(){var e,t,n,r,u;n=arguments[0],t=2<=arguments.length?L.call(arguments,1):[],e=this;if(n===void 0||typeof n=="object")return u=n,s(e,u);if(typeof n=="string"&&n[0]!=="_")return r=n,r==="destroy"?o(e):i(e,r,t)}},t}(),this.SimpleWidget=m,f=function(t){function n(){return N=n.__super__.constructor.apply(this,arguments),N}return O(n,t),n.is_mouse_handled=!1,n.prototype._init=function(){return this.$el.bind("mousedown.mousewidget",e.proxy(this._mouseDown,this)),this.$el.bind("touchstart.mousewidget",e.proxy(this._touchStart,this)),this.is_mouse_started=!1,this.mouse_delay=0,this._mouse_delay_timer=null,this._is_mouse_delay_met=!0,this.mouse_down_info=null},n.prototype._deinit=function(){var t;return this.$el.unbind("mousedown.mousewidget"),this.$el.unbind("touchstart.mousewidget"),t=e(document),t.unbind("mousemove.mousewidget"),t.unbind("mouseup.mousewidget")},n.prototype._mouseDown=function(e){var t;if(e.which!==1)return;return t=this._handleMouseDown(e,this._getPositionInfo(e)),t&&e.preventDefault(),t},n.prototype._handleMouseDown=function(e,t){if(n.is_mouse_handled)return;this.is_mouse_started&&this._handleMouseUp(t),this.mouse_down_info=t;if(!this._mouseCapture(t))return;return this._handleStartMouse(),this.is_mouse_handled=!0,!0},n.prototype._handleStartMouse=function(){var t;t=e(document),t.bind("mousemove.mousewidget",e.proxy(this._mouseMove,this)),t.bind("touchmove.mousewidget",e.proxy(this._touchMove,this)),t.bind("mouseup.mousewidget",e.proxy(this._mouseUp,this)),t.bind("touchend.mousewidget",e.proxy(this._touchEnd,this));if(this.mouse_delay)return this._startMouseDelayTimer()},n.prototype._startMouseDelayTimer=function(){var e=this;return this._mouse_delay_timer&&clearTimeout(this._mouse_delay_timer),this._mouse_delay_timer=setTimeout(function(){return e._is_mouse_delay_met=!0},this.mouse_delay),this._is_mouse_delay_met=!1},n.prototype._mouseMove=function(e){return this._handleMouseMove(e,this._getPositionInfo(e))},n.prototype._handleMouseMove=function(e,t){return this.is_mouse_started?(this._mouseDrag(t),e.preventDefault()):this.mouse_delay&&!this._is_mouse_delay_met?!0:(this.is_mouse_started=this._mouseStart(this.mouse_down_info)!==!1,this.is_mouse_started?this._mouseDrag(t):this._handleMouseUp(t),!this.is_mouse_started)},n.prototype._getPositionInfo=function(e){return{page_x:e.pageX,page_y:e.pageY,target:e.target,original_event:e}},n.prototype._mouseUp=function(e){return this._handleMouseUp(this._getPositionInfo(e))},n.prototype._handleMouseUp=function(t){var n;n=e(document),n.unbind("mousemove.mousewidget"),n.unbind("touchmove.mousewidget"),n.unbind("mouseup.mousewidget"),n.unbind("touchend.mousewidget"),this.is_mouse_started&&(this.is_mouse_started=!1,this._mouseStop(t))},n.prototype._mouseCapture=function(e){return!0},n.prototype._mouseStart=function(e){return null},n.prototype._mouseDrag=function(e){return null},n.prototype._mouseStop=function(e){return null},n.prototype.setMouseDelay=function(e){return this.mouse_delay=e},n.prototype._touchStart=function(e){var t;if(e.originalEvent.touches.length>1)return;return t=e.originalEvent.changedTouches[0],this._handleMouseDown(e,this._getPositionInfo(t))},n.prototype._touchMove=function(e){var t;if(e.originalEvent.touches.length>1)return;return t=e.originalEvent.changedTouches[0],this._handleMouseMove(e,this._getPositionInfo(t))},n.prototype._touchEnd=function(e){var t;if(e.originalEvent.touches.length>1)return;return t=e.originalEvent.changedTouches[0],this._handleMouseUp(this._getPositionInfo(t))},n}(m),this.Tree={},e=this.jQuery,h={getName:function(e){return h.strings[e-1]},nameToIndex:function(e){var t,n,r;for(t=n=1,r=h.strings.length;1<=r?n<=r:n>=r;t=1<=r?++n:--n)if(h.strings[t-1]===e)return t;return 0}},h.BEFORE=1,h.AFTER=2,h.INSIDE=3,h.NONE=4,h.strings=["before","after","inside","none"],this.Tree.Position=h,l=function(){function t(e,n,r){n==null&&(n=!1),r==null&&(r=t),this.setData(e),this.children=[],this.parent=null,n&&(this.id_mapping={},this.tree=this,this.node_class=r)}return t.prototype.setData=function(e){var t,n,r;if(typeof e!="object")return this.name=e;r=[];for(t in e)n=e[t],t==="label"?r.push(this.name=n):r.push(this[t]=n);return r},t.prototype.initFromData=function(e){var t,n,r=this;return n=function(e){r.setData(e);if(e.children)return t(e.children)},t=function(e){var t,n,i,s;for(i=0,s=e.length;i<s;i++)t=e[i],n=new r.tree.node_class(""),n.initFromData(t),r.addChild(n);return null},n(e),null},t.prototype.loadFromData=function(e){var t,n,r,i;this.removeChildren();for(r=0,i=e.length;r<i;r++)n=e[r],t=new this.tree.node_class(n),this.addChild(t),typeof n=="object"&&n.children&&t.loadFromData(n.children);return null},t.prototype.addChild=function(e){return this.children.push(e),e._setParent(this)},t.prototype.addChildAtPosition=function(e,t){return this.children.splice(t,0,e),e._setParent(this)},t.prototype._setParent=function(e){return this.parent=e,this.tree=e.tree,this.tree.addNodeToIndex(this)},t.prototype.removeChild=function(e){return e.removeChildren(),this._removeChild(e)},t.prototype._removeChild=function(e){return this.children.splice(this.getChildIndex(e),1),this.tree.removeNodeFromIndex(e)},t.prototype.getChildIndex=function(t){return e.inArray(t,this.children)},t.prototype.hasChildren=function(){return this.children.length!==0},t.prototype.isFolder=function(){return this.hasChildren()||this.load_on_demand},t.prototype.iterate=function(e){var t,n=this;return t=function(r,i){var s,o,u,a,f;if(r.children){f=r.children;for(u=0,a=f.length;u<a;u++)s=f[u],o=e(s,i),n.hasChildren()&&o&&t(s,i+1);return null}},t(this,0),null},t.prototype.moveNode=function(e,t,n){if(e.isParentOf(t))return;e.parent._removeChild(e);if(n===h.AFTER)return t.parent.addChildAtPosition(e,t.parent.getChildIndex(t)+1);if(n===h.BEFORE)return t.parent.addChildAtPosition(e,t.parent.getChildIndex(t));if(n===h.INSIDE)return t.addChildAtPosition(e,0)},t.prototype.getData=function(){var e,t=this;return e=function(t){var n,r,i,s,o,u,a;n=[];for(u=0,a=t.length;u<a;u++){i=t[u],s={};for(r in i)o=i[r],r!=="parent"&&r!=="children"&&r!=="element"&&r!=="tree"&&Object.prototype.hasOwnProperty.call(i,r)&&(s[r]=o);i.hasChildren()&&(s.children=e(i.children)),n.push(s)}return n},e(this.children)},t.prototype.getNodeByName=function(e){var t;return t=null,this.iterate(function(n){return n.name===e?(t=n,!1):!0}),t},t.prototype.addAfter=function(e){var t,n;return this.parent?(n=new this.tree.node_class(e),t=this.parent.getChildIndex(this),this.parent.addChildAtPosition(n,t+1),n):null},t.prototype.addBefore=function(e){var t,n;return this.parent?(n=new this.tree.node_class(e),t=this.parent.getChildIndex(this),this.parent.addChildAtPosition(n,t),n):null},t.prototype.addParent=function(e){var t,n,r,i,s,o;if(!this.parent)return null;n=new this.tree.node_class(e),n._setParent(this.tree),r=this.parent,o=r.children;for(i=0,s=o.length;i<s;i++)t=o[i],n.addChild(t);return r.children=[],r.addChild(n),n},t.prototype.remove=function(){if(this.parent)return this.parent.removeChild(this),this.parent=null},t.prototype.append=function(e){var t;return t=new this.tree.node_class(e),this.addChild(t),t},t.prototype.prepend=function(e){var t;return t=new this.tree.node_class(e),this.addChildAtPosition(t,0),t},t.prototype.isParentOf=function(e){var t;t=e.parent;while(t){if(t===this)return!0;t=t.parent}return!1},t.prototype.getLevel=function(){var e,t;e=0,t=this;while(t.parent)e+=1,t=t.parent;return e},t.prototype.getNodeById=function(e){return this.id_mapping[e]},t.prototype.addNodeToIndex=function(e){if(e.id!=null)return this.id_mapping[e.id]=e},t.prototype.removeNodeFromIndex=function(e){if(e.id!=null)return delete this.id_mapping[e.id]},t.prototype.removeChildren=function(){var e=this;return this.iterate(function(t){return e.tree.removeNodeFromIndex(t),!0}),this.children=[]},t.prototype.getPreviousSibling=function(){var e;return this.parent?(e=this.parent.getChildIndex(this)-1,e>=0?this.parent.children[e]:null):null},t.prototype.getNextSibling=function(){var e;return this.parent?(e=this.parent.getChildIndex(this)+1,e<this.parent.children.length?this.parent.children[e]:null):null},t}(),this.Tree.Node=l,u=function(t){function r(){return C=r.__super__.constructor.apply(this,arguments),C}return O(r,t),r.prototype.defaults={autoOpen:!1,saveState:!1,dragAndDrop:!1,selectable:!0,useContextMenu:!0,onCanSelectNode:null,onSetStateFromStorage:null,onGetStateFromStorage:null,onCreateLi:null,onIsMoveHandle:null,onCanMove:null,onCanMoveTo:null,onLoadFailed:null,autoEscape:!0,dataUrl:null,closedIcon:"&#x25ba;",openedIcon:"&#x25bc;",slide:!0,nodeClass:l,dataFilter:null,keyboardSupport:!0,openFolderDelay:500},r.prototype.toggle=function(e,t){return t==null&&(t=!0),e.is_open?this.closeNode(e,t):this.openNode(e,t)},r.prototype.getTree=function(){return this.tree},r.prototype.selectNode=function(e){return this._selectNode(e,!1)},r.prototype._selectNode=function(e,t){var n,r,i,s,o=this;t==null&&(t=!1);if(!this.select_node_handler)return;n=function(){return o.options.onCanSelectNode?o.options.selectable&&o.options.onCanSelectNode(e):o.options.selectable},i=function(){var t;t=e.parent;if(t&&t.parent&&!t.is_open)return o.openNode(t,!1)},s=function(){if(o.options.saveState)return o.save_state_handler.saveState()};if(!e){this._deselectCurrentNode(),s();return}if(!n())return;return this.select_node_handler.isNodeSelected(e)?t&&(this._deselectCurrentNode(),this._triggerEvent("tree.select",{node:null,previous_node:e})):(r=this.getSelectedNode(),this._deselectCurrentNode(),this.addToSelection(e),this._triggerEvent("tree.select",{node:e,deselected_node:r}),i()),s()},r.prototype.getSelectedNode=function(){return this.select_node_handler.getSelectedNode()},r.prototype.toJson=function(){return JSON.stringify(this.tree.getData())},r.prototype.loadData=function(e,t){return this._loadData(e,t)},r.prototype.loadDataFromUrl=function(t,n,r){return e.type(t)!=="string"&&(r=n,n=t,t=null),this._loadDataFromUrl(t,n,r)},r.prototype._loadDataFromUrl=function(t,n,r){var s,o,u,a,f=this;return s=null,o=function(){var e;return n?(e=new i(n,f),s=e.getLi()):s=f.element,s.addClass("jqtree-loading")},a=function(){if(s)return s.removeClass("jqtree-loading")},u=function(){e.type(t)==="string"&&(t={url:t});if(!t.method)return t.method="get"},o(),t||(t=this._getDataUrlInfo(n)),u(),e.ajax({url:t.url,data:t.data,type:t.method.toUpperCase(),cache:!1,dataType:"json",success:function(t){var i;e.isArray(t)||typeof t=="object"?i=t:i=e.parseJSON(t),f.options.dataFilter&&(i=f.options.dataFilter(i)),a(),f._loadData(i,n);if(r&&e.isFunction(r))return r()},error:function(e){a();if(f.options.onLoadFailed)return f.options.onLoadFailed(e)}})},r.prototype._loadData=function(e,t){var n,r,i,s;if(!e)return;this._triggerEvent("tree.load_data",{tree_data:e});if(!t)this._initTree(e);else{r=this.select_node_handler.getSelectedNodes(t);for(i=0,s=r.length;i<s;i++)n=r[i],this.select_node_handler.removeFromSelection(n);t.loadFromData(e),t.load_on_demand=!1,this._refreshElements(t.parent)}if(this.is_dragging)return this.dnd_handler.refreshHitAreas()},r.prototype.getNodeById=function(e){return this.tree.getNodeById(e)},r.prototype.getNodeByName=function(e){return this.tree.getNodeByName(e)},r.prototype.openNode=function(e,t){return t==null&&(t=!0),this._openNode(e,t)},r.prototype._openNode=function(e,t,n){var r,s,o=this;t==null&&(t=!0),r=function(e,t,n){var r;return r=new i(e,o),r.open(n,t)};if(e.isFolder()){if(e.load_on_demand)return this._loadFolderOnDemand(e,t,n);s=e.parent;while(s&&!s.is_open)s.parent&&r(s,!1,null),s=s.parent;return r(e,t,n),this._saveState()}},r.prototype._loadFolderOnDemand=function(e,t,n){var r=this;return t==null&&(t=!0),this._loadDataFromUrl(null,e,function(){return r._openNode(e,t,n)})},r.prototype.closeNode=function(e,t){t==null&&(t=!0);if(e.isFolder())return(new i(e,this)).close(t),this._saveState()},r.prototype.isDragging=function(){return this.is_dragging},r.prototype.refreshHitAreas=function(){return this.dnd_handler.refreshHitAreas()},r.prototype.addNodeAfter=function(e,t){var n;return n=t.addAfter(e),this._refreshElements(t.parent),n},r.prototype.addNodeBefore=function(e,t){var n;return n=t.addBefore(e),this._refreshElements(t.parent),n},r.prototype.addParentNode=function(e,t){var n;return n=t.addParent(e),this._refreshElements(n.parent),n},r.prototype.removeNode=function(e){var t;t=e.parent;if(t)return this.select_node_handler.removeFromSelection(e,!0),e.remove(),this._refreshElements(t.parent)},r.prototype.appendNode=function(e,t){var n,r;return t||(t=this.tree),n=t.isFolder(),r=t.append(e),n?this._refreshElements(t):this._refreshElements(t.parent),r},r.prototype.prependNode=function(e,t){var n;return t||(t=this.tree),n=t.prepend(e),this._refreshElements(t),n},r.prototype.updateNode=function(e,t){var n;return n=t.id&&t.id!==e.id,n&&this.tree.removeNodeFromIndex(e),e.setData(t),n&&this.tree.addNodeToIndex(e),this._refreshElements(e.parent),this._selectCurrentNode()},r.prototype.moveNode=function(e,t,n){var r;return r=h.nameToIndex(n),this.tree.moveNode(e,t,r),this._refreshElements()},r.prototype.getStateFromStorage=function(){return this.save_state_handler.getStateFromStorage()},r.prototype.addToSelection=function(e){return this.select_node_handler.addToSelection(e),this._getNodeElementForNode(e).select()},r.prototype.getSelectedNodes=function(){return this.select_node_handler.getSelectedNodes()},r.prototype.isNodeSelected=function(e){return this.select_node_handler.isNodeSelected(e)},r.prototype.removeFromSelection=function(e){return this.select_node_handler.removeFromSelection(e),this._getNodeElementForNode(e).deselect()},r.prototype.scrollToNode=function(t){var n,r;return n=e(t.element),r=n.offset().top-this.$el.offset().top,this.scroll_handler.scrollTo(r)},r.prototype.getState=function(){return this.save_state_handler.getState()},r.prototype.setState=function(e){return this.save_state_handler.setState(e),this._refreshElements()},r.prototype._init=function(){r.__super__._init.call(this),this.element=this.$el,this.mouse_delay=300,this.is_initialized=!1,typeof p!="undefined"&&p!==null?this.save_state_handler=new p(this):this.options.saveState=!1,typeof v!="undefined"&&v!==null&&(this.select_node_handler=new v(this)),typeof n!="undefined"&&n!==null?this.dnd_handler=new n(this):this.options.dragAndDrop=!1,typeof d!="undefined"&&d!==null&&(this.scroll_handler=new d(this)),typeof a!="undefined"&&a!==null&&typeof v!="undefined"&&v!==null&&(this.key_handler=new a(this)),this._initData(),this.element.click(e.proxy(this._click,this)),this.element.dblclick(e.proxy(this._dblclick,this));if(this.options.useContextMenu)return this.element.bind("contextmenu",e.proxy(this._contextmenu,this))},r.prototype._deinit=function(){return this.element.empty(),this.element.unbind(),this.key_handler.deinit(),this.tree=null,r.__super__._deinit.call(this)},r.prototype._initData=function(){return this.options.data?this._loadData(this.options.data):this._loadDataFromUrl(this._getDataUrlInfo())},r.prototype._getDataUrlInfo=function(t){var n,r,i=this;return n=this.options.dataUrl||this.element.data("url"),r=function(){var e,r,s;return s={url:n},t&&t.id?(e={node:t.id},s.data=e):(r=i._getNodeIdToBeSelected(),r&&(e={selected_node:r},s.data=e)),s},e.isFunction(n)?n(t):e.type(n)==="string"?r():n},r.prototype._getNodeIdToBeSelected=function(){return this.options.saveState?this.save_state_handler.getNodeIdToBeSelected():null},r.prototype._initTree=function(e){this.tree=new this.options.nodeClass(null,!0,this.options.nodeClass),this.select_node_handler&&this.select_node_handler.clear(),this.tree.loadFromData(e),this._openNodes(),this._refreshElements();if(!this.is_initialized)return this.is_initialized=!0,this._triggerEvent("tree.init")},r.prototype._openNodes=function(){var e;if(this.options.saveState&&this.save_state_handler.restoreState())return;if(this.options.autoOpen===!1)return;return this.options.autoOpen===!0?e=-1:e=parseInt(this.options.autoOpen),this.tree.iterate(function(t,n){return t.hasChildren()&&(t.is_open=!0),n!==e})},r.prototype._refreshElements=function(t){var n,r,i,s,o,u,a,f,l,c=this;return t==null&&(t=null),a=function(e){return c.options.autoEscape?y(e):e},o=function(t){var n;return t?n="jqtree-tree":n="",e('<ul class="jqtree_common '+n+'"></ul>')},i=function(e){var t;return e.isFolder()?t=r(e):t=s(e),c.options.onCreateLi&&c.options.onCreateLi(e,t),t},s=function(t){var n,r,i;return i=["jqtree_common"],c.select_node_handler&&c.select_node_handler.isNodeSelected(t)&&i.push("jqtree-selected"),n=i.join(" "),r=a(t.name),e('<li class="'+n+'"><div class="jqtree-element jqtree_common"><span class="jqtree-title jqtree_common">'+r+"</span></div></li>")},r=function(t){var n,r,i,s,o,u;return o=function(){var e;return e=["jqtree-toggler"],t.is_open||e.push("jqtree-closed"),e.join(" ")},u=function(){var e;return e=["jqtree-folder"],t.is_open||e.push("jqtree-closed"),c.select_node_handler&&c.select_node_handler.isNodeSelected(t)&&e.push("jqtree-selected"),e.join(" ")},r=o(),s=u(),i=a(t.name),t.is_open?n=c.options.openedIcon:n=c.options.closedIcon,e('<li class="jqtree_common '+s+'"><div class="jqtree-element jqtree_common"><a class="jqtree_common '+r+'">'+n+'</a><span class="jqtree_common jqtree-title">'+i+"</span></div></li>")},u=function(e,t,n,r){var s,a,f,l,c;a=o(n),e.append(a);for(l=0,c=t.length;l<c;l++)f=t[l],s=i(f),a.append(s),f.element=s[0],s.data("node",f),f.hasChildren()&&u(s,f.children,!1,f.is_open);return null},t&&t.parent?(f=!1,l=this._getNodeElementForNode(t),l.getUl().remove(),n=l.$element):(t=this.tree,n=this.element,n.empty(),f=!0),u(n,t.children,f,f),this._triggerEvent("tree.refresh")},r.prototype._click=function(e){var t,n,r;t=this._getClickTarget(e.target);if(t){if(t.type==="button")return this.toggle(t.node,this.options.slide),e.preventDefault(),e.stopPropagation();if(t.type==="label"){r=t.node,n=this._triggerEvent("tree.click",{node:r,click_event:e});if(!n.isDefaultPrevented())return this._selectNode(r,!0)}}},r.prototype._dblclick=function(e){var t;t=this._getClickTarget(e.target);if(t&&t.type==="label")return this._triggerEvent("tree.dblclick",{node:t.node,click_event:e})},r.prototype._getClickTarget=function(t){var n,r,i,s;i=e(t),n=i.closest(".jqtree-toggler");if(n.length){s=this._getNode(n);if(s)return{type:"button",node:s}}else{r=i.closest(".jqtree-element");if(r.length){s=this._getNode(r);if(s)return{type:"label",node:s}}}return null},r.prototype._getNode=function(e){var t;return t=e.closest("li"),t.length===0?null:t.data("node")},r.prototype._getNodeElementForNode=function(e){return e.isFolder()?new i(e,this):new c(e,this)},r.prototype._getNodeElement=function(e){var t;return t=this._getNode(e),t?this._getNodeElementForNode(t):null},r.prototype._contextmenu=function(t){var n,r;n=e(t.target).closest("ul.jqtree-tree .jqtree-element");if(n.length){r=this._getNode(n);if(r)return t.preventDefault(),t.stopPropagation(),this._triggerEvent("tree.contextmenu",{node:r,click_event:t}),!1}},r.prototype._saveState=function(){if(this.options.saveState)return this.save_state_handler.saveState()},r.prototype._mouseCapture=function(e){return this.options.dragAndDrop?this.dnd_handler.mouseCapture(e):!1},r.prototype._mouseStart=function(e){return this.options.dragAndDrop?this.dnd_handler.mouseStart(e):!1},r.prototype._mouseDrag=function(e){var t;return this.options.dragAndDrop?(t=this.dnd_handler.mouseDrag(e),this.scroll_handler&&this.scroll_handler.checkScrolling(),t):!1},r.prototype._mouseStop=function(e){return this.options.dragAndDrop?this.dnd_handler.mouseStop(e):!1},r.prototype._triggerEvent=function(t,n){var r;return r=e.Event(t),e.extend(r,n),this.element.trigger(r),r},r.prototype.testGenerateHitAreas=function(e){return this.dnd_handler.current_item=this._getNodeElementForNode(e),this.dnd_handler.generateHitAreas(),this.dnd_handler.hit_areas},r.prototype._selectCurrentNode=function(){var e,t;e=this.getSelectedNode();if(e){t=this._getNodeElementForNode(e);if(t)return t.select()}},r.prototype._deselectCurrentNode=function(){var e;e=this.getSelectedNode();if(e)return this.removeFromSelection(e)},r}(f),m.register(u,"tree"),c=function(){function n(e,t){this.init(e,t)}return n.prototype.init=function(t,n){return this.node=t,this.tree_widget=n,this.$element=e(t.element)},n.prototype.getUl=function(){return this.$element.children("ul:first")},n.prototype.getSpan=function(){return this.$element.children(".jqtree-element").find("span.jqtree-title")},n.prototype.getLi=function(){return this.$element},n.prototype.addDropHint=function(e){return e===h.INSIDE?new t(this.$element):new s(this.node,this.$element,e)},n.prototype.select=function(){return this.getLi().addClass("jqtree-selected")},n.prototype.deselect=function(){return this.getLi().removeClass("jqtree-selected")},n}(),i=function(e){function n(){return k=n.__super__.constructor.apply(this,arguments),k}return O(n,e),n.prototype.open=function(e,t){var n,r,i=this;t==null&&(t=!0);if(!this.node.is_open)return this.node.is_open=!0,n=this.getButton(),n.removeClass("jqtree-closed"),n.html(this.tree_widget.options.openedIcon),r=function(){return i.getLi().removeClass("jqtree-closed"),e&&e(),i.tree_widget._triggerEvent("tree.open",{node:i.node})},t?this.getUl().slideDown("fast",r):(this.getUl().show(),r())},n.prototype.close=function(e){var t,n,r=this;e==null&&(e=!0);if(this.node.is_open)return this.node.is_open=!1,t=this.getButton(),t.addClass("jqtree-closed"),t.html(this.tree_widget.options.closedIcon),n=function(){return r.getLi().addClass("jqtree-closed"),r.tree_widget._triggerEvent("tree.close",{node:r.node})},e?this.getUl().slideUp("fast",n):(this.getUl().hide(),n())},n.prototype.getButton=function(){return this.$element.children(".jqtree-element").find("a.jqtree-toggler")},n.prototype.addDropHint=function(e){return!this.node.is_open&&e===h.INSIDE?new t(this.$element):new s(this.node,this.$element,e)},n}(c),y=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},T=function(e,t){var n,r,i,s;for(n=i=0,s=e.length;i<s;n=++i){r=e[n];if(r===t)return n}return-1},b=function(e,t){return e.indexOf?e.indexOf(t):T(e,t)},this.Tree.indexOf=b,this.Tree._indexOf=T;if(this.JSON==null||this.JSON.stringify==null||typeof this.JSON.stringify!="function")w=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,E={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},S=function(e){return w.lastIndex=0,w.test(e)?'"'+e.replace(w,function(e){var t;return t=E[e],typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'},x=function(e,t){var n,r,i,s,o,u,a;o=t[e];switch(typeof o){case"string":return S(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":return String(o);case"object":if(!o)return"null";i=[];if(Object.prototype.toString.apply(o)==="[object Array]"){for(n=u=0,a=o.length;u<a;n=++u)s=o[n],i[n]=x(n,o)||"null";return i.length===0?"[]":"["+i.join(",")+"]"}for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(s=x(r,o),s&&i.push(S(r)+":"+s));return i.length===0?"{}":"{"+i.join(",")+"}"}},this.JSON==null&&(this.JSON={}),this.JSON.stringify=function(e){return x("",{"":e})};p=function(){function t(e){this.tree_widget=e}return t.prototype.saveState=function(){var t;t=JSON.stringify(this.getState());if(this.tree_widget.options.onSetStateFromStorage)return this.tree_widget.options.onSetStateFromStorage(t);if(this.supportsLocalStorage())return localStorage.setItem(this.getCookieName(),t);if(e.cookie)return e.cookie.raw=!0,e.cookie(this.getCookieName(),t,{path:"/"})},t.prototype.restoreState=function(){var t;return t=this.getStateFromStorage(),t?(this.setState(e.parseJSON(t)),!0):!1},t.prototype.getStateFromStorage=function(){return this.tree_widget.options.onGetStateFromStorage?this.tree_widget.options.onGetStateFromStorage():this.supportsLocalStorage()?localStorage.getItem(this.getCookieName()):e.cookie?(e.cookie.raw=!0,e.cookie(this.getCookieName())):null},t.prototype.getState=function(){var e,t,n,r=this;return e=[],this.tree_widget.tree.iterate(function(t){return t.is_open&&t.id&&t.hasChildren()&&e.push(t.id),!0}),t=this.tree_widget.getSelectedNode(),t?n=t.id:n="",{open_nodes:e,selected_node:n}},t.prototype.setState=function(e){var t,n,r,i=this;if(e){t=e.open_nodes,r=e.selected_node,this.tree_widget.tree.iterate(function(e){return e.is_open=e.id&&e.hasChildren()&&b(t,e.id)>=0,!0});if(r&&this.tree_widget.select_node_handler){this.tree_widget.select_node_handler.clear(),n=this.tree_widget.getNodeById(r);if(n)return this.tree_widget.select_node_handler.addToSelection(n)}}},t.prototype.getCookieName=function(){return typeof this.tree_widget.options.saveState=="string"?this.tree_widget.options.saveState:"tree"},t.prototype.supportsLocalStorage=function(){var e;return e=function(){var e,t;if(typeof localStorage=="undefined"||localStorage===null)return!1;try{t="_storage_test",sessionStorage.setItem(t,!0),sessionStorage.removeItem(t)}catch(n){return e=n,!1}return!0},this._supportsLocalStorage==null&&(this._supportsLocalStorage=e()),this._supportsLocalStorage},t.prototype.getNodeIdToBeSelected=function(){var t,n;return n=this.getStateFromStorage(),n?(t=e.parseJSON(n),t.selected_node):null},t}(),v=function(){function e(e){this.tree_widget=e,this.clear()}return e.prototype.getSelectedNode=function(){var e;return e=this.getSelectedNodes(),e.length?e[0]:!1},e.prototype.getSelectedNodes=function(){var e,t,n;if(this.selected_single_node)return[this.selected_single_node];n=[];for(e in this.selected_nodes)t=this.tree_widget.getNodeById(e),t&&n.push(t);return n},e.prototype.isNodeSelected=function(e){return e.id?this.selected_nodes[e.id]:this.selected_single_node?this.selected_single_node.element===e.element:!1},e.prototype.clear=function(){return this.selected_nodes={},this.selected_single_node=null},e.prototype.removeFromSelection=function(e,t){var n=this;t==null&&(t=!1);if(!e.id){if(this.selected_single_node&&e.element===this.selected_single_node.element)return this.selected_single_node=null}else{delete this.selected_nodes[e.id];if(t)return e.iterate(function(t){return delete n.selected_nodes[e.id],!0})}},e.prototype.addToSelection=function(e){return e.id?this.selected_nodes[e.id]=!0:this.selected_single_node=e},e}(),n=function(){function t(e){this.tree_widget=e,this.hovered_area=null,this.$ghost=null,this.hit_areas=[],this.is_dragging=!1}return t.prototype.mouseCapture=function(t){var n,r;return n=e(t.target),this.tree_widget.options.onIsMoveHandle&&!this.tree_widget.options.onIsMoveHandle(n)?null:(r=this.tree_widget._getNodeElement(n),r&&this.tree_widget.options.onCanMove&&(this.tree_widget.options.onCanMove(r.node)||(r=null)),this.current_item=r,this.current_item!==null)},t.prototype.mouseStart=function(t){var n;return this.refreshHitAreas(),n=e(t.target).offset(),this.drag_element=new r(this.current_item.node,t.page_x-n.left,t.page_y-n.top,this.tree_widget.element),this.is_dragging=!0,this.current_item.$element.addClass("jqtree-moving"),!0},t.prototype.mouseDrag=function(e){var t,n;return this.drag_element.move(e.page_x,e.page_y),t=this.findHoveredArea(e.page_x,e.page_y),n=this.canMoveToArea(t),t?this.hovered_area!==t&&(this.hovered_area=t,this.mustOpenFolderTimer(t)&&this.startOpenFolderTimer(t.node),n&&this.updateDropHint()):(this.removeHover(),this.removeDropHint(),this.stopOpenFolderTimer()),!0},t.prototype.canMoveToArea=function(e){var t;return e?this.tree_widget.options.onCanMoveTo?(t=h.getName(e.position),this.tree_widget.options.onCanMoveTo(this.current_item.node,e.node,t)):!0:!1},t.prototype.mouseStop=function(e){return this.moveItem(e),this.clear(),this.removeHover(),this.removeDropHint(),this.removeHitAreas(),this.current_item&&this.current_item.$element.removeClass("jqtree-moving"),this.is_dragging=!1,!1},t.prototype.refreshHitAreas=function(){return this.removeHitAreas(),this.generateHitAreas()},t.prototype.removeHitAreas=function(){return this.hit_areas=[]},t.prototype.clear=function(){return this.drag_element.remove(),this.drag_element=null},t.prototype.removeDropHint=function(){if(this.previous_ghost)return this.previous_ghost.remove()},t.prototype.removeHover=function(){return this.hovered_area=null},t.prototype.generateHitAreas=function(){var e;return e=new o(this.tree_widget.tree,this.current_item.node,this.getTreeDimensions().bottom),this.hit_areas=e.generate()},t.prototype.findHoveredArea=function(e,t){var n,r,i,s,o;r=this.getTreeDimensions();if(e<r.left||t<r.top||e>r.right||t>r.bottom)return null;s=0,i=this.hit_areas.length;while(s<i){o=s+i>>1,n=this.hit_areas[o];if(t<n.top)i=o;else{if(!(t>n.bottom))return n;s=o+1}}return null},t.prototype.mustOpenFolderTimer=function(e){var t;return t=e.node,t.isFolder()&&!t.is_open&&e.position===h.INSIDE},t.prototype.updateDropHint=function(){var e;if(!this.hovered_area)return;return this.removeDropHint(),e=this.tree_widget._getNodeElementForNode(this.hovered_area.node),this.previous_ghost=e.addDropHint(this.hovered_area.position)},t.prototype.startOpenFolderTimer=function(e){var t,n=this;return t=function(){return n.tree_widget._openNode(e,n.tree_widget.options.slide,function(){return n.refreshHitAreas(),n.updateDropHint()})},this.stopOpenFolderTimer(),this.open_folder_timer=setTimeout(t,this.tree_widget.options.openFolderDelay)},t.prototype.stopOpenFolderTimer=function(){if(this.open_folder_timer)return clearTimeout(this.open_folder_timer),this.open_folder_timer=null},t.prototype.moveItem=function(e){var t,n,r,i,s,o,u=this;if(this.hovered_area&&this.hovered_area.position!==h.NONE&&this.canMoveToArea(this.hovered_area)){r=this.current_item.node,o=this.hovered_area.node,i=this.hovered_area.position,s=r.parent,i===h.INSIDE&&(this.hovered_area.node.is_open=!0),t=function(){return u.tree_widget.tree.moveNode(r,o,i),u.tree_widget.element.empty(),u.tree_widget._refreshElements()},n=this.tree_widget._triggerEvent("tree.move",{move_info:{moved_node:r,target_node:o,position:h.getName(i),previous_parent:s,do_move:t,original_event:e.original_event}});if(!n.isDefaultPrevented())return t()}},t.prototype.getTreeDimensions=function(){var e;return e=this.tree_widget.element.offset(),{left:e.left,top:e.top,right:e.left+this.tree_widget.element.width(),bottom:e.top+this.tree_widget.element.height()+16}},t}(),g=function(){function t(e){this.tree=e}return t.prototype.iterate=function(){var t,n,r=this;return t=!0,n=function(i,s){var o,u,a,f,l,c,h,p,d;l=(i.is_open||!i.element)&&i.hasChildren();if(i.element){o=e(i.element);if(!o.is(":visible"))return;t&&(r.handleFirstNode(i,o),t=!1),i.hasChildren()?i.is_open?r.handleOpenFolder(i,o)||(l=!1):r.handleClosedFolder(i,s,o):r.handleNode(i,s,o)}if(l){a=i.children.length,p=i.children,d=[];for(f=c=0,h=p.length;c<h;f=++c)u=p[f],f===a-1?d.push(n(i.children[f],null)):d.push(n(i.children[f],i.children[f+1]));return d}},n(this.tree,null)},t.prototype.handleNode=function(e,t,n){},t.prototype.handleOpenFolder=function(e,t){},t.prototype.handleClosedFolder=function(e,t,n){},t.prototype.handleFirstNode=function(e,t){},t}(),o=function(t){function n(e,t,r){n.__super__.constructor.call(this,e),this.current_node=t,this.tree_bottom=r}return O(n,t),n.prototype.generate=function(){return this.positions=[],this.last_top=0,this.iterate(),this.generateHitAreas(this.positions)},n.prototype.getTop=function(e){return e.offset().top},n.prototype.addPosition=function(e,t,n){return this.positions.push({top:n,node:e,position:t}),this.last_top=n},n.prototype.handleNode=function(e,t,n){var r;return r=this.getTop(n),e===this.current_node?this.addPosition(e,h.NONE,r):this.addPosition(e,h.INSIDE,r),t===this.current_node||e===this.current_node?this.addPosition(e,h.NONE,r):this.addPosition(e,h.AFTER,r)},n.prototype.handleOpenFolder=function(e,t){return e===this.current_node?!1:(e.children[0]!==this.current_node&&this.addPosition(e,h.INSIDE,this.getTop(t)),!0)},n.prototype.handleClosedFolder=function(e,t,n){var r;r=this.getTop(n);if(e===this.current_node)return this.addPosition(e,h.NONE,r);this.addPosition(e,h.INSIDE,r);if(t!==this.current_node)return this.addPosition(e,h.AFTER,r)},n.prototype.handleFirstNode=function(t,n){if(t!==this.current_node)return this.addPosition(t,h.BEFORE,this.getTop(e(t.element)))},n.prototype.generateHitAreas=function(e){var t,n,r,i,s,o;i=-1,t=[],n=[];for(s=0,o=e.length;s<o;s++)r=e[s],r.top!==i&&t.length&&(t.length&&this.generateHitAreasForGroup(n,t,i,r.top),i=r.top,t=[]),t.push(r);return this.generateHitAreasForGroup(n,t,i,this.tree_bottom),n},n.prototype.generateHitAreasForGroup=function(e,t,n,r){var i,s,o,u,a;i=(r-n)/t.length,s=n;for(u=0,a=t.length;u<a;u++)o=t[u],e.push({top:s,bottom:s+i,node:o.node,position:o.position}),s+=i;return null},n}(g),r=function(){function t(t,n,r,i){this.offset_x=n,this.offset_y=r,this.$element=e('<span class="jqtree-title jqtree-dragging">'+t.name+"</span>"),this.$element.css("position","absolute"),i.append(this.$element)}return t.prototype.move=function(e,t){return this.$element.offset({left:e-this.offset_x,top:t-this.offset_y})},t.prototype.remove=function(){return this.$element.remove()},t}(),s=function(){function t(t,n,r){this.$element=n,this.node=t,this.$ghost=e('<li class="jqtree_common jqtree-ghost"><span class="jqtree_common jqtree-circle"></span><span class="jqtree_common jqtree-line"></span></li>'),r===h.AFTER?this.moveAfter():r===h.BEFORE?this.moveBefore():r===h.INSIDE&&(t.isFolder()&&t.is_open?this.moveInsideOpenFolder():this.moveInside())}return t.prototype.remove=function(){return this.$ghost.remove()},t.prototype.moveAfter=function(){return this.$element.after(this.$ghost)},t.prototype.moveBefore=function(){return this.$element.before(this.$ghost)},t.prototype.moveInsideOpenFolder=function(){return e(this.node.children[0].element).before(this.$ghost)},t.prototype.moveInside=function(){return this.$element.after(this.$ghost),this.$ghost.addClass("jqtree-inside")},t}(),t=function(){function t(t){var n,r;n=t.children(".jqtree-element"),r=t.width()-4,this.$hint=e('<span class="jqtree-border"></span>'),n.append(this.$hint),this.$hint.css({width:r,height:n.height()-4})}return t.prototype.remove=function(){return this.$hint.remove()},t}(),d=function(){function t(e){this.tree_widget=e,this.previous_top=-1,this._initScrollParent()}return t.prototype._initScrollParent=function(){var t,n,r,i=this;return n=function(){var t,n,r,s,o,u;t=["overflow","overflow-y"],r=function(n){var r,i,s,o;for(i=0,s=t.length;i<s;i++){r=t[i];if((o=e.css(n,r))==="auto"||o==="scroll")return!0}return!1};if(r(i.tree_widget.$el[0]))return i.tree_widget.$el;u=i.tree_widget.$el.parents();for(s=0,o=u.length;s<o;s++){n=u[s];if(r(n))return e(n)}return null},r=function(){return i.scroll_parent_top=0,i.$scroll_parent=null},this.tree_widget.$el.css("position")==="fixed"&&r(),t=n(),t&&t.length&&t[0].tagName!=="HTML"?(this.$scroll_parent=t,this.scroll_parent_top=this.$scroll_parent.offset().top):r()},t.prototype.checkScrolling=function(){var e;e=this.tree_widget.dnd_handler.hovered_area;if(e&&e.top!==this.previous_top)return this.previous_top=e.top,this.$scroll_parent?this._handleScrollingWithScrollParent(e):this._handleScrollingWithDocument(e)},t.prototype._handleScrollingWithScrollParent=function(e){var t;t=this.scroll_parent_top+this.$scroll_parent[0].offsetHeight-e.bottom;if(t<20)return this.$scroll_parent[0].scrollTop+=20,this.tree_widget.refreshHitAreas(),this.previous_top=-1;if(e.top-this.scroll_parent_top<20)return this.$scroll_parent[0].scrollTop-=20,this.tree_widget.refreshHitAreas(),this.previous_top=-1},t.prototype._handleScrollingWithDocument=function(t){var n;n=t.top-e(document).scrollTop();if(n<20)return e(document).scrollTop(e(document).scrollTop()-20);if(e(window).height()-(t.bottom-e(document).scrollTop())<20)return e(document).scrollTop(e(document).scrollTop()+20)},t.prototype.scrollTo=function(t){var n;return this.$scroll_parent?this.$scroll_parent[0].scrollTop=t:(n=this.tree_widget.$el.offset().top,e(document).scrollTop(t+n))},t.prototype.isScrolledIntoView=function(t){var n,r,i,s,o;return n=e(t),this.$scroll_parent?(o=0,s=this.$scroll_parent.height(),i=n.offset().top-this.scroll_parent_top,r=i+n.height()):(o=e(window).scrollTop(),s=o+e(window).height(),i=n.offset().top,r=i+n.height()),r<=s&&i>=o},t}(),a=function(){function s(t){this.tree_widget=t,t.options.keyboardSupport&&e(document).bind("keydown.jqtree",e.proxy(this.handleKeyDown,this))}var t,n,r,i;return n=37,i=38,r=39,t=40,s.prototype.deinit=function(){return e(document).unbind("keydown.jqtree")},s.prototype.handleKeyDown=function(s){var o,u,a,f,l,c,h,p=this;if(e(document.activeElement).is("textarea,input"))return!0;o=this.tree_widget.getSelectedNode(),h=function(t){return t?(p.tree_widget.selectNode(t),p.tree_widget.scroll_handler&&!p.tree_widget.scroll_handler.isScrolledIntoView(e(t.element).find(".jqtree-element"))&&p.tree_widget.scrollToNode(t),!1):!0},a=function(){return h(p.getNextNode(o))},c=function(){return h(p.getPreviousNode(o))},l=function(){return o.hasChildren()&&!o.is_open?(p.tree_widget.openNode(o),!1):!0},f=function(){return o.hasChildren()&&o.is_open?(p.tree_widget.closeNode(o),!1):!0};if(!o)return!0;u=s.which;switch(u){case t:return a();case i:return c();case r:return l();case n:return f()}},s.prototype.getNextNode=function(e,t){var n;return t==null&&(t=!0),t&&e.hasChildren()&&e.is_open?e.children[0]:e.parent?(n=e.getNextSibling(),n?n:this.getNextNode(e.parent,!1)):null},s.prototype.getPreviousNode=function(e){var t;return e.parent?(t=e.getPreviousSibling(),t?!t.hasChildren()||!t.is_open?t:this.getLastChild(t):e.parent.parent?e.parent:null):null},s.prototype.getLastChild=function(e){var t;return e.hasChildren()?(t=e.children[e.children.length-1],!t.hasChildren()||!t.is_open?t:this.getLastChild(t)):null},s}()}.call(this),define("jqtree",["jquery"],function(){}),define("mockup-patterns-tree",["jquery","underscore","mockup-patterns-base","mockup-utils","jqtree"],function(e,t,n,r){var i=n.extend({name:"tree",defaults:{dragAndDrop:!1,autoOpen:!1,selectable:!0,keyboardSupport:!0},init:function(){var t=this;for(var n in t.options){var i=t.defaults[n];i!==undefined&&typeof i=="boolean"&&(t.options[n]=r.bool(t.options[n]))}t.options.dragAndDrop&&t.options.onCanMoveTo===undefined&&(t.options.onCanMoveTo=function(e,t,n){return t.folder===undefined||t.folder===!0}),t.options.data&&typeof t.options.data=="string"&&(t.options.data=e.parseJSON(t.options.data)),t.tree=t.$el.tree(t.options)}});return i}),define("mockup-patterns-relateditems",["jquery","underscore","mockup-patterns-base","mockup-patterns-select2","mockup-utils","mockup-patterns-tree"],function(e,t,n,r,i,s){var o=n.extend({name:"relateditems",browsing:!1,currentPath:null,defaults:{vocabularyUrl:null,width:"300px",multiple:!0,tokenSeparators:[","," "],separator:",",orderable:!0,cache:!0,mode:"search",closeOnSelect:!1,basePath:"/",searchText:"Search:",searchAllText:"entire site",homeText:"home",folderTypes:["Folder"],selectableTypes:null,attributes:["UID","Title","Type","path"],dropdownCssClass:"pattern-relateditems-dropdown",maximumSelectionSize:-1,resultTemplate:'<div class="pattern-relateditems-result pattern-relateditems-type-<%= Type %> <% if (selected) { %>pattern-relateditems-active<% } %>">  <a href="#" class="pattern-relateditems-result-select <% if (selectable) { %>selectable<% } %>">    <span class="pattern-relateditems-result-title"><%= Title %></span>    <span class="pattern-relateditems-result-path"><%= path %></span>  </a>  <span class="pattern-relateditems-buttons">  <% if (folderish) { %>     <a class="pattern-relateditems-result-browse" href="#" data-path="<%= path %>"></a>   <% } %> </span></div>',resultTemplateSelector:null,selectionTemplate:'<span class="pattern-relateditems-item pattern-relateditems-type-<%= Type %>"> <span class="pattern-relateditems-item-title"><%= Title %></span> <span class="pattern-relateditems-item-path"><%= path %></span></span>',selectionTemplateSelector:null,breadCrumbsTemplate:'<span><span class="pattern-relateditems-tree"><a href="#" class="pattern-relateditems-tree-select"><span class="glyphicon glyphicon-indent-left"></span></a> <div class="tree-container"><span class="select-folder-label">Select folder</span><a href="#" class="btn close pattern-relateditems-tree-cancel">X</a><div class="pat-tree" /><a href="#" class="btn btn-default pattern-relateditems-tree-itemselect">Select</a></div></span><span class="pattern-relateditems-path-label"><%= searchText %></span><a class="crumb" href="/"><span class="glyphicon glyphicon-home"></span></a><%= items %></span></span>',breadCrumbsTemplateSelector:null,breadCrumbTemplate:'/<a href="<%= path %>" class="crumb"><%= text %></a>',breadCrumbTemplateSelector:null,escapeMarkup:function(e){return e},setupAjax:function(){var e=this;return e.query.valid?e.query.selectAjax():{}}},applyTemplate:function(n,r){var i=this,s;i.options[n+"TemplateSelector"]?(s=e(i.options[n+"TemplateSelector"]).html(),s||(s=i.options[n+"Template"])):s=i.options[n+"Template"];var o=e.extend(!0,{},i.options,r);return o._item=r,t.template(s,o)},activateBrowsing:function(){var e=this;e.browsing=!0,e.setBreadCrumbs()},deactivateBrowsing:function(){var e=this;e.browsing=!1,e.setBreadCrumbs()},browseTo:function(e){var t=this;t.trigger("before-browse"),t.currentPath=e,e==="/"&&t.options.mode==="search"?t.deactivateBrowsing():t.activateBrowsing(),t.$el.select2("close"),t.$el.select2("open"),t.trigger("after-browse")},setBreadCrumbs:function(){var n=this,r=n.currentPath?n.currentPath:n.options.basePath,i;if(r==="/"){var o="";n.options.mode==="search"&&(o="<em>"+n.options.searchAllText+"</em>"),i=n.applyTemplate("breadCrumbs",{items:o,searchText:n.options.searchText})}else{var u=r.split("/"),a="",f="";t.each(u,function(e){if(e!==""){var t={};a=a+"/"+e,t.text=e,t.path=a,f+=n.applyTemplate("breadCrumb",t)}}),i=n.applyTemplate("breadCrumbs",{items:f,searchText:n.options.searchText})}var l=e(i);e("a.crumb",l).on("click",function(t){return t.preventDefault(),n.browseTo(e(this).attr("href")),!1});var c=e(".pattern-relateditems-tree-select",l),h=c.parent(),p=e(".tree-container",h),d=e(".pat-tree",h),v=null,m=new s(d,{data:[],dataFilter:function(e){var n=[];return t.each(e.results,function(e){n.push({label:e.Title,id:e.UID,path:e.path})}),n}});m.$el.bind("tree.select",function(e){var t=e.node;t&&!t._loaded&&(n.currentPath=t.path,v=t,m.$el.tree("loadDataFromUrl",n.treeQuery.getUrl(),t),t._loaded=!0)}),m.$el.bind("tree.refresh",function(){v&&m.$el.tree("selectNode",v)}),e("a.pattern-relateditems-tree-cancel",p).click(function(e){return e.preventDefault(),p.fadeOut(),!1}),e("a.pattern-relateditems-tree-itemselect",p).click(function(e){return e.preventDefault(),n.browseTo(n.currentPath),p.fadeOut(),!1}),c.on("click",function(e){return e.preventDefault(),n.browsing=!0,n.currentPath="/",p.fadeIn(),m.$el.tree("loadDataFromUrl",n.treeQuery.getUrl()),!1}),n.$browsePath.html(l)},selectItem:function(e){var t=this;t.trigger("selecting");var n=t.$el.select2("data");n.push(e),t.$el.select2("data",n),e.selected=!0,t.trigger("selected")},deselectItem:function(e){var n=this;n.trigger("deselecting");var r=n.$el.select2("data");t.each(r,function(t,n){t.UID===e.UID&&r.splice(n,1)}),n.$el.select2("data",r),e.selected=!1,n.trigger("deselected")},isSelectable:function(e){var n=this;return n.options.selectableTypes===null?!0:t.indexOf(n.options.selectableTypes,e.Type)>-1},init:function(){var n=this;n.query=new i.QueryHelper(e.extend(!0,{},n.options,{pattern:n})),n.treeQuery=new i.QueryHelper(e.extend(!0,{},n.options,{pattern:n,baseCriteria:[{i:"Type",o:"plone.app.querystring.operation.list.contains",v:n.options.folderTypes}]})),n.options.ajax=n.options.setupAjax.apply(n),n.$el.wrap('<div class="pattern-relateditems-container" />'),n.$container=n.$el.parents(".pattern-relateditems-container"),n.$container.width(n.options.width),r.prototype.initializeValues.call(n),r.prototype.initializeTags.call(n),n.options.formatSelection=function(e,t){return n.applyTemplate("selection",e)},r.prototype.initializeOrdering.call(n),n.options.formatResult=function(r){!r.Type||t.indexOf(n.options.folderTypes,r.Type)===-1?r.folderish=!1:r.folderish=!0,r.selectable=n.isSelectable(r);if(r.selected===undefined){var i=n.$el.select2("data");r.selected=!1,t.each(i,function(e){e.UID===r.UID&&(r.selected=!0)})}var s=e(n.applyTemplate("result",r));return e(".pattern-relateditems-result-select",s).on("click",function(t){t.preventDefault();if(e(this).is(".selectable")){var i=e(this).parents(".pattern-relateditems-result");if(i.is(".pattern-relateditems-active"))i.removeClass("pattern-relateditems-active"),n.deselectItem(r);else{n.selectItem(r),i.addClass("pattern-relateditems-active");if(n.options.maximumSelectionSize>0){var s=n.$select2.select2("data");s.length>=n.options.maximumSelectionSize&&n.$select2.select2("close")}}}}),e(".pattern-relateditems-result-browse",s).on("click",function(t){t.preventDefault(),t.stopPropagation();var r=e(this).data("path");n.browseTo(r)}),e(s)},n.options.initSelection=function(t,r){var i=[],s=e(t).val();if(s!==""){var o=s.split(n.options.separator);n.query.search("UID","plone.app.querystring.operation.list.contains",o,function(e){r(e.results)},!1)}},n.options.id=function(e){return e.UID},r.prototype.initializeSelect2.call(n);var s={browseText:n.options.browseText,searchText:n.options.searchText};n.$browsePath=e('<span class="pattern-relateditems-path" />'),n.$container.prepend(n.$browsePath),n.options.mode==="search"?(n.deactivateBrowsing(),n.browsing=!1):(n.activateBrowsing(),n.browsing=!0),n.$el.on("select2-selecting",function(e){e.preventDefault()})}});return o}),define("mockup-patterns-querystring",["jquery","mockup-patterns-base","mockup-patterns-select2","mockup-patterns-pickadate","select2"],function(e,t,n,r,i){var s=function(){this.init.apply(this,arguments)};s.prototype={defaults:{indexWidth:"20em",placeholder:"Select criteria",remove:"",results:" items matching your search.",days:"days",betweendt:"to",classBetweenDtName:"querystring-criteria-betweendt",classWrapperName:"querystring-criteria-wrapper",classIndexName:"querystring-criteria-index",classOperatorName:"querystring-criteria-operator",classValueName:"querystring-criteria-value",classRemoveName:"querystring-criteria-remove",classResultsName:"querystring-criteria-results",classClearName:"querystring-criteria-clear"},init:function(t,n,r,s,o,u){var a=this;a.options=e.extend(!0,{},a.defaults,n),a.indexes=r,a.indexGroups={},a.$wrapper=e("<div/>").addClass(a.options.classWrapperName).appendTo(t),a.$remove=e("<div>"+a.options.remove+"</div>").addClass(a.options.classRemoveName).appendTo(a.$wrapper).on("click",function(e){a.remove()}),a.$index=e("<select><option></option></select>").attr("placeholder",a.options.placeholder),e.each(a.indexes,function(t,n){n.enabled&&(a.indexGroups[n.group]||(a.indexGroups[n.group]=e("<optgroup/>").attr("label",n.group).appendTo(a.$index)),a.indexGroups[n.group].append(e("<option/>").attr("value",t).html(n.title)))}),a.$wrapper.append(e("<div/>").addClass(a.options.classIndexName).append(a.$index)),a.$index.patternSelect2({width:a.options.indexWidth,placeholder:a.options.placeholder}).on("change",function(e){a.removeValue(),a.createOperator(e.val),a.createClear(),a.trigger("index-changed")}),s!==i&&(a.$index.select2("val",s),a.createOperator(s,o,u),a.createClear()),a.trigger("create-criteria")},createOperator:function(t,n,r){var s=this;s.removeOperator(),s.$operator=e("<select/>"),s.indexes[t]&&e.each(s.indexes[t].operators,function(t,n){e("<option/>").attr("value",t).html(n.title).appendTo(s.$operator)}),s.$wrapper.append(e("<div/>").addClass(s.options.classOperatorName).append(s.$operator)),s.$operator.patternSelect2({width:"10em"}).on("change",function(e){s.createValue(t),s.createClear(),s.trigger("operator-changed")}),n===i&&(n=s.$operator.select2("val")),s.$operator.select2("val",n),s.createValue(t,r),s.trigger("create-operator")},createValue:function(t,n){var r=this,s=r.indexes[t].operators[r.$operator.val()].widget,o=e("<div/>").addClass(r.options.classValueName).appendTo(r.$wrapper);r.removeValue();if(s==="StringWidget")r.$value=e('<input type="text"/>').addClass(r.options.classValueName+"-"+s).val(n).appendTo(o).change(function(){r.trigger("value-changed")});else if(s==="DateWidget")r.$value=e('<input type="text"/>').addClass(r.options.classValueName+"-"+s).appendTo(o).patternPickadate({time:!1,date:{format:"dd/mm/yyyy"}}).change(function(){r.trigger("value-changed")});else if(s==="DateRangeWidget"){var u=e("<span/>").appendTo(o),a=e('<input type="text"/>').addClass(r.options.classValueName+"-"+s).addClass(r.options.classValueName+"-"+s+"-start").appendTo(u).patternPickadate({time:!1,date:{format:"dd/mm/yyyy"}});o.append(e("<span/>").html(r.options.betweendt).addClass(r.options.classBetweenDtName));var f=e("<span/>").appendTo(o),l=e('<input type="text"/>').addClass(r.options.classValueName+"-"+s).addClass(r.options.classValueName+"-"+s+"-end").appendTo(f).patternPickadate({time:!1,date:{format:"dd/mm/yyyy"}});o.find(".picker__input").change(function(){r.trigger("value-changed")}),r.$value=[a,l]}else s==="RelativeDateWidget"?r.$value=e('<input type="text"/>').after(e("<span/>").html(r.options.days)).addClass(r.options.classValueName+"-"+s).appendTo(o).change(function(){r.trigger("value-changed")}):s==="ReferenceWidget"?r.$value=e('<input type="text"/>').addClass(r.options.classValueName+"-"+s).appendTo(o).change(function(){r.trigger("value-changed")}):s==="RelativePathWidget"?r.$value=e('<input type="text"/>').addClass(r.options.classValueName+"-"+s).appendTo(o).val(n).change(function(){r.trigger("value-changed")}):s==="MultipleSelectionWidget"&&(r.$value=e("<select/>").attr("multiple",!0).addClass(r.options.classValueName+"-"+s).appendTo(o).change(function(){r.trigger("value-changed")}),r.indexes[t]&&e.each(r.indexes[t].values,function(t,n){e("<option/>").attr("value",t).html(n.title).appendTo(r.$value)}),r.$value.patternSelect2({width:"250px"}));n!==i&&typeof r.$value!="undefined"&&r.$value.select2("val",n),r.trigger("create-value")},createClear:function(){var t=this;t.removeClear(),t.$clear=e("<div/>").addClass(t.options.classClearName).appendTo(t.$wrapper)},remove:function(){var e=this;e.trigger("remove"),e.$remove.remove(),e.$index.parent().remove(),e.removeOperator(),e.removeValue(),e.removeClear(),e.$wrapper.remove()},removeClear:function(){var e=this;e.trigger("remove-clear"),e.$clear&&e.$clear.remove()},removeOperator:function(){var e=this;e.trigger("remove-operator"),e.$operator&&e.$operator.parent().remove()},removeValue:function(){var t=this;t.trigger("remove-value"),t.$value&&(e.isArray(t.$value)?t.$value[0].parents(".querystring-criteria-value").remove():t.$value.parents(".querystring-criteria-value").remove())},buildQueryPart:function(){var t=this,n=t.$index.select2("val");if(n==="")return"";var r="query.i:records="+n;if(typeof t.$operator=="undefined")return"";var i=t.$operator.val(),s="query.o:records="+i,o="query.v:records=",u="query.v:records:list=",a=[];return typeof t.$value=="undefined"?a.push(o):e.isArray(t.$value)?e.each(t.$value,function(t,n){a.push(u+e(this).parent().find(".picker__input").val())}):a.push(o+t.$value.val()),r+"&"+s+"&"+a.join("&")},getJSONListStr:function(){var t=this,n=t.$index.select2("val");if(n==="")return"";if(typeof t.$operator=="undefined")return"";var r=t.$operator.val(),i=[];e.isArray(t.$value)?e.each(t.$value,function(t,n){i.push(e(this).parent().find(".picker__input").val())}):typeof t.$value!="undefined"&&i.push(t.$value.val());var s;return i.length>1?s='["'+i.join('","')+'"]':i.length===1?s=JSON.stringify(i[0]):s='""','{"i":"'+n+'", "o":"'+r+'", "v":'+s+"}"},trigger:function(e){this.$wrapper.trigger(e+"-criteria.querystring.patterns",[this])},on:function(e,t){this.$wrapper.on(e+"-criteria.querystring.patterns",t)}};var o=t.extend({name:"querystring",defaults:{indexes:[],classWrapperName:"querystring-wrapper",criteria:{},indexOptionsUrl:null,previewURL:"portal_factory/@@querybuilder_html_results",previewCountURL:"portal_factory/@@querybuildernumberofresults",sorttxt:"Sort On",reversetxt:"Reversed Order",previewTitle:"Preview",previewDescription:"Preview of at most 10 items",classSortLabelName:"querystring-sort-label",classSortReverseName:"querystring-sortreverse",classSortReverseLabelName:"querystring-sortreverse-label",classPreviewCountWrapperName:"querystring-previewcount-wrapper",classPreviewResultsWrapperName:"querystring-previewresults-wrapper",classPreviewWrapperName:"querystring-preview-wrapper",classPreviewName:"querystring-preview",classPreviewTitleName:"querystring-preview-title",classPreviewDescriptionName:"querystring-preview-description",classSortWrapperName:"querystring-sort-wrapper",showPreviews:!0},init:function(){var t=this;t.$el.hide(),t.$wrapper=e("<div/>"),t.$el.after(t.$wrapper),t.initialized=!1,t.options.indexOptionsUrl?e.ajax({url:t.options.indexOptionsUrl,success:function(e){t.options.indexes=e.indexes,t.options.sortable_indexes=e.sortable_indexes,t._init()},error:function(e){}}):t._init()},_init:function(){var t=this;t.$criteriaWrapper=e("<div/>").addClass(t.options.classWrapperName).appendTo(t.$wrapper),t.$sortWrapper=e("<div/>").addClass(t.options.classSortWrapperName).appendTo(t.$wrapper),t.options.showPreviews==="false"&&(t.options.showPreviews=!1),t.options.showPreviews&&(t.$previewWrapper=e("<div/>").addClass(t.options.classPreviewWrapperName).appendTo(t.$wrapper),e("<div/>").addClass(t.options.classPreviewTitleName).html(t.options.previewTitle).appendTo(t.$previewWrapper),e("<div/>").addClass(t.options.classPreviewDescriptionName).html(t.options.previewDescription).appendTo(t.$previewWrapper)),t.criterias=[],t.$el.val()&&e.each(JSON.parse(t.$el.val()),function(e,n){t.createCriteria(n.i,n.o,n.v)}),t.createCriteria(),t.createSort(),t.options.showPreviews&&t.refreshPreviewEvent(),t.$el.trigger("initialized"),t.initialized=!0},createCriteria:function(e,t,n){var r=this,i=new s(r.$criteriaWrapper,r.options.criteria,r.options.indexes,e,t,n);i.on("remove",function(e){r.criterias[r.criterias.length-1]===i&&r.createCriteria()}),i.on("index-changed",function(e){r.criterias[r.criterias.length-1]===i&&r.createCriteria()});var o=function(){r.refreshPreviewEvent(),r.updateValue()};i.on("remove",function(e,t){r.criterias.indexOf(t)!==-1&&r.criterias.splice(r.criterias.indexOf(t),1),o(e,t)}),i.on("remove-clear",o),i.on("remove-operator",o),i.on("remove-value",o),i.on("index-changed",o),i.on("operator-changed",o),i.on("create-criteria",o),i.on("create-operator",o),i.on("create-value",o),i.on("value-changed",o),r.criterias.push(i)},createSort:function(){var t=this,n=e('[id$="-sort_on"]').filter('[id^="formfield-"]'),r=e('[id$="-sort_reversed"]').filter('[id^="formfield-"]');e("<span/>").addClass(t.options.classSortLabelName).html(t.options.sorttxt).appendTo(t.$sortWrapper),t.$sortOn=e("<select/>").attr("name","sort_on").appendTo(t.$sortWrapper).change(function(){t.refreshPreviewEvent.call(t),e('[id$="sort_on"]',n).val(e(this).val())}),t.$sortOn.append(e('<option value="">No sorting</option>'));for(var i in t.options.sortable_indexes)t.$sortOn.append(e("<option/>").attr("value",i).html(t.options.indexes[i].title));t.$sortOn.patternSelect2({width:150}),t.$sortOrder=e("<input type='checkbox' />").attr("name","sort_reversed:boolean").change(function(){t.refreshPreviewEvent.call(t),e(this).attr("checked")==="checked"?e('.option input[type="checkbox"]',r).attr("checked","checked"):e('.option input[type="checkbox"]',r).removeAttr("checked")}),e("<span/>").addClass(t.options.classSortReverseName).appendTo(t.$sortWrapper).append(t.$sortOrder).append(e("<span/>").html(t.options.reversetxt).addClass(t.options.classSortReverseLabelName));if(n.length>=1&&r.length>=1){var s=e('.option input[type="checkbox"]',r).attr("checked")==="checked",o=e('[id$="-sort_on"]',n).val();s&&t.$sortOrder.attr("checked","checked"),t.$sortOn.select2("val",o),e(n).hide(),e(r).hide()}},refreshPreviewEvent:function(){var t=this;if(!t.options.showPreviews)return;typeof t._preview_xhr!="undefined"&&t._preview_xhr.abort(),typeof t.$previewPane!="undefined"&&t.$previewPane.remove();var n=[],r;e.each(t.criterias,function(e,t){r=t.buildQueryPart(),r!==""&&n.push(t.buildQueryPart())}),t.$previewPane=e("<div/>").addClass(t.options.classPreviewName).appendTo(t.$previewWrapper);if(n.length<=0){e("<div/>").addClass(t.options.classPreviewCountWrapperName).html("No results to preview").prependTo(t.$previewPane);return}n.push("sort_on="+t.$sortOn.val());var i=t.$sortOrder.attr("checked");i==="checked"&&n.push("sort_order=reverse"),t._preview_xhr=e.get(t.options.previewURL+"?"+n.join("&")).done(function(n,r){e("<div/>").addClass(t.options.classPreviewResultsWrapperName).html(n).appendTo(t.$previewPane)})},updateValue:function(){var t=this,n=[];e.each(t.criterias,function(e,t){var r=t.getJSONListStr();r!==""&&n.push(r)});var r=t.$el.val(),i="["+n.join(",")+"]";t.$el.val(i),t.$el.trigger("change")}});return o}),define("mockup-patterns-backdrop",["jquery","mockup-patterns-base"],function(e,t){var n=t.extend({name:"backdrop",defaults:{zIndex:null,opacity:.8,className:"backdrop",classActiveName:"backdrop-active",closeOnEsc:!0,closeOnClick:!0},init:function(){var t=this;t.$backdrop=e("> ."+t.options.className,t.$el),t.$backdrop.size()===0&&(t.$backdrop=e("<div/>").hide().appendTo(t.$el).addClass(t.options.className),t.options.zIndex!==null&&t.$backdrop.css("z-index",t.options.zIndex)),t.options.closeOnEsc===!0&&e(document).on("keydown",function(e,n){t.$el.is("."+t.options.classActiveName)&&e.keyCode===27&&t.hide()}),t.options.closeOnClick===!0&&t.$backdrop.on("click",function(){t.$el.is("."+t.options.classActiveName)&&t.hide()})},show:function(){var e=this;e.$el.hasClass(e.options.classActiveName)||(e.trigger("show"),e.$backdrop.css("opacity","0").show(),e.$el.addClass(e.options.classActiveName),e.$backdrop.animate({opacity:e.options.opacity},500),e.trigger("shown"))},hide:function(){var e=this;e.$el.hasClass(e.options.classActiveName)&&(e.trigger("hide"),e.$backdrop.animate({opacity:"0"},500).hide(),e.$el.removeClass(e.options.classActiveName),e.trigger("hidden"))}});return n}),function(){var e=this,t=e.Backbone,n=[],r=n.push,i=n.slice,s=n.splice,o;typeof exports!="undefined"?o=exports:o=e.Backbone={},o.VERSION="1.1.0";var u=e._;!u&&typeof require!="undefined"&&(u=require("underscore")),o.$=e.jQuery||e.Zepto||e.ender||e.$,o.noConflict=function(){return e.Backbone=t,this},o.emulateHTTP=!1,o.emulateJSON=!1;var a=o.Events={on:function(e,t,n){if(!l(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,s,o,a,f,c,h;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:u.keys(this._events);for(a=0,f=o.length;a<f;a++){e=o[a];if(s=this._events[e]){this._events[e]=r=[];if(t||n)for(c=0,h=s.length;c<h;c++)i=s[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&c(n,t),r&&c(r,arguments),this},stopListening:function(e,t,n){var r=this._listeningTo;if(!r)return this;var i=!t&&!n;!n&&typeof t=="object"&&(n=this),e&&((r={})[e._listenId]=e);for(var s in r)e=r[s],e.off(t,n,this),(i||u.isEmpty(e._events))&&delete this._listeningTo[s];return this}},f=/\s+/,l=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(f.test(n)){var s=n.split(f);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},c=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};u.each(h,function(e,t){a[t]=function(t,n,r){var i=this._listeningTo||(this._listeningTo={}),s=t._listenId||(t._listenId=u.uniqueId("l"));return i[s]=t,!r&&typeof n=="object"&&(r=this),t[e](n,r,this),this}}),a.bind=a.on,a.unbind=a.off,u.extend(o,a);var p=o.Model=function(e,t){var n=e||{};t||(t={}),this.cid=u.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=u.defaults({},n,u.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};u.extend(p.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return u.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s,o,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,a=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=u.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(c[r],t)||o.push(r),u.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!a){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!a)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e){if(u.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r){if(!t.set(t.parse(r,e),e))return!1;n&&n(t,r,e),t.trigger("sync",t,r,e)},F(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o=this.attributes;e==null||typeof e=="object"?(r=e,n=t):(r={})[e]=t,n=u.extend({validate:!0},n);if(r&&!n.wait){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=u.extend({},o,r)),n.parse===void 0&&(n.parse=!0);var a=this,f=n.success;return n.success=function(e){a.attributes=o;var t=a.parse(e,n);n.wait&&(t=u.extend(r||{},t));if(u.isObject(t)&&!a.set(t,n))return!1;f&&f(a,e,n),a.trigger("sync",a,e,n)},F(this,n),i=this.isNew()?"create":n.patch?"patch":"update",i==="patch"&&(n.attrs=r),s=this.sync(i,this,n),r&&n.wait&&(this.attributes=o),s},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)};if(this.isNew())return e.success(),!1;F(this,e);var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||j();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},u.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,u.extend(t,{validationError:n})),!1):!0}});var d=["keys","values","pairs","invert","pick","omit"];u.each(d,function(e){p.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.attributes),u[e].apply(u,t)}});var v=o.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))},m={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};u.extend(v.prototype,a,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return o.sync.apply(this,arguments)},add:function(e,t){return this.set(e,u.extend({merge:!1},t,g))},remove:function(e,t){var n=!u.isArray(e);e=n?[e]:u.clone(e),t||(t={});var r,i,s,o;for(r=0,i=e.length;r<i;r++){o=e[r]=this.get(e[r]);if(!o)continue;delete this._byId[o.id],delete this._byId[o.cid],s=this.indexOf(o),this.models.splice(s,1),this.length--,t.silent||(t.index=s,o.trigger("remove",o,this,t)),this._removeReference(o)}return n?e[0]:e},set:function(e,t){t=u.defaults({},t,m),t.parse&&(e=this.parse(e,t));var n=!u.isArray(e);e=n?e?[e]:[]:u.clone(e);var r,i,s,o,a,f,l,c=t.at,h=this.model,d=this.comparator&&c==null&&t.sort!==!1,v=u.isString(this.comparator)?this.comparator:null,g=[],y=[],b={},w=t.add,E=t.merge,S=t.remove,x=!d&&w&&S?[]:!1;for(r=0,i=e.length;r<i;r++){a=e[r],a instanceof p?s=o=a:s=a[h.prototype.idAttribute];if(f=this.get(s))S&&(b[f.cid]=!0),E&&(a=a===o?o.attributes:a,t.parse&&(a=f.parse(a,t)),f.set(a,t),d&&!l&&f.hasChanged(v)&&(l=!0)),e[r]=f;else if(w){o=e[r]=this._prepareModel(a,t);if(!o)continue;g.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,o.id!=null&&(this._byId[o.id]=o)}x&&x.push(f||o)}if(S){for(r=0,i=this.length;r<i;++r)b[(o=this.models[r]).cid]||y.push(o);y.length&&this.remove(y,t)}if(g.length||x&&x.length){d&&(l=!0),this.length+=g.length;if(c!=null)for(r=0,i=g.length;r<i;r++)this.models.splice(c+r,0,g[r]);else{x&&(this.models.length=0);var T=x||g;for(r=0,i=T.length;r<i;r++)this.models.push(T[r])}}l&&this.sort({silent:!0});if(!t.silent){for(r=0,i=g.length;r<i;r++)(o=g[r]).trigger("add",o,this,t);(l||x&&x.length)&&this.trigger("sort",this,t)}return n?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),e=this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,u.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,u.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return i.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e.id]||this._byId[e.cid]||this._byId[e]},at:function(e){return this.models[e]},where:function(e,t){return u.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return u.invoke(this.models,"get",e)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t(n,r,e),n.trigger("sync",n,r,e)},F(this,e),this.sync("read",this,e)},create:function(e,t){t=t?u.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(e,t,i){i.wait&&n.add(e,i),r&&r(e,t,i)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t=t?u.clone(t):{},t.collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(y,function(e){v.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}});var b=["groupBy","countBy","sortBy"];u.each(b,function(e){v.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var w=o.View=function(e){this.cid=u.uniqueId("view"),e||(e={}),u.extend(this,u.pick(e,S)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},E=/^(\S+)\s*(.*)$/,S=["model","collection","el","id","attributes","className","tagName","events"];u.extend(w.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o.$?e:o.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=u.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];u.isFunction(n)||(n=this[e[t]]);if(!n)continue;var r=t.match(E),i=r[1],s=r[2];n=u.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.on(i,n):this.$el.on(i,s,n)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(!this.el){var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className"));var t=o.$("<"+u.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}else this.setElement(u.result(this,"el"),!1)}}),o.sync=function(e,t,n){var r=T[e];u.defaults(n||(n={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=u.result(t,"url")||j()),n.data==null&&t&&(e==="create"||e==="update"||e==="patch")&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1),i.type==="PATCH"&&x&&(i.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=n.xhr=o.ajax(u.extend(i,n));return t.trigger("request",t,a,n),a};var x=typeof window!="undefined"&&!!window.ActiveXObject&&(!window.XMLHttpRequest||!(new XMLHttpRequest).dispatchEvent),T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.ajax=function(){return o.$.ajax.apply(o.$,arguments)};var N=o.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,L=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(N.prototype,a,{initialize:function(){},route:function(e,t,n){u.isRegExp(e)||(e=this._routeToRegExp(e)),u.isFunction(t)&&(n=t,t=""),n||(n=this[t]);var r=this;return o.history.route(e,function(i){var s=r._extractParameters(e,i);n&&n.apply(r,s),r.trigger.apply(r,["route:"+t].concat(s)),r.trigger("route",t,s),o.history.trigger("route",r,t,s)}),this},navigate:function(e,t){return o.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;this.routes=u.result(this,"routes");var e,t=u.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(C,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(L,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return u.map(n,function(e){return e?decodeURIComponent(e):null})}});var O=o.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,_=/^\/+|\/+$/g,D=/msie [\w.]+/,P=/\/$/,H=/[?#].*$/;O.started=!1,u.extend(O.prototype,a,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(P,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(M,"")},start:function(e){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=u.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=D.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(_,"/"),r&&this._wantsHashChange&&(this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search))}if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),O.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),u.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!O.started)return!1;if(!t||t===!0)t={trigger:!!t};var n=this.root+(e=this.getFragment(e||""));e=e.replace(H,"");if(this.fragment===e)return;this.fragment=e,e===""&&n!=="/"&&(n=n.slice(0,-1));if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),o.history=new O;var B=function(e,t){var n=this,r;e&&u.has(e,"constructor")?r=e.constructor:r=function(){return n.apply(this,arguments)},u.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.extend(r.prototype,e),r.__super__=n.prototype,r};p.extend=v.extend=N.extend=w.extend=O.extend=B;var j=function(){throw new Error('A "url" property or function must be specified')},F=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}}}.call(this),define("backbone",["underscore","jquery"],function(e){return function(){var t,n;return t||e.window.Backbone}}(this)),define("mockup-router",["jquery","underscore","backbone"],function(e,t,n){var r=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},i=n.Router.extend({actions:[],redirects:{},addRoute:function(e,n,i,s,o,u){t.findWhere(this.patterns,{patternName:e,id:n})===undefined&&this.actions.push({patternName:e,id:n,callback:i,context:s,pathExp:o,expReplace:u});var a=new RegExp("("+r(e)+":"+r(n)+")");this.route(a,"handleRoute")},addRedirect:function(e,t){this.redirects[e]=t},handleRoute:function(e){var n=e.split(":"),r=n[0],i=n[1],s=t.findWhere(this.actions,{patternName:r,id:i});s&&s.callback.call(s.context)},redirect:function(){var e=window.parent.location.pathname,n,r,i;t.some(this.actions,function(t){if(t.pathExp){r=new RegExp(t.pathExp);if(e.match(r)){i="!/"+t.patternName+":"+t.id;var s="";return t.expReplace&&(s=t.expReplace),n=e.replace(r,s),!0}}},this);if(i===undefined)for(var s in this.redirects){r=new RegExp(s);if(e.match(r)){i="!/"+this.redirects[s],n=e.replace(r,"");break}}i!==undefined&&this._change_location.apply(this,[n,i])},_change_location:function(e,t){window.parent.location.hash=t,window.parent.location.pathname=e},start:function(){n.history.start()},reset:function(){this.actions=[]}});return new i}),function(e){typeof define=="function"&&define.amd?define("jquery.form",["jquery"],e):e(typeof jQuery!="undefined"?jQuery:window.Zepto)}(function(e){function r(t){var n=t.data;t.isDefaultPrevented()||(t.preventDefault(),e(t.target).ajaxSubmit(n))}function i(t){var n=t.target,r=e(n);if(!r.is("[type=submit],[type=image]")){var i=r.closest("[type=submit]");if(i.length===0)return;n=i[0]}var s=this;s.clk=n;if(n.type=="image")if(t.offsetX!==undefined)s.clk_x=t.offsetX,s.clk_y=t.offsetY;else if(typeof e.fn.offset=="function"){var o=r.offset();s.clk_x=t.pageX-o.left,s.clk_y=t.pageY-o.top}else s.clk_x=t.pageX-n.offsetLeft,s.clk_y=t.pageY-n.offsetTop;setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)}function s(){if(!e.fn.ajaxSubmit.debug)return;var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}var t={};t.fileapi=e("<input type='file'/>").get(0).files!==undefined,t.formdata=window.FormData!==undefined;var n=!!e.fn.prop;e.fn.attr2=function(){if(!n)return this.attr.apply(this,arguments);var e=this.prop.apply(this,arguments);return e&&e.jquery||typeof e=="string"?e:this.attr.apply(this,arguments)},e.fn.ajaxSubmit=function(r){function k(t){var n=e.param(t,r.traditional).split("&"),i=n.length,s=[],o,u;for(o=0;o<i;o++)n[o]=n[o].replace(/\+/g," "),u=n[o].split("="),s.push([decodeURIComponent(u[0]),decodeURIComponent(u[1])]);return s}function L(t){var n=new FormData;for(var s=0;s<t.length;s++)n.append(t[s].name,t[s].value);if(r.extraData){var o=k(r.extraData);for(s=0;s<o.length;s++)o[s]&&n.append(o[s][0],o[s][1])}r.data=null;var u=e.extend(!0,{},e.ajaxSettings,r,{contentType:!1,processData:!1,cache:!1,type:i||"POST"});r.uploadProgress&&(u.xhr=function(){var t=e.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(e){var t=0,n=e.loaded||e.position,i=e.total;e.lengthComputable&&(t=Math.ceil(n/i*100)),r.uploadProgress(e,n,i,t)},!1),t}),u.data=null;var a=u.beforeSend;return u.beforeSend=function(e,t){r.formData?t.data=r.formData:t.data=n,a&&a.call(this,e,t)},e.ajax(u)}function A(t){function T(e){var t=null;try{e.contentWindow&&(t=e.contentWindow.document)}catch(n){s("cannot get iframe.contentWindow document: "+n)}if(t)return t;try{t=e.contentDocument?e.contentDocument:e.document}catch(n){s("cannot get iframe.contentDocument: "+n),t=e.document}return t}function k(){function r(){try{var e=T(v).readyState;s("state = "+e),e&&e.toLowerCase()=="uninitialized"&&setTimeout(r,50)}catch(t){s("Server abort: ",t," (",t.name,")"),_(x),w&&clearTimeout(w),w=undefined}}var t=a.attr2("target"),n=a.attr2("action");o.setAttribute("target",p),(!i||/post/i.test(i))&&o.setAttribute("method","POST"),n!=l.url&&o.setAttribute("action",l.url),!l.skipEncodingOverride&&(!i||/post/i.test(i))&&a.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),l.timeout&&(w=setTimeout(function(){b=!0,_(S)},l.timeout));var u=[];try{if(l.extraData)for(var f in l.extraData)l.extraData.hasOwnProperty(f)&&(e.isPlainObject(l.extraData[f])&&l.extraData[f].hasOwnProperty("name")&&l.extraData[f].hasOwnProperty("value")?u.push(e('<input type="hidden" name="'+l.extraData[f].name+'">').val(l.extraData[f].value).appendTo(o)[0]):u.push(e('<input type="hidden" name="'+f+'">').val(l.extraData[f]).appendTo(o)[0]));l.iframeTarget||d.appendTo("body"),v.attachEvent?v.attachEvent("onload",_):v.addEventListener("load",_,!1),setTimeout(r,15);try{o.submit()}catch(c){var h=document.createElement("form").submit;h.apply(o)}}finally{o.setAttribute("action",n),t?o.setAttribute("target",t):a.removeAttr("target"),e(u).remove()}}function _(t){if(m.aborted||M)return;A=T(v),A||(s("cannot access response document"),t=x);if(t===S&&m){m.abort("timeout"),E.reject(m,"timeout");return}if(t==x&&m){m.abort("server abort"),E.reject(m,"error","server abort");return}if(!A||A.location.href==l.iframeSrc)if(!b)return;v.detachEvent?v.detachEvent("onload",_):v.removeEventListener("load",_,!1);var n="success",r;try{if(b)throw"timeout";var i=l.dataType=="xml"||A.XMLDocument||e.isXMLDoc(A);s("isXml="+i);if(!i&&window.opera&&(A.body===null||!A.body.innerHTML)&&--O){s("requeing onLoad callback, DOM not available"),setTimeout(_,250);return}var o=A.body?A.body:A.documentElement;m.responseText=o?o.innerHTML:null,m.responseXML=A.XMLDocument?A.XMLDocument:A,i&&(l.dataType="xml"),m.getResponseHeader=function(e){var t={"content-type":l.dataType};return t[e.toLowerCase()]},o&&(m.status=Number(o.getAttribute("status"))||m.status,m.statusText=o.getAttribute("statusText")||m.statusText);var u=(l.dataType||"").toLowerCase(),a=/(json|script|text)/.test(u);if(a||l.textarea){var f=A.getElementsByTagName("textarea")[0];if(f)m.responseText=f.value,m.status=Number(f.getAttribute("status"))||m.status,m.statusText=f.getAttribute("statusText")||m.statusText;else if(a){var c=A.getElementsByTagName("pre")[0],p=A.getElementsByTagName("body")[0];c?m.responseText=c.textContent?c.textContent:c.innerText:p&&(m.responseText=p.textContent?p.textContent:p.innerText)}}else u=="xml"&&!m.responseXML&&m.responseText&&(m.responseXML=D(m.responseText));try{L=H(m,u,l)}catch(g){n="parsererror",m.error=r=g||n}}catch(g){s("error caught: ",g),n="error",m.error=r=g||n}m.aborted&&(s("upload aborted"),n=null),m.status&&(n=m.status>=200&&m.status<300||m.status===304?"success":"error"),n==="success"?(l.success&&l.success.call(l.context,L,"success",m),E.resolve(m.responseText,"success",m),h&&e.event.trigger("ajaxSuccess",[m,l])):n&&(r===undefined&&(r=m.statusText),l.error&&l.error.call(l.context,m,n,r),E.reject(m,"error",r),h&&e.event.trigger("ajaxError",[m,l,r])),h&&e.event.trigger("ajaxComplete",[m,l]),h&&!--e.active&&e.event.trigger("ajaxStop"),l.complete&&l.complete.call(l.context,m,n),M=!0,l.timeout&&clearTimeout(w),setTimeout(function(){l.iframeTarget?d.attr("src",l.iframeSrc):d.remove(),m.responseXML=null},100)}var o=a[0],u,f,l,h,p,d,v,m,g,y,b,w,E=e.Deferred();E.abort=function(e){m.abort(e)};if(t)for(f=0;f<c.length;f++)u=e(c[f]),n?u.prop("disabled",!1):u.removeAttr("disabled");l=e.extend(!0,{},e.ajaxSettings,r),l.context=l.context||l,p="jqFormIO"+(new Date).getTime(),l.iframeTarget?(d=e(l.iframeTarget),y=d.attr2("name"),y?p=y:d.attr2("name",p)):(d=e('<iframe name="'+p+'" src="'+l.iframeSrc+'" />'),d.css({position:"absolute",top:"-1000px",left:"-1000px"})),v=d[0],m={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(t){var n=t==="timeout"?"timeout":"aborted";s("aborting upload... "+n),this.aborted=1;try{v.contentWindow.document.execCommand&&v.contentWindow.document.execCommand("Stop")}catch(r){}d.attr("src",l.iframeSrc),m.error=n,l.error&&l.error.call(l.context,m,n,t),h&&e.event.trigger("ajaxError",[m,l,n]),l.complete&&l.complete.call(l.context,m,n)}},h=l.global,h&&0===e.active++&&e.event.trigger("ajaxStart"),h&&e.event.trigger("ajaxSend",[m,l]);if(l.beforeSend&&l.beforeSend.call(l.context,m,l)===!1)return l.global&&e.active--,E.reject(),E;if(m.aborted)return E.reject(),E;g=o.clk,g&&(y=g.name,y&&!g.disabled&&(l.extraData=l.extraData||{},l.extraData[y]=g.value,g.type=="image"&&(l.extraData[y+".x"]=o.clk_x,l.extraData[y+".y"]=o.clk_y)));var S=1,x=2,N=e("meta[name=csrf-token]").attr("content"),C=e("meta[name=csrf-param]").attr("content");C&&N&&(l.extraData=l.extraData||{},l.extraData[C]=N),l.forceSync?k():setTimeout(k,10);var L,A,O=50,M,D=e.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&t.documentElement.nodeName!="parsererror"?t:null},P=e.parseJSON||function(e){return window.eval("("+e+")")},H=function(t,n,r){var i=t.getResponseHeader("content-type")||"",s=n==="xml"||!n&&i.indexOf("xml")>=0,o=s?t.responseXML:t.responseText;return s&&o.documentElement.nodeName==="parsererror"&&e.error&&e.error("parsererror"),r&&r.dataFilter&&(o=r.dataFilter(o,n)),typeof o=="string"&&(n==="json"||!n&&i.indexOf("json")>=0?o=P(o):(n==="script"||!n&&i.indexOf("javascript")>=0)&&e.globalEval(o)),o};return E}if(!this.length)return s("ajaxSubmit: skipping submit process - no element selected"),this;var i,o,u,a=this;typeof r=="function"?r={success:r}:r===undefined&&(r={}),i=r.type||this.attr2("method"),o=r.url||this.attr2("action"),u=typeof o=="string"?e.trim(o):"",u=u||window.location.href||"",u&&(u=(u.match(/^([^#]+)/)||[])[1]),r=e.extend(!0,{url:u,success:e.ajaxSettings.success,type:i||e.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},r);var f={};this.trigger("form-pre-serialize",[this,r,f]);if(f.veto)return s("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(r.beforeSerialize&&r.beforeSerialize(this,r)===!1)return s("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var l=r.traditional;l===undefined&&(l=e.ajaxSettings.traditional);var c=[],h,p=this.formToArray(r.semantic,c);r.data&&(r.extraData=r.data,h=e.param(r.data,l));if(r.beforeSubmit&&r.beforeSubmit(p,this,r)===!1)return s("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[p,this,r,f]);if(f.veto)return s("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var d=e.param(p,l);h&&(d=d?d+"&"+h:h),r.type.toUpperCase()=="GET"?(r.url+=(r.url.indexOf("?")>=0?"&":"?")+d,r.data=null):r.data=d;var v=[];r.resetForm&&v.push(function(){a.resetForm()}),r.clearForm&&v.push(function(){a.clearForm(r.includeHidden)});if(!r.dataType&&r.target){var m=r.success||function(){};v.push(function(t){var n=r.replaceTarget?"replaceWith":"html";e(r.target)[n](t).each(m,arguments)})}else r.success&&v.push(r.success);r.success=function(e,t,n){var i=r.context||this;for(var s=0,o=v.length;s<o;s++)v[s].apply(i,[e,t,n||a,a])};if(r.error){var g=r.error;r.error=function(e,t,n){var i=r.context||this;g.apply(i,[e,t,n,a])}}if(r.complete){var y=r.complete;r.complete=function(e,t){var n=r.context||this;y.apply(n,[e,t,a])}}var b=e("input[type=file]:enabled",this).filter(function(){return e(this).val()!==""}),w=b.length>0,E="multipart/form-data",S=a.attr("enctype")==E||a.attr("encoding")==E,x=t.fileapi&&t.formdata;s("fileAPI :"+x);var T=(w||S)&&!x,N;r.iframe!==!1&&(r.iframe||T)?r.closeKeepAlive?e.get(r.closeKeepAlive,function(){N=A(p)}):N=A(p):(w||S)&&x?N=L(p):N=e.ajax(r),a.removeData("jqxhr").data("jqxhr",N);for(var C=0;C<c.length;C++)c[C]=null;return this.trigger("form-submit-notify",[this,r]),this},e.fn.ajaxForm=function(t){t=t||{},t.delegation=t.delegation&&e.isFunction(e.fn.on);if(!t.delegation&&this.length===0){var n={s:this.selector,c:this.context};return!e.isReady&&n.s?(s("DOM not ready, queuing ajaxForm"),e(function(){e(n.s,n.c).ajaxForm(t)}),this):(s("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return t.delegation?(e(document).off("submit.form-plugin",this.selector,r).off("click.form-plugin",this.selector,i).on("submit.form-plugin",this.selector,t,r).on("click.form-plugin",this.selector,t,i),this):this.ajaxFormUnbind().bind("submit.form-plugin",t,r).bind("click.form-plugin",t,i)},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(n,r){var i=[];if(this.length===0)return i;var s=this[0],o=n?s.getElementsByTagName("*"):s.elements;if(!o)return i;var u,a,f,l,c,h,p;for(u=0,h=o.length;u<h;u++){c=o[u],f=c.name;if(!f||c.disabled)continue;if(n&&s.clk&&c.type=="image"){s.clk==c&&(i.push({name:f,value:e(c).val(),type:c.type}),i.push({name:f+".x",value:s.clk_x},{name:f+".y",value:s.clk_y}));continue}l=e.fieldValue(c,!0);if(l&&l.constructor==Array){r&&r.push(c);for(a=0,p=l.length;a<p;a++)i.push({name:f,value:l[a]})}else if(t.fileapi&&c.type=="file"){r&&r.push(c);var d=c.files;if(d.length)for(a=0;a<d.length;a++)i.push({name:f,value:d[a],type:c.type});else i.push({name:f,value:"",type:c.type})}else l!==null&&typeof l!="undefined"&&(r&&r.push(c),i.push({name:f,value:l,type:c.type,required:c.required}))}if(!n&&s.clk){var v=e(s.clk),m=v[0];f=m.name,f&&!m.disabled&&m.type=="image"&&(i.push({name:f,value:v.val()}),i.push({name:f+".x",value:s.clk_x},{name:f+".y",value:s.clk_y}))}return i},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var n=[];return this.each(function(){var r=this.name;if(!r)return;var i=e.fieldValue(this,t);if(i&&i.constructor==Array)for(var s=0,o=i.length;s<o;s++)n.push({name:r,value:i[s]});else i!==null&&typeof i!="undefined"&&n.push({name:this.name,value:i})}),e.param(n)},e.fn.fieldValue=function(t){for(var n=[],r=0,i=this.length;r<i;r++){var s=this[r],o=e.fieldValue(s,t);if(o===null||typeof o=="undefined"||o.constructor==Array&&!o.length)continue;o.constructor==Array?e.merge(n,o):n.push(o)}return n},e.fieldValue=function(t,n){var r=t.name,i=t.type,s=t.tagName.toLowerCase();n===undefined&&(n=!0);if(n&&(!r||t.disabled||i=="reset"||i=="button"||(i=="checkbox"||i=="radio")&&!t.checked||(i=="submit"||i=="image")&&t.form&&t.form.clk!=t||s=="select"&&t.selectedIndex==-1))return null;if(s=="select"){var o=t.selectedIndex;if(o<0)return null;var u=[],a=t.options,f=i=="select-one",l=f?o+1:a.length;for(var c=f?o:0;c<l;c++){var h=a[c];if(h.selected){var p=h.value;p||(p=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value);if(f)return p;u.push(p)}}return u}return e(t).val()},e.fn.clearForm=function(t){return this.each(function(){e("input,select,textarea",this).clearFields(t)})},e.fn.clearFields=e.fn.clearInputs=function(t){var n=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var r=this.type,i=this.tagName.toLowerCase();n.test(r)||i=="textarea"?this.value="":r=="checkbox"||r=="radio"?this.checked=!1:i=="select"?this.selectedIndex=-1:r=="file"?/MSIE/.test(navigator.userAgent)?e(this).replaceWith(e(this).clone(!0)):e(this).val(""):t&&(t===!0&&/hidden/.test(r)||typeof t=="string"&&e(this).is(t))&&(this.value="")})},e.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return e===undefined&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return t===undefined&&(t=!0),this.each(function(){var n=this.type;if(n=="checkbox"||n=="radio")this.checked=t;else if(this.tagName.toLowerCase()=="option"){var r=e(this).parent("select");t&&r[0]&&r[0].type=="select-one"&&r.find("option").selected(!1),this.selected=t}})},e.fn.ajaxSubmit.debug=!1}),define("mockup-patterns-modal",["jquery","underscore","mockup-patterns-base","mockup-patterns-backdrop","mockup-registry","mockup-router","mockup-utils","jquery.form"],function(e,t,n,r,i,s,o){var u=n.extend({name:"modal",createModal:null,$model:null,defaults:{width:"",height:"",margin:20,position:"center middle",triggers:[],backdrop:"body",backdropOptions:{zIndex:"1040",opacity:"0.8",className:"backdrop",classActiveName:"backdrop-active",closeOnEsc:!0,closeOnClick:!0},title:null,titleSelector:"h1:first",buttons:'.formControls > input[type="submit"]',content:"#content",automaticallyAddButtonActions:!0,loadLinksWithinModal:!0,prependContent:".portalMessage",templateOptions:{className:"modal fade",classDialog:"modal-dialog",classModal:"modal-content",classHeaderName:"modal-header",classBodyName:"modal-body",classFooterName:"modal-footer",classWrapperName:"modal-wrapper",classWrapperInnerName:"modal-wrapper-inner",classActiveName:"in",classPrependName:"",classContentName:"",template:'<div class="<%= options.className %>">  <div class="<%= options.classDialog %>">    <div class="<%= options.classModal %>">      <div class="<%= options.classHeaderName %>">        <a class="close">&times;</a>        <% if (title) { %><h3><%= title %></h3><% } %>      </div>      <div class="<%= options.classBodyName %>">        <div class="<%= options.classPrependName %>"><%= prepend %></div>         <div class="<%= options.classContentName %>"><%= content %></div>      </div>      <div class="<%= options.classFooterName %>">         <%= buttons %>         <a class="close hiddenStructure">&times;</a>      </div>    </div>  </div></div>'},actions:{},actionOptions:{eventType:"click",target:null,ajaxUrl:null,modalFunction:null,isForm:!1,timeout:5e3,displayInModal:!0,reloadWindowOnClose:!0,error:".portalMessage.error",formFieldError:".field.error",onSuccess:null,onError:null,onFormError:null,onTimeout:null,redirectOnResponse:!1,redirectToUrl:function(t,n,r){var i=e(/<base.*?(\/>|<\/base>)/im.exec(n)[0]);return i.attr("href")}},routerOptions:{id:null,pathExp:null},form:function(n){var r=this,i=r.$modal;r.options.automaticallyAddButtonActions&&(n[r.options.buttons]={}),r.options.loadLinksWithinModal&&(n.a={}),e.each(n,function(n,s){var o=t.union(t.keys(r.options.actionOptions),["templateOptions"]),u=e.extend(!0,{},r.options.actionOptions,t.pick(s,o));s.templateOptions=e.extend(!0,s.templateOptions,r.options.templateOptions);var a=t.union(t.keys(r.options.actionOptions),["actions","actionOptions"]),f=e.extend(!0,t.omit(s,a),r.options);e(n,e("."+s.templateOptions.classBodyName,i)).each(function(t){var n=e(this);n.on(u.eventType,function(t){t.stopPropagation(),t.preventDefault(),r.loading.show(!1),u.modalFunction!==null?r[u.modalFunction]():e.nodeName(n[0],"input")||e.nodeName(n[0],"button")||s.isForm===!0?r.options.handleFormAction.apply(r,[n,u,f]):(s.ajaxUrl!==null||e.nodeName(n[0],"a"))&&r.options.handleLinkAction.apply(r,[n,u,f])})})})},handleFormAction:function(t,n,r){var i=this,s={};s[t.attr("name")]=t.attr("value");var o;e.nodeName(t[0],"form")?o=t:o=t.parents("form:not(.disableAutoSubmit)");var u;n.ajaxUrl!==null?typeof n.ajaxUrl=="function"?u=n.ajaxUrl.apply(i,[t,n]):u=n.ajaxUrl:u=t.parents("form").attr("action"),o.on("submit",function(e){e.preventDefault()}),o.trigger("submit"),i.loading.show(!1),o.ajaxSubmit({timeout:n.timeout,data:s,url:u,error:function(e,t,r){i.loading.hide(),t==="timeout"&&n.onTimeout?n.onTimeout.apply(i,e,r):n.onError?n.onError(e,t,r):console.log("error happened do something"),i.trigger("formActionError",[e,t,r])},success:function(s,o,u,a){i.loading.hide();if(e(n.error,s).size()!==0||e(n.formFieldError,s).size()!==0){n.onFormError?n.onFormError(i,s,o,u,a):i.redraw(s,r);return}if(n.redirectOnResponse===!0){typeof n.redirectToUrl=="function"?window.parent.location.href=n.redirectToUrl.apply(i,[t,s,n]):window.parent.location.href=n.redirectToUrl;return}n.onSuccess&&n.onSuccess(i,s,o,u,a),n.displayInModal===!0?i.redraw(s,r):(t.trigger("destroy.modal.patterns"),n.reloadWindowOnClose&&i.reloadWindow()),i.trigger("formActionSuccess",[s,o,u,a])}})},handleLinkAction:function(t,n,r){var i=this,s;n.ajaxUrl?typeof n.ajaxUrl=="function"?s=n.ajaxUrl.apply(i,[t,n]):s=n.ajaxUrl:s=t.attr("href");if(n.displayInModal===!1){window.parent.location.href=s;return}e.ajax({url:s,error:function(e,t,r){t==="timeout"&&n.onTimeout?n.onTimeout(i.$modal,e,r):n.onError?n.onError(e,t,r):console.log("error happened do something"),i.loading.hide(),i.trigger("linkActionError",[e,t,r])},success:function(e,t,s){i.redraw(e,r),n.onSuccess&&n.onSuccess(i,e,t,s),i.loading.hide(),i.trigger("linkActionSuccess",[e,t,s])}})},render:function(n){var r=this;r.trigger("before-render");if(!r.$raw)return;var i=r.$raw.clone();e("input:checked",i).each(function(){this.setAttribute&&this.setAttribute("checked","checked")});var s={title:"",prepend:"<div />",content:"",buttons:'<div class="pattern-modal-buttons"></div>',options:n.templateOptions};if(n.title===null){var o=e(n.titleSelector,i);s.title=o.html(),e(n.titleSelector,i).remove()}else s.title=n.title;n.prependContent&&(s.prepend=e("<div />").append(e(n.prependContent,i).clone()).html(),e(n.prependContent,i).remove()),n.content?s.content=e(n.content,i).html():s.content=i.html(),r.$modal=e(t.template(r.options.templateOptions.template,s)),r.$modalDialog=e("> ."+r.options.templateOptions.classDialog,r.$modal),e("form",r.$modal).on("keydown",function(t){if(t.keyCode!==13||t.target.nodeName=="TEXTAREA")return;t.preventDefault(),e("input[type=submit], button[type=submit], button:not(type)",this).eq(0).trigger("click")}),e(n.buttons,r.$modal).each(function(){var t=e(this);t.on("click",function(e){e.stopPropagation(),e.preventDefault()}).clone().appendTo(e(".pattern-modal-buttons",r.$modal)).off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),t.trigger("click")}),t.hide()}),r.trigger("before-events-setup"),e(".modal-header > a.close, .modal-footer > a.close",r.$modal).off("click").on("click",function(t){t.stopPropagation(),t.preventDefault(),e(t.target).trigger("destroy.modal.patterns")}),e(".row",r.$modal).removeClass("row"),n.form&&n.form.apply(r,[n.actions]),r.$modal.addClass(r.options.templateOptions.className).on("click",function(t){t.stopPropagation(),e.nodeName(t.target,"a")&&t.preventDefault(),r.$modal.trigger("modal-click")}).on("destroy.modal.patterns",function(e){e.stopPropagation(),r.hide()}).on("resize.modal.patterns",function(e){e.stopPropagation(),e.preventDefault(),r.positionModal()}).appendTo(r.$wrapperInner),r.$modal.data("pattern-"+r.name,r),r.trigger("after-render")}},reloadWindow:function(){window.parent.location.reload()},init:function(){var t=this;t.backdrop=new r(t.$el.parents(t.options.backdrop),t.options.backdropOptions),t.$wrapper=e("> ."+t.options.templateOptions.classWrapperName,t.backdrop.$el);if(t.$wrapper.size()===0){var n=t.options.backdropOptions.zIndex!==null?parseInt(t.options.backdropOptions.zIndex,10)+1:1041;t.$wrapper=e("<div/>").hide().css({"z-index":n,"overflow-y":"auto",position:"fixed",height:"100%",width:"100%",bottom:"0",left:"0",right:"0",top:"0"}).addClass(t.options.templateOptions.classWrapperName).insertBefore(t.backdrop.$backdrop).on("click",function(e){e.stopPropagation(),e.preventDefault(),t.options.backdropOptions.closeOnClick&&t.backdrop.hide()})}t.options.routerOptions.id!==null&&s.addRoute("modal",t.options.routerOptions.id,function(){this.show()},t,t.options.routerOptions.pathExp,t.options.routerOptions.expReplace),t.backdrop.on("hidden",function(e){t.$modal!==undefined&&t.$modal.hasClass(t.options.templateOptions.classActiveName)&&t.hide()}),t.options.backdropOptions.closeOnEsc===!0&&e(document).on("keydown",function(e,n){t.$el.is("."+t.options.templateOptions.classActiveName)&&e.keyCode===27&&t.hide()}),t.$wrapperInner=e("> ."+t.options.templateOptions.classWrapperInnerName,t.$wrapper),t.$wrapperInner.size()===0&&(t.$wrapperInner=e("<div/>").addClass(t.options.classWrapperInnerName).css({position:"absolute",bottom:"0",left:"0",right:"0",top:"0"}).appendTo(t.$wrapper)),t.loading=new o.ProgressIndicator({container:t.$wrapperInner,backdrop:t.backdrop,wrapper:t.$wrapper,zIndex:function(){if(!t.modalInitialized())return 10005;var e=t.$modal.css("zIndex");if(e)return parseInt(e,10)+1}}),e(window.parent).resize(function(){t.positionModal()}),t.options.triggers&&e.each(t.options.triggers,function(n,r){var i=r.substring(0,r.indexOf(" ")),s=r.substring(r.indexOf(" "),r.length);e(s||t.$el).on(i,function(e){e.stopPropagation(),e.preventDefault(),t.show()})}),t.$el.is("a")&&(t.$el.attr("href")&&(!t.options.target&&t.$el.attr("href").substr(0,1)==="#"&&(t.options.target=t.$el.attr("href"),t.options.content=""),!t.options.ajaxUrl&&t.$el.attr("href").substr(0,1)!=="#"&&(t.options.ajaxUrl=t.$el.attr("href"))),t.$el.on("click",function(e){e.stopPropagation(),e.preventDefault(),t.show()})),t.initModal()},createAjaxModal:function(){var t=this;t.trigger("before-ajax"),t.loading.show(),t.ajaxXHR=e.ajax({url:t.options.ajaxUrl,type:t.options.ajaxType}).done(function(n,r,i){t.ajaxXHR=undefined,t.loading.hide(),t.$raw=e("<div />").append(e(o.parseBodyTag(n))),t.trigger("after-ajax",t,r,i),t._show()})},createTargetModal:function(){var t=this;t.$raw=e(t.options.target).clone(),t._show()},createBasicModal:function(){var t=this;t.$raw=e("<div/>").html(t.$el.clone()),t._show()},createHtmlModal:function(){var t=this,n=e(t.options.html);t.$raw=n,t._show()},initModal:function(){var e=this;e.options.ajaxUrl?e.createModal=e.createAjaxModal:e.options.target?e.createModal=e.createTargetModal:e.options.html?e.createModal=e.createHtmlModal:e.createModal=e.createBasicModal},findPosition:function(e,t,n,r,i,s,o){var u={},a,f,l,c;return c=l=a=l="auto",e==="left"?(l=n+"px",r>s&&(l="0px"),u.left=l):e==="right"?(c=n+"px",r>s&&(c="0px"),u.right=c,u.left="auto"):(l=s/2-r/2-n+"px",r>s&&(l="0px"),u.left=l),t==="top"?(a=n+"px",i>o&&(a="0px"),u.top=a):t==="bottom"?(f=n+"px",i>o&&(f="0px"),u.bottom=f,u.top="auto"):(a=o/2-i/2-n+"px",i>o&&(a="0px"),u.top=a),u},modalInitialized:function(){var e=this;return e.$modal!==null&&e.$modal!==undefined},positionModal:function(){var t=this;if(!t.modalInitialized())return;t.$modal.removeAttr("style"),t.$wrapper.parent().is("body")&&t.$wrapper.height(e(window.parent).height());var n=typeof t.options.margin=="function"?t.options.margin():t.options.margin;t.$modal.css({position:"absolute",padding:n}),t.$modalDialog.css({margin:"0",padding:"0",width:t.options.width,height:t.options.height});var r=t.options.position.split(" "),i=r[0],s=r[1],o=t.$modalDialog.outerWidth(!0),u=t.$modalDialog.outerHeight(!0),a=t.$wrapperInner.width(),f=t.$wrapperInner.height(),l=t.findPosition(i,s,n,o,u,a,f);for(var c in l)t.$modalDialog.css(c,l[c])},render:function(e){var t=this;t.trigger("render"),t.options.render.apply(t,[e]),t.trigger("rendered")},show:function(){var e=this;e.createModal()},_show:function(){var t=this;t.render.apply(t,[t.options]),t.trigger("show"),t.backdrop.show(),t.$wrapper.show(),t.loading.hide(),t.$wrapper.parent().css("overflow","hidden"),t.$el.addClass(t.options.templateOptions.classActiveName),t.$modal.addClass(t.options.templateOptions.classActiveName),i.scan(t.$modal),t.positionModal(),e("img",t.$modal).load(function(){t.positionModal()}),e(window.parent).on("resize.modal.patterns",function(){t.positionModal()}),t.trigger("shown")},hide:function(){var t=this;t.ajaxXHR&&t.ajaxXHR.abort(),t.trigger("hide");if(t._suppressHide&&!confirm(t._suppressHide))return;e(".modal",t.$wrapper).size()<2&&(t.backdrop.hide(),t.$wrapper.hide(),t.$wrapper.parent().css("overflow","visible")),t.loading.hide(),t.$el.removeClass(t.options.templateOptions.classActiveName),t.$modal!==undefined&&(t.$modal.remove(),t.initModal()),e(window.parent).off("resize.modal.patterns"),t.trigger("hidden")},redraw:function(t,n){var r=this;r.trigger("beforeDraw"),r.$modal.remove(),r.$raw=e("<div />").append(e(o.parseBodyTag(t))),r.render.apply(r,[n||r.options]),r.$modal.addClass(r.options.templateOptions.classActiveName),r.positionModal(),i.scan(r.$modal),r.trigger("afterDraw")}});return u}),!function(e,t){function n(e,t){for(var n,r=[],i=0;i<e.length;++i){if(n=u[e[i]]||s(e[i]),!n)throw"module definition dependecy not found: "+e[i];r.push(n)}t.apply(null,r)}function r(e,r,i){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(r===t)throw"invalid module definition, dependencies must be specified";if(i===t)throw"invalid module definition, definition function must be specified";n(r,function(){u[e]=i.apply(null,arguments)})}function i(e){return!!u[e]}function s(t){for(var n=e,r=t.split(/[.\/]/),i=0;i<r.length;++i){if(!n[r[i]])return;n=n[r[i]]}return n}function o(n){for(var r=0;r<n.length;r++){for(var i=e,s=n[r],o=s.split(/[.\/]/),a=0;a<o.length-1;++a)i[o[a]]===t&&(i[o[a]]={}),i=i[o[a]];i[o[o.length-1]]=u[s]}}var u={},a="tinymce/dom/EventUtils",f="tinymce/dom/Sizzle",l="tinymce/dom/DomQuery",c="tinymce/html/Styles",h="tinymce/dom/TreeWalker",p="tinymce/util/Tools",d="tinymce/dom/Range",v="tinymce/html/Entities",m="tinymce/Env",g="tinymce/dom/DOMUtils",y="tinymce/dom/ScriptLoader",b="tinymce/AddOnManager",w="tinymce/html/Node",E="tinymce/html/Schema",S="tinymce/html/SaxParser",x="tinymce/html/DomParser",T="tinymce/html/Writer",N="tinymce/html/Serializer",C="tinymce/dom/Serializer",k="tinymce/dom/TridentSelection",L="tinymce/util/VK",A="tinymce/dom/ControlSelection",O="tinymce/dom/Selection",M="tinymce/dom/RangeUtils",_="tinymce/Formatter",D="tinymce/UndoManager",P="tinymce/EnterKey",H="tinymce/ForceBlocks",B="tinymce/EditorCommands",j="tinymce/util/URI",F="tinymce/util/Class",I="tinymce/ui/Selector",q="tinymce/ui/Collection",R="tinymce/ui/DomUtils",U="tinymce/ui/Control",z="tinymce/ui/Factory",W="tinymce/ui/Container",X="tinymce/ui/DragHelper",V="tinymce/ui/Scrollable",$="tinymce/ui/Panel",J="tinymce/ui/Movable",K="tinymce/ui/Resizable",Q="tinymce/ui/FloatPanel",G="tinymce/ui/KeyboardNavigation",Y="tinymce/ui/Window",Z="tinymce/ui/MessageBox",et="tinymce/WindowManager",tt="tinymce/util/Quirks",nt="tinymce/util/Observable",rt="tinymce/Shortcuts",it="tinymce/Editor",st="tinymce/util/I18n",ot="tinymce/FocusManager",ut="tinymce/EditorManager",at="tinymce/LegacyInput",ft="tinymce/util/XHR",lt="tinymce/util/JSON",ct="tinymce/util/JSONRequest",ht="tinymce/util/JSONP",pt="tinymce/util/LocalStorage",dt="tinymce/Compat",vt="tinymce/ui/Layout",mt="tinymce/ui/AbsoluteLayout",gt="tinymce/ui/Tooltip",yt="tinymce/ui/Widget",bt="tinymce/ui/Button",wt="tinymce/ui/ButtonGroup",Et="tinymce/ui/Checkbox",St="tinymce/ui/PanelButton",xt="tinymce/ui/ColorButton",Tt="tinymce/ui/ComboBox",Nt="tinymce/ui/Path",Ct="tinymce/ui/ElementPath",kt="tinymce/ui/FormItem",Lt="tinymce/ui/Form",At="tinymce/ui/FieldSet",Ot="tinymce/ui/FilePicker",Mt="tinymce/ui/FitLayout",_t="tinymce/ui/FlexLayout",Dt="tinymce/ui/FlowLayout",Pt="tinymce/ui/FormatControls",Ht="tinymce/ui/GridLayout",Bt="tinymce/ui/Iframe",jt="tinymce/ui/Label",Ft="tinymce/ui/Toolbar",It="tinymce/ui/MenuBar",qt="tinymce/ui/MenuButton",Rt="tinymce/ui/ListBox",Ut="tinymce/ui/MenuItem",zt="tinymce/ui/Menu",Wt="tinymce/ui/Radio",Xt="tinymce/ui/ResizeHandle",Vt="tinymce/ui/Spacer",$t="tinymce/ui/SplitButton",Jt="tinymce/ui/StackLayout",Kt="tinymce/ui/TabPanel",Qt="tinymce/ui/TextBox",Gt="tinymce/ui/Throbber";r(a,[],function(){function e(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent&&e.attachEvent("on"+t,n)}function t(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r||!1):e.detachEvent&&e.detachEvent("on"+t,n)}function n(e,t){function n(){return!1}function r(){return!0}var i,s=t||{},u;for(i in e)"layerX"!==i&&"layerY"!==i&&(s[i]=e[i]);if(s.target||(s.target=s.srcElement||document),e&&o.test(e.type)&&e.pageX===u&&e.clientX!==u){var a=s.target.ownerDocument||document,f=a.documentElement,l=a.body;s.pageX=e.clientX+(f&&f.scrollLeft||l&&l.scrollLeft||0)-(f&&f.clientLeft||l&&l.clientLeft||0),s.pageY=e.clientY+(f&&f.scrollTop||l&&l.scrollTop||0)-(f&&f.clientTop||l&&l.clientTop||0)}return s.preventDefault=function(){s.isDefaultPrevented=r,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},s.stopPropagation=function(){s.isPropagationStopped=r,e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},s.stopImmediatePropagation=function(){s.isImmediatePropagationStopped=r,s.stopPropagation()},s.isDefaultPrevented||(s.isDefaultPrevented=n,s.isPropagationStopped=n,s.isImmediatePropagationStopped=n),s}function r(n,r,i){function s(){i.domLoaded||(i.domLoaded=!0,r(f))}function o(){"complete"===a.readyState&&(t(a,"readystatechange",o),s())}function u(){try{a.documentElement.doScroll("left")}catch(e){return setTimeout(u,0),void 0}s()}var a=n.document,f={type:"ready"};return i.domLoaded?(r(f),void 0):(a.addEventListener?e(n,"DOMContentLoaded",s):(e(a,"readystatechange",o),a.documentElement.doScroll&&n===n.top&&u()),e(n,"load",s),void 0)}function i(){function i(e,t){var n,r,i,s;if(n=u[t][e.type])for(r=0,i=n.length;i>r;r++)if(s=n[r],s&&s.func.call(s.scope,e)===!1&&e.preventDefault(),e.isImmediatePropagationStopped())return}var o=this,u={},a,f,l,c,h;f=s+(+(new Date)).toString(32),c="onmouseenter"in document.documentElement,l="onfocusin"in document.documentElement,h={mouseenter:"mouseover",mouseleave:"mouseout"},a=1,o.domLoaded=!1,o.events=u,o.bind=function(t,s,p,d){function v(e){i(n(e||x.event),m)}var m,g,y,b,w,E,S,x=window;if(t&&3!==t.nodeType&&8!==t.nodeType){for(t[f]?m=t[f]:(m=a++,t[f]=m,u[m]={}),d=d||t,s=s.split(" "),y=s.length;y--;)b=s[y],E=v,w=S=!1,"DOMContentLoaded"===b&&(b="ready"),o.domLoaded&&"ready"===b&&"complete"==t.readyState?p.call(d,n({type:b})):(c||(w=h[b],w&&(E=function(e){var t,r;if(t=e.currentTarget,r=e.relatedTarget,r&&t.contains)r=t.contains(r);else for(;r&&r!==t;)r=r.parentNode;r||(e=n(e||x.event),e.type="mouseout"===e.type?"mouseleave":"mouseenter",e.target=t,i(e,m))})),l||"focusin"!==b&&"focusout"!==b||(S=!0,w="focusin"===b?"focus":"blur",E=function(e){e=n(e||x.event),e.type="focus"===e.type?"focusin":"focusout",i(e,m)}),g=u[m][b],g?"ready"===b&&o.domLoaded?p({type:b}):g.push({func:p,scope:d}):(u[m][b]=g=[{func:p,scope:d}],g.fakeName=w,g.capture=S,g.nativeHandler=E,"ready"===b?r(t,E,o):e(t,w||b,E,S)));return t=g=0,p}},o.unbind=function(e,n,r){var i,s,a,l,c,h;if(!e||3===e.nodeType||8===e.nodeType)return o;if(i=e[f]){if(h=u[i],n){for(n=n.split(" "),a=n.length;a--;)if(c=n[a],s=h[c]){if(r)for(l=s.length;l--;)s[l].func===r&&s.splice(l,1);r&&0!==s.length||(delete h[c],t(e,s.fakeName||c,s.nativeHandler,s.capture))}}else{for(c in h)s=h[c],t(e,s.fakeName||c,s.nativeHandler,s.capture);h={}}for(c in h)return o;delete u[i];try{delete e[f]}catch(p){e[f]=null}}return o},o.fire=function(e,t,r){var s;if(!e||3===e.nodeType||8===e.nodeType)return o;r=n(null,r),r.type=t,r.target=e;do s=e[f],s&&i(r,s),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow;while(e&&!r.isPropagationStopped());return o},o.clean=function(e){var t,n,r=o.unbind;if(!e||3===e.nodeType||8===e.nodeType)return o;if(e[f]&&r(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName)for(r(e),n=e.getElementsByTagName("*"),t=n.length;t--;)e=n[t],e[f]&&r(e);return o},o.destroy=function(){u={}},o.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1}}var s="mce-data-",o=/^(?:mouse|contextmenu)|click/;return i.Event=new i,i.Event.bind(window,"ready",function(){}),i}),r(f,[],function(){function e(e){return mt.test(e+"")}function n(){var e,t=[];return e=function(n,r){return t.push(n+=" ")>T.cacheLength&&delete e[t.shift()],e[n]=r,r}}function i(e){return e[I]=!0,e}function s(e){var t=_.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t=null}}function o(e,t,n,r){var i,s,o,u,a,f,l,p,d,v;if((t?t.ownerDocument||t:q)!==_&&M(t),t=t||_,n=n||[],!e||"string"!=typeof e)return n;if(1!==(u=t.nodeType)&&9!==u)return[];if(P&&!r){if(i=gt.exec(e))if(o=i[1]){if(9===u){if(s=t.getElementById(o),!s||!s.parentNode)return n;if(s.id===o)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&F(t,s)&&s.id===o)return n.push(s),n}else{if(i[2])return et.apply(n,t.getElementsByTagName(e)),n;if((o=i[3])&&R.getElementsByClassName&&t.getElementsByClassName)return et.apply(n,t.getElementsByClassName(o)),n}if(R.qsa&&!H.test(e)){if(l=!0,p=I,d=t,v=9===u&&e,1===u&&"object"!==t.nodeName.toLowerCase()){for(f=c(e),(l=t.getAttribute("id"))?p=l.replace(wt,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",a=f.length;a--;)f[a]=p+h(f[a]);d=vt.test(e)&&t.parentNode||t,v=f.join(",")}if(v)try{return et.apply(n,d.querySelectorAll(v)),n}catch(m){}finally{l||t.removeAttribute("id")}}}return w(e.replace(ft,"$1"),t,n,r)}function u(e,t){var n=t&&e,r=n&&(~t.sourceIndex||Q)-(~e.sourceIndex||Q);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function a(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function f(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function l(e){return i(function(t){return t=+t,i(function(n,r){for(var i,s=e([],n.length,t),o=s.length;o--;)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function c(e,t){var n,r,i,s,u,a,f,l=X[e+" "];if(l)return t?0:l.slice(0);for(u=e,a=[],f=T.preFilter;u;){(!n||(r=lt.exec(u)))&&(r&&(u=u.slice(r[0].length)||u),a.push(i=[])),n=!1,(r=ct.exec(u))&&(n=r.shift(),i.push({value:n,type:r[0].replace(ft," ")}),u=u.slice(n.length));for(s in T.filter)!(r=dt[s].exec(u))||f[s]&&!(r=f[s](r))||(n=r.shift(),i.push({value:n,type:s,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?o.error(e):X(e,a).slice(0)}function h(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}function p(e,t,n){var r=t.dir,i=n&&"parentNode"===r,s=z++;return t.first?function(t,n,s){for(;t=t[r];)if(1===t.nodeType||i)return e(t,n,s)}:function(t,n,o){var u,a,f,l=U+" "+s;if(o){for(;t=t[r];)if((1===t.nodeType||i)&&e(t,n,o))return!0}else for(;t=t[r];)if(1===t.nodeType||i)if(f=t[I]||(t[I]={}),(a=f[r])&&a[0]===l){if((u=a[1])===!0||u===x)return u===!0}else if(a=f[r]=[l],a[1]=e(t,n,o)||x,a[1]===!0)return!0}}function d(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function v(e,t,n,r,i){for(var s,o=[],u=0,a=e.length,f=null!=t;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function m(e,t,n,r,s,o){return r&&!r[I]&&(r=m(r)),s&&!s[I]&&(s=m(s,o)),i(function(i,o,u,a){var f,l,c,h=[],p=[],d=o.length,m=i||b(t||"*",u.nodeType?[u]:u,[]),g=!e||!i&&t?m:v(m,h,e,u,a),y=n?s||(i?e:d||r)?[]:o:g;if(n&&n(g,y,u,a),r)for(f=v(y,p),r(f,[],u,a),l=f.length;l--;)(c=f[l])&&(y[p[l]]=!(g[p[l]]=c));if(i){if(s||e){if(s){for(f=[],l=y.length;l--;)(c=y[l])&&f.push(g[l]=c);s(null,y=[],f,a)}for(l=y.length;l--;)(c=y[l])&&(f=s?nt.call(i,c):h[l])>-1&&(i[f]=!(o[f]=c))}}else y=v(y===o?y.splice(d,y.length):y),s?s(null,o,y,a):et.apply(o,y)})}function g(e){for(var t,n,r,i=e.length,s=T.relative[e[0].type],o=s||T.relative[" "],u=s?1:0,a=p(function(e){return e===t},o,!0),f=p(function(e){return nt.call(t,e)>-1},o,!0),l=[function(e,n,r){return!s&&(r||n!==L)||((t=n).nodeType?a(e,n,r):f(e,n,r))}];i>u;u++)if(n=T.relative[e[u].type])l=[p(d(l),n)];else{if(n=T.filter[e[u].type].apply(null,e[u].matches),n[I]){for(r=++u;i>r&&!T.relative[e[r].type];r++);return m(u>1&&d(l),u>1&&h(e.slice(0,u-1)).replace(ft,"$1"),n,r>u&&g(e.slice(u,r)),i>r&&g(e=e.slice(r)),i>r&&h(e))}l.push(n)}return d(l)}function y(e,t){var n=0,r=t.length>0,s=e.length>0,u=function(i,u,a,f,l){var c,h,p,d=[],m=0,g="0",y=i&&[],b=null!=l,w=L,E=i||s&&T.find.TAG("*",l&&u.parentNode||u),S=U+=null==w?1:Math.random()||.1;for(b&&(L=u!==_&&u,x=n);null!=(c=E[g]);g++){if(s&&c){for(h=0;p=e[h++];)if(p(c,u,a)){f.push(c);break}b&&(U=S,x=++n)}r&&((c=!p&&c)&&m--,i&&y.push(c))}if(m+=g,r&&g!==m){for(h=0;p=t[h++];)p(y,d,u,a);if(i){if(m>0)for(;g--;)y[g]||d[g]||(d[g]=Y.call(f));d=v(d)}et.apply(f,d),b&&!i&&d.length>0&&m+t.length>1&&o.uniqueSort(f)}return b&&(U=S,L=w),y};return r?i(u):u}function b(e,t,n){for(var r=0,i=t.length;i>r;r++)o(e,t[r],n);return n}function w(e,t,n,r){var i,s,o,u,a,f=c(e);if(!r&&1===f.length){if(s=f[0]=f[0].slice(0),s.length>2&&"ID"===(o=s[0]).type&&9===t.nodeType&&P&&T.relative[s[1].type]){if(t=(T.find.ID(o.matches[0].replace(St,xt),t)||[])[0],!t)return n;e=e.slice(s.shift().value.length)}for(i=dt.needsContext.test(e)?0:s.length;i--&&(o=s[i],!T.relative[u=o.type]);)if((a=T.find[u])&&(r=a(o.matches[0].replace(St,xt),vt.test(s[0].type)&&t.parentNode||t))){if(s.splice(i,1),e=r.length&&h(s),!e)return et.apply(n,r),n;break}}return k(e,f)(r,t,!P,n,vt.test(e)),n}function E(){}var S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I="sizzle"+ -(new Date),q=window.document,R={},U=0,z=0,W=n(),X=n(),V=n(),$=!1,J=function(){return 0},K=typeof t,Q=1<<31,G=[],Y=G.pop,Z=G.push,et=G.push,tt=G.slice,nt=G.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},rt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",st=it.replace("w","w#"),ot="([*^$|!~]?=)",ut="\\["+rt+"*("+it+")"+rt+"*(?:"+ot+rt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+st+")|)|)"+rt+"*\\]",at=":("+it+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ut.replace(3,8)+")*)|.*)\\)|)",ft=new RegExp("^"+rt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+rt+"+$","g"),lt=new RegExp("^"+rt+"*,"+rt+"*"),ct=new RegExp("^"+rt+"*([\\x20\\t\\r\\n\\f>+~])"+rt+"*"),ht=new RegExp(at),pt=new RegExp("^"+st+"$"),dt={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),NAME:new RegExp("^\\[name=['\"]?("+it+")['\"]?\\]"),TAG:new RegExp("^("+it.replace("w","w*")+")"),ATTR:new RegExp("^"+ut),PSEUDO:new RegExp("^"+at),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+rt+"*(even|odd|(([+-]|)(\\d*)n|)"+rt+"*(?:([+-]|)"+rt+"*(\\d+)|))"+rt+"*\\)|)","i"),needsContext:new RegExp("^"+rt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+rt+"*((?:-\\d)?\\d*)"+rt+"*\\)|)(?=[^-]|$)","i")},vt=/[\x20\t\r\n\f]*[+~]/,mt=/^[^{]+\{\s*\[native code/,gt=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,yt=/^(?:input|select|textarea|button)$/i,bt=/^h\d$/i,wt=/'|\\/g,Et=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,St=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,xt=function(e,t){var n="0x"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{et.apply(G=tt.call(q.childNodes),q.childNodes),G[q.childNodes.length].nodeType}catch(Tt){et={apply:G.length?function(e,t){Z.apply(e,tt.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}C=o.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},M=o.setDocument=function(n){var r=n?n.ownerDocument||n:q;return r!==_&&9===r.nodeType&&r.documentElement?(_=r,D=r.documentElement,P=!C(r),R.getElementsByTagName=s(function(e){return e.appendChild(r.createComment("")),!e.getElementsByTagName("*").length}),R.attributes=s(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),R.getElementsByClassName=s(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),R.getByName=s(function(e){e.id=I+0,e.appendChild(_.createElement("a")).setAttribute("name",I),e.appendChild(_.createElement("i")).setAttribute("name",I),D.appendChild(e);var t=r.getElementsByName&&r.getElementsByName(I).length===2+r.getElementsByName(I+0).length;return D.removeChild(e),t}),R.sortDetached=s(function(e){return e.compareDocumentPosition&&1&e.compareDocumentPosition(_.createElement("div"))}),T.attrHandle=s(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==K&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},R.getByName?(T.find.ID=function(e,t){if(typeof t.getElementById!==K&&P){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},T.filter.ID=function(e){var t=e.replace(St,xt);return function(e){return e.getAttribute("id")===t}}):(T.find.ID=function(e,n){if(typeof n.getElementById!==K&&P){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==K&&r.getAttributeNode("id").value===e?[r]:t:[]}},T.filter.ID=function(e){var t=e.replace(St,xt);return function(e){var n=typeof e.getAttributeNode!==K&&e.getAttributeNode("id");return n&&n.value===t}}),T.find.TAG=R.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==K?t.getElementsByTagName(e):void 0}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){for(;n=s[i++];)1===n.nodeType&&r.push(n);return r}return s},T.find.NAME=R.getByName&&function(e,t){return typeof t.getElementsByName!==K?t.getElementsByName(name):void 0},T.find.CLASS=R.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==K&&P?t.getElementsByClassName(e):void 0},B=[],H=[":focus"],(R.qsa=e(r.querySelectorAll))&&(s(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||H.push("\\["+rt+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||H.push(":checked")}),s(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&H.push("[*^$]="+rt+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||H.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),H.push(",.*:")})),(R.matchesSelector=e(j=D.matchesSelector||D.mozMatchesSelector||D.webkitMatchesSelector||D.oMatchesSelector||D.msMatchesSelector))&&s(function(e){R.disconnectedMatch=j.call(e,"div"),j.call(e,"[s!='']:x"),B.push("!=",at)}),H=new RegExp(H.join("|")),B=B.length&&new RegExp(B.join("|")),F=e(D.contains)||D.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},J=D.compareDocumentPosition?function(e,t){if(e===t)return $=!0,0;var n=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return n?1&n||A&&t.compareDocumentPosition(e)===n?e===r||F(q,e)?-1:t===r||F(q,t)?1:O?nt.call(O,e)-nt.call(O,t):0:4&n?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var n,i=0,s=e.parentNode,o=t.parentNode,a=[e],f=[t];if(e===t)return $=!0,0;if(!s||!o)return e===r?-1:t===r?1:s?-1:o?1:0;if(s===o)return u(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)f.unshift(n);for(;a[i]===f[i];)i++;return i?u(a[i],f[i]):a[i]===q?-1:f[i]===q?1:0},_):_},o.matches=function(e,t){return o(e,null,null,t)},o.matchesSelector=function(e,t){if((e.ownerDocument||e)!==_&&M(e),t=t.replace(Et,"='$1']"),R.matchesSelector&&P&&(!B||!B.test(t))&&!H.test(t))try{var n=j.call(e,t);if(n||R.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return o(t,_,null,[e]).length>0},o.contains=function(e,t){return(e.ownerDocument||e)!==_&&M(e),F(e,t)},o.attr=function(e,t){var n;return(e.ownerDocument||e)!==_&&M(e),P&&(t=t.toLowerCase()),(n=T.attrHandle[t])?n(e):!P||R.attributes?e.getAttribute(t):((n=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:n&&n.specified?n.value:null},o.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},o.uniqueSort=function(e){var t,n=[],r=0,i=0;if($=!R.detectDuplicates,A=!R.sortDetached,O=!R.sortStable&&e.slice(0),e.sort(J),$){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return e},N=o.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=N(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=N(t);return n},T=o.selectors={cacheLength:50,createPseudo:i,match:dt,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(St,xt),e[3]=(e[4]||e[5]||"").replace(St,xt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||o.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&o.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return dt.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&ht.test(n)&&(t=c(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(St,xt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=W[e+" "];return t||(t=new RegExp("(^|"+rt+")"+e+"("+rt+"|$)"))&&W(e,function(e){return t.test(e.className||typeof e.getAttribute!==K&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=o.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){for(;v;){for(c=t;c=c[v];)if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){for(l=m[I]||(m[I]={}),f=l[e]||[],p=f[0]===U&&f[1],h=f[0]===U&&f[2],c=p&&m.childNodes[p];c=++p&&c&&c[v]||(h=p=0)||d.pop();)if(1===c.nodeType&&++h&&c===t){l[e]=[U,p,h];break}}else if(y&&(f=(t[I]||(t[I]={}))[e])&&f[0]===U)h=f[1];else for(;(c=++p&&c&&c[v]||(h=p=0)||d.pop())&&((u?c.nodeName.toLowerCase()!==g:1!==c.nodeType)||!++h||(y&&((c[I]||(c[I]={}))[e]=[U,h]),c!==t)););return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var n,r=T.pseudos[e]||T.setFilters[e.toLowerCase()]||o.error("unsupported pseudo: "+e);return r[I]?r(t):r.length>1?(n=[e,e,"",t],T.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,n){for(var i,s=r(e,t),o=s.length;o--;)i=nt.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:i(function(e){var t=[],n=[],r=k(e.replace(ft,"$1"));return r[I]?i(function(e,t,n,i){for(var s,o=r(e,null,i,[]),u=e.length;u--;)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:i(function(e){return function(t){return o(e,t).length>0}}),contains:i(function(e){return function(t){return(t.textContent||t.innerText||N(t)).indexOf(e)>-1}}),lang:i(function(e){return pt.test(e||"")||o.error("unsupported lang: "+e),e=e.replace(St,xt).toLowerCase(),function(t){var n;do if(n=P?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(e){var t=window.location&&window.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===D},focus:function(e){return e===_.activeElement&&(!_.hasFocus||_.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!T.pseudos.empty(e)},header:function(e){return bt.test(e.nodeName)},input:function(e){return yt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,n){return[0>n?n+t:n]}),even:l(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:l(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:l(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:l(function(e,t,n){for(var r=0>n?n+t:n;++r<t;)e.push(r);return e})}};for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})T.pseudos[S]=a(S);for(S in{submit:!0,reset:!0})T.pseudos[S]=f(S);return k=o.compile=function(e,t){var n,r=[],i=[],s=V[e+" "];if(!s){for(t||(t=c(e)),n=t.length;n--;)s=g(t[n]),s[I]?r.push(s):i.push(s);s=V(e,y(i,r))}return s},T.pseudos.nth=T.pseudos.eq,E.prototype=T.filters=T.pseudos,T.setFilters=new E,R.sortStable=I.split("").sort(J).join("")===I,M(),[0,0].sort(J),R.detectDuplicates=$,"function"==typeof r&&r.amd?r(function(){return o}):window.Sizzle=o,o}),r(l,[a,f],function(e,n){function r(e){return"undefined"!=typeof e}function i(e){return"string"==typeof e}function s(e){var t,n,r;for(r=m.createElement("div"),t=m.createDocumentFragment(),r.innerHTML=e;n=r.firstChild;)t.appendChild(n);return t}function o(e,t,n){var r;if("string"==typeof t)t=s(t);else if(t.length){for(r=0;r<t.length;r++)o(e,t[r],n);return e}for(r=e.length;r--;)n.call(e[r],t.parentNode?t:t);return e}function u(e,t){return e&&t&&-1!==(" "+e.className+" ").indexOf(" "+t+" ")}function a(e,t){var n;for(e=e||[],"string"==typeof e&&(e=e.split(" ")),t=t||{},n=e.length;n--;)t[e[n]]={};return t}function f(e,t){return new f.fn.init(e,t)}function l(e){var t=arguments,n,r,i;for(r=1;r<t.length;r++){n=t[r];for(i in n)e[i]=n[i]}return e}function c(e){var t=[],n,r;for(n=0,r=e.length;r>n;n++)t[n]=e[n];return t}function h(e,t){var n;if(t.indexOf)return t.indexOf(e);for(n=t.length;n--;)if(t[n]===e)return n;return-1}function p(e,t){var n,r,i,s,o;if(e)if(n=e.length,n===s){for(r in e)if(e.hasOwnProperty(r)&&(o=e[r],t.call(o,o,r)===!1))break}else for(i=0;n>i&&(o=e[i],t.call(o,o,r)!==!1);i++);return e}function d(e,n,r){for(var i=[],s=e[n];s&&9!==s.nodeType&&(r===t||1!==s.nodeType||!f(s).is(r));)1===s.nodeType&&i.push(s),s=s[n];return i}function v(e,t,n,r){for(var i=[];e;e=e[n])r&&e.nodeType!==r||e===t||i.push(e);return i}var m=document,g=Array.prototype.push,y=Array.prototype.slice,b=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,w=e.Event,E=a("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"),S=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},x=/^\s*|\s*$/g,T=function(e){return null===e||e===t?"":(""+e).replace(x,"")};return f.fn=f.prototype={constructor:f,selector:"",length:0,init:function(e,t){var n=this,r,o;if(!e)return n;if(e.nodeType)return n.context=n[0]=e,n.length=1,n;if(i(e)){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:b.exec(e),!r)return f(t||document).find(e);if(r[1])for(o=s(e).firstChild;o;)this.add(o),o=o.nextSibling;else{if(o=m.getElementById(r[2]),o.id!==r[2])return n.find(e);n.length=1,n[0]=o}}else this.add(e);return n},toArray:function(){return c(this)},add:function(e){var t=this;return S(e)?g.apply(t,e):e instanceof f?t.add(e.toArray()):g.call(t,e),t},attr:function(e,n){var i=this;if("object"==typeof e)p(e,function(e,t){i.attr(t,e)});else{if(!r(n))return i[0]&&1===i[0].nodeType?i[0].getAttribute(e):t;this.each(function(){1===this.nodeType&&this.setAttribute(e,n)})}return i},css:function(e,n){var i=this;if("object"==typeof e)p(e,function(e,t){i.css(t,e)});else{if(e=e.replace(/-(\D)/g,function(e,t){return t.toUpperCase()}),!r(n))return i[0]?i[0].style[e]:t;"number"!=typeof n||E[e]||(n+="px"),i.each(function(){var t=this.style;"opacity"===e&&this.runtimeStyle&&"undefined"==typeof this.runtimeStyle.opacity&&(t.filter=""===n?"":"alpha(opacity="+100*n+")");try{t[e]=n}catch(r){}})}return i},remove:function(){for(var e=this,t,n=this.length;n--;)t=e[n],w.clean(t),t.parentNode&&t.parentNode.removeChild(t);return this},empty:function(){for(var e=this,t,n=this.length;n--;)for(t=e[n];t.firstChild;)t.removeChild(t.firstChild);return this},html:function(e){var t=this,n;if(r(e)){for(n=t.length;n--;)t[n].innerHTML=e;return t}return t[0]?t[0].innerHTML:""},text:function(e){var t=this,n;if(r(e)){for(n=t.length;n--;)t[n].innerText=t[0].textContent=e;return t}return t[0]?t[0].innerText||t[0].textContent:""},append:function(){return o(this,arguments,function(e){1===this.nodeType&&this.appendChild(e)})},prepend:function(){return o(this,arguments,function(e){1===this.nodeType&&this.insertBefore(e,this.firstChild)})},before:function(){var e=this;return e[0]&&e[0].parentNode?o(e,arguments,function(e){this.parentNode.insertBefore(e,this.nextSibling)}):e},after:function(){var e=this;return e[0]&&e[0].parentNode?o(e,arguments,function(e){this.parentNode.insertBefore(e,this)}):e},appendTo:function(e){return f(e).append(this),this},addClass:function(e){return this.toggleClass(e,!0)},removeClass:function(e){return this.toggleClass(e,!1)},toggleClass:function(e,t){var n=this;return-1!==e.indexOf(" ")?p(e.split(" "),function(){n.toggleClass(this,t)}):n.each(function(){var n=this,r;u(n,e)!==t&&(r=n.className,t?n.className+=r?" "+e:e:n.className=T((" "+r+" ").replace(" "+e+" "," ")))}),n},hasClass:function(e){return u(this[0],e)},each:function(e){return p(this,e)},on:function(e,t){return this.each(function(){w.bind(this,e,t)})},off:function(e,t){return this.each(function(){w.unbind(this,e,t)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new f(y.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},replaceWith:function(e){var t=this;return t[0]&&t[0].parentNode.replaceChild(f(e)[0],t[0]),t},wrap:function(e){return e=f(e)[0],this.each(function(){var t=this,n=e.cloneNode(!1);t.parentNode.insertBefore(n,t),n.appendChild(t)})},unwrap:function(){return this.each(function(){for(var e=this,t=e.firstChild,n;t;)n=t,t=t.nextSibling,e.parentNode.insertBefore(n,e)})},clone:function(){var e=[];return this.each(function(){e.push(this.cloneNode(!0))}),f(e)},find:function(e){var t,n,r=[];for(t=0,n=this.length;n>t;t++)f.find(e,this[t],r);return f(r)},push:g,sort:[].sort,splice:[].splice},l(f,{extend:l,toArray:c,inArray:h,isArray:S,each:p,trim:T,makeMap:a,find:n,expr:n.selectors,unique:n.uniqueSort,text:n.getText,isXMLDoc:n.isXML,contains:n.contains,filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?f.find.matchesSelector(t[0],e)?[t[0]]:[]:f.find.matches(e,t)}}),p({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return d(e,"parentNode")},parentsUntil:function(e,t){return d(e,"parentNode",t)},next:function(e){return v(e,"nextSibling",1)},prev:function(e){return v(e,"previousSibling",1)},nextNodes:function(e){return v(e,"nextSibling")},prevNodes:function(e){return v(e,"previousSibling")},children:function(e){return v(e.firstChild,"nextSibling",1)},contents:function(e){return c(("iframe"===e.nodeName?e.contentDocument||e.contentWindow.document:e).childNodes)}},function(e,t){f.fn[e]=function(n){var r=this,i;if(r.length>1)throw new Error("DomQuery only supports traverse functions on a single node.");return r[0]&&(i=t(r[0],n)),i=f(i),n&&"parentsUntil"!==e?i.filter(n):i}}),f.fn.filter=function(e){return f.filter(e)},f.fn.is=function(e){return!!e&&this.filter(e).length>0},f.fn.init.prototype=f.fn,f}),r(c,[],function(){return function(e,t){function n(e,t,n,r){function i(e){return e=parseInt(e,10).toString(16),e.length>1?e:"0"+e}return"#"+i(t)+i(n)+i(r)}var r=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,i=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,s=/\s*([^:]+):\s*([^;]+);?/g,o=/\s+$/,u,a,f={},l,c="";for(e=e||{},l=("\\\" \\' \\; \\: ; : "+c).split(" "),a=0;a<l.length;a++)f[l[a]]=c+a,f[c+a]=l[a];return{toHex:function(e){return e.replace(r,n)},parse:function(t){function u(e,t){var n,r,i,s;n=d[e+"-top"+t],n&&(r=d[e+"-right"+t],n==r&&(i=d[e+"-bottom"+t],r==i&&(s=d[e+"-left"+t],i==s&&(d[e+t]=s,delete d[e+"-top"+t],delete d[e+"-right"+t],delete d[e+"-bottom"+t],delete d[e+"-left"+t]))))}function a(e){var t=d[e],n;if(t&&!(t.indexOf(" ")<0)){for(t=t.split(" "),n=t.length;n--;)if(t[n]!==t[0])return!1;return d[e]=t[0],!0}}function l(e,t,n,r){a(t)&&a(n)&&a(r)&&(d[e]=d[t]+" "+d[n]+" "+d[r],delete d[t],delete d[n],delete d[r])}function c(e){return y=!0,f[e]}function h(e,t){return y&&(e=e.replace(/\uFEFF[0-9]/g,function(e){return f[e]})),t||(e=e.replace(/\\([\'\";:])/g,"$1")),e}function p(e,t,n,r,i,s){return(i=i||s)?(i=h(i),"'"+i.replace(/\'/g,"\\'")+"'"):(t=h(t||n||r),b&&(t=b.call(w,t,"style")),"url('"+t.replace(/\'/g,"\\'")+"')")}var d={},v,m,g,y,b=e.url_converter,w=e.url_converter_scope||this;if(t){for(t=t.replace(/\\[\"\';:\uFEFF]/g,c).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(e){return e.replace(/[;:]/g,c)});v=s.exec(t);)m=v[1].replace(o,"").toLowerCase(),g=v[2].replace(o,""),m&&g.length>0&&("font-weight"===m&&"700"===g?g="bold":("color"===m||"background-color"===m)&&(g=g.toLowerCase()),g=g.replace(r,n),g=g.replace(i,p),d[m]=y?h(g,!0):g),s.lastIndex=v.index+v[0].length;u("border",""),u("border","-width"),u("border","-color"),u("border","-style"),u("padding",""),u("margin",""),l("border","border-width","border-style","border-color"),"medium none"===d.border&&delete d.border}return d},serialize:function(e,n){function r(n){var r,s,o,a;if(r=t.styles[n])for(s=0,o=r.length;o>s;s++)n=r[s],a=e[n],a!==u&&a.length>0&&(i+=(i.length>0?" ":"")+n+": "+a+";")}var i="",s,o;if(n&&t&&t.styles)r("*"),r(n);else for(s in e)o=e[s],o!==u&&o.length>0&&(i+=(i.length>0?" ":"")+s+": "+o+";");return i}}}}),r(h,[],function(){return function(e,t){function n(e,n,r,i){var s,o;if(e){if(!i&&e[n])return e[n];if(e!=t){if(s=e[r])return s;for(o=e.parentNode;o&&o!=t;o=o.parentNode)if(s=o[r])return s}}}var r=e;this.current=function(){return r},this.next=function(e){return r=n(r,"firstChild","nextSibling",e)},this.prev=function(e){return r=n(r,"lastChild","previousSibling",e)}}}),r(p,[],function(){function e(e,n){return n?"array"==n&&m(e)?!0:typeof e==n:e!==t}function n(e){var t=[],n,r;for(n=0,r=e.length;r>n;n++)t[n]=e[n];return t}function r(e,t,n){var r;for(e=e||[],t=t||",","string"==typeof e&&(e=e.split(t)),n=n||{},r=e.length;r--;)n[e[r]]={};return n}function i(e,n,r){var i,s;if(!e)return 0;if(r=r||e,e.length!==t){for(i=0,s=e.length;s>i;i++)if(n.call(r,e[i],i,e)===!1)return 0}else for(i in e)if(e.hasOwnProperty(i)&&n.call(r,e[i],i,e)===!1)return 0;return 1}function s(e,t){var n=[];return i(e,function(e){n.push(t(e))}),n}function o(e,t){var n=[];return i(e,function(e){(!t||t(e))&&n.push(e)}),n}function u(e,t,n){var r=this,i,s,o,u,a,f=0;if(e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e),o=e[3].match(/(^|\.)(\w+)$/i)[2],s=r.createNS(e[3].replace(/\.\w+$/,""),n),!s[o]){if("static"==e[2])return s[o]=t,this.onCreate&&this.onCreate(e[2],e[3],s[o]),void 0;t[o]||(t[o]=function(){},f=1),s[o]=t[o],r.extend(s[o].prototype,t),e[5]&&(i=r.resolve(e[5]).prototype,u=e[5].match(/\.(\w+)$/i)[1],a=s[o],s[o]=f?function(){return i[u].apply(this,arguments)}:function(){return this.parent=i[u],a.apply(this,arguments)},s[o].prototype[o]=s[o],r.each(i,function(e,t){s[o].prototype[t]=i[t]}),r.each(t,function(e,t){i[t]?s[o].prototype[t]=function(){return this.parent=i[t],e.apply(this,arguments)}:t!=o&&(s[o].prototype[t]=e)})),r.each(t["static"],function(e,t){s[o][t]=e})}}function a(e,t){var n,r;if(e)for(n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1}function f(e,n){var r,i,s,o=arguments,u;for(r=1,i=o.length;i>r;r++){n=o[r];for(s in n)n.hasOwnProperty(s)&&(u=n[s],u!==t&&(e[s]=u))}return e}function l(e,t,n,r){r=r||this,e&&(n&&(e=e[n]),i(e,function(e,i){return t.call(r,e,i,n)===!1?!1:(l(e,t,n,r),void 0)}))}function c(e,t){var n,r;for(t=t||window,e=e.split("."),n=0;n<e.length;n++)r=e[n],t[r]||(t[r]={}),t=t[r];return t}function h(e,t){var n,r;for(t=t||window,e=e.split("."),n=0,r=e.length;r>n&&(t=t[e[n]],t);n++);return t}function p(t,n){return!t||e(t,"array")?t:s(t.split(n||","),v)}var d=/^\s*|\s*$/g,v=function(e){return null===e||e===t?"":(""+e).replace(d,"")},m=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};return{trim:v,isArray:m,is:e,toArray:n,makeMap:r,each:i,map:s,grep:o,inArray:a,extend:f,create:u,walk:l,createNS:c,resolve:h,explode:p}}),r(d,[p],function(e){function t(n){function r(){return H.createDocumentFragment()}function i(e,t){x(I,e,t)}function s(e,t){x(q,e,t)}function o(e){i(e.parentNode,V(e))}function u(e){i(e.parentNode,V(e)+1)}function a(e){s(e.parentNode,V(e))}function f(e){s(e.parentNode,V(e)+1)}function l(e){e?(P[z]=P[U],P[W]=P[R]):(P[U]=P[z],P[R]=P[W]),P.collapsed=I}function c(e){o(e),f(e)}function h(e){i(e,0),s(e,1===e.nodeType?e.childNodes.length:e.nodeValue.length)}function p(e,t){var n=P[U],r=P[R],i=P[z],s=P[W],o=t.startContainer,u=t.startOffset,a=t.endContainer,f=t.endOffset;return 0===e?S(n,r,o,u):1===e?S(i,s,o,u):2===e?S(i,s,a,f):3===e?S(n,r,a,f):void 0}function d(){T(F)}function v(){return T(B)}function m(){return T(j)}function g(e){var t=this[U],r=this[R],i,s;3!==t.nodeType&&4!==t.nodeType||!t.nodeValue?(t.childNodes.length>0&&(s=t.childNodes[r]),s?t.insertBefore(e,s):t.appendChild(e)):r?r>=t.nodeValue.length?n.insertAfter(e,t):(i=t.splitText(r),t.parentNode.insertBefore(e,i)):t.parentNode.insertBefore(e,t)}function y(e){var t=P.extractContents();P.insertNode(e),e.appendChild(t),P.selectNode(e)}function b(){return X(new t(n),{startContainer:P[U],startOffset:P[R],endContainer:P[z],endOffset:P[W],collapsed:P.collapsed,commonAncestorContainer:P.commonAncestorContainer})}function w(e,t){var n;if(3==e.nodeType)return e;if(0>t)return e;for(n=e.firstChild;n&&t>0;)--t,n=n.nextSibling;return n?n:e}function E(){return P[U]==P[z]&&P[R]==P[W]}function S(e,t,r,i){var s,o,u,a,f,l;if(e==r)return t==i?0:i>t?-1:1;for(s=r;s&&s.parentNode!=e;)s=s.parentNode;if(s){for(o=0,u=e.firstChild;u!=s&&t>o;)o++,u=u.nextSibling;return o>=t?-1:1}for(s=e;s&&s.parentNode!=r;)s=s.parentNode;if(s){for(o=0,u=r.firstChild;u!=s&&i>o;)o++,u=u.nextSibling;return i>o?-1:1}for(a=n.findCommonAncestor(e,r),f=e;f&&f.parentNode!=a;)f=f.parentNode;for(f||(f=a),l=r;l&&l.parentNode!=a;)l=l.parentNode;if(l||(l=a),f==l)return 0;for(u=a.firstChild;u;){if(u==f)return-1;if(u==l)return 1;u=u.nextSibling}}function x(e,t,r){var i,s;for(e?(P[U]=t,P[R]=r):(P[z]=t,P[W]=r),i=P[z];i.parentNode;)i=i.parentNode;for(s=P[U];s.parentNode;)s=s.parentNode;s==i?S(P[U],P[R],P[z],P[W])>0&&P.collapse(e):P.collapse(e),P.collapsed=E(),P.commonAncestorContainer=n.findCommonAncestor(P[U],P[z])}function T(e){var t,n=0,r=0,i,s,o,u,a,f;if(P[U]==P[z])return N(e);for(t=P[z],i=t.parentNode;i;t=i,i=i.parentNode){if(i==P[U])return C(t,e);++n}for(t=P[U],i=t.parentNode;i;t=i,i=i.parentNode){if(i==P[z])return k(t,e);++r}for(s=r-n,o=P[U];s>0;)o=o.parentNode,s--;for(u=P[z];0>s;)u=u.parentNode,s++;for(a=o.parentNode,f=u.parentNode;a!=f;a=a.parentNode,f=f.parentNode)o=a,u=f;return L(o,u,e)}function N(e){var t,n,i,s,o,u,a,f,l;if(e!=F&&(t=r()),P[R]==P[W])return t;if(3==P[U].nodeType){if(n=P[U].nodeValue,i=n.substring(P[R],P[W]),e!=j&&(s=P[U],f=P[R],l=P[W]-P[R],0===f&&l>=s.nodeValue.length-1?s.parentNode.removeChild(s):s.deleteData(f,l),P.collapse(I)),e==F)return;return i.length>0&&t.appendChild(H.createTextNode(i)),t}for(s=w(P[U],P[R]),o=P[W]-P[R];s&&o>0;)u=s.nextSibling,a=_(s,e),t&&t.appendChild(a),--o,s=u;return e!=j&&P.collapse(I),t}function C(e,t){var n,i,s,o,u,a;if(t!=F&&(n=r()),i=A(e,t),n&&n.appendChild(i),s=V(e),o=s-P[R],0>=o)return t!=j&&(P.setEndBefore(e),P.collapse(q)),n;for(i=e.previousSibling;o>0;)u=i.previousSibling,a=_(i,t),n&&n.insertBefore(a,n.firstChild),--o,i=u;return t!=j&&(P.setEndBefore(e),P.collapse(q)),n}function k(e,t){var n,i,s,o,u,a;for(t!=F&&(n=r()),s=O(e,t),n&&n.appendChild(s),i=V(e),++i,o=P[W]-i,s=e.nextSibling;s&&o>0;)u=s.nextSibling,a=_(s,t),n&&n.appendChild(a),--o,s=u;return t!=j&&(P.setStartAfter(e),P.collapse(I)),n}function L(e,t,n){var i,s,o,u,a,f,l,c;for(n!=F&&(s=r()),i=O(e,n),s&&s.appendChild(i),o=e.parentNode,u=V(e),a=V(t),++u,f=a-u,l=e.nextSibling;f>0;)c=l.nextSibling,i=_(l,n),s&&s.appendChild(i),l=c,--f;return i=A(t,n),s&&s.appendChild(i),n!=j&&(P.setStartAfter(e),P.collapse(I)),s}function A(e,t){var n=w(P[z],P[W]-1),r,i,s,o,u,a=n!=P[z];if(n==e)return M(n,a,q,t);for(r=n.parentNode,i=M(r,q,q,t);r;){for(;n;)s=n.previousSibling,o=M(n,a,q,t),t!=F&&i.insertBefore(o,i.firstChild),a=I,n=s;if(r==e)return i;n=r.previousSibling,r=r.parentNode,u=M(r,q,q,t),t!=F&&u.appendChild(i),i=u}}function O(e,t){var n=w(P[U],P[R]),r=n!=P[U],i,s,o,u,a;if(n==e)return M(n,r,I,t);for(i=n.parentNode,s=M(i,q,I,t);i;){for(;n;)o=n.nextSibling,u=M(n,r,I,t),t!=F&&s.appendChild(u),r=I,n=o;if(i==e)return s;n=i.nextSibling,i=i.parentNode,a=M(i,q,I,t),t!=F&&a.appendChild(s),s=a}}function M(e,t,r,i){var s,o,u,a,f;if(t)return _(e,i);if(3==e.nodeType){if(s=e.nodeValue,r?(a=P[R],o=s.substring(a),u=s.substring(0,a)):(a=P[W],o=s.substring(0,a),u=s.substring(a)),i!=j&&(e.nodeValue=u),i==F)return;return f=n.clone(e,q),f.nodeValue=o,f}if(i!=F)return n.clone(e,q)}function _(e,t){return t!=F?t==j?n.clone(e,I):e:(e.parentNode.removeChild(e),void 0)}function D(){return n.create("body",null,m()).outerText}var P=this,H=n.doc,B=0,j=1,F=2,I=!0,q=!1,R="startOffset",U="startContainer",z="endContainer",W="endOffset",X=e.extend,V=n.nodeIndex;return X(P,{startContainer:H,startOffset:0,endContainer:H,endOffset:0,collapsed:I,commonAncestorContainer:H,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:i,setEnd:s,setStartBefore:o,setStartAfter:u,setEndBefore:a,setEndAfter:f,collapse:l,selectNode:c,selectNodeContents:h,compareBoundaryPoints:p,deleteContents:d,extractContents:v,cloneContents:m,insertNode:g,surroundContents:y,cloneRange:b,toStringIE:D}),P}return t.prototype.toString=function(){return this.toStringIE()},t}),r(v,[p],function(e){function t(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.textContent||t.innerText||e}function n(e,t){var n,r,i,o={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)r=String.fromCharCode(parseInt(e[n],t)),s[r]||(i="&"+e[n+1]+";",o[r]=i,o[i]=r);return o}}var r=e.makeMap,i,s,o,u=/[&<>\"\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,a=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,f=/[<>&\"\']/g,l=/&(#x|#)?([\w]+);/g,c={128:"",130:"",131:"",132:"",133:"",134:"",135:"",136:"",137:"",138:"",139:"",140:"",142:"",145:"",146:"",147:"",148:"",149:"",150:"",151:"",152:"",153:"",154:"",155:"",156:"",158:"",159:""};s={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"},o={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},i=n("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var h={encodeRaw:function(e,t){return e.replace(t?u:a,function(e){return s[e]||e})},encodeAllRaw:function(e){return(""+e).replace(f,function(e){return s[e]||e})},encodeNumeric:function(e,t){return e.replace(t?u:a,function(e){return e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":s[e]||"&#"+e.charCodeAt(0)+";"})},encodeNamed:function(e,t,n){return n=n||i,e.replace(t?u:a,function(e){return s[e]||n[e]||e})},getEncodeFunc:function(e,t){function o(e,n){return e.replace(n?u:a,function(e){return s[e]||t[e]||"&#"+e.charCodeAt(0)+";"||e})}function f(e,n){return h.encodeNamed(e,n,t)}return t=n(t)||i,e=r(e.replace(/\+/g,",")),e.named&&e.numeric?o:e.named?t?f:h.encodeNamed:e.numeric?h.encodeNumeric:h.encodeRaw},decode:function(e){return e.replace(l,function(e,n,r){return n?(r=parseInt(r,2===n.length?16:10),r>65535?(r-=65536,String.fromCharCode(55296+(r>>10),56320+(1023&r))):c[r]||String.fromCharCode(r)):o[e]||i[e]||t(e)})}};return h}),r(m,[],function(){var e=navigator,t=e.userAgent,n,r,i,s,o,u;n=window.opera&&window.opera.buildNumber,r=/WebKit/.test(t),i=!r&&!n&&/MSIE/gi.test(t)&&/Explorer/gi.test(e.appName),i=i&&/MSIE (\w+)\./.exec(t)[1],s=!r&&/Gecko/.test(t),o=-1!=t.indexOf("Mac"),u=/(iPad|iPhone)/.test(t);var a=!u||t.match(/AppleWebKit\/(\d*)/)[1]>=534;return{opera:n,webkit:r,ie:i,gecko:s,mac:o,iOS:u,contentEditable:a,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:8!=i,range:window.getSelection&&"Range"in window,documentMode:i?document.documentMode||7:10}}),r(g,[f,c,a,h,d,v,m,p],function(e,n,r,i,s,o,u,a){function f(e,t){var i=this,s;i.doc=e,i.win=window,i.files={},i.counter=0,i.stdMode=!m||e.documentMode>=8,i.boxModel=!m||"CSS1Compat"==e.compatMode||i.stdMode,i.hasOuterHTML="outerHTML"in e.createElement("a"),i.settings=t=d({keep_values:!1,hex_colors:1},t),i.schema=t.schema,i.styles=new n({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),i.fixDoc(e),i.events=t.ownEvents?new r(t.proxy):r.Event,s=t.schema?t.schema.getBlockElements():{},i.isBlock=function(e){if(!e)return!1;var t=e.nodeType;return t?1===t&&!!s[e.nodeName]:!!s[e]}}var l=a.each,c=a.is,h=a.grep,p=a.trim,d=a.extend,v=u.webkit,m=u.ie,g=/^([a-z0-9],?)+$/i,y=/^[ \t\r\n]*$/,b=a.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," ");return f.prototype={root:null,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"},fixDoc:function(e){var t=this.settings,n;if(m&&t.schema){"abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video".replace(/\w+/g,function(t){e.createElement(t)});for(n in t.schema.getCustomElements())e.createElement(n)}},clone:function(e,t){var n=this,r,i;return!m||1!==e.nodeType||t?e.cloneNode(t):(i=n.doc,t?r.firstChild:(r=i.createElement(e.nodeName),l(n.getAttribs(e),function(t){n.setAttrib(r,t.nodeName,n.getAttrib(e,t.nodeName))}),r))},getRoot:function(){var e=this;return e.get(e.settings.root_element)||e.doc.body},getViewPort:function(e){var t,n;return e=e?e:this.win,t=e.document,n=this.boxModel?t.documentElement:t.body,{x:e.pageXOffset||n.scrollLeft,y:e.pageYOffset||n.scrollTop,w:e.innerWidth||n.clientWidth,h:e.innerHeight||n.clientHeight}},getRect:function(e){var t=this,n,r;return e=t.get(e),n=t.getPos(e),r=t.getSize(e),{x:n.x,y:n.y,w:r.w,h:r.h}},getSize:function(e){var t=this,n,r;return e=t.get(e),n=t.getStyle(e,"width"),r=t.getStyle(e,"height"),-1===n.indexOf("px")&&(n=0),-1===r.indexOf("px")&&(r=0),{w:parseInt(n,10)||e.offsetWidth||e.clientWidth,h:parseInt(r,10)||e.offsetHeight||e.clientHeight}},getParent:function(e,t,n){return this.getParents(e,t,n,!1)},getParents:function(e,n,r,i){var s=this,o,u=[];for(e=s.get(e),i=i===t,r=r||("BODY"!=s.getRoot().nodeName?s.getRoot().parentNode:null),c(n,"string")&&(o=n,n="*"===n?function(e){return 1==e.nodeType}:function(e){return s.is(e,o)});e&&e!=r&&e.nodeType&&9!==e.nodeType;){if(!n||n(e)){if(!i)return e;u.push(e)}e=e.parentNode}return i?u:null},get:function(e){var t;return e&&this.doc&&"string"==typeof e&&(t=e,e=this.doc.getElementById(e),e&&e.id!==t)?this.doc.getElementsByName(t)[1]:e},getNext:function(e,t){return this._findSib(e,t,"nextSibling")},getPrev:function(e,t){return this._findSib(e,t,"previousSibling")},select:function(t,n){var r=this;return e(t,r.get(n)||r.get(r.settings.root_element)||r.doc,[])},is:function(n,r){var i;if(n.length===t){if("*"===r)return 1==n.nodeType;if(g.test(r)){for(r=r.toLowerCase().split(/,/),n=n.nodeName.toLowerCase(),i=r.length-1;i>=0;i--)if(r[i]==n)return!0;return!1}}return n.nodeType&&1!=n.nodeType?!1:e.matches(r,n.nodeType?[n]:n).length>0},add:function(e,t,n,r,i){var s=this;return this.run(e,function(e){var o;return o=c(t,"string")?s.doc.createElement(t):t,s.setAttribs(o,n),r&&(r.nodeType?o.appendChild(r):s.setHTML(o,r)),i?o:e.appendChild(o)})},create:function(e,t,n){return this.add(this.doc.createElement(e),e,t,n,1)},createHTML:function(e,t,n){var r="",i;r+="<"+e;for(i in t)t.hasOwnProperty(i)&&null!==t[i]&&(r+=" "+i+'="'+this.encode(t[i])+'"');return"undefined"!=typeof n?r+">"+n+"</"+e+">":r+" />"},createFragment:function(e){var t,n,r=this.doc,i;for(i=r.createElement("div"),t=r.createDocumentFragment(),e&&(i.innerHTML=e);n=i.firstChild;)t.appendChild(n);return t},remove:function(e,t){return this.run(e,function(e){var n,r=e.parentNode;if(!r)return null;if(t)for(;n=e.firstChild;)!m||3!==n.nodeType||n.nodeValue?r.insertBefore(n,e):e.removeChild(n);return r.removeChild(e)})},setStyle:function(e,t,n){return this.run(e,function(e){var r=this,i,s;if(t)if("string"==typeof t){i=e.style,t=t.replace(/-(\D)/g,function(e,t){return t.toUpperCase()}),"number"!=typeof n||b[t]||(n+="px"),"opacity"===t&&e.runtimeStyle&&"undefined"==typeof e.runtimeStyle.opacity&&(i.filter=""===n?"":"alpha(opacity="+100*n+")"),"float"==t&&(t="cssFloat"in e.style?"cssFloat":"styleFloat");try{i[t]=n}catch(o){}r.settings.update_styles&&e.removeAttribute("data-mce-style")}else for(s in t)r.setStyle(e,s,t[s])})},getStyle:function(e,n,r){if(e=this.get(e)){if(this.doc.defaultView&&r){n=n.replace(/[A-Z]/g,function(e){return"-"+e});try{return this.doc.defaultView.getComputedStyle(e,null).getPropertyValue(n)}catch(i){return null}}return n=n.replace(/-(\D)/g,function(e,t){return t.toUpperCase()}),"float"==n&&(n=m?"styleFloat":"cssFloat"),n.currentStyle&&r?e.currentStyle[n]:e.style?e.style[n]:t}},setStyles:function(e,t){this.setStyle(e,t)},css:function(e,t,n){this.setStyle(e,t,n)},removeAllAttribs:function(e){return this.run(e,function(e){var t,n=e.attributes;for(t=n.length-1;t>=0;t--)e.removeAttributeNode(n.item(t))})},setAttrib:function(e,t,n){var r=this;if(e&&t)return this.run(e,function(e){var i=r.settings,s=e.getAttribute(t);if(null!==n)switch(t){case"style":if(!c(n,"string"))return l(n,function(t,n){r.setStyle(e,n,t)}),void 0;i.keep_values&&(n?e.setAttribute("data-mce-style",n,2):e.removeAttribute("data-mce-style",2)),e.style.cssText=n;break;case"class":e.className=n||"";break;case"src":case"href":i.keep_values&&(i.url_converter&&(n=i.url_converter.call(i.url_converter_scope||r,n,t,e)),r.setAttrib(e,"data-mce-"+t,n,2));break;case"shape":e.setAttribute("data-mce-style",n)}c(n)&&null!==n&&0!==n.length?e.setAttribute(t,""+n,2):e.removeAttribute(t,2),s!=n&&i.onSetAttrib&&i.onSetAttrib({attrElm:e,attrName:t,attrValue:n})})},setAttribs:function(e,t){var n=this;return this.run(e,function(e){l(t,function(t,r){n.setAttrib(e,r,t)})})},getAttrib:function(e,t,n){var r,i=this,s;if(e=i.get(e),!e||1!==e.nodeType)return n===s?!1:n;if(c(n)||(n=""),/^(src|href|style|coords|shape)$/.test(t)&&(r=e.getAttribute("data-mce-"+t)))return r;if(m&&i.props[t]&&(r=e[i.props[t]],r=r&&r.nodeValue?r.nodeValue:r),r||(r=e.getAttribute(t,2)),/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(t))return e[i.props[t]]===!0&&""===r?t:r?t:"";if("FORM"===e.nodeName&&e.getAttributeNode(t))return e.getAttributeNode(t).nodeValue;if("style"===t&&(r=r||e.style.cssText,r&&(r=i.serializeStyle(i.parseStyle(r),e.nodeName),i.settings.keep_values&&e.setAttribute("data-mce-style",r))),v&&"class"===t&&r&&(r=r.replace(/(apple|webkit)\-[a-z\-]+/gi,"")),m)switch(t){case"rowspan":case"colspan":1===r&&(r="");break;case"size":("+0"===r||20===r||0===r)&&(r="");break;case"width":case"height":case"vspace":case"checked":case"disabled":case"readonly":0===r&&(r="");break;case"hspace":-1===r&&(r="");break;case"maxlength":case"tabindex":(32768===r||2147483647===r||"32768"===r)&&(r="");break;case"multiple":case"compact":case"noshade":case"nowrap":return 65535===r?t:n;case"shape":r=r.toLowerCase();break;default:0===t.indexOf("on")&&r&&(r=(""+r).replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1"))}return r!==s&&null!==r&&""!==r?""+r:n},getPos:function(e,t){var n=this,r=0,i=0,s,o=n.doc,u;if(e=n.get(e),t=t||o.body,e){if(t===o.body&&e.getBoundingClientRect)return u=e.getBoundingClientRect(),t=n.boxModel?o.documentElement:o.body,r=u.left+(o.documentElement.scrollLeft||o.body.scrollLeft)-t.clientTop,i=u.top+(o.documentElement.scrollTop||o.body.scrollTop)-t.clientLeft,{x:r,y:i};for(s=e;s&&s!=t&&s.nodeType;)r+=s.offsetLeft||0,i+=s.offsetTop||0,s=s.offsetParent;for(s=e.parentNode;s&&s!=t&&s.nodeType;)r-=s.scrollLeft||0,i-=s.scrollTop||0,s=s.parentNode}return{x:r,y:i}},parseStyle:function(e){return this.styles.parse(e)},serializeStyle:function(e,t){return this.styles.serialize(e,t)},addStyle:function(e){var t=this,n=t.doc,r,i;if(t!==f.DOM&&n===document){var s=f.DOM.addedStyles;if(s=s||[],s[e])return;s[e]=!0,f.DOM.addedStyles=s}i=n.getElementById("mceDefaultStyles"),i||(i=n.createElement("style"),i.id="mceDefaultStyles",i.type="text/css",r=n.getElementsByTagName("head")[0],r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i)),i.styleSheet?i.styleSheet.cssText+=e:i.appendChild(n.createTextNode(e))},loadCSS:function(e){var t=this,n=t.doc,r;return t!==f.DOM&&n===document?(f.DOM.loadCSS(e),void 0):(e||(e=""),r=n.getElementsByTagName("head")[0],l(e.split(","),function(e){var i;t.files[e]||(t.files[e]=!0,i=t.create("link",{rel:"stylesheet",href:e}),m&&n.documentMode&&n.recalc&&(i.onload=function(){n.recalc&&n.recalc(),i.onload=null}),r.appendChild(i))}),void 0)},addClass:function(e,t){return this.run(e,function(e){var n;return t?this.hasClass(e,t)?e.className:(n=this.removeClass(e,t),e.className=n=(""!==n?n+" ":"")+t,n):0})},removeClass:function(e,t){var n=this,r;return n.run(e,function(e){var i;return n.hasClass(e,t)?(r||(r=new RegExp("(^|\\s+)"+t+"(\\s+|$)","g")),i=e.className.replace(r," "),i=p(" "!=i?i:""),e.className=i,i||(e.removeAttribute("class"),e.removeAttribute("className")),i):e.className})},hasClass:function(e,t){return e=this.get(e),e&&t?-1!==(" "+e.className+" ").indexOf(" "+t+" "):!1},toggleClass:function(e,n,r){r=r===t?!this.hasClass(e,n):r,this.hasClass(e,n)!==r&&(r?this.addClass(e,n):this.removeClass(e,n))},show:function(e){return this.setStyle(e,"display","block")},hide:function(e){return this.setStyle(e,"display","none")},isHidden:function(e){return e=this.get(e),!e||"none"==e.style.display||"none"==this.getStyle(e,"display")},uniqueId:function(e){return(e?e:"mce_")+this.counter++},setHTML:function(e,t){var n=this;return n.run(e,function(e){if(m){for(;e.firstChild;)e.removeChild(e.firstChild);try{e.innerHTML="<br />"+t,e.removeChild(e.firstChild)}catch(r){var i=n.create("div");i.innerHTML="<br />"+t,l(h(i.childNodes),function(t,n){n&&e.canHaveHTML&&e.appendChild(t)})}}else e.innerHTML=t;return t})},getOuterHTML:function(e){var t,n=this;return(e=n.get(e))?1===e.nodeType&&n.hasOuterHTML?e.outerHTML:(t=(e.ownerDocument||n.doc).createElement("body"),t.appendChild(e.cloneNode(!0)),t.innerHTML):null},setOuterHTML:function(e,t,n){var r=this;return r.run(e,function(e){function i(){var i,s;for(s=n.createElement("body"),s.innerHTML=t,i=s.lastChild;i;)r.insertAfter(i.cloneNode(!0),e),i=i.previousSibling;r.remove(e)}if(1==e.nodeType)if(n=n||e.ownerDocument||r.doc,m)try{1==e.nodeType&&r.hasOuterHTML?e.outerHTML=t:i()}catch(s){i()}else i()})},decode:o.decode,encode:o.encodeAllRaw,insertAfter:function(e,t){return t=this.get(t),this.run(e,function(e){var n,r;return n=t.parentNode,r=t.nextSibling,r?n.insertBefore(e,r):n.appendChild(e),e})},replace:function(e,t,n){var r=this;return r.run(t,function(t){return c(t,"array")&&(e=e.cloneNode(!0)),n&&l(h(t.childNodes),function(t){e.appendChild(t)}),t.parentNode.replaceChild(e,t)})},rename:function(e,t){var n=this,r;return e.nodeName!=t.toUpperCase()&&(r=n.create(t),l(n.getAttribs(e),function(t){n.setAttrib(r,t.nodeName,n.getAttrib(e,t.nodeName))}),n.replace(r,e,1)),r||e},findCommonAncestor:function(e,t){for(var n=e,r;n;){for(r=t;r&&n!=r;)r=r.parentNode;if(n==r)break;n=n.parentNode}return!n&&e.ownerDocument?e.ownerDocument.documentElement:n},toHex:function(e){return this.styles.toHex(a.trim(e))},getClasses:function(){function e(t){l(t.imports,function(t){e(t)}),l(t.cssRules||t.rules,function(t){switch(t.type||1){case 1:t.selectorText&&l(t.selectorText.split(","),function(e){e=e.replace(/^\s*|\s*$|^\s\./g,""),!/\.mce/.test(e)&&/\.[\w\-]+$/.test(e)&&(s=e,e=e.replace(/.*\.([a-z0-9_\-]+).*/i,"$1"),(!i||(e=i(e,s)))&&(r[e]||(n.push({"class":e}),r[e]=1)))});break;case 3:e(t.styleSheet)}})}var t=this,n=[],r={},i=t.settings.class_filter,s;if(t.classes)return t.classes;try{l(t.doc.styleSheets,e)}catch(o){}return n.length>0&&(t.classes=n),n},run:function(e,t,n){var r=this,i;return"string"==typeof e&&(e=r.get(e)),e?(n=n||this,e.nodeType||!e.length&&0!==e.length?t.call(n,e):(i=[],l(e,function(e,s){e&&("string"==typeof e&&(e=r.get(e)),i.push(t.call(n,e,s)))}),i)):!1},getAttribs:function(e){var t;if(e=this.get(e),!e)return[];if(m){if(t=[],"OBJECT"==e.nodeName)return e.attributes;"OPTION"===e.nodeName&&this.getAttrib(e,"selected")&&t.push({specified:1,nodeName:"selected"});var n=/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi;return e.cloneNode(!1).outerHTML.replace(n,"").replace(/[\w:\-]+/gi,function(e){t.push({specified:1,nodeName:e})}),t}return e.attributes},isEmpty:function(e,t){var n=this,r,s,o,u,a,f=0;if(e=e.firstChild){u=new i(e,e.parentNode),t=t||n.schema?n.schema.getNonEmptyElements():null;do{if(o=e.nodeType,1===o){if(e.getAttribute("data-mce-bogus"))continue;if(a=e.nodeName.toLowerCase(),t&&t[a]){if("br"===a){f++;continue}return!1}for(s=n.getAttribs(e),r=e.attributes.length;r--;)if(a=e.attributes[r].nodeName,"name"===a||"data-mce-bookmark"===a)return!1}if(8==o)return!1;if(3===o&&!y.test(e.nodeValue))return!1}while(e=u.next())}return 1>=f},createRng:function(){var e=this.doc;return e.createRange?e.createRange():new s(this)},nodeIndex:function(e,t){var n=0,r,i,s;if(e)for(r=e.nodeType,e=e.previousSibling,i=e;e;e=e.previousSibling)s=e.nodeType,(!t||3!=s||s!=r&&e.nodeValue.length)&&(n++,r=s);return n},split:function(e,t,n){function r(e){function t(e){var t=e.previousSibling&&"SPAN"==e.previousSibling.nodeName,n=e.nextSibling&&"SPAN"==e.nextSibling.nodeName;return t&&n}var n,s=e.childNodes,o=e.nodeType;if(1!=o||"bookmark"!=e.getAttribute("data-mce-type")){for(n=s.length-1;n>=0;n--)r(s[n]);if(9!=o){if(3==o&&e.nodeValue.length>0){var u=p(e.nodeValue).length;if(!i.isBlock(e.parentNode)||u>0||0===u&&t(e))return}else if(1==o&&(s=e.childNodes,1==s.length&&s[0]&&1==s[0].nodeType&&"bookmark"==s[0].getAttribute("data-mce-type")&&e.parentNode.insertBefore(s[0],e),s.length||/^(br|hr|input|img)$/i.test(e.nodeName)))return;i.remove(e)}return e}}var i=this,s=i.createRng(),o,u,a;return e&&t?(s.setStart(e.parentNode,i.nodeIndex(e)),s.setEnd(t.parentNode,i.nodeIndex(t)),o=s.extractContents(),s=i.createRng(),s.setStart(t.parentNode,i.nodeIndex(t)+1),s.setEnd(e.parentNode,i.nodeIndex(e)+1),u=s.extractContents(),a=e.parentNode,a.insertBefore(r(o),e),n?a.replaceChild(n,t):a.insertBefore(t,e),a.insertBefore(r(u),e),i.remove(e),n||t):void 0},bind:function(e,t,n,r){return this.events.bind(e,t,n,r||this)},unbind:function(e,t,n){return this.events.unbind(e,t,n)},fire:function(e,t,n){return this.events.fire(e,t,n)},getContentEditable:function(e){var t;return 1!=e.nodeType?null:(t=e.getAttribute("data-mce-contenteditable"),t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null)},destroy:function(){var e=this;e.win=e.doc=e.root=e.events=e.frag=null},dumpRng:function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset},_findSib:function(e,t,n){var r=this,i=t;if(e)for("string"==typeof i&&(i=function(e){return r.is(e,t)}),e=e[n];e;e=e[n])if(i(e))return e;return null}},f.DOM=new f(document),f}),r(y,[g,p],function(e,t){function n(){function e(e,t){function n(){s.remove(u),o&&(o.onreadystatechange=o.onload=o=null),t()}function i(){"undefined"!=typeof console&&console.log&&console.log("Failed to load: "+e)}var s=r,o,u;u=s.uniqueId(),o=document.createElement("script"),o.id=u,o.type="text/javascript",o.src=e,"onreadystatechange"in o?o.onreadystatechange=function(){/loaded|complete/.test(o.readyState)&&n()}:o.onload=n,o.onerror=i,(document.getElementsByTagName("head")[0]||document.body).appendChild(o)}var t=0,n=1,o=2,u={},a=[],f={},l=[],c=0,h;this.isDone=function(e){return u[e]==o},this.markDone=function(e){u[e]=o},this.add=this.load=function(e,n,r){var i=u[e];i==h&&(a.push(e),u[e]=t),n&&(f[e]||(f[e]=[]),f[e].push({func:n,scope:r||this}))},this.loadQueue=function(e,t){this.loadScripts(a,e,t)},this.loadScripts=function(t,r,a){function p(e){i(f[e],function(e){e.func.call(e.scope)}),f[e]=h}var d;l.push({func:r,scope:a||this}),d=function(){var r=s(t);t.length=0,i(r,function(t){return u[t]==o?(p(t),void 0):(u[t]!=n&&(u[t]=n,c++,e(t,function(){u[t]=o,c--,p(t),d()})),void 0)}),c||(i(l,function(e){e.func.call(e.scope)}),l.length=0)},d()}}var r=e.DOM,i=t.each,s=t.grep;return n.ScriptLoader=new n,n}),r(b,[y,p],function(e,n){function r(){var e=this;e.items=[],e.urls={},e.lookup={}}var i=n.each;return r.prototype={get:function(e){return this.lookup[e]?this.lookup[e].instance:t},dependencies:function(e){var t;return this.lookup[e]&&(t=this.lookup[e].dependencies),t||[]},requireLangPack:function(t){var n=r.settings;n&&n.language&&n.language_load!==!1&&e.ScriptLoader.add(this.urls[t]+"/langs/"+n.language+".js")},add:function(e,t,n){return this.items.push(t),this.lookup[e]={instance:t,dependencies:n},t},createUrl:function(e,t){return"object"==typeof t?t:{prefix:e.prefix,resource:t,suffix:e.suffix}},addComponents:function(t,n){var r=this.urls[t];i(n,function(t){e.ScriptLoader.add(r+"/"+t)})},load:function(n,s,o,u){function a(){var r=f.dependencies(n);i(r,function(e){var n=f.createUrl(s,e);f.load(n.resource,n,t,t)}),o&&(u?o.call(u):o.call(e))}var f=this,l=s;f.urls[n]||("object"==typeof s&&(l=s.prefix+s.resource+s.suffix),0!==l.indexOf("/")&&-1==l.indexOf("://")&&(l=r.baseURL+"/"+l),f.urls[n]=l.substring(0,l.lastIndexOf("/")),f.lookup[n]?a():e.ScriptLoader.add(l,a,u))}},r.PluginManager=new r,r.ThemeManager=new r,r}),r(w,[],function(){function e(e,t,n){var r,i,s=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[s])return e[s];if(e!==t){if(r=e[o])return r;for(i=e.parent;i&&i!==t;i=i.parent)if(r=i[o])return r}}function t(e,t){this.name=e,this.type=t,1===t&&(this.attributes=[],this.attributes.map={})}var n=/^[ \t\r\n]*$/,r={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};return t.prototype={replace:function(e){var t=this;return e.parent&&e.remove(),t.insert(e,t),t.remove(),t},attr:function(e,t){var n=this,r,i,s;if("string"!=typeof e){for(i in e)n.attr(i,e[i]);return n}if(r=n.attributes){if(t!==s){if(null===t){if(e in r.map)for(delete r.map[e],i=r.length;i--;)if(r[i].name===e)return r=r.splice(i,1),n;return n}if(e in r.map){for(i=r.length;i--;)if(r[i].name===e){r[i].value=t;break}}else r.push({name:e,value:t});return r.map[e]=t,n}return r.map[e]}},clone:function(){var e=this,n=new t(e.name,e.type),r,i,s,o,u;if(s=e.attributes){for(u=[],u.map={},r=0,i=s.length;i>r;r++)o=s[r],"id"!==o.name&&(u[u.length]={name:o.name,value:o.value},u.map[o.name]=o.value);n.attributes=u}return n.value=e.value,n.shortEnded=e.shortEnded,n},wrap:function(e){var t=this;return t.parent.insert(e,t),e.append(t),t},unwrap:function(){var e=this,t,n;for(t=e.firstChild;t;)n=t.next,e.insert(t,e,!0),t=n;e.remove()},remove:function(){var e=this,t=e.parent,n=e.next,r=e.prev;return t&&(t.firstChild===e?(t.firstChild=n,n&&(n.prev=null)):r.next=n,t.lastChild===e?(t.lastChild=r,r&&(r.next=null)):n.prev=r,e.parent=e.next=e.prev=null),e},append:function(e){var t=this,n;return e.parent&&e.remove(),n=t.lastChild,n?(n.next=e,e.prev=n,t.lastChild=e):t.lastChild=t.firstChild=e,e.parent=t,e},insert:function(e,t,n){var r;return e.parent&&e.remove(),r=t.parent||this,n?(t===r.firstChild?r.firstChild=e:t.prev.next=e,e.prev=t.prev,e.next=t,t.prev=e):(t===r.lastChild?r.lastChild=e:t.next.prev=e,e.next=t.next,e.prev=t,t.next=e),e.parent=r,e},getAll:function(t){var n=this,r,i=[];for(r=n.firstChild;r;r=e(r,n))r.name===t&&i.push(r);return i},empty:function(){var t=this,n,r,i;if(t.firstChild){for(n=[],i=t.firstChild;i;i=e(i,t))n.push(i);for(r=n.length;r--;)i=n[r],i.parent=i.firstChild=i.lastChild=i.next=i.prev=null}return t.firstChild=t.lastChild=null,t},isEmpty:function(t){var r=this,i=r.firstChild,s,o;if(i)do{if(1===i.type){if(i.attributes.map["data-mce-bogus"])continue;if(t[i.name])return!1;for(s=i.attributes.length;s--;)if(o=i.attributes[s].name,"name"===o||0===o.indexOf("data-mce-"))return!1}if(8===i.type)return!1;if(3===i.type&&!n.test(i.value))return!1}while(i=e(i,r));return!0},walk:function(t){return e(this,null,t)}},t.create=function(e,n){var i,s;if(i=new t(e,r[e]||1),n)for(s in n)i.attr(s,n[s]);return i},t}),r(E,[p],function(e){function t(e,t){return e?e.split(t||" "):[]}function n(e){function n(e,n,r){function i(e){var t={},n,r;for(n=0,r=e.length;r>n;n++)t[e[n]]={};return t}var s,a,f,l=arguments;for(r=r||[],n=n||"","string"==typeof r&&(r=t(r)),a=3;a<l.length;a++)"string"==typeof l[a]&&(l[a]=t(l[a])),r.push.apply(r,l[a]);for(e=t(e),s=e.length;s--;)f=[].concat(u,t(n)),o[e[s]]={attributes:i(f),attributesOrder:f,children:i(r)}}function i(e,n){var r,i,s,u;for(e=t(e),r=e.length,n=t(n);r--;)for(i=o[e[r]],s=0,u=n.length;u>s;s++)i.attributes[n[s]]={},i.attributesOrder.push(n[s])}var o={},u,a,f,l,c,h,p;return r[e]?r[e]:(u=t("id accesskey class dir lang style tabindex title"),a=t("onabort onblur oncancel oncanplay oncanplaythrough onchange onclick onclose oncontextmenu oncuechange ondblclick ondrag ondragend ondragenter ondragleave ondragover ondragstart ondrop ondurationchange onemptied onended onerror onfocus oninput oninvalid onkeydown onkeypress onkeyup onload onloadeddata onloadedmetadata onloadstart onmousedown onmousemove onmouseout onmouseover onmouseup onmousewheel onpause onplay onplaying onprogress onratechange onreset onscroll onseeked onseeking onseeking onselect onshow onstalled onsubmit onsuspend ontimeupdate onvolumechange onwaiting"),f=t("address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul"),l=t("a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment"),"html4"!=e&&(u.push.apply(u,t("contenteditable contextmenu draggable dropzone hidden spellcheck translate")),f.push.apply(f,t("article aside details dialog figure header footer hgroup section nav")),l.push.apply(l,t("audio canvas command datalist mark meter output progress time wbr video ruby bdi keygen"))),"html5-strict"!=e&&(u.push("xml:lang"),p=t("acronym applet basefont big font strike tt"),l.push.apply(l,p),s(p,function(e){n(e,"",l)}),h=t("center dir isindex noframes"),f.push.apply(f,h),c=[].concat(f,l),s(h,function(e){n(e,"",c)})),c=c||[].concat(f,l),n("html","manifest","head body"),n("head","","base command link meta noscript script style title"),n("title hr noscript br"),n("base","href target"),n("link","href rel media hreflang type sizes hreflang"),n("meta","name http-equiv content charset"),n("style","media type scoped"),n("script","src async defer type charset"),n("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",c),n("address dt dd div caption","",c),n("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",l),n("blockquote","cite",c),n("ol","reversed start type","li"),n("ul","","li"),n("li","value",c),n("dl","","dt dd"),n("a","href target rel media hreflang type",l),n("q","cite",l),n("ins del","cite datetime",c),n("img","src alt usemap ismap width height"),n("iframe","src name width height",c),n("embed","src type width height"),n("object","data type typemustmatch name usemap form width height",c,"param"),n("param","name value"),n("map","name",c,"area"),n("area","alt coords shape href target rel media hreflang type"),n("table","border","caption colgroup thead tfoot tbody tr"+("html4"==e?" col":"")),n("colgroup","span","col"),n("col","span"),n("tbody thead tfoot","","tr"),n("tr","","td th"),n("td","colspan rowspan headers",c),n("th","colspan rowspan headers scope abbr",c),n("form","accept-charset action autocomplete enctype method name novalidate target",c),n("fieldset","disabled form name",c,"legend"),n("label","form for",l),n("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),n("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"==e?c:l),n("select","disabled form multiple name required size","option optgroup"),n("optgroup","disabled label","option"),n("option","disabled label selected value"),n("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),n("menu","type label",c,"li"),n("noscript","",c),"html4"!=e&&(n("wbr"),n("ruby","",l,"rt rp"),n("figcaption","",c),n("mark rt rp summary bdi","",l),n("canvas","width height",c),n("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height",c,"track source"),n("audio","src crossorigin preload autoplay mediagroup loop muted controls",c,"track source"),n("source","src type media"),n("track","kind src srclang label default"),n("datalist","",l,"option"),n("article section nav aside header footer","",c),n("hgroup","","h1 h2 h3 h4 h5 h6"),n("figure","",c,"figcaption"),n("time","datetime",l),n("dialog","open",c),n("command","type label icon disabled checked radiogroup command"),n("output","for form name",l),n("progress","value max",l),n("meter","value min max low high optimum",l),n("details","open",c,"summary"),n("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!=e&&(i("script","language xml:space"),i("style","xml:space"),i("object","declare classid codebase codetype archive standby align border hspace vspace"),i("param","valuetype type"),i("a","charset name rev shape coords"),i("br","clear"),i("applet","codebase archive code object alt name width height align hspace vspace"),i("img","name longdesc align border hspace vspace"),i("iframe","longdesc frameborder marginwidth marginheight scrolling align"),i("font basefont","size color face"),i("input","usemap align"),i("select","onchange"),i("textarea"),i("h1 h2 h3 h4 h5 h6 div p legend caption","align"),i("ul","type compact"),i("li","type"),i("ol dl menu dir","compact"),i("pre","width xml:space"),i("hr","align noshade size width"),i("isindex","prompt"),i("table","summary width frame rules cellspacing cellpadding align bgcolor"),i("col","width align char charoff valign"),i("colgroup","width align char charoff valign"),i("thead","align char charoff valign"),i("tr","align char charoff valign bgcolor"),i("th","axis align char charoff valign nowrap bgcolor width height"),i("form","accept"),i("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),i("tfoot","align char charoff valign"),i("tbody","align char charoff valign"),i("area","nohref"),i("body","background bgcolor text link vlink alink")),"html4"!=e&&(i("input button select textarea","autofocus"),i("input textarea","placeholder"),i("a","download"),i("link script img","crossorigin"),i("iframe","srcdoc sandbox seamless allowfullscreen")),s(t("a form meter progress dfn"),function(e){o[e]&&delete o[e].children[e]}),delete o.caption.children.table,r[e]=o,o)}var r={},i=e.makeMap,s=e.each,o=e.extend,u=e.explode,a=e.inArray;return function(e){function f(t,n,s){var u=e[t];return u?u=i(u,",",i(u.toUpperCase()," ")):(u=r[t],u||(u=i(n," ",i(n.toUpperCase()," ")),u=o(u,s),r[t]=u)),u}function l(e){return new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$")}function c(e){var n,r,s,o,u,f,c,h,p,d,v,m,y,w,E,S,x,T,N,C=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,k=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,L=/[*?+]/;if(e)for(e=t(e,","),g["@"]&&(S=g["@"].attributes,x=g["@"].attributesOrder),n=0,r=e.length;r>n;n++)if(u=C.exec(e[n])){if(w=u[1],p=u[2],E=u[3],h=u[5],m={},y=[],f={attributes:m,attributesOrder:y},"#"===w&&(f.paddEmpty=!0),"-"===w&&(f.removeEmpty=!0),"!"===u[4]&&(f.removeEmptyAttrs=!0),S){for(T in S)m[T]=S[T];y.push.apply(y,x)}if(h)for(h=t(h,"|"),s=0,o=h.length;o>s;s++)if(u=k.exec(h[s])){if(c={},v=u[1],d=u[2].replace(/::/g,":"),w=u[3],N=u[4],"!"===v&&(f.attributesRequired=f.attributesRequired||[],f.attributesRequired.push(d),c.required=!0),"-"===v){delete m[d],y.splice(a(y,d),1);continue}w&&("="===w&&(f.attributesDefault=f.attributesDefault||[],f.attributesDefault.push({name:d,value:N}),c.defaultValue=N),":"===w&&(f.attributesForced=f.attributesForced||[],f.attributesForced.push({name:d,value:N}),c.forcedValue=N),"<"===w&&(c.validValues=i(N,"?"))),L.test(d)?(f.attributePatterns=f.attributePatterns||[],c.pattern=l(d),f.attributePatterns.push(c)):(m[d]||y.push(d),m[d]=c)}S||"@"!=p||(S=m,x=y),E&&(f.outputName=p,g[E]=f),L.test(p)?(f.pattern=l(p),b.push(f)):g[p]=f}}function h(e){g={},b=[],c(e),s(E,function(e,t){y[t]=e.children})}function p(e){var n=/^(~)?(.+)$/;e&&s(t(e,","),function(e){var t=n.exec(e),r="~"===t[1],i=r?"span":"div",o=t[2];y[o]=y[i],A[o]=i,r||(C[o.toUpperCase()]={},C[o]={}),g[o]||(g[o]=g[i]),s(y,function(e){e[i]&&(e[o]=e[i])})})}function d(e){var n=/^([+\-]?)(\w+)\[([^\]]+)\]$/;e&&s(t(e,","),function(e){var r=n.exec(e),i,o;r&&(o=r[1],i=o?y[r[2]]:y[r[2]]={"#comment":{}},i=y[r[2]],s(t(r[3],"|"),function(e){"-"===o?delete i[e]:i[e]={}}))})}function v(e){var t=g[e],n;if(t)return t;for(n=b.length;n--;)if(t=b[n],t.pattern.test(e))return t}var m=this,g={},y={},b=[],w,E,S,x,T,N,C,k,L,A={},O={};e=e||{},E=n(e.schema),e.verify_html===!1&&(e.valid_elements="*[*]"),e.valid_styles&&(w={},s(e.valid_styles,function(e,t){w[t]=u(e)})),S=f("whitespace_elements","pre script noscript style textarea video audio iframe object"),x=f("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),T=f("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),N=f("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),k=f("non_empty_elements","td th iframe video audio object",T),L=f("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside nav figure"),C=f("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex samp option datalist select optgroup",L),s((e.special||"script noscript style textarea").split(" "),function(e){O[e]=new RegExp("</"+e+"[^>]*>","gi")}),e.valid_elements?h(e.valid_elements):(s(E,function(e,t){g[t]={attributes:e.attributes,attributesOrder:e.attributesOrder},y[t]=e.children}),"html5"!=e.schema&&s(t("strong/b em/i"),function(e){e=t(e,"/"),g[e[1]].outputName=e[0]}),g.img.attributesDefault=[{name:"alt",value:""}],s(t("ol ul sub sup blockquote span font a table tbody tr strong em b i"),function(e){g[e]&&(g[e].removeEmpty=!0)}),s(t("p h1 h2 h3 h4 h5 h6 th td pre div address caption"),function(e){g[e].paddEmpty=!0}),s(t("span"),function(e){g[e].removeEmptyAttrs=!0})),p(e.custom_elements),d(e.valid_children),c(e.extended_valid_elements),d("+ol[ul|ol],+ul[ul|ol]"),e.invalid_elements&&s(u(e.invalid_elements),function(e){g[e]&&delete g[e]}),v("span")||c("span[!data-mce-type|*]"),m.children=y,m.styles=w,m.getBoolAttrs=function(){return N},m.getBlockElements=function(){return C},m.getTextBlockElements=function(){return L},m.getShortEndedElements=function(){return T},m.getSelfClosingElements=function(){return x},m.getNonEmptyElements=function(){return k},m.getWhiteSpaceElements=function(){return S},m.getSpecialElements=function(){return O},m.isValidChild=function(e,t){var n=y[e];return!!n&&!!n[t]},m.isValid=function(e,t){var n,r,i=v(e);if(i){if(!t)return!0;if(i.attributes[t])return!0;if(n=i.attributePatterns)for(r=n.length;r--;)if(n[r].pattern.test(e))return!0}return!1},m.getElementRule=v,m.getCustomElements=function(){return A},m.addValidElements=c,m.setValidElements=h,m.addCustomElements=p,m.addValidChildren=d,m.elements=g}}),r(S,[E,v,p],function(e,t,n){var r=n.each;return function(n,i){var s=this,o=function(){};n=n||{},s.schema=i=i||new e,n.fix_self_closing!==!1&&(n.fix_self_closing=!0),r("comment cdata text start end pi doctype".split(" "),function(e){e&&(s[e]=n[e]||o)}),s.parse=function(e){function r(e){var t,n;for(t=c.length;t--&&c[t].name!==e;);if(t>=0){for(n=c.length-1;n>=t;n--)e=c[n],e.valid&&o.end(e.name);c.length=t}}function s(e,t,n,r,i){var s,o;if(t=t.toLowerCase(),n=t in b?t:F(n||r||i||""),E&&!m&&0!==t.indexOf("data-")){if(s=C[t],!s&&k){for(o=k.length;o--&&(s=k[o],!s.pattern.test(t)););-1===o&&(s=null)}if(!s)return;if(s.validValues&&!(n in s.validValues))return}h.map[t]=n,h.push({name:t,value:n})}var o=this,u,a=0,f,l,c=[],h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j=0,F=t.decode,I;for(D=new RegExp("<(?:(?:!--([\\w\\W]*?)-->)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([A-Za-z0-9\\-\\:\\.]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),P=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,y=i.getShortEndedElements(),_=n.self_closing_elements||i.getSelfClosingElements(),b=i.getBoolAttrs(),E=n.validate,g=n.remove_internals,I=n.fix_self_closing,H=i.getSpecialElements();u=D.exec(e);){if(a<u.index&&o.text(F(e.substr(a,u.index-a))),f=u[6])f=f.toLowerCase(),":"===f.charAt(0)&&(f=f.substr(1)),r(f);else if(f=u[7]){if(f=f.toLowerCase(),":"===f.charAt(0)&&(f=f.substr(1)),w=f in y,I&&_[f]&&c.length>0&&c[c.length-1].name===f&&r(f),!E||(S=i.getElementRule(f))){if(x=!0,E&&(C=S.attributes,k=S.attributePatterns),(N=u[8])?(m=-1!==N.indexOf("data-mce-type"),m&&g&&(x=!1),h=[],h.map={},N.replace(P,s)):(h=[],h.map={}),E&&!m){if(L=S.attributesRequired,A=S.attributesDefault,O=S.attributesForced,M=S.removeEmptyAttrs,M&&!h.length&&(x=!1),O)for(p=O.length;p--;)T=O[p],v=T.name,B=T.value,"{$uid}"===B&&(B="mce_"+j++),h.map[v]=B,h.push({name:v,value:B});if(A)for(p=A.length;p--;)T=A[p],v=T.name,v in h.map||(B=T.value,"{$uid}"===B&&(B="mce_"+j++),h.map[v]=B,h.push({name:v,value:B}));if(L){for(p=L.length;p--&&!(L[p]in h.map););-1===p&&(x=!1)}h.map["data-mce-bogus"]&&(x=!1)}x&&o.start(f,h,w)}else x=!1;if(l=H[f]){l.lastIndex=a=u.index+u[0].length,(u=l.exec(e))?(x&&(d=e.substr(a,u.index-a)),a=u.index+u[0].length):(d=e.substr(a),a=e.length),x&&(d.length>0&&o.text(d,!0),o.end(f)),D.lastIndex=a;continue}w||(N&&N.indexOf("/")==N.length-1?x&&o.end(f):c.push({name:f,valid:x}))}else(f=u[1])?o.comment(f):(f=u[2])?o.cdata(f):(f=u[3])?o.doctype(f):(f=u[4])&&o.pi(f,u[5]);a=u.index+u[0].length}for(a<e.length&&o.text(F(e.substr(a))),p=c.length-1;p>=0;p--)f=c[p],f.valid&&o.end(f.name)}}}),r(x,[w,E,S,p],function(e,t,n,r){var i=r.makeMap,s=r.each,o=r.explode,u=r.extend;return function(r,a){function f(t){var n,r,s,o,u,f,c,h,p,d,v,m,g,y;for(v=i("tr,td,th,tbody,thead,tfoot,table"),d=a.getNonEmptyElements(),m=a.getTextBlockElements(),n=0;n<t.length;n++)if(r=t[n],r.parent&&!r.fixed)if(m[r.name]&&"li"==r.parent.name){for(g=r.next;g&&m[g.name];)g.name="li",g.fixed=!0,r.parent.insert(g,r.parent),g=g.next;r.unwrap(r)}else{for(o=[r],s=r.parent;s&&!a.isValidChild(s.name,r.name)&&!v[s.name];s=s.parent)o.push(s);if(s&&o.length>1){for(o.reverse(),u=f=l.filterNode(o[0].clone()),p=0;p<o.length-1;p++){for(a.isValidChild(f.name,o[p].name)?(c=l.filterNode(o[p].clone()),f.append(c)):c=f,h=o[p].firstChild;h&&h!=o[p+1];)y=h.next,c.append(h),h=y;f=c}u.isEmpty(d)?s.insert(r,o[0],!0):(s.insert(u,o[0],!0),s.insert(r,u)),s=o[0],(s.isEmpty(d)||s.firstChild===s.lastChild&&"br"===s.firstChild.name)&&s.empty().remove()}else if(r.parent){if("li"===r.name){if(g=r.prev,!g||"ul"!==g.name&&"ul"!==g.name){if(g=r.next,!g||"ul"!==g.name&&"ul"!==g.name){r.wrap(l.filterNode(new e("ul",1)));continue}g.insert(r,g.firstChild,!0);continue}g.append(r);continue}a.isValidChild(r.parent.name,"div")&&a.isValidChild("div",r.name)?r.wrap(l.filterNode(new e("div",1))):"style"===r.name||"script"===r.name?r.empty().remove():r.unwrap()}}}var l=this,c={},h=[],p={},d={};r=r||{},r.validate="validate"in r?r.validate:!0,r.root_name=r.root_name||"body",l.schema=a=a||new t,l.filterNode=function(e){var t,n,r;n in c&&(r=p[n],r?r.push(e):p[n]=[e]),t=h.length;for(;t--;)n=h[t].name,n in e.attributes.map&&(r=d[n],r?r.push(e):d[n]=[e]);return e},l.addNodeFilter=function(e,t){s(o(e),function(e){var n=c[e];n||(c[e]=n=[]),n.push(t)})},l.addAttributeFilter=function(e,t){s(o(e),function(e){var n;for(n=0;n<h.length;n++)if(h[n].name===e)return h[n].callbacks.push(t),void 0;h.push({name:e,callbacks:[t]})})},l.parse=function(t,s){function o(){function e(e){e&&(t=e.firstChild,t&&3==t.type&&(t.value=t.value.replace(A,"")),t=e.lastChild,t&&3==t.type&&(t.value=t.value.replace(_,"")))}var t=y.firstChild,n,r;if(a.isValidChild(y.name,F.toLowerCase())){for(;t;)n=t.next,3==t.type||1==t.type&&"p"!==t.name&&!L[t.name]&&!t.attr("data-mce-type")?r?r.append(t):(r=l(F,1),y.insert(r,t),r.append(t)):(e(r),r=null),t=n;e(r)}}function l(t,n){var r=new e(t,n),i;return t in c&&(i=p[t],i?i.push(r):p[t]=[r]),r}function v(e){var t,n,r;for(t=e.prev;t&&3===t.type;)n=t.value.replace(_,""),n.length>0?(t.value=n,t=t.prev):(r=t.prev,t.remove(),t=r)}function m(e){var t,n={};for(t in e)"li"!==t&&"p"!=t&&(n[t]=e[t]);return n}var g,y,b,w,E,S,x,T,N,C,k,L,A,O=[],M,_,D,P,H,B,j,F;if(s=s||{},p={},d={},L=u(i("script,style,head,html,body,title,meta,param"),a.getBlockElements()),j=a.getNonEmptyElements(),B=a.children,k=r.validate,F="forced_root_block"in s?s.forced_root_block:r.forced_root_block,H=a.getWhiteSpaceElements(),A=/^[ \t\r\n]+/,_=/[ \t\r\n]+$/,D=/[ \t\r\n]+/g,P=/^[ \t\r\n]+$/,g=new n({validate:k,self_closing_elements:m(a.getSelfClosingElements()),cdata:function(e){b.append(l("#cdata",4)).value=e},text:function(e,t){var n;M||(e=e.replace(D," "),b.lastChild&&L[b.lastChild.name]&&(e=e.replace(A,""))),0!==e.length&&(n=l("#text",3),n.raw=!!t,b.append(n).value=e)},comment:function(e){b.append(l("#comment",8)).value=e},pi:function(e,t){b.append(l(e,7)).value=t,v(b)},doctype:function(e){var t;t=b.append(l("#doctype",10)),t.value=e,v(b)},start:function(e,t,n){var r,i,s,o,u;if(s=k?a.getElementRule(e):{}){for(r=l(s.outputName||e,1),r.attributes=t,r.shortEnded=n,b.append(r),u=B[b.name],u&&B[r.name]&&!u[r.name]&&O.push(r),i=h.length;i--;)o=h[i].name,o in t.map&&(N=d[o],N?N.push(r):d[o]=[r]);L[e]&&v(r),n||(b=r),!M&&H[e]&&(M=!0)}},end:function(t){var n,r,i,s,o;if(r=k?a.getElementRule(t):{}){if(L[t]&&!M){if(n=b.firstChild,n&&3===n.type)if(i=n.value.replace(A,""),i.length>0)n.value=i,n=n.next;else for(s=n.next,n.remove(),n=s;n&&3===n.type;)i=n.value,s=n.next,(0===i.length||P.test(i))&&(n.remove(),n=s),n=s;if(n=b.lastChild,n&&3===n.type)if(i=n.value.replace(_,""),i.length>0)n.value=i,n=n.prev;else for(s=n.prev,n.remove(),n=s;n&&3===n.type;)i=n.value,s=n.prev,(0===i.length||P.test(i))&&(n.remove(),n=s),n=s}if(M&&H[t]&&(M=!1),(r.removeEmpty||r.paddEmpty)&&b.isEmpty(j))if(r.paddEmpty)b.empty().append(new e("#text","3")).value="";else if(!b.attributes.map.name&&!b.attributes.map.id)return o=b.parent,b.empty().remove(),b=o,void 0;b=b.parent}}},a),y=b=new e(s.context||r.root_name,11),g.parse(t),k&&O.length&&(s.context?s.invalid=!0:f(O)),F&&("body"==y.name||s.isRootContent)&&o(),!s.invalid){for(C in p){for(N=c[C],w=p[C],x=w.length;x--;)w[x].parent||w.splice(x,1);for(E=0,S=N.length;S>E;E++)N[E](w,C,s)}for(E=0,S=h.length;S>E;E++)if(N=h[E],N.name in d){for(w=d[N.name],x=w.length;x--;)w[x].parent||w.splice(x,1);for(x=0,T=N.callbacks.length;T>x;x++)N.callbacks[x](w,N.name,s)}}return y},r.remove_trailing_brs&&l.addNodeFilter("br",function(t){var n,r=t.length,i,s=u({},a.getBlockElements()),o=a.getNonEmptyElements(),f,l,c,h,p,d;for(s.body=1,n=0;r>n;n++)if(i=t[n],f=i.parent,s[i.parent.name]&&i===f.lastChild){for(c=i.prev;c;){if(h=c.name,"span"!==h||"bookmark"!==c.attr("data-mce-type")){if("br"!==h)break;if("br"===h){i=null;break}}c=c.prev}i&&(i.remove(),f.isEmpty(o)&&(p=a.getElementRule(f.name),p&&(p.removeEmpty?f.remove():p.paddEmpty&&(f.empty().append(new e("#text",3)).value=""))))}else{for(l=i;f&&f.firstChild===l&&f.lastChild===l&&(l=f,!s[f.name]);)f=f.parent;l===f&&(d=new e("#text",3),d.value="",i.replace(d))}}),r.allow_html_in_named_anchor||l.addAttributeFilter("id,name",function(e){for(var t=e.length,n,r,i,s;t--;)if(s=e[t],"a"===s.name&&s.firstChild&&!s.attr("href")){i=s.parent,n=s.lastChild;do r=n.prev,i.insert(n,s),n=r;while(n)}})}}),r(T,[v,p],function(e,t){var n=t.makeMap;return function(t){var r=[],i,s,o,u,a;return t=t||{},i=t.indent,s=n(t.indent_before||""),o=n(t.indent_after||""),u=e.getEncodeFunc(t.entity_encoding||"raw",t.entities),a="html"==t.element_format,{start:function(e,t,n){var f,l,c,h;if(i&&s[e]&&r.length>0&&(h=r[r.length-1],h.length>0&&"\n"!==h&&r.push("\n")),r.push("<",e),t)for(f=0,l=t.length;l>f;f++)c=t[f],r.push(" ",c.name,'="',u(c.value,!0),'"');r[r.length]=!n||a?">":" />",n&&i&&o[e]&&r.length>0&&(h=r[r.length-1],h.length>0&&"\n"!==h&&r.push("\n"))},end:function(e){var t;r.push("</",e,">"),i&&o[e]&&r.length>0&&(t=r[r.length-1],t.length>0&&"\n"!==t&&r.push("\n"))},text:function(e,t){e.length>0&&(r[r.length]=t?e:u(e))},cdata:function(e){r.push("<![CDATA[",e,"]]>")},comment:function(e){r.push("<!--",e,"-->")},pi:function(e,t){t?r.push("<?",e," ",t,"?>"):r.push("<?",e,"?>"),i&&r.push("\n")},doctype:function(e){r.push("<!DOCTYPE",e,">",i?"\n":"")},reset:function(){r.length=0},getContent:function(){return r.join("").replace(/\n$/,"")}}}}),r(N,[T,E],function(e,t){return function(n,r){var i=this,s=new e(n);n=n||{},n.validate="validate"in n?n.validate:!0,i.schema=r=r||new t,i.writer=s,i.serialize=function(e){function t(e){var n=i[e.type],u,a,f,l,c,h,p,d,v;if(n)n(e);else{if(u=e.name,a=e.shortEnded,f=e.attributes,o&&f&&f.length>1){for(h=[],h.map={},v=r.getElementRule(e.name),p=0,d=v.attributesOrder.length;d>p;p++)l=v.attributesOrder[p],l in f.map&&(c=f.map[l],h.map[l]=c,h.push({name:l,value:c}));for(p=0,d=f.length;d>p;p++)l=f[p].name,l in h.map||(c=f.map[l],h.map[l]=c,h.push({name:l,value:c}));f=h}if(s.start(e.name,f,a),!a){if(e=e.firstChild)do t(e);while(e=e.next);s.end(u)}}}var i,o;return o=n.validate,i={3:function(e){s.text(e.value,e.raw)},8:function(e){s.comment(e.value)},7:function(e){s.pi(e.name,e.value)},10:function(e){s.doctype(e.value)},4:function(e){s.cdata(e.value)},11:function(e){if(e=e.firstChild)do t(e);while(e=e.next)}},s.reset(),1!=e.type||n.inner?i[11](e):t(e),s.getContent()}}}),r(C,[g,x,v,N,w,E,m,p],function(e,t,n,r,i,s,o,u){var a=u.each,f=u.trim,l=e.DOM;return function(e,i){var u,c,h;return i&&(u=i.dom,c=i.schema),u=u||l,c=c||new s(e),e.entity_encoding=e.entity_encoding||"named",e.remove_trailing_brs="remove_trailing_brs"in e?e.remove_trailing_brs:!0,h=new t(e,c),h.addAttributeFilter("src,href,style",function(t,n){for(var r=t.length,i,s,o="data-mce-"+n,a=e.url_converter,f=e.url_converter_scope,l;r--;)i=t[r],s=i.attributes.map[o],s!==l?(i.attr(n,s.length>0?s:null),i.attr(o,null)):(s=i.attributes.map[n],"style"===n?s=u.serializeStyle(u.parseStyle(s),i.name):a&&(s=a.call(f,s,n,i.name)),i.attr(n,s.length>0?s:null))}),h.addAttributeFilter("class",function(e){for(var t=e.length,n,r;t--;)n=e[t],r=n.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),n.attr("class",r.length>0?r:null)}),h.addAttributeFilter("data-mce-type",function(e,t,n){for(var r=e.length,i;r--;)i=e[r],"bookmark"!==i.attributes.map["data-mce-type"]||n.cleanup||i.remove()}),h.addAttributeFilter("data-mce-expando",function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}),h.addNodeFilter("noscript",function(e){for(var t=e.length,r;t--;)r=e[t].firstChild,r&&(r.value=n.decode(r.value))}),h.addNodeFilter("script,style",function(e,t){function n(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")}for(var r=e.length,i,s;r--;)i=e[r],s=i.firstChild?i.firstChild.value:"","script"===t?(i.attr("type",(i.attr("type")||"text/javascript").replace(/^mce\-/,"")),s.length>0&&(i.firstChild.value="// <![CDATA[\n"+n(s)+"\n// ]]>")):s.length>0&&(i.firstChild.value="<!--\n"+n(s)+"\n-->")}),h.addNodeFilter("#comment",function(e){for(var t=e.length,n;t--;)n=e[t],0===n.value.indexOf("[CDATA[")?(n.name="#cdata",n.type=4,n.value=n.value.replace(/^\[CDATA\[|\]\]$/g,"")):0===n.value.indexOf("mce:protected ")&&(n.name="#text",n.type=3,n.raw=!0,n.value=unescape(n.value).substr(14))}),h.addNodeFilter("xml:namespace,input",function(e,t){for(var n=e.length,r;n--;)r=e[n],7===r.type?r.remove():1===r.type&&("input"!==t||"type"in r.attributes.map||r.attr("type","text"))}),e.fix_list_elements&&h.addNodeFilter("ul,ol",function(e){for(var t=e.length,n,r;t--;)n=e[t],r=n.parent,("ul"===r.name||"ol"===r.name)&&n.prev&&"li"===n.prev.name&&n.prev.append(n)}),h.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected",function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}),{schema:c,addNodeFilter:h.addNodeFilter,addAttributeFilter:h.addAttributeFilter,serialize:function(t,n){var i=this,s,l,p,d,v;return o.ie&&u.select("script,style,select,map").length>0?(v=t.innerHTML,t=t.cloneNode(!1),u.setHTML(t,v)):t=t.cloneNode(!0),s=t.ownerDocument.implementation,s.createHTMLDocument&&(l=s.createHTMLDocument(""),a("BODY"==t.nodeName?t.childNodes:[t],function(e){l.body.appendChild(l.importNode(e,!0))}),t="BODY"!=t.nodeName?l.body.firstChild:l.body,p=u.doc,u.doc=l),n=n||{},n.format=n.format||"html",n.selection&&(n.forced_root_block=""),n.no_events||(n.node=t,i.onPreProcess(n)),d=new r(e,c),n.content=d.serialize(h.parse(f(n.getInner?t.innerHTML:u.getOuterHTML(t)),n)),n.cleanup||(n.content=n.content.replace(/\uFEFF/g,"")),n.no_events||i.onPostProcess(n),p&&(u.doc=p),n.node=null,n.content},addRules:function(e){c.addValidElements(e)},setRules:function(e){c.setValidElements(e)},onPreProcess:function(e){i&&i.fire("PreProcess",e)},onPostProcess:function(e){i&&i.fire("PostProcess",e)}}}}),r(k,[],function(){function e(e){function t(t,n){var r,i=0,s,o,u,a,f,l,c=-1,h;if(r=t.duplicate(),r.collapse(n),h=r.parentElement(),h.ownerDocument===e.dom.doc){for(;"false"===h.contentEditable;)h=h.parentNode;if(!h.hasChildNodes())return{node:h,inside:1};for(u=h.children,s=u.length-1;s>=i;)if(l=Math.floor((i+s)/2),a=u[l],r.moveToElementText(a),c=r.compareEndPoints(n?"StartToStart":"EndToEnd",t),c>0)s=l-1;else{if(!(0>c))return{node:a};i=l+1}if(0>c)for(a?r.collapse(!1):(r.moveToElementText(h),r.collapse(!0),a=h,o=!0),f=0;0!==r.compareEndPoints(n?"StartToStart":"StartToEnd",t)&&0!==r.move("character",1)&&h==r.parentElement();)f++;else for(r.collapse(!0),f=0;0!==r.compareEndPoints(n?"StartToStart":"StartToEnd",t)&&0!==r.move("character",-1)&&h==r.parentElement();)f++;return{node:a,position:c,offset:f,inside:o}}}function n(){function n(e){var n=t(s,e),r,i,u=0,a,f,l;if(r=n.node,i=n.offset,n.inside&&!r.hasChildNodes())return o[e?"setStart":"setEnd"](r,0),void 0;if(i===f)return o[e?"setStartBefore":"setEndAfter"](r),void 0;if(n.position<0){if(a=n.inside?r.firstChild:r.nextSibling,!a)return o[e?"setStartAfter":"setEndAfter"](r),void 0;if(!i)return 3==a.nodeType?o[e?"setStart":"setEnd"](a,0):o[e?"setStartBefore":"setEndBefore"](a),void 0;for(;a;){if(l=a.nodeValue,u+=l.length,u>=i){r=a,u-=i,u=l.length-u;break}a=a.nextSibling}}else{if(a=r.previousSibling,!a)return o[e?"setStartBefore":"setEndBefore"](r);if(!i)return 3==r.nodeType?o[e?"setStart":"setEnd"](a,r.nodeValue.length):o[e?"setStartAfter":"setEndAfter"](a),void 0;for(;a;){if(u+=a.nodeValue.length,u>=i){r=a,u-=i;break}a=a.previousSibling}}o[e?"setStart":"setEnd"](r,u)}var s=e.getRng(),o=i.createRng(),u,a,f,l,c;if(u=s.item?s.item(0):s.parentElement(),u.ownerDocument!=i.doc)return o;if(a=e.isCollapsed(),s.item)return o.setStart(u.parentNode,i.nodeIndex(u)),o.setEnd(o.startContainer,o.startOffset+1),o;try{n(!0),a||n()}catch(h){if(-2147024809!=h.number)throw h;c=r.getBookmark(2),f=s.duplicate(),f.collapse(!0),u=f.parentElement(),a||(f=s.duplicate(),f.collapse(!1),l=f.parentElement(),l.innerHTML=l.innerHTML),u.innerHTML=u.innerHTML,r.moveToBookmark(c),s=e.getRng(),n(!0),a||n()}return o}var r=this,i=e.dom,s=!1;this.getBookmark=function(n){function r(e){var t,n,r,s,o=[];for(t=e.parentNode,n=i.getRoot().parentNode;t!=n&&9!==t.nodeType;){for(r=t.children,s=r.length;s--;)if(e===r[s]){o.push(s);break}e=t,t=t.parentNode}return o}function s(e){var n;return n=t(o,e),n?{position:n.position,offset:n.offset,indexes:r(n.node),inside:n.inside}:void 0}var o=e.getRng(),u={};return 2===n&&(o.item?u.start={ctrl:!0,indexes:r(o.item(0))}:(u.start=s(!0),e.isCollapsed()||(u.end=s()))),u},this.moveToBookmark=function(e){function t(e){var t,n,r,s;for(t=i.getRoot(),n=e.length-1;n>=0;n--)s=t.children,r=e[n],r<=s.length-1&&(t=s[r]);return t}function n(n){var i=e[n?"start":"end"],o,u,a,f;i&&(o=i.position>0,u=s.createTextRange(),u.moveToElementText(t(i.indexes)),f=i.offset,f!==a?(u.collapse(i.inside||o),u.moveStart("character",o?-f:f)):u.collapse(n),r.setEndPoint(n?"StartToStart":"EndToStart",u),n&&r.collapse(!0))}var r,s=i.doc.body;e.start&&(e.start.ctrl?(r=s.createControlRange(),r.addElement(t(e.start.indexes)),r.select()):(r=s.createTextRange(),n(!0),n(),r.select()))},this.addRange=function(t){function n(e){var t,n,o,c,d;o=i.create("a"),t=e?u:f,n=e?a:l,c=r.duplicate(),(t==h||t==h.documentElement)&&(t=p,n=0),3==t.nodeType?(t.parentNode.insertBefore(o,t),c.moveToElementText(o),c.moveStart("character",n),i.remove(o),r.setEndPoint(e?"StartToStart":"EndToEnd",c)):(d=t.childNodes,d.length?(n>=d.length?i.insertAfter(o,d[d.length-1]):t.insertBefore(o,d[n]),c.moveToElementText(o)):t.canHaveHTML&&(t.innerHTML="<span>&#xFEFF;</span>",o=t.firstChild,c.moveToElementText(o),c.collapse(s)),r.setEndPoint(e?"StartToStart":"EndToEnd",c),i.remove(o))}var r,o,u,a,f,l,c,h=e.dom.doc,p=h.body,d,v;if(u=t.startContainer,a=t.startOffset,f=t.endContainer,l=t.endOffset,r=p.createTextRange(),u==f&&1==u.nodeType){if(a==l&&!u.hasChildNodes()){if(u.canHaveHTML)return c=u.previousSibling,c&&!c.hasChildNodes()&&i.isBlock(c)?c.innerHTML="&#xFEFF;":c=null,u.innerHTML="<span>&#xFEFF;</span><span>&#xFEFF;</span>",r.moveToElementText(u.lastChild),r.select(),i.doc.selection.clear(),u.innerHTML="",c&&(c.innerHTML=""),void 0;a=i.nodeIndex(u),u=u.parentNode}if(a==l-1)try{if(v=u.childNodes[a],o=p.createControlRange(),o.addElement(v),o.select(),d=e.getRng(),d.item&&v===d.item(0))return}catch(m){}}n(!0),n(),r.select()},this.getRangeAt=n}return e}),r(L,[m],function(e){return{BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey},metaKeyPressed:function(t){return(e.mac?t.ctrlKey||t.metaKey:t.ctrlKey)&&!t.altKey}}}),r(A,[L,p,m],function(e,t,n){return function(r,i){function s(e){return i.settings.object_resizing===!1?!1:/TABLE|IMG|DIV/.test(e.nodeName)?"false"===e.getAttribute("data-mce-resize")?!1:!0:!1}function o(t){var n,r;n=t.screenX-N,r=t.screenY-C,D=n*T[2]+A,P=r*T[3]+O,D=5>D?5:D,P=5>P?5:P,(e.modifierPressed(t)||"IMG"==E.nodeName&&0!==T[2]*T[3])&&(D=Math.round(P/M),P=Math.round(D*M)),b.setStyles(S,{width:D,height:P}),T[2]<0&&S.clientWidth<=D&&b.setStyle(S,"left",k+(A-D)),T[3]<0&&S.clientHeight<=P&&b.setStyle(S,"top",L+(O-P)),_||(i.fire("ObjectResizeStart",{target:E,width:A,height:O}),_=!0)}function u(){function e(e,t){t&&(E.style[e]||!i.schema.isValid(E.nodeName.toLowerCase(),e)?b.setStyle(E,e,t):b.setAttrib(E,e,t))}_=!1,e("width",D),e("height",P),b.unbind(H,"mousemove",o),b.unbind(H,"mouseup",u),B!=H&&(b.unbind(B,"mousemove",o),b.unbind(B,"mouseup",u)),b.remove(S),j&&"TABLE"!=E.nodeName||a(E),i.fire("ObjectResized",{target:E,width:D,height:P}),i.nodeChanged()}function a(e,t,n){var r,a,l,c,h;r=b.getPos(e,i.getBody()),k=r.x,L=r.y,h=e.getBoundingClientRect(),a=h.width||h.right-h.left,l=h.height||h.bottom-h.top,E!=e&&(v(),E=e,D=P=0),c=i.fire("ObjectSelected",{target:e}),s(e)&&!c.isDefaultPrevented()?w(x,function(e,r){function s(t){_=!0,N=t.screenX,C=t.screenY,A=E.clientWidth,O=E.clientHeight,M=O/A,T=e,S=E.cloneNode(!0),b.addClass(S,"mce-clonedresizable"),S.contentEditable=!1,S.unSelectabe=!0,b.setStyles(S,{left:k,top:L,margin:0}),S.removeAttribute("data-mce-selected"),i.getBody().appendChild(S),b.bind(H,"mousemove",o),b.bind(H,"mouseup",u),B!=H&&(b.bind(B,"mousemove",o),b.bind(B,"mouseup",u))}var f,c;return t?(r==t&&s(n),void 0):(f=b.get("mceResizeHandle"+r),f?b.show(f):(c=i.getBody(),f=b.add(c,"div",{id:"mceResizeHandle"+r,"data-mce-bogus":!0,"class":"mce-resizehandle",contentEditable:!1,unSelectabe:!0,style:"cursor:"+r+"-resize; margin:0; padding:0"}),b.bind(f,"mousedown",function(e){e.preventDefault(),s(e)})),b.setStyles(f,{left:a*e[0]+k-f.offsetWidth/2,top:l*e[1]+L-f.offsetHeight/2}),void 0)}):f(),E.setAttribute("data-mce-selected","1")}function f(){var e,t;E&&E.removeAttribute("data-mce-selected");for(e in x)t=b.get("mceResizeHandle"+e),t&&(b.unbind(t),b.remove(t))}function l(e){function t(e,t){do if(e===t)return!0;while(e=e.parentNode)}var n;return w(b.select("img[data-mce-selected],hr[data-mce-selected]"),function(e){e.removeAttribute("data-mce-selected")}),n="mousedown"==e.type?e.target:r.getNode(),n=b.getParent(n,j?"table":"table,img,hr"),n&&(m(),t(r.getStart(),n)&&t(r.getEnd(),n)&&(!j||n!=r.getStart()&&"IMG"!==r.getStart().nodeName))?(a(n),void 0):(f(),void 0)}function c(e,t,n){e&&e.attachEvent&&e.attachEvent("on"+t,n)}function h(e,t,n){e&&e.detachEvent&&e.detachEvent("on"+t,n)}function p(e){var t=e.srcElement,n,r,s,o,u,f,l;n=t.getBoundingClientRect(),f=e.clientX-n.left,l=e.clientY-n.top;for(r in x)if(s=x[r],o=t.offsetWidth*s[0],u=t.offsetHeight*s[1],Math.abs(o-f)<8&&Math.abs(u-l)<8){T=s;break}_=!0,i.getDoc().selection.empty(),a(t,r,e)}function d(e){var t=e.srcElement;if(t!=E){if(v(),0===t.id.indexOf("mceResizeHandle"))return e.returnValue=!1,void 0;("IMG"==t.nodeName||"TABLE"==t.nodeName)&&(f(),E=t,c(t,"resizestart",p))}}function v(){h(E,"resizestart",p)}function m(){try{i.getDoc().execCommand("enableObjectResizing",!1,!1)}catch(e){}}function g(e){var t;if(j){t=H.body.createControlRange();try{return t.addElement(e),t.select(),!0}catch(n){}}}function y(){E=S=null,j&&(v(),h(i.getBody(),"controlselect",d))}var b=i.dom,w=t.each,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H=i.getDoc(),B=document,j=n.ie;x={n:[.5,0,0,-1],e:[1,.5,1,0],s:[.5,1,0,1],w:[0,.5,-1,0],nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var F=".mce-content-body";return i.contentStyles.push(F+" div.mce-resizehandle {"+"position: absolute;"+"border: 1px solid black;"+"background: #FFF;"+"width: 5px;"+"height: 5px;"+"z-index: 10000"+"}"+F+" .mce-resizehandle:hover {"+"background: #000"+"}"+F+" img[data-mce-selected], hr[data-mce-selected] {"+"outline: 1px solid black;"+"resize: none"+"}"+F+" .mce-clonedresizable {"+"position: absolute;"+(n.gecko?"":"outline: 1px dashed black;")+"opacity: .5;"+"filter: alpha(opacity=50);"+"z-index: 10000"+"}"),i.on("init",function(){j?(i.on("ObjectResized",function(e){"TABLE"!=e.target.nodeName&&(f(),g(e.target))}),c(i.getBody(),"controlselect",d)):m(),i.on("nodechange mousedown ResizeEditor",l),i.on("keydown keyup",function(e){E&&"TABLE"==E.nodeName&&l(e)})}),{controlSelect:g,destroy:y}}}),r(O,[h,k,A,m,p],function(e,n,r,i,s){function o(e,t,i,s){var o=this;o.dom=e,o.win=t,o.serializer=i,o.editor=s,o.controlSelection=new r(o,s),o.win.getSelection||(o.tridentSel=new n(o))}var u=s.each,a=s.grep,f=s.trim,l=i.ie,c=i.opera;return o.prototype={setCursorLocation:function(e,t){var n=this,r=n.dom.createRng();r.setStart(e,t),r.setEnd(e,t),n.setRng(r),n.collapse(!1)},getContent:function(e){var n=this,r=n.getRng(),i=n.dom.create("body"),s=n.getSel(),o,u,a;return e=e||{},o=u="",e.get=!0,e.format=e.format||"html",e.selection=!0,n.editor.fire("BeforeGetContent",e),"text"==e.format?n.isCollapsed()?"":r.text||(s.toString?s.toString():""):(r.cloneContents?(a=r.cloneContents(),a&&i.appendChild(a)):r.item!==t||r.htmlText!==t?(i.innerHTML="<br>"+(r.item?r.item(0).outerHTML:r.htmlText),i.removeChild(i.firstChild)):i.innerHTML=r.toString(),/^\s/.test(i.innerHTML)&&(o=" "),/\s+$/.test(i.innerHTML)&&(u=" "),e.getInner=!0,e.content=n.isCollapsed()?"":o+n.serializer.serialize(i,e)+u,n.editor.fire("GetContent",e),e.content)},setContent:function(e,t){var n=this,r=n.getRng(),i,s=n.win.document,o,u;if(t=t||{format:"html"},t.set=!0,t.selection=!0,e=t.content=e,t.no_events||n.editor.fire("BeforeSetContent",t),e=t.content,r.insertNode){e+='<span id="__caret">_</span>',r.startContainer==s&&r.endContainer==s?s.body.innerHTML=e:(r.deleteContents(),0===s.body.childNodes.length?s.body.innerHTML=e:r.createContextualFragment?r.insertNode(r.createContextualFragment(e)):(o=s.createDocumentFragment(),u=s.createElement("div"),o.appendChild(u),u.outerHTML=e,r.insertNode(o))),i=n.dom.get("__caret"),r=s.createRange(),r.setStartBefore(i),r.setEndBefore(i),n.setRng(r),n.dom.remove("__caret");try{n.setRng(r)}catch(a){}}else r.item&&(s.execCommand("Delete",!1,null),r=n.getRng()),/^\s+/.test(e)?(r.pasteHTML('<span id="__mce_tmp">_</span>'+e),n.dom.remove("__mce_tmp")):r.pasteHTML(e);t.no_events||n.editor.fire("SetContent",t)},getStart:function(){var e=this,t=e.getRng(),n,r,i,s;if(t.duplicate||t.item){if(t.item)return t.item(0);for(i=t.duplicate(),i.collapse(1),n=i.parentElement(),n.ownerDocument!==e.dom.doc&&(n=e.dom.getRoot()),r=s=t.parentElement();s=s.parentNode;)if(s==n){n=r;break}return n}return n=t.startContainer,1==n.nodeType&&n.hasChildNodes()&&(n=n.childNodes[Math.min(n.childNodes.length-1,t.startOffset)]),n&&3==n.nodeType?n.parentNode:n},getEnd:function(){var e=this,t=e.getRng(),n,r;return t.duplicate||t.item?t.item?t.item(0):(t=t.duplicate(),t.collapse(0),n=t.parentElement(),n.ownerDocument!==e.dom.doc&&(n=e.dom.getRoot()),n&&"BODY"==n.nodeName?n.lastChild||n:n):(n=t.endContainer,r=t.endOffset,1==n.nodeType&&n.hasChildNodes()&&(n=n.childNodes[r>0?r-1:r]),n&&3==n.nodeType?n.parentNode:n)},getBookmark:function(e,t){function n(e,t){var n=0;return u(o.select(e),function(e,r){e==t&&(n=r)}),n}function r(e){function t(t){var n,r,i,s=t?"start":"end";n=e[s+"Container"],r=e[s+"Offset"],1==n.nodeType&&"TR"==n.nodeName&&(i=n.childNodes,n=i[Math.min(t?r:r-1,i.length-1)],n&&(r=t?0:n.childNodes.length,e["set"+(t?"Start":"End")](n,r)))}return t(!0),t(),e}function i(){function e(e,n){var i=e[n?"startContainer":"endContainer"],o=e[n?"startOffset":"endOffset"],u=[],a,f,l=0;if(3==i.nodeType){if(t)for(a=i.previousSibling;a&&3==a.nodeType;a=a.previousSibling)o+=a.nodeValue.length;u.push(o)}else f=i.childNodes,o>=f.length&&f.length&&(l=1,o=Math.max(0,f.length-1)),u.push(s.dom.nodeIndex(f[o],t)+l);for(;i&&i!=r;i=i.parentNode)u.push(s.dom.nodeIndex(i,t));return u}var n=s.getRng(!0),r=o.getRoot(),i={};return i.start=e(n,!0),s.isCollapsed()||(i.end=e(n)),i}var s=this,o=s.dom,a,f,l,c,h,p,d="&#xFEFF;",v;if(2==e)return p=s.getNode(),h=p.nodeName,"IMG"==h?{name:h,index:n(h,p)}:s.tridentSel?s.tridentSel.getBookmark(e):i();if(e)return{rng:s.getRng()};if(a=s.getRng(),l=o.uniqueId(),c=s.isCollapsed(),v="overflow:hidden;line-height:0px",a.duplicate||a.item){if(a.item)return p=a.item(0),h=p.nodeName,{name:h,index:n(h,p)};f=a.duplicate();try{a.collapse(),a.pasteHTML('<span data-mce-type="bookmark" id="'+l+'_start" style="'+v+'">'+d+"</span>"),c||(f.collapse(!1),a.moveToElementText(f.parentElement()),0===a.compareEndPoints("StartToEnd",f)&&f.move("character",-1),f.pasteHTML('<span data-mce-type="bookmark" id="'+l+'_end" style="'+v+'">'+d+"</span>"))}catch(m){return null}}else{if(p=s.getNode(),h=p.nodeName,"IMG"==h)return{name:h,index:n(h,p)};f=r(a.cloneRange()),c||(f.collapse(!1),f.insertNode(o.create("span",{"data-mce-type":"bookmark",id:l+"_end",style:v},d))),a=r(a),a.collapse(!0),a.insertNode(o.create("span",{"data-mce-type":"bookmark",id:l+"_start",style:v},d))}return s.moveToBookmark({id:l,keep:1}),{id:l}},moveToBookmark:function(e){function t(t){var n=e[t?"start":"end"],r,i,s,u;if(n){for(s=n[0],i=f,r=n.length-1;r>=1;r--){if(u=i.childNodes,n[r]>u.length-1)return;i=u[n[r]]}3===i.nodeType&&(s=Math.min(n[0],i.nodeValue.length)),1===i.nodeType&&(s=Math.min(n[0],i.childNodes.length)),t?o.setStart(i,s):o.setEnd(i,s)}return!0}function n(t){var n=s.get(e.id+"_"+t),r,i,o,f,l=e.keep;if(n&&(r=n.parentNode,"start"==t?(l?(r=n.firstChild,i=1):i=s.nodeIndex(n),h=p=r,d=v=i):(l?(r=n.firstChild,i=1):i=s.nodeIndex(n),p=r,v=i),!l)){for(f=n.previousSibling,o=n.nextSibling,u(a(n.childNodes),function(e){3==e.nodeType&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))});n=s.get(e.id+"_"+t);)s.remove(n,1);f&&o&&f.nodeType==o.nodeType&&3==f.nodeType&&!c&&(i=f.nodeValue.length,f.appendData(o.nodeValue),s.remove(o),"start"==t?(h=p=f,d=v=i):(p=f,v=i))}}function r(e){return!s.isBlock(e)||e.innerHTML||l||(e.innerHTML='<br data-mce-bogus="1" />'),e}var i=this,s=i.dom,o,f,h,p,d,v;if(e)if(e.start){if(o=s.createRng(),f=s.getRoot(),i.tridentSel)return i.tridentSel.moveToBookmark(e);t(!0)&&t()&&i.setRng(o)}else e.id?(n("start"),n("end"),h&&(o=s.createRng(),o.setStart(r(h),d),o.setEnd(r(p),v),i.setRng(o))):e.name?i.select(s.select(e.name)[e.index]):e.rng&&i.setRng(e.rng)},select:function(t,n){function r(t,n){var r=new e(t,t);do{if(3==t.nodeType&&0!==f(t.nodeValue).length)return n?o.setStart(t,0):o.setEnd(t,t.nodeValue.length),void 0;if("BR"==t.nodeName)return n?o.setStartBefore(t):o.setEndBefore(t),void 0}while(t=n?r.next():r.prev())}var i=this,s=i.dom,o=s.createRng(),u;if(t){if(!n&&i.controlSelection.controlSelect(t))return;u=s.nodeIndex(t),o.setStart(t.parentNode,u),o.setEnd(t.parentNode,u+1),n&&(r(t,1),r(t)),i.setRng(o)}return t},isCollapsed:function(){var e=this,t=e.getRng(),n=e.getSel();return!t||t.item?!1:t.compareEndPoints?0===t.compareEndPoints("StartToEnd",t):!n||t.collapsed},collapse:function(e){var t=this,n=t.getRng(),r;n.item&&(r=n.item(0),n=t.win.document.body.createTextRange(),n.moveToElementText(r)),n.collapse(!!e),t.setRng(n)},getSel:function(){var e=this.win;return e.getSelection?e.getSelection():e.document.selection},getRng:function(e){var t=this,n,r,i,s=t.win.document,o;if(!e&&t.restoreRng)return t.restoreRng;if(e&&t.tridentSel)return t.tridentSel.getRangeAt(0);try{(n=t.getSel())&&(r=n.rangeCount>0?n.getRangeAt(0):n.createRange?n.createRange():s.createRange())}catch(u){}if(l&&r&&r.setStart){try{o=s.selection.createRange()}catch(u){}o&&o.item&&(i=o.item(0),r=s.createRange(),r.setStartBefore(i),r.setEndAfter(i))}return r||(r=s.createRange?s.createRange():s.body.createTextRange()),r.setStart&&9===r.startContainer.nodeType&&r.collapsed&&(i=t.dom.getRoot(),r.setStart(i,0),r.setEnd(i,0)),t.selectedRange&&t.explicitRange&&(0===r.compareBoundaryPoints(r.START_TO_START,t.selectedRange)&&0===r.compareBoundaryPoints(r.END_TO_END,t.selectedRange)?r=t.explicitRange:(t.selectedRange=null,t.explicitRange=null)),r},setRng:function(e,t){var n=this,r;if(e.select)try{e.select()}catch(i){}else if(n.tridentSel){if(e.cloneRange)try{return n.tridentSel.addRange(e),void 0}catch(i){}}else if(r=n.getSel()){n.explicitRange=e;try{r.removeAllRanges()}catch(i){}r.addRange(e),t===!1&&r.extend&&(r.collapse(e.endContainer,e.endOffset),r.extend(e.startContainer,e.startOffset)),n.selectedRange=r.rangeCount>0?r.getRangeAt(0):null}},setNode:function(e){var t=this;return t.setContent(t.dom.getOuterHTML(e)),e},getNode:function(){function e(e,t){for(var n=e;e&&3===e.nodeType&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||n}var t=this,n=t.getRng(),r,i=n.startContainer,s=n.endContainer,o=n.startOffset,u=n.endOffset;return n?n.setStart?(r=n.commonAncestorContainer,!n.collapsed&&(i==s&&2>u-o&&i.hasChildNodes()&&(r=i.childNodes[o]),3===i.nodeType&&3===s.nodeType&&(i=i.length===o?e(i.nextSibling,!0):i.parentNode,s=0===u?e(s.previousSibling,!1):s.parentNode,i&&i===s))?i:r&&3==r.nodeType?r.parentNode:r):n.item?n.item(0):n.parentElement():t.dom.getRoot()},getSelectedBlocks:function(t,n){var r=this,i=r.dom,s,o,u=[];if(o=i.getRoot(),t=i.getParent(t||r.getStart(),i.isBlock),n=i.getParent(n||r.getEnd(),i.isBlock),t&&t!=o&&u.push(t),t&&n&&t!=n){s=t;for(var a=new e(t,o);(s=a.next())&&s!=n;)i.isBlock(s)&&u.push(s)}return n&&t!=n&&n!=o&&u.push(n),u},isForward:function(){var e=this.dom,t=this.getSel(),n,r;return t&&t.anchorNode&&t.focusNode?(n=e.createRng(),n.setStart(t.anchorNode,t.anchorOffset),n.collapse(!0),r=e.createRng(),r.setStart(t.focusNode,t.focusOffset),r.collapse(!0),n.compareBoundaryPoints(n.START_TO_START,r)<=0):!0},normalize:function(){function t(t){function o(t,n){for(var r=new e(t,h.getParent(t.parentNode,h.isBlock)||p);t=r[n?"prev":"next"]();)if("BR"===t.nodeName)return!0}function u(e,t){return e.previousSibling&&e.previousSibling.nodeName==t}function a(t,n){var r,o;for(n=n||f,r=new e(n,h.getParent(n.parentNode,h.isBlock)||p);d=r[t?"prev":"next"]();){if(3===d.nodeType&&d.nodeValue.length>0)return f=d,l=t?d.nodeValue.length:0,i=!0,void 0;if(h.isBlock(d)||v[d.nodeName.toLowerCase()])return;o=d}s&&o&&(f=o,i=!0,l=0)}var f,l,c,h=n.dom,p=h.getRoot(),d,v,m;if(f=r[(t?"start":"end")+"Container"],l=r[(t?"start":"end")+"Offset"],v=h.schema.getNonEmptyElements(),9===f.nodeType&&(f=h.getRoot(),l=0),f===p){if(t&&(d=f.childNodes[l>0?l-1:0],d&&(m=d.nodeName.toLowerCase(),v[d.nodeName]||"TABLE"==d.nodeName)))return;if(f.hasChildNodes()&&(l=Math.min(!t&&l>0?l-1:l,f.childNodes.length-1),f=f.childNodes[l],l=0,f.hasChildNodes()&&!/TABLE/.test(f.nodeName))){d=f,c=new e(f,p);do{if(3===d.nodeType&&d.nodeValue.length>0){l=t?0:d.nodeValue.length,f=d,i=!0;break}if(v[d.nodeName.toLowerCase()]){l=h.nodeIndex(d),f=d.parentNode,"IMG"!=d.nodeName||t||l++,i=!0;break}}while(d=t?c.next():c.prev())}}s&&(3===f.nodeType&&0===l&&a(!0),1===f.nodeType&&(d=f.childNodes[l],!d||"BR"!==d.nodeName||u(d,"A")||o(d)||o(d,!0)||a(!0,f.childNodes[l]))),t&&!s&&3===f.nodeType&&l===f.nodeValue.length&&a(!1),i&&r["set"+(t?"Start":"End")](f,l)}var n=this,r,i,s;l||(r=n.getRng(),s=r.collapsed,t(!0),s||t(),i&&(s&&r.collapse(!0),n.setRng(r,n.isForward())))},selectorChanged:function(e,t){var n=this,r;return n.selectorChangedData||(n.selectorChangedData={},r={},n.editor.on("NodeChange",function(e){var t=e.element,i=n.dom,s=i.getParents(t,null,i.getRoot()),o={};u(n.selectorChangedData,function(e,t){u(s,function(n){return i.is(n,t)?(r[t]||(u(e,function(e){e(!0,{node:n,selector:t,parents:s})}),r[t]=e),o[t]=e,!1):void 0})}),u(r,function(e,n){o[n]||(delete r[n],u(e,function(e){e(!1,{node:t,selector:n,parents:s})}))})})),n.selectorChangedData[e]||(n.selectorChangedData[e]=[]),n.selectorChangedData[e].push(t),n},scrollIntoView:function(e){var t,n,r=this,i=r.dom;n=i.getViewPort(r.editor.getWin()),t=i.getPos(e).y,(t<n.y||t+25>n.y+n.h)&&r.editor.getWin().scrollTo(0,t<n.y?t:t-n.h+25)},destroy:function(){this.win=null,this.controlSelection.destroy()}},o}),r(M,[p],function(e){function t(e){this.walk=function(t,r){function i(e){var t;return t=e[0],3===t.nodeType&&t===a&&f>=t.nodeValue.length&&e.splice(0,1),t=e[e.length-1],0===c&&e.length>0&&t===l&&3===t.nodeType&&e.splice(e.length-1,1),e}function s(e,t,n){for(var r=[];e&&e!=n;e=e[t])r.push(e);return r}function o(e,t){do{if(e.parentNode==t)return e;e=e.parentNode}while(e)}function u(e,t,n){var o=n?"nextSibling":"previousSibling";for(v=e,m=v.parentNode;v&&v!=t;v=m)m=v.parentNode,g=s(v==e?v:v[o],o),g.length&&(n||g.reverse(),r(i(g)))}var a=t.startContainer,f=t.startOffset,l=t.endContainer,c=t.endOffset,h,p,d,v,m,g,y;if(y=e.select("td.mce-item-selected,th.mce-item-selected"),y.length>0)return n(y,function(e){r([e])}),void 0;if(1==a.nodeType&&a.hasChildNodes()&&(a=a.childNodes[f]),1==l.nodeType&&l.hasChildNodes()&&(l=l.childNodes[Math.min(c-1,l.childNodes.length-1)]),a==l)return r(i([a]));for(h=e.findCommonAncestor(a,l),v=a;v;v=v.parentNode){if(v===l)return u(a,h,!0);if(v===h)break}for(v=l;v;v=v.parentNode){if(v===a)return u(l,h);if(v===h)break}p=o(a,h)||a,d=o(l,h)||l,u(a,p,!0),g=s(p==a?p:p.nextSibling,"nextSibling",d==l?d.nextSibling:d),g.length&&r(i(g)),u(l,d)},this.split=function(e){function t(e,t){return e.splitText(t)}var n=e.startContainer,r=e.startOffset,i=e.endContainer,s=e.endOffset;return n==i&&3==n.nodeType?r>0&&r<n.nodeValue.length&&(i=t(n,r),n=i.previousSibling,s>r?(s-=r,n=i=t(i,s).previousSibling,s=i.nodeValue.length,r=0):s=0):(3==n.nodeType&&r>0&&r<n.nodeValue.length&&(n=t(n,r),r=0),3==i.nodeType&&s>0&&s<i.nodeValue.length&&(i=t(i,s).previousSibling,s=i.nodeValue.length)),{startContainer:n,startOffset:r,endContainer:i,endOffset:s}}}var n=e.each;return t.compareRanges=function(e,t){if(e&&t){if(!e.item&&!e.duplicate)return e.startContainer==t.startContainer&&e.startOffset==t.startOffset;if(e.item&&t.item&&e.item(0)===t.item(0))return!0;if(e.isEqual&&t.isEqual&&t.isEqual(e))return!0}return!1},t}),r(_,[h,M,p],function(e,t,n){return function(r){function i(e){return e.nodeType&&(e=e.nodeName),!!r.schema.getTextBlockElements()[e.toLowerCase()]}function s(e,t){return F.getParents(e,t,F.getRoot())}function o(e){return 1===e.nodeType&&"_mce_caret"===e.id}function u(){l({alignleft:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},defaultBlock:"div"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"right"}}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},defaultBlock:"div"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:!1},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},wrap_links:!1},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(){return!0},onformat:function(e,t,n){et(n,function(t,n){F.setAttrib(e,n,t)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]}),et("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(e){l(e,{block:e,remove:"all"})}),l(r.settings.formats)}function a(){r.addShortcut("ctrl+b","bold_desc","Bold"),r.addShortcut("ctrl+i","italic_desc","Italic"),r.addShortcut("ctrl+u","underline_desc","Underline");for(var e=1;6>=e;e++)r.addShortcut("ctrl+"+e,"",["FormatBlock",!1,"h"+e]);r.addShortcut("ctrl+7","",["FormatBlock",!1,"p"]),r.addShortcut("ctrl+8","",["FormatBlock",!1,"div"]),r.addShortcut("ctrl+9","",["FormatBlock",!1,"address"])}function f(e){return e?j[e]:j}function l(e,t){e&&("string"!=typeof e?et(e,function(e,t){l(t,e)}):(t=t.length?t:[t],et(t,function(e){e.deep===Q&&(e.deep=!e.selector),e.split===Q&&(e.split=!e.selector||e.inline),e.remove===Q&&e.selector&&!e.inline&&(e.remove="none"),e.selector&&e.inline&&(e.mixed=!0,e.block_expand=!0),"string"==typeof e.classes&&(e.classes=e.classes.split(/\s+/))}),j[e]=t))}function c(e){var t;return r.dom.getParent(e,function(e){return t=r.dom.getStyle(e,"text-decoration"),t&&"none"!==t}),t}function h(e){var t;1===e.nodeType&&e.parentNode&&1===e.parentNode.nodeType&&(t=c(e.parentNode),r.dom.getStyle(e,"color")&&t?r.dom.setStyle(e,"text-decoration",t):r.dom.getStyle(e,"textdecoration")===t&&r.dom.setStyle(e,"text-decoration",null))}function p(t,n,s){function u(e,t){t=t||v,e&&(t.onformat&&t.onformat(e,t,n,s),et(t.styles,function(t,r){F.setStyle(e,r,N(t,n))}),et(t.attributes,function(t,r){F.setAttrib(e,r,N(t,n))}),et(t.classes,function(t){t=N(t,n),F.hasClass(e,t)||F.addClass(e,t)}))}function a(){function t(t,n){var r=new e(n);for(s=r.current();s;s=r.prev())if(s.childNodes.length>1||s==t||"BR"==s.tagName)return s}var n=r.selection.getRng(),i=n.startContainer,o=n.endContainer;if(i!=o&&0===n.endOffset){var u=t(i,o),a=3==u.nodeType?u.length:u.childNodes.length;n.setEnd(u,a)}return n}function l(e,t,n,r,i){var s=[],o=-1,u,a=-1,f=-1,l;return et(e.childNodes,function(e,t){return"UL"===e.nodeName||"OL"===e.nodeName?(o=t,u=e,!1):void 0}),et(e.childNodes,function(e,n){"SPAN"===e.nodeName&&"bookmark"==F.getAttrib(e,"data-mce-type")&&(e.id==t.id+"_start"?a=n:e.id==t.id+"_end"&&(f=n))}),0>=o||o>a&&f>o?(et(tt(e.childNodes),i),0):(l=F.clone(n,$),et(tt(e.childNodes),function(e,t){(o>a&&o>t||a>o&&t>o)&&(s.push(e),e.parentNode.removeChild(e))}),o>a?e.insertBefore(l,u):a>o&&e.insertBefore(l,u.nextSibling),r.push(l),et(s,function(e){l.appendChild(e)}),l)}function c(e,r,s){var a=[],f,c,h=!0;f=v.inline||v.block,c=F.create(f),u(c),q.walk(e,function(e){function p(e){var y,w,E,x,T;return T=h,y=e.nodeName.toLowerCase(),w=e.parentNode.nodeName.toLowerCase(),1===e.nodeType&&G(e)&&(T=h,h="true"===G(e),x=!0),S(y,"br")?(g=0,v.block&&F.remove(e),void 0):v.wrapper&&m(e,t,n)?(g=0,void 0):h&&!x&&v.block&&!v.wrapper&&i(y)&&R(w,f)?(e=F.rename(e,f),u(e),a.push(e),g=0,void 0):v.selector&&(et(d,function(t){"collapsed"in t&&t.collapsed!==b||F.is(e,t.selector)&&!o(e)&&(u(e,t),E=!0)}),!v.inline||E)?(g=0,void 0):(!h||x||!R(f,y)||!R(w,f)||!s&&3===e.nodeType&&1===e.nodeValue.length&&65279===e.nodeValue.charCodeAt(0)||o(e)||v.inline&&U(e)?"li"==y&&r?g=l(e,r,c,a,p):(g=0,et(tt(e.childNodes),p),x&&(h=T),g=0):(g||(g=F.clone(c,$),e.parentNode.insertBefore(g,e),a.push(g)),g.appendChild(e)),void 0)}var g;et(e,p)}),v.wrap_links===!1&&et(a,function(e){function t(e){var n,r,i;if("A"===e.nodeName){for(r=F.clone(c,$),a.push(r),i=tt(e.childNodes),n=0;n<i.length;n++)r.appendChild(i[n]);e.appendChild(r)}et(tt(e.childNodes),t)}t(e)}),et(a,function(e){function r(e){var t=0;return et(e.childNodes,function(e){C(e)||_(e)||t++}),t}function i(e){var t,n;return et(e.childNodes,function(e){return 1!=e.nodeType||_(e)||o(e)?void 0:(t=e,$)}),t&&E(t,v)&&(n=F.clone(t,$),u(n),F.replace(n,e,J),F.remove(t,1)),n||e}var s;if(s=r(e),(a.length>1||!U(e))&&0===s)return F.remove(e,1),void 0;if(v.inline||v.wrapper){if(v.exact||1!==s||(e=i(e)),et(d,function(t){et(F.select(t.inline,e),function(e){var r;if(t.wrap_links===!1){r=e.parentNode;do if("A"===r.nodeName)return;while(r=r.parentNode)}A(t,n,e,t.exact?e:null)})}),m(e.parentNode,t,n))return F.remove(e,1),e=0,J;v.merge_with_parents&&F.getParent(e.parentNode,function(r){return m(r,t,n)?(F.remove(e,1),e=0,J):void 0}),e&&v.merge_siblings!==!1&&(e=D(M(e),e),e=D(e,M(e,J)))}})}var d=f(t),v=d[0],g,y,b=!s&&I.isCollapsed();if(v)if(s)s.nodeType?(y=F.createRng(),y.setStartBefore(s),y.setEndAfter(s),c(L(y,d),null,!0)):c(s,null,!0);else if(b&&v.inline&&!F.select("td.mce-item-selected,th.mce-item-selected").length)H("apply",t,n);else{var w=r.selection.getNode();z||!d[0].defaultBlock||F.getParent(w,F.isBlock)||p(d[0].defaultBlock),r.selection.setRng(a()),g=I.getBookmark(),c(L(I.getRng(J),d),g),v.styles&&(v.styles.color||v.styles.textDecoration)&&(nt(w,h,"childNodes"),h(w)),I.moveToBookmark(g),B(I.getRng(J)),r.nodeChanged()}}function d(e,t,n){function i(e){var n,r,s,o,u;if(1===e.nodeType&&G(e)&&(o=b,b="true"===G(e),u=!0),n=tt(e.childNodes),b&&!u)for(r=0,s=p.length;s>r&&!A(p[r],t,e,e);r++);if(d.deep&&n.length){for(r=0,s=n.length;s>r;r++)i(n[r]);u&&(b=o)}}function o(n){var r;return et(s(n.parentNode).reverse(),function(n){var i;r||"_start"==n.id||"_end"==n.id||(i=m(n,e,t),i&&i.split!==!1&&(r=n))}),r}function u(e,n,r,i){var s,o,u,a,f,l;if(e){for(l=e.parentNode,s=n.parentNode;s&&s!=l;s=s.parentNode){for(o=F.clone(s,$),f=0;f<p.length;f++)if(A(p[f],t,o,o)){o=0;break}o&&(u&&o.appendChild(u),a||(a=o),u=o)}!i||d.mixed&&U(e)||(n=F.split(e,n)),u&&(r.parentNode.insertBefore(u,r),a.appendChild(r))}return n}function a(e){return u(o(e),e,e,!0)}function l(e){var t=F.get(e?"_start":"_end"),n=t[e?"firstChild":"lastChild"];return _(n)&&(n=n[e?"firstChild":"lastChild"]),F.remove(t,!0),n}function h(e){var t,n;e=L(e,p,J),d.split&&(t=P(e,J),n=P(e),t!=n?(/^(TR|TD)$/.test(t.nodeName)&&t.firstChild&&(t="TD"==t.nodeName?t.firstChild||t:t.firstChild.firstChild||t),t=k(t,"span",{id:"_start","data-mce-type":"bookmark"}),n=k(n,"span",{id:"_end","data-mce-type":"bookmark"}),a(t),a(n),t=l(J),n=l()):t=n=a(t),e.startContainer=t.parentNode,e.startOffset=W(t),e.endContainer=n.parentNode,e.endOffset=W(n)+1),q.walk(e,function(e){et(e,function(e){i(e),1===e.nodeType&&"underline"===r.dom.getStyle(e,"text-decoration")&&e.parentNode&&"underline"===c(e.parentNode)&&A({deep:!1,exact:!0,inline:"span",styles:{textDecoration:"underline"}},null,e)})})}var p=f(e),d=p[0],v,y,b=!0;return n?(n.nodeType?(y=F.createRng(),y.setStartBefore(n),y.setEndAfter(n),h(y)):h(n),void 0):(I.isCollapsed()&&d.inline&&!F.select("td.mce-item-selected,th.mce-item-selected").length?H("remove",e,t):(v=I.getBookmark(),h(I.getRng(J)),I.moveToBookmark(v),d.inline&&g(e,t,I.getStart())&&B(I.getRng(!0)),r.nodeChanged()),void 0)}function v(e,t,n){var r=f(e);!g(e,t,n)||"toggle"in r[0]&&!r[0].toggle?p(e,t,n):d(e,t,n)}function m(e,t,n,r){function i(e,t,i){var s,o,u=t[i],a;if(t.onmatch)return t.onmatch(e,t,i);if(u)if(u.length===Q){for(s in u)if(u.hasOwnProperty(s)){if(o="attributes"===i?F.getAttrib(e,s):x(e,s),r&&!o&&!t.exact)return;if((!r||t.exact)&&!S(o,T(N(u[s],n),s)))return}}else for(a=0;a<u.length;a++)if("attributes"===i?F.getAttrib(e,u[a]):x(e,u[a]))return t;return t}var s=f(t),o,u,a;if(s&&e)for(u=0;u<s.length;u++)if(o=s[u],E(e,o)&&i(e,o,"attributes")&&i(e,o,"styles")){if(a=o.classes)for(u=0;u<a.length;u++)if(!F.hasClass(e,a[u]))return;return o}}function g(e,t,n){function r(n){return n=F.getParent(n,function(n){return!!m(n,e,t,!0)}),m(n,e,t)}var i;return n?r(n):(n=I.getNode(),r(n)?J:(i=I.getStart(),i!=n&&r(i)?J:$))}function y(e,t){var n,r=[],i={};return n=I.getStart(),F.getParent(n,function(n){var s,o;for(s=0;s<e.length;s++)o=e[s],!i[o]&&m(n,o,t)&&(i[o]=!0,r.push(o))},F.getRoot()),r}function b(e){var t=f(e),n,r,i,o,u;if(t)for(n=I.getStart(),r=s(n),o=t.length-1;o>=0;o--){if(u=t[o].selector,!u)return J;for(i=r.length-1;i>=0;i--)if(F.is(r[i],u))return J}return $}function w(e,t,n){var i;return K||(K={},i={},r.on("NodeChange",function(e){var t=s(e.element),n={};et(K,function(e,r){et(t,function(s){return m(s,r,{},e.similar)?(i[r]||(et(e,function(e){e(!0,{node:s,format:r,parents:t})}),i[r]=e),n[r]=e,!1):void 0})}),et(i,function(r,s){n[s]||(delete i[s],et(r,function(n){n(!1,{node:e.element,format:s,parents:t})}))})})),et(e.split(","),function(e){K[e]||(K[e]=[],K[e].similar=n),K[e].push(t)}),this}function E(e,t){return S(e,t.inline)?J:S(e,t.block)?J:t.selector?1==e.nodeType&&F.is(e,t.selector):void 0}function S(e,t){return e=e||"",t=t||"",e=""+(e.nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()==t.toLowerCase()}function x(e,t){return T(F.getStyle(e,t),t)}function T(e,t){return("color"==t||"backgroundColor"==t)&&(e=F.toHex(e)),"fontWeight"==t&&700==e&&(e="bold"),"fontFamily"==t&&(e=e.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+e}function N(e,t){return"string"!=typeof e?e=e(t):t&&(e=e.replace(/%(\w+)/g,function(e,n){return t[n]||e})),e}function C(e){return e&&3===e.nodeType&&/^([\t \r\n]+|)$/.test(e.nodeValue)}function k(e,t,n){var r=F.create(t,n);return e.parentNode.insertBefore(r,e),r.appendChild(e),r}function L(t,n,o){function u(e){function t(e){return"BR"==e.nodeName&&e.getAttribute("data-mce-bogus")&&!e.nextSibling}var r,i,s,o,u;if(r=i=e?m:y,o=e?"previousSibling":"nextSibling",u=F.getRoot(),3==r.nodeType&&!C(r)&&(e?g>0:b<r.nodeValue.length))return r;for(;;){if(!n[0].block_expand&&U(i))return i;for(s=i[o];s;s=s[o])if(!_(s)&&!C(s)&&!t(s))return i;if(i.parentNode==u){r=i;break}i=i.parentNode}return r}function a(e,t){for(t===Q&&(t=3===e.nodeType?e.length:e.childNodes.length);e&&e.hasChildNodes();)e=e.childNodes[t],e&&(t=3===e.nodeType?e.length:e.childNodes.length);return{node:e,offset:t}}function f(e){for(var t=e;t;){if(1===t.nodeType&&G(t))return"false"===G(t)?t:e;t=t.parentNode}return e}function l(t,n,i){function s(e,t){var n,r,s=e.nodeValue;return"undefined"==typeof t&&(t=i?s.length:0),i?(n=s.lastIndexOf(" ",t),r=s.lastIndexOf("",t),n=n>r?n:r,-1===n||o||n++):(n=s.indexOf(" ",t),r=s.indexOf("",t),n=-1!==n&&(-1===r||r>n)?n:r),n}var u,a,f,l;if(3===t.nodeType){if(f=s(t,n),-1!==f)return{container:t,offset:f};l=t}for(u=new e(t,F.getParent(t,U)||r.getBody());a=u[i?"prev":"next"]();)if(3===a.nodeType){if(l=a,f=s(a),-1!==f)return{container:a,offset:f}}else if(U(a))break;return l?(n=i?0:l.length,{container:l,offset:n}):void 0}function c(e,r){var i,o,u,a;for(3==e.nodeType&&0===e.nodeValue.length&&e[r]&&(e=e[r]),i=s(e),o=0;o<i.length;o++)for(u=0;u<n.length;u++)if(a=n[u],!("collapsed"in a&&a.collapsed!==t.collapsed)&&F.is(i[o],a.selector))return i[o];return e}function h(e,t){var r;if(n[0].wrapper||(r=F.getParent(e,n[0].block)),r||(r=F.getParent(3==e.nodeType?e.parentNode:e,i)),r&&n[0].wrapper&&(r=s(r,"ul,ol").reverse()[0]||r),!r)for(r=e;r[t]&&!U(r[t])&&(r=r[t],!S(r,"br")););return r||e}var p,d,v,m=t.startContainer,g=t.startOffset,y=t.endContainer,b=t.endOffset;if(1==m.nodeType&&m.hasChildNodes()&&(p=m.childNodes.length-1,m=m.childNodes[g>p?p:g],3==m.nodeType&&(g=0)),1==y.nodeType&&y.hasChildNodes()&&(p=y.childNodes.length-1,y=y.childNodes[b>p?p:b-1],3==y.nodeType&&(b=y.nodeValue.length)),m=f(m),y=f(y),(_(m.parentNode)||_(m))&&(m=_(m)?m:m.parentNode,m=m.nextSibling||m,3==m.nodeType&&(g=0)),(_(y.parentNode)||_(y))&&(y=_(y)?y:y.parentNode,y=y.previousSibling||y,3==y.nodeType&&(b=y.length)),n[0].inline&&(t.collapsed&&(v=l(m,g,!0),v&&(m=v.container,g=v.offset),v=l(y,b),v&&(y=v.container,b=v.offset)),d=a(y,b),d.node)){for(;d.node&&0===d.offset&&d.node.previousSibling;)d=a(d.node.previousSibling);d.node&&d.offset>0&&3===d.node.nodeType&&" "===d.node.nodeValue.charAt(d.offset-1)&&d.offset>1&&(y=d.node,y.splitText(d.offset-1))}return(n[0].inline||n[0].block_expand)&&(n[0].inline&&3==m.nodeType&&0!==g||(m=u(!0)),n[0].inline&&3==y.nodeType&&b!==y.nodeValue.length||(y=u())),n[0].selector&&n[0].expand!==$&&!n[0].inline&&(m=c(m,"previousSibling"),y=c(y,"nextSibling")),(n[0].block||n[0].selector)&&(m=h(m,"previousSibling"),y=h(y,"nextSibling"),n[0].block&&(U(m)||(m=u(!0)),U(y)||(y=u()))),1==m.nodeType&&(g=W(m),m=m.parentNode),1==y.nodeType&&(b=W(y)+1,y=y.parentNode),{startContainer:m,startOffset:g,endContainer:y,endOffset:b}}function A(e,t,n,r){var i,s,o;if(!E(n,e))return $;if("all"!=e.remove)for(et(e.styles,function(e,i){e=T(N(e,t),i),"number"==typeof i&&(i=e,r=0),(!r||S(x(r,i),e))&&F.setStyle(n,i,""),o=1}),o&&""===F.getAttrib(n,"style")&&(n.removeAttribute("style"),n.removeAttribute("data-mce-style")),et(e.attributes,function(e,i){var s;if(e=N(e,t),"number"==typeof i&&(i=e,r=0),!r||S(F.getAttrib(r,i),e)){if("class"==i&&(e=F.getAttrib(n,i),e&&(s="",et(e.split(/\s+/),function(e){/mce\w+/.test(e)&&(s+=(s?" ":"")+e)}),s)))return F.setAttrib(n,i,s),void 0;"class"==i&&n.removeAttribute("className"),V.test(i)&&n.removeAttribute("data-mce-"+i),n.removeAttribute(i)}}),et(e.classes,function(e){e=N(e,t),(!r||F.hasClass(r,e))&&F.removeClass(n,e)}),s=F.getAttribs(n),i=0;i<s.length;i++)if(0!==s[i].nodeName.indexOf("_"))return $;return"none"!=e.remove?(O(n,e),J):void 0}function O(e,t){function n(e,t,n){return e=M(e,t,n),!e||"BR"==e.nodeName||U(e)}var r=e.parentNode,i;t.block&&(z?r==F.getRoot()&&(t.list_block&&S(e,t.list_block)||et(tt(e.childNodes),function(e){R(z,e.nodeName.toLowerCase())?i?i.appendChild(e):i=k(e,z):i=0})):U(e)&&!U(r)&&(n(e,$)||n(e.firstChild,J,1)||e.insertBefore(F.create("br"),e.firstChild),n(e,J)||n(e.lastChild,$,1)||e.appendChild(F.create("br")))),t.selector&&t.inline&&!S(t.inline,e)||F.remove(e,1)}function M(e,t,n){if(e)for(t=t?"nextSibling":"previousSibling",e=n?e:e[t];e;e=e[t])if(1==e.nodeType||!C(e))return e}function _(e){return e&&1==e.nodeType&&"bookmark"==e.getAttribute("data-mce-type")}function D(e,t){function n(e,t){function n(e){var t={};return et(F.getAttribs(e),function(n){var r=n.nodeName.toLowerCase();0!==r.indexOf("_")&&"style"!==r&&(t[r]=F.getAttrib(e,r))}),t}function r(e,t){var n,r;for(r in e)if(e.hasOwnProperty(r)){if(n=t[r],n===Q)return $;if(e[r]!=n)return $;delete t[r]}for(r in t)if(t.hasOwnProperty(r))return $;return J}return e.nodeName!=t.nodeName?$:r(n(e),n(t))?r(F.parseStyle(F.getAttrib(e,"style")),F.parseStyle(F.getAttrib(t,"style")))?J:$:$}function r(e,t){for(i=e;i;i=i[t]){if(3==i.nodeType&&0!==i.nodeValue.length)return e;if(1==i.nodeType&&!_(i))return i}return e}var i,s;if(e&&t&&(e=r(e,"previousSibling"),t=r(t,"nextSibling"),n(e,t))){for(i=e.nextSibling;i&&i!=t;)s=i,i=i.nextSibling,e.appendChild(s);return F.remove(t),et(tt(t.childNodes),function(t){e.appendChild(t)}),e}return t}function P(t,n){var i,s,o;return i=t[n?"startContainer":"endContainer"],s=t[n?"startOffset":"endOffset"],1==i.nodeType&&(o=i.childNodes.length-1,!n&&s&&s--,i=i.childNodes[s>o?o:s]),3===i.nodeType&&n&&s>=i.nodeValue.length&&(i=(new e(i,r.getBody())).next()||i),3!==i.nodeType||n||0!==s||(i=(new e(i,r.getBody())).prev()||i),i}function H(t,n,s){function o(e){var t=F.create("span",{id:y,"data-mce-bogus":!0,style:b?"color:red":""});return e&&t.appendChild(r.getDoc().createTextNode(X)),t}function u(e,t){for(;e;){if(3===e.nodeType&&e.nodeValue!==X||e.childNodes.length>1)return!1;t&&1===e.nodeType&&t.push(e),e=e.firstChild}return!0}function a(e){for(;e;){if(e.id===y)return e;e=e.parentNode}}function l(t){var n;if(t)for(n=new e(t,t),t=n.current();t;t=n.next())if(3===t.nodeType)return t}function c(e,t){var n,r;if(e)r=I.getRng(!0),u(e)?(t!==!1&&(r.setStartBefore(e),r.setEndBefore(e)),F.remove(e)):(n=l(e),n.nodeValue.charAt(0)===X&&(n=n.deleteData(0,1)),F.remove(e,1)),I.setRng(r);else if(e=a(I.getStart()),!e)for(;e=F.get(y);)c(e,!1)}function h(){var e,t,r,i,u,c,h;e=I.getRng(!0),i=e.startOffset,c=e.startContainer,h=c.nodeValue,t=a(I.getStart()),t&&(r=l(t)),h&&i>0&&i<h.length&&/\w/.test(h.charAt(i))&&/\w/.test(h.charAt(i-1))?(u=I.getBookmark(),e.collapse(!0),e=L(e,f(n)),e=q.split(e),p(n,s,e),I.moveToBookmark(u)):(t&&r.nodeValue===X?p(n,s,t):(t=o(!0),r=t.firstChild,e.insertNode(t),i=1,p(n,s,t)),I.setCursorLocation(r,i))}function v(){var e=I.getRng(!0),t,r,u,a,l,c,h=[],p,v;for(t=e.startContainer,r=e.startOffset,l=t,3==t.nodeType&&((r!=t.nodeValue.length||t.nodeValue===X)&&(a=!0),l=l.parentNode);l;){if(m(l,n,s)){c=l;break}l.nextSibling&&(a=!0),h.push(l),l=l.parentNode}if(c)if(a)u=I.getBookmark(),e.collapse(!0),e=L(e,f(n),!0),e=q.split(e),d(n,s,e),I.moveToBookmark(u);else{for(v=o(),l=v,p=h.length-1;p>=0;p--)l.appendChild(F.clone(h[p],!1)),l=l.firstChild;l.appendChild(F.doc.createTextNode(X)),l=l.firstChild;var g=F.getParent(c,i);g&&F.isEmpty(g)?c.parentNode.replaceChild(v,c):F.insertAfter(v,c),I.setCursorLocation(l,1)}}function g(){var e;e=a(I.getStart()),e&&!F.isEmpty(e)&&nt(e,function(e){1!=e.nodeType||e.id===y||F.isEmpty(e)||F.setAttrib(e,"data-mce-bogus",null)},"childNodes")}var y="_mce_caret",b=r.settings.caret_debug;r._hasCaretEvents||(Z=function(){var e=[],t;if(u(a(I.getStart()),e))for(t=e.length;t--;)F.setAttrib(e[t],"data-mce-bogus","1")},Y=function(e){var t=e.keyCode;c(),(8==t||37==t||39==t)&&c(a(I.getStart())),g()},r.on("SetContent",function(e){e.selection&&g()}),r._hasCaretEvents=!0),"apply"==t?h():v()}function B(t){var n=t.startContainer,r=t.startOffset,i,s,o,u,a;if(3==n.nodeType&&r>=n.nodeValue.length&&(r=W(n),n=n.parentNode,i=!0),1==n.nodeType)for(u=n.childNodes,n=u[Math.min(r,u.length-1)],s=new e(n,F.getParent(n,F.isBlock)),(r>u.length-1||i)&&s.next(),o=s.current();o;o=s.next())if(3==o.nodeType&&!C(o))return a=F.create("a",null,X),o.parentNode.insertBefore(a,o),t.setStart(o,0),I.setRng(t),F.remove(a),void 0}var j={},F=r.dom,I=r.selection,q=new t(F),R=r.schema.isValidChild,U=F.isBlock,z=r.settings.forced_root_block,W=F.nodeIndex,X="",V=/^(src|href|style)$/,$=!1,J=!0,K,Q,G=F.getContentEditable,Y,Z,et=n.each,tt=n.grep,nt=n.walk,rt=n.extend;rt(this,{get:f,register:l,apply:p,remove:d,toggle:v,match:g,matchAll:y,matchNode:m,canApply:b,formatChanged:w}),u(),a(),r.on("BeforeGetContent",function(){Z&&Z()}),r.on("mouseup keydown",function(e){Y&&Y(e)})}}),r(D,[m,p],function(e,t){var n=t.trim,r;return r=new RegExp(["<span[^>]+data-mce-bogus[^>]+>[]+<\\/span>","<div[^>]+data-mce-bogus[^>]+><\\/div>",'\\s?data-mce-selected="[^"]+"'].join("|"),"gi"),function(t){function i(){return n(t.getContent({format:"raw",no_events:1}).replace(r,""))}function s(){o.typing=!1,o.add()}var o,u=0,a=[],f,l;return t.on("init",function(){o.add()}),t.on("BeforeExecCommand",function(e){var t=e.command;"Undo"!=t&&"Redo"!=t&&"mceRepaint"!=t&&o.beforeChange()}),t.on("ExecCommand",function(e){var t=e.command;"Undo"!=t&&"Redo"!=t&&"mceRepaint"!=t&&o.add()}),t.on("ObjectResizeStart",function(){o.beforeChange()}),t.on("SaveContent ObjectResized",s),t.dom.bind(t.dom.getRoot(),"dragend",s),t.dom.bind(t.getBody(),"focusout",function(){!t.removed&&o.typing&&s()}),t.on("KeyUp",function(n){var r=n.keyCode;(r>=33&&36>=r||r>=37&&40>=r||45==r||13==r||n.ctrlKey)&&(s(),t.nodeChanged()),(46==r||8==r||e.mac&&(91==r||93==r))&&t.nodeChanged(),l&&o.typing&&(t.isDirty()||(t.isNotDirty=!a[0]||i()==a[0].content),t.fire("TypingUndo"),l=!1,t.nodeChanged())}),t.on("KeyDown",function(e){var t=e.keyCode;return t>=33&&36>=t||t>=37&&40>=t||45==t?(o.typing&&s(),void 0):((16>t||t>20)&&224!=t&&91!=t&&!o.typing&&(o.beforeChange(),o.typing=!0,o.add(),l=!0),void 0)}),t.on("MouseDown",function(){o.typing&&s()}),t.addShortcut("ctrl+z","","Undo"),t.addShortcut("ctrl+y,ctrl+shift+z","","Redo"),t.on("AddUndo Undo Redo ClearUndos MouseUp",function(e){e.isDefaultPrevented()||t.nodeChanged()}),o={data:a,typing:!1,beforeChange:function(){f=t.selection.getBookmark(2,!0)},add:function(e){var n,r=t.settings,s;if(e=e||{},e.content=i(),t.fire("BeforeAddUndo",{level:e}).isDefaultPrevented())return null;if(s=a[u],s&&s.content==e.content)return null;if(a[u]&&(a[u].beforeBookmark=f),r.custom_undo_redo_levels&&a.length>r.custom_undo_redo_levels){for(n=0;n<a.length-1;n++)a[n]=a[n+1];a.length--,u=a.length}e.bookmark=t.selection.getBookmark(2,!0),u<a.length-1&&(a.length=u+1),a.push(e),u=a.length-1;var o={level:e,lastLevel:s};return t.fire("AddUndo",o),u>0&&(t.fire("change",o),t.isNotDirty=!1),e},undo:function(){var e;return o.typing&&(o.add(),o.typing=!1),u>0&&(e=a[--u],t.setContent(e.content,{format:"raw"}),t.selection.moveToBookmark(e.beforeBookmark),t.fire("undo",{level:e})),e},redo:function(){var e;return u<a.length-1&&(e=a[++u],t.setContent(e.content,{format:"raw"}),t.selection.moveToBookmark(e.bookmark),t.fire("redo",{level:e})),e},clear:function(){a=[],u=0,o.typing=!1,t.fire("ClearUndos")},hasUndo:function(){return u>0||o.typing&&a[0]&&i()!=a[0].content},hasRedo:function(){return u<a.length-1&&!this.typing},transact:function(e){o.beforeChange(),e(),o.add()}}}}),r(P,[h,m],function(e,t){var n=t.ie;return function(t){function r(r){function l(e){return e&&i.isBlock(e)&&!/^(TD|TH|CAPTION|FORM)$/.test(e.nodeName)&&!/^(fixed|absolute)/i.test(e.style.position)&&"true"!==i.getContentEditable(e)}function c(e){var t;i.isBlock(e)&&(t=s.getRng(),e.appendChild(i.create("span",null,"")),s.select(e),e.lastChild.outerHTML="",s.setRng(t))}function h(e){for(var t=e,n=[],r;t=t.firstChild;){if(i.isBlock(t))return;1!=t.nodeType||f[t.nodeName.toLowerCase()]||n.push(t)}for(r=n.length;r--;)t=n[r],!t.hasChildNodes()||t.firstChild==t.lastChild&&""===t.firstChild.nodeValue?i.remove(t):"A"==t.nodeName&&" "===(t.innerText||t.textContent)&&i.remove(t)}function p(t){var n,r,o,u=t,a;if(o=i.createRng(),t.hasChildNodes()){for(n=new e(t,t);r=n.current();){if(3==r.nodeType){o.setStart(r,0),o.setEnd(r,0);break}if(f[r.nodeName.toLowerCase()]){o.setStartBefore(r),o.setEndBefore(r);break}u=r,r=n.next()}r||(o.setStart(u,0),o.setEnd(u,0))}else"BR"==t.nodeName?t.nextSibling&&i.isBlock(t.nextSibling)?((!A||9>A)&&(a=i.create("br"),t.parentNode.insertBefore(a,t)),o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)):(o.setStart(t,0),o.setEnd(t,0));s.setRng(o),i.remove(a),s.scrollIntoView(t)}function d(e){var t=C,r,s,u;if(r=e||"TABLE"==P?i.create(e||B):L.cloneNode(!1),u=r,o.keep_styles!==!1)do if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(t.nodeName)){if("_mce_caret"==t.id)continue;s=t.cloneNode(!1),i.setAttrib(s,"id",""),r.hasChildNodes()?(s.appendChild(r.firstChild),r.appendChild(s)):(u=s,r.appendChild(s))}while(t=t.parentNode);return n||(u.innerHTML='<br data-mce-bogus="1">'),r}function v(t){var n,r,i;if(3==C.nodeType&&(t?k>0:k<C.nodeValue.length))return!1;if(C.parentNode==L&&j&&!t)return!0;if(t&&1==C.nodeType&&C==L.firstChild)return!0;if("TABLE"===C.nodeName||C.previousSibling&&"TABLE"==C.previousSibling.nodeName)return j&&!t||!j&&t;for(n=new e(C,L),3==C.nodeType&&(t&&0===k?n.prev():t||k!=C.nodeValue.length||n.next());r=n.current();){if(1===r.nodeType){if(!r.getAttribute("data-mce-bogus")&&(i=r.nodeName.toLowerCase(),f[i]&&"br"!==i))return!1}else if(3===r.nodeType&&!/^[ \t\r\n]*$/.test(r.nodeValue))return!1;t?n.prev():n.next()}return!0}function m(e,n){var r,s,o,u,f,c,h=B||"P";if(s=i.getParent(e,i.isBlock),c=t.getBody().nodeName.toLowerCase(),!s||!l(s)){if(s=s||N,!s.hasChildNodes())return r=i.create(h),s.appendChild(r),x.setStart(r,0),x.setEnd(r,0),r;for(u=e;u.parentNode!=s;)u=u.parentNode;for(;u&&!i.isBlock(u);)o=u,u=u.previousSibling;if(o&&a.isValidChild(c,h.toLowerCase())){for(r=i.create(h),o.parentNode.insertBefore(r,o),u=o;u&&!i.isBlock(u);)f=u.nextSibling,r.appendChild(u),u=f;x.setStart(e,n),x.setEnd(e,n)}}return e}function g(){function e(e){for(var t=D[e?"firstChild":"lastChild"];t&&1!=t.nodeType;)t=t[e?"nextSibling":"previousSibling"];return t===L}function t(){var e=D.parentNode;return"LI"==e.nodeName?e:D}var n=D.parentNode.nodeName;/^(OL|UL|LI)$/.test(n)&&(B="LI"),M=B?d(B):i.create("BR"),e(!0)&&e()?"LI"==n?i.insertAfter(M,t()):i.replace(M,D):e(!0)?"LI"==n?(i.insertAfter(M,t()),M.appendChild(i.doc.createTextNode(" ")),M.appendChild(D)):D.parentNode.insertBefore(M,D):e()?(i.insertAfter(M,t()),c(M)):(D=t(),T=x.cloneRange(),T.setStartAfter(L),T.setEndAfter(D),_=T.extractContents(),i.insertAfter(_,D),i.insertAfter(M,D)),i.remove(L),p(M),u.add()}function y(){for(var t=new e(C,L),n;n=t.next();)if(f[n.nodeName.toLowerCase()]||n.length>0)return!0}function b(){var e,t,r;C&&3==C.nodeType&&k>=C.nodeValue.length&&(n||y()||(e=i.create("br"),x.insertNode(e),x.setStartAfter(e),x.setEndAfter(e),t=!0)),e=i.create("br"),x.insertNode(e),n&&"PRE"==P&&(!A||8>A)&&e.parentNode.insertBefore(i.doc.createTextNode("\r"),e),r=i.create("span",{},"&nbsp;"),e.parentNode.insertBefore(r,e),s.scrollIntoView(r),i.remove(r),t?(x.setStartBefore(e),x.setEndBefore(e)):(x.setStartAfter(e),x.setEndAfter(e)),s.setRng(x),u.add()}function w(e){do 3===e.nodeType&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,"")),e=e.firstChild;while(e)}function E(e){var t=i.getRoot(),n,r;for(n=e;n!==t&&"false"!==i.getContentEditable(n);)"true"===i.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==t?r:t}function S(e){var t;n||(e.normalize(),t=e.lastChild,(!t||/^(left|right)$/gi.test(i.getStyle(t,"float",!0)))&&i.add(e,"br"))}var x=s.getRng(!0),T,N,C,k,L,A,O,M,_,D,P,H,B,j;if(!x.collapsed)return t.execCommand("Delete"),void 0;if(!r.isDefaultPrevented()&&(C=x.startContainer,k=x.startOffset,B=(o.force_p_newlines?"p":"")||o.forced_root_block,B=B?B.toUpperCase():"",A=i.doc.documentMode,O=r.shiftKey,1==C.nodeType&&C.hasChildNodes()&&(j=k>C.childNodes.length-1,C=C.childNodes[Math.min(k,C.childNodes.length-1)]||C,k=j&&3==C.nodeType?C.nodeValue.length:0),N=E(C))){if(u.beforeChange(),!i.isBlock(N)&&N!=i.getRoot())return(!B||O)&&b(),void 0;if((B&&!O||!B&&O)&&(C=m(C,k)),L=i.getParent(C,i.isBlock),D=L?i.getParent(L.parentNode,i.isBlock):null,P=L?L.nodeName.toUpperCase():"",H=D?D.nodeName.toUpperCase():"","LI"!=H||r.ctrlKey||(L=D,P=H),"LI"==P){if(!B&&O)return b(),void 0;if(i.isEmpty(L))return g(),void 0}if("PRE"==P&&o.br_in_pre!==!1){if(!O)return b(),void 0}else if(!B&&!O&&"LI"!=P||B&&O)return b(),void 0;B&&L===t.getBody()||(B=B||"P",v()?(M=/^(H[1-6]|PRE|FIGURE)$/.test(P)&&"HGROUP"!=H?d(B):d(),o.end_container_on_empty_block&&l(D)&&i.isEmpty(L)?M=i.split(D,L):i.insertAfter(M,L),p(M)):v(!0)?(M=L.parentNode.insertBefore(d(),L),c(M)):(T=x.cloneRange(),T.setEndAfter(L),_=T.extractContents(),w(_),M=_.firstChild,i.insertAfter(_,L),h(M),S(L),p(M)),i.setAttrib(M,"id",""),u.add())}}var i=t.dom,s=t.selection,o=t.settings,u=t.undoManager,a=t.schema,f=a.getNonEmptyElements();t.on("keydown",function(e){13==e.keyCode&&r(e)!==!1&&e.preventDefault()})}}),r(H,[],function(){return function(e){function t(){var t=i.getStart(),u=e.getBody(),a,f,l,c,h,p,d,v=-16777215,m,g,y,b,w;if(w=n.forced_root_block,t&&1===t.nodeType&&w){for(;t&&t!=u;){if(o[t.nodeName])return;t=t.parentNode}if(a=i.getRng(),a.setStart){f=a.startContainer,l=a.startOffset,c=a.endContainer,h=a.endOffset;try{g=e.getDoc().activeElement===u}catch(E){}}else a.item&&(t=a.item(0),a=e.getDoc().body.createTextRange(),a.moveToElementText(t)),g=a.parentElement().ownerDocument===e.getDoc(),y=a.duplicate(),y.collapse(!0),l=-1*y.move("character",v),y.collapsed||(y=a.duplicate(),y.collapse(!1),h=-1*y.move("character",v)-l);for(t=u.firstChild,b=u.nodeName.toLowerCase();t;)if((3===t.nodeType||1==t.nodeType&&!o[t.nodeName])&&s.isValidChild(b,w.toLowerCase())){if(3===t.nodeType&&0===t.nodeValue.length){d=t,t=t.nextSibling,r.remove(d);continue}p||(p=r.create(w),t.parentNode.insertBefore(p,t),m=!0),d=t,t=t.nextSibling,p.appendChild(d)}else p=null,t=t.nextSibling;if(m&&g){if(a.setStart)a.setStart(f,l),a.setEnd(c,h),i.setRng(a);else try{a=e.getDoc().body.createTextRange(),a.moveToElementText(u),a.collapse(!0),a.moveStart("character",l),h>0&&a.moveEnd("character",h),a.select()}catch(E){}e.nodeChanged()}}}var n=e.settings,r=e.dom,i=e.selection,s=e.schema,o=s.getBlockElements();n.forced_root_block&&e.on("KeyUp NodeChange",t)}}),r(B,[N,m,p],function(e,n,r){var i=r.each,s=r.extend,o=r.map,u=r.inArray,a=r.explode,f=n.gecko,l=n.ie,c=!0,h=!1;return function(n){function r(e,t,n){var r;return e=e.toLowerCase(),(r=x.exec[e])?(r(e,t,n),c):h}function p(e){var t;return e=e.toLowerCase(),(t=x.state[e])?t(e):-1}function d(e){var t;return e=e.toLowerCase(),(t=x.value[e])?t(e):h}function v(e,t){t=t||"exec",i(e,function(e,n){i(n.toLowerCase().split(","),function(n){x[t][n]=e})})}function m(e,r,i){return r===t&&(r=h),i===t&&(i=null),n.getDoc().execCommand(e,r,i)}function g(e){return N.match(e)}function y(e,r){N.toggle(e,r?{value:r}:t),n.nodeChanged()}function b(e){C=S.getBookmark(e)}function w(){S.moveToBookmark(C)}var E=n.dom,S=n.selection,x={state:{},exec:{},value:{}},T=n.settings,N=n.formatter,C;s(this,{execCommand:r,queryCommandState:p,queryCommandValue:d,addCommands:v}),v({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){n.undoManager.add()},"Cut,Copy,Paste":function(e){var t=n.getDoc(),r;try{m(e)}catch(i){r=c}(r||!t.queryCommandSupported(e))&&n.windowManager.alert("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.")},unlink:function(e){S.isCollapsed()&&S.select(S.getNode()),m(e),S.collapse(h)},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(e){var t=e.substring(7);"full"==t&&(t="justify"),i("left,center,right,justify".split(","),function(e){t!=e&&N.remove("align"+e)}),y("align"+t),r("mceRepaint")},"InsertUnorderedList,InsertOrderedList":function(e){var t,n;m(e),t=E.getParent(S.getNode(),"ol,ul"),t&&(n=t.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(n.nodeName)&&(b(),E.split(n,t),w()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){y(e)},"ForeColor,HiliteColor,FontName":function(e,t,n){y(e,n)},FontSize:function(e,t,n){var r,i;n>=1&&7>=n&&(i=a(T.font_size_style_values),r=a(T.font_size_classes),n=r?r[n-1]||n:i[n-1]||n),y(e,n)},RemoveFormat:function(e){N.remove(e)},mceBlockQuote:function(){y("blockquote")},FormatBlock:function(e,t,n){return y(n||"p")},mceCleanup:function(){var e=S.getBookmark();n.setContent(n.getContent({cleanup:c}),{cleanup:c}),S.moveToBookmark(e)},mceRemoveNode:function(e,t,r){var i=r||S.getNode();i!=n.getBody()&&(b(),n.dom.remove(i,c),w())},mceSelectNodeDepth:function(e,t,r){var i=0;E.getParent(S.getNode(),function(e){return 1==e.nodeType&&i++==r?(S.select(e),h):void 0},n.getBody())},mceSelectNode:function(e,t,n){S.select(n)},mceInsertContent:function(t,r,i){function s(e){function t(e){return r[e]&&3==r[e].nodeType}var n,r,i;return n=S.getRng(!0),r=n.startContainer,i=n.startOffset,3==r.nodeType&&(i>0?e=e.replace(/^&nbsp;/," "):t("previousSibling")||(e=e.replace(/^ /,"&nbsp;")),i<r.length?e=e.replace(/&nbsp;(<br>|)$/," "):t("nextSibling")||(e=e.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;"))),e}var o,u,a,f,c,h,p,d,v,m,g,y,b,w;if(/^ | $/.test(i)&&(i=s(i)),o=n.parser,u=new e({},n.schema),b='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>',h={content:i,format:"html",selection:!0},n.fire("BeforeSetContent",h),i=h.content,-1==i.indexOf("{$caret}")&&(i+="{$caret}"),i=i.replace(/\{\$caret\}/,b),S.isCollapsed()||n.getDoc().execCommand("Delete",!1,null),a=S.getNode(),h={context:a.nodeName.toLowerCase()},c=o.parse(i,h),g=c.lastChild,"mce_marker"==g.attr("id"))for(p=g,g=g.prev;g;g=g.walk(!0))if(3==g.type||!E.isBlock(g.name)){g.parent.insert(p,g,"br"===g.name);break}if(h.invalid){for(S.setContent(b),a=S.getNode(),f=n.getBody(),9==a.nodeType?a=g=f:g=a;g!==f;)a=g,g=g.parentNode;i=a==f?f.innerHTML:E.getOuterHTML(a),i=u.serialize(o.parse(i.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return u.serialize(c)}))),a==f?E.setHTML(f,i):E.setOuterHTML(a,i)}else i=u.serialize(c),g=a.firstChild,y=a.lastChild,!g||g===y&&"BR"===g.nodeName?E.setHTML(a,i):S.setContent(i);p=E.get("mce_marker"),d=E.getRect(p),v=E.getViewPort(n.getWin()),(d.y+d.h>v.y+v.h||d.y<v.y||d.x>v.x+v.w||d.x<v.x)&&(w=l?n.getDoc().documentElement:n.getBody(),w.scrollLeft=d.x,w.scrollTop=d.y-v.h+25),m=E.createRng(),g=p.previousSibling,g&&3==g.nodeType?(m.setStart(g,g.nodeValue.length),l||(y=p.nextSibling,y&&3==y.nodeType&&(g.appendData(y.data),y.parentNode.removeChild(y)))):(m.setStartBefore(p),m.setEndBefore(p)),E.remove(p),S.setRng(m),n.fire("SetContent",h),n.addVisual()},mceInsertRawHTML:function(e,t,r){S.setContent("tiny_mce_marker"),n.setContent(n.getContent().replace(/tiny_mce_marker/g,function(){return r}))},mceToggleFormat:function(e,t,n){y(n)},mceSetContent:function(e,t,r){n.setContent(r)},"Indent,Outdent":function(e){var t,n,r;t=T.indentation,n=/[a-z%]+$/i.exec(t),t=parseInt(t,10),p("InsertUnorderedList")||p("InsertOrderedList")?m(e):(T.forced_root_block||E.getParent(S.getNode(),E.isBlock)||N.apply("div"),i(S.getSelectedBlocks(),function(i){var s;"LI"!=i.nodeName&&(s="rtl"==E.getStyle(i,"direction",!0)?"paddingRight":"paddingLeft","outdent"==e?(r=Math.max(0,parseInt(i.style[s]||0,10)-t),E.setStyle(i,s,r?r+n:"")):(r=parseInt(i.style[s]||0,10)+t+n,E.setStyle(i,s,r)))}))},mceRepaint:function(){if(f)try{b(c),S.getSel()&&S.getSel().selectAllChildren(n.getBody()),S.collapse(c),w()}catch(e){}},InsertHorizontalRule:function(){n.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){n.hasVisual=!n.hasVisual,n.addVisual()},mceReplaceContent:function(e,t,r){n.execCommand("mceInsertContent",!1,r.replace(/\{\$selection\}/g,S.getContent({format:"text"})))},mceInsertLink:function(e,t,n){var r;"string"==typeof n&&(n={href:n}),r=E.getParent(S.getNode(),"a"),n.href=n.href.replace(" ","%20"),r&&n.href||N.remove("link"),n.href&&N.apply("link",n,r)},selectAll:function(){var e=E.getRoot(),t=E.createRng();S.getRng().setStart?(t.setStart(e,0),t.setEnd(e,e.childNodes.length),S.setRng(t)):m("SelectAll")},mceNewDocument:function(){n.setContent("")}}),v({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(e){var t="align"+e.substring(7),n=S.isCollapsed()?[E.getParent(S.getNode(),E.isBlock)]:S.getSelectedBlocks(),r=o(n,function(e){return!!N.matchNode(e,t)});return-1!==u(r,c)},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){return g(e)},mceBlockQuote:function(){return g("blockquote")},Outdent:function(){var e;if(T.inline_styles){if((e=E.getParent(S.getStart(),E.isBlock))&&parseInt(e.style.paddingLeft,10)>0)return c;if((e=E.getParent(S.getEnd(),E.isBlock))&&parseInt(e.style.paddingLeft,10)>0)return c}return p("InsertUnorderedList")||p("InsertOrderedList")||!T.inline_styles&&!!E.getParent(S.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(e){var t=E.getParent(S.getNode(),"ul,ol");return t&&("insertunorderedlist"===e&&"UL"===t.tagName||"insertorderedlist"===e&&"OL"===t.tagName)}},"state"),v({"FontSize,FontName":function(e){var t=0,n;return(n=E.getParent(S.getNode(),"span"))&&(t="fontsize"==e?n.style.fontSize:n.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase()),t}},"value"),v({Undo:function(){n.undoManager.undo()},Redo:function(){n.undoManager.redo()}})}}),r(j,[p],function(e){function t(e,i){var s=this,o,u;return e=r(e),i=s.settings=i||{},/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e)?(s.source=e,void 0):(0===e.indexOf("/")&&0!==e.indexOf("//")&&(e=(i.base_uri?i.base_uri.protocol||"http":"http")+"://mce_host"+e),/^[\w\-]*:?\/\//.test(e)||(u=i.base_uri?i.base_uri.path:(new t(location.href)).directory,e=(i.base_uri&&i.base_uri.protocol||"http")+"://mce_host"+s.toAbsPath(u,e)),e=e.replace(/@@/g,"(mce_at)"),e=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e),n(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(t,n){var r=e[n];r&&(r=r.replace(/\(mce_at\)/g,"@@")),s[t]=r}),o=i.base_uri,o&&(s.protocol||(s.protocol=o.protocol),s.userInfo||(s.userInfo=o.userInfo),s.port||"mce_host"!==s.host||(s.port=o.port),s.host&&"mce_host"!==s.host||(s.host=o.host),s.source=""),void 0)}var n=e.each,r=e.trim;return t.prototype={setPath:function(e){var t=this;e=/^(.*?)\/?(\w+)?$/.exec(e),t.path=e[0],t.directory=e[1],t.file=e[2],t.source="",t.getURI()},toRelative:function(e){var n=this,r;if("./"===e)return e;if(e=new t(e,{base_uri:n}),"mce_host"!=e.host&&n.host!=e.host&&e.host||n.port!=e.port||n.protocol!=e.protocol)return e.getURI();var i=n.getURI(),s=e.getURI();return i==s||"/"==i.charAt(i.length-1)&&i.substr(0,i.length-1)==s?i:(r=n.toRelPath(n.path,e.path),e.query&&(r+="?"+e.query),e.anchor&&(r+="#"+e.anchor),r)},toAbsolute:function(e,n){return e=new t(e,{base_uri:this}),e.getURI(this.host==e.host&&this.protocol==e.protocol?n:0)},toRelPath:function(e,t){var n,r=0,i="",s,o;if(e=e.substring(0,e.lastIndexOf("/")),e=e.split("/"),n=t.split("/"),e.length>=n.length)for(s=0,o=e.length;o>s;s++)if(s>=n.length||e[s]!=n[s]){r=s+1;break}if(e.length<n.length)for(s=0,o=n.length;o>s;s++)if(s>=e.length||e[s]!=n[s]){r=s+1;break}if(1===r)return t;for(s=0,o=e.length-(r-1);o>s;s++)i+="../";for(s=r-1,o=n.length;o>s;s++)i+=s!=r-1?"/"+n[s]:n[s];return i},toAbsPath:function(e,t){var r,i=0,s=[],o,u;for(o=/\/$/.test(t)?"/":"",e=e.split("/"),t=t.split("/"),n(e,function(e){e&&s.push(e)}),e=s,r=t.length-1,s=[];r>=0;r--)0!==t[r].length&&"."!==t[r]&&(".."!==t[r]?i>0?i--:s.push(t[r]):i++);return r=e.length-i,u=0>=r?s.reverse().join("/"):e.slice(0,r).join("/")+"/"+s.reverse().join("/"),0!==u.indexOf("/")&&(u="/"+u),o&&u.lastIndexOf("/")!==u.length-1&&(u+=o),u},getURI:function(e){var t,n=this;return(!n.source||e)&&(t="",e||(n.protocol&&(t+=n.protocol+"://"),n.userInfo&&(t+=n.userInfo+"@"),n.host&&(t+=n.host),n.port&&(t+=":"+n.port)),n.path&&(t+=n.path),n.query&&(t+="?"+n.query),n.anchor&&(t+="#"+n.anchor),n.source=t),n.source}},t}),r(F,[p],function(e){function t(){}var n=e.each,r=e.extend,i,s;return t.extend=i=function(e){function t(){var e,t,n,r;if(!s&&(r=this,r.init&&r.init.apply(r,arguments),t=r.Mixins))for(e=t.length;e--;)n=t[e],n.init&&n.init.apply(r,arguments)}function o(){return this}function u(e,t){return function(){var n=this,r=n._super,i;return n._super=f[e],i=t.apply(n,arguments),n._super=r,i}}var a=this,f=a.prototype,l,c,h;s=!0,l=new a,s=!1,e.Mixins&&(n(e.Mixins,function(t){t=t;for(var n in t)"init"!==n&&(e[n]=t[n])}),f.Mixins&&(e.Mixins=f.Mixins.concat(e.Mixins))),e.Methods&&n(e.Methods.split(","),function(t){e[t]=o}),e.Properties&&n(e.Properties.split(","),function(t){var n="_"+t;e[t]=function(e){var t=this,r;return e!==r?(t[n]=e,t):t[n]}}),e.Statics&&n(e.Statics,function(e,n){t[n]=e}),e.Defaults&&f.Defaults&&(e.Defaults=r({},f.Defaults,e.Defaults));for(c in e)h=e[c],l[c]="function"==typeof h&&f[c]?u(c,h):h;return t.prototype=l,t.constructor=t,t.extend=i,t},t}),r(I,[F,p],function(e,t){function n(e){for(var t=[],n=e.length,r;n--;)r=e[n],r.__checked||(t.push(r),r.__checked=1);for(n=t.length;n--;)delete t[n].__checked;return t}var r=/^([\w\\*]+)?(?:#([\w\\]+))?(?:\.([\w\\\.]+))?(?:\[\@?([\w\\]+)([\^\$\*!~]?=)([\w\\]+)\])?(?:\:(.+))?/i,i=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,s=/^\s*|\s*$/g,o,u=e.extend({init:function(e){function t(e){return e?(e=e.toLowerCase(),function(t){return"*"===e||t.type===e}):void 0}function n(e){return e?function(t){return t._name===e}:void 0}function o(e){return e?(e=e.split("."),function(t){for(var n=e.length;n--;)if(!t.hasClass(e[n]))return!1;return!0}):void 0}function u(e,t,n){return e?function(r){var i=r[e]?r[e]():"";return t?"="===t?i===n:"*="===t?i.indexOf(n)>=0:"~="===t?(" "+i+" ").indexOf(" "+n+" ")>=0:"!="===t?i!=n:"^="===t?0===i.indexOf(n):"$="===t?i.substr(i.length-n.length)===n:!1:!!n}:void 0}function a(e){var t;return e?(e=/(?:not\((.+)\))|(.+)/i.exec(e),e[1]?(t=l(e[1],[]),function(e){return!c(e,t)}):(e=e[2],function(t,n,r){return"first"===e?0===n:"last"===e?n===r-1:"even"===e?0===n%2:"odd"===e?1===n%2:t[e]?t[e]():!1})):void 0}function f(e,i,f){function l(e){e&&i.push(e)}var c;return c=r.exec(e.replace(s,"")),l(t(c[1])),l(n(c[2])),l(o(c[3])),l(u(c[4],c[5],c[6])),l(a(c[7])),i.psuedo=!!c[7],i.direct=f,i}function l(e,t){var n=[],r,s,o;do if(i.exec(""),s=i.exec(e),s&&(e=s[3],n.push(s[1]),s[2])){r=s[3];break}while(s);for(r&&l(r,t),e=[],o=0;o<n.length;o++)">"!=n[o]&&e.push(f(n[o],[],">"===n[o-1]));return t.push(e),t}var c=this.match;this._selectors=l(e,[])},match:function(e,n){var r,i,s,o,u,a,f,l,c,h,p,d,v;for(n=n||this._selectors,r=0,i=n.length;i>r;r++){for(u=n[r],o=u.length,v=e,d=0,s=o-1;s>=0;s--)for(l=u[s];v;){for(l.psuedo&&(p=v.parent().items(),c=t.inArray(v,p),h=p.length),a=0,f=l.length;f>a;a++)if(!l[a](v,c,h)){a=f+1;break}if(a===f){d++;break}if(s===o-1)break;v=v.parent()}if(d===o)return!0}return!1},find:function(e){function t(e,n,i){var s,o,u,a,f,l=n[i];for(s=0,o=e.length;o>s;s++){for(f=e[s],u=0,a=l.length;a>u;u++)if(!l[u](f,s,o)){u=a+1;break}if(u===a)i==n.length-1?r.push(f):f.items&&t(f.items(),n,i+1);else if(l.direct)return;f.items&&t(f.items(),n,i)}}var r=[],i,s,a=this._selectors;if(e.items){for(i=0,s=a.length;s>i;i++)t(e.items(),a[i],0);s>1&&(r=n(r))}return o||(o=u.Collection),new o(r)}});return u}),r(q,[p,I,F],function(e,t,n){var r,i,s=Array.prototype.push,o=Array.prototype.slice;return i={length:0,init:function(e){e&&this.add(e)},add:function(t){var n=this;return e.isArray(t)?s.apply(n,t):t instanceof r?n.add(t.toArray()):s.call(n,t),n},set:function(e){var t=this,n=t.length,r;for(t.length=0,t.add(e),r=t.length;n>r;r++)delete t[r];return t},filter:function(e){var n=this,i,s,o=[],u,a;for("string"==typeof e?(e=new t(e),a=function(t){return e.match(t)}):a=e,i=0,s=n.length;s>i;i++)u=n[i],a(u)&&o.push(u);return new r(o)},slice:function(){return new r(o.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},each:function(t){return e.each(this,t),this},toArray:function(){return e.toArray(this)},indexOf:function(e){for(var t=this,n=t.length;n--&&t[n]!==e;);return n},reverse:function(){return new r(e.toArray(this).reverse())},hasClass:function(e){return this[0]?this[0].hasClass(e):!1},prop:function(e,t){var n=this,r,i;return t!==r?(n.each(function(n){n[e]&&n[e](t)}),n):(i=n[0],i&&i[e]?i[e]():void 0)},exec:function(t){var n=this,r=e.toArray(arguments).slice(1);return n.each(function(e){e[t]&&e[t].apply(e,r)}),n}},e.each("fire on off show hide addClass removeClass append prepend before after reflow".split(" "),function(t){i[t]=function(){var n=e.toArray(arguments);return this.each(function(e){t in e&&e[t].apply(e,n)}),this}}),e.each("text name disabled active selected checked visible parent value data".split(" "),function(e){i[e]=function(t){return this.prop(e,t)}}),r=n.extend(i),t.Collection=r,r}),r(R,[p,g],function(e,t){return{id:function(){return t.DOM.uniqueId()},createFragment:function(e){return t.DOM.createFragment(e)},getWindowSize:function(){return t.DOM.getViewPort()},getSize:function(e){return t.DOM.getSize(e)},getPos:function(e,n){return t.DOM.getPos(e,n)},getViewPort:function(e){return t.DOM.getViewPort(e)},get:function(e){return document.getElementById(e)},addClass:function(e,n){return t.DOM.addClass(e,n)},removeClass:function(e,n){return t.DOM.removeClass(e,n)},hasClass:function(e,n){return t.DOM.hasClass(e,n)},toggleClass:function(e,n,r){return t.DOM.toggleClass(e,n,r)},css:function(e,n,r){return t.DOM.setStyle(e,n,r)},on:function(e,n,r,i){return t.DOM.bind(e,n,r,i)},off:function(e,n,r){return t.DOM.unbind(e,n,r)},fire:function(e,n,r){return t.DOM.fire(e,n,r)}}}),r(U,[F,p,q,R],function(e,t,n,r){var i=t.makeMap("focusin focusout scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave wheel keydown keypress keyup contextmenu"," "),s={},o="onmousewheel"in document,u=!1,a=e.extend({Statics:{controlIdLookup:{}},classPrefix:"mce-",init:function(e){var n=this,i,s;if(n.settings=e=t.extend({},n.Defaults,e),n._id=r.id(),n._text=n._name="",n._width=n._height=0,n._aria={role:e.role},i=e.classes)for(i=i.split(" "),i.map={},s=i.length;s--;)i.map[i[s]]=!0;n._classes=i||[],n.visible(!0),t.each("title text width height name classes visible disabled active value".split(" "),function(t){var r=e[t],i;r!==i?n[t](r):n["_"+t]===i&&(n["_"+t]=!1)}),n.on("click",function(){return n.disabled()?!1:void 0}),e.classes&&t.each(e.classes.split(" "),function(e){n.addClass(e)}),n.settings=e,n._borderBox=n.parseBox(e.border),n._paddingBox=n.parseBox(e.padding),n._marginBox=n.parseBox(e.margin),e.hidden&&n.hide()},Properties:"parent,title,text,width,height,disabled,active,name,value",Methods:"renderHtml",getContainerElm:function(){return document.body},getParentCtrl:function(e){for(var t;e&&!(t=a.controlIdLookup[e.id]);)e=e.parentNode;return t},parseBox:function(e){var t,n=10;if(e)return"number"==typeof e?(e=e||0,{top:e,left:e,bottom:e,right:e}):(e=e.split(" "),t=e.length,1===t?e[1]=e[2]=e[3]=e[0]:2===t?(e[2]=e[0],e[3]=e[1]):3===t&&(e[3]=e[1]),{top:parseInt(e[0],n)||0,right:parseInt(e[1],n)||0,bottom:parseInt(e[2],n)||0,left:parseInt(e[3],n)||0})},borderBox:function(){return this._borderBox},paddingBox:function(){return this._paddingBox},marginBox:function(){return this._marginBox},measureBox:function(e,t){function n(t){var n=document.defaultView;return n?(t=t.replace(/[A-Z]/g,function(e){return"-"+e}),n.getComputedStyle(e,null).getPropertyValue(t)):e.currentStyle[t]}function r(e){var t=parseInt(n(e),10);return isNaN(t)?0:t}return{top:r(t+"TopWidth"),right:r(t+"RightWidth"),bottom:r(t+"BottomWidth"),left:r(t+"LeftWidth")}},initLayoutRect:function(){var e=this,t=e.settings,n,r,i=e.getEl(),s,o,u,a,f,l,c;n=e._borderBox=e._borderBox||e.measureBox(i,"border"),e._paddingBox=e._paddingBox||e.measureBox(i,"padding"),e._marginBox=e._marginBox||e.measureBox(i,"margin"),l=t.minWidth,c=t.minHeight,u=l||i.offsetWidth,a=c||i.offsetHeight,s=t.width,o=t.height,f=t.autoResize,f="undefined"!=typeof f?f:!s&&!o,s=s||u,o=o||a;var h=n.left+n.right,p=n.top+n.bottom,d=t.maxWidth||65535,v=t.maxHeight||65535;return e._layoutRect=r={x:t.x||0,y:t.y||0,w:s,h:o,deltaW:h,deltaH:p,contentW:s-h,contentH:o-p,innerW:s-h,innerH:o-p,startMinWidth:l||0,startMinHeight:c||0,minW:Math.min(u,d),minH:Math.min(a,v),maxW:d,maxH:v,autoResize:f,scrollW:0},e._lastLayoutRect={},r},layoutRect:function(e){var t=this,n=t._layoutRect,r,i,s,o,u,f;return n||(n=t.initLayoutRect()),e?(s=n.deltaW,o=n.deltaH,e.x!==u&&(n.x=e.x),e.y!==u&&(n.y=e.y),e.minW!==u&&(n.minW=e.minW),e.minH!==u&&(n.minH=e.minH),i=e.w,i!==u&&(i=i<n.minW?n.minW:i,i=i>n.maxW?n.maxW:i,n.w=i,n.innerW=i-s),i=e.h,i!==u&&(i=i<n.minH?n.minH:i,i=i>n.maxH?n.maxH:i,n.h=i,n.innerH=i-o),i=e.innerW,i!==u&&(i=i<n.minW-s?n.minW-s:i,i=i>n.maxW-s?n.maxW-s:i,n.innerW=i,n.w=i+s),i=e.innerH,i!==u&&(i=i<n.minH-o?n.minH-o:i,i=i>n.maxH-o?n.maxH-o:i,n.innerH=i,n.h=i+o),e.contentW!==u&&(n.contentW=e.contentW),e.contentH!==u&&(n.contentH=e.contentH),r=t._lastLayoutRect,(r.x!==n.x||r.y!==n.y||r.w!==n.w||r.h!==n.h)&&(f=a.repaintControls,f&&f.map&&!f.map[t._id]&&(f.push(t),f.map[t._id]=!0),r.x=n.x,r.y=n.y,r.w=n.w,r.h=n.h),t):n},repaint:function(){var e=this,t,n,r,i,s=0,o=0,u;t=e.getEl().style,r=e._layoutRect,u=e._lastRepaintRect||{},i=e._borderBox,s=i.left+i.right,o=i.top+i.bottom,r.x!==u.x&&(t.left=r.x+"px",u.x=r.x),r.y!==u.y&&(t.top=r.y+"px",u.y=r.y),r.w!==u.w&&(t.width=r.w-s+"px",u.w=r.w),r.h!==u.h&&(t.height=r.h-o+"px",u.h=r.h),e._hasBody&&r.innerW!==u.innerW&&(n=e.getEl("body").style,n.width=r.innerW+"px",u.innerW=r.innerW),e._hasBody&&r.innerH!==u.innerH&&(n=n||e.getEl("body").style,n.height=r.innerH+"px",u.innerH=r.innerH),e._lastRepaintRect=u,e.fire("repaint",{},!1)},on:function(e,t){function n(e){var t,n;return function(i){return t||r.parents().each(function(r){var i=r.settings.callbacks;return i&&(t=i[e])?(n=r,!1):void 0}),t.call(n,i)}}var r=this,s,o,u,a;if(t)for("string"==typeof t&&(t=n(t)),u=e.toLowerCase().split(" "),a=u.length;a--;)e=u[a],s=r._bindings,s||(s=r._bindings={}),o=s[e],o||(o=s[e]=[]),o.push(t),i[e]&&(r._nativeEvents?r._nativeEvents[e]=!0:r._nativeEvents={name:!0},r._rendered&&r.bindPendingEvents());return r},off:function(e,t){var n=this,r,i=n._bindings,s,o,u,a;if(i)if(e)for(u=e.toLowerCase().split(" "),r=u.length;r--;){if(e=u[r],s=i[e],!e){for(o in i)i[o].length=0;return n}if(s)if(t)for(a=s.length;a--;)s[a]===t&&s.splice(a,1);else s.length=0}else n._bindings=[];return n},fire:function(e,t,n){function r(){return!1}function i(){return!0}var s=this,o,u,a,f;if(e=e.toLowerCase(),t=t||{},t.type||(t.type=e),t.control||(t.control=s),t.preventDefault||(t.preventDefault=function(){t.isDefaultPrevented=i},t.stopPropagation=function(){t.isPropagationStopped=i},t.stopImmediatePropagation=function(){t.isImmediatePropagationStopped=i},t.isDefaultPrevented=r,t.isPropagationStopped=r,t.isImmediatePropagationStopped=r),s._bindings&&(a=s._bindings[e]))for(o=0,u=a.length;u>o&&(t.isImmediatePropagationStopped()||a[o].call(s,t)!==!1);o++);if(n!==!1)for(f=s.parent();f&&!t.isPropagationStopped();)f.fire(e,t,!1),f=f.parent();return t},parents:function(e){var t=this,r=new n;for(t=t.parent();t;t=t.parent())r.add(t);return e&&(r=r.filter(e)),r},next:function(){var e=this.parent().items();return e[e.indexOf(this)+1]},prev:function(){var e=this.parent().items();return e[e.indexOf(this)-1]},findCommonAncestor:function(e,t){for(var n;e;){for(n=t;n&&e!=n;)n=n.parent();if(e==n)break;e=e.parent()}return e},hasClass:function(e,t){var n=this._classes[t||"control"];return e=this.classPrefix+e,n&&!!n.map[e]},addClass:function(e,t){var n=this,r,i;return e=this.classPrefix+e,r=n._classes[t||"control"],r||(r=[],r.map={},n._classes[t||"control"]=r),r.map[e]||(r.map[e]=e,r.push(e),n._rendered&&(i=n.getEl(t),i&&(i.className=r.join(" ")))),n},removeClass:function(e,t){var n=this,r,i,s;if(e=this.classPrefix+e,r=n._classes[t||"control"],r&&r.map[e])for(delete r.map[e],i=r.length;i--;)r[i]===e&&r.splice(i,1);return n._rendered&&(s=n.getEl(t),s&&(s.className=r.join(" "))),n},toggleClass:function(e,t,n){var r=this;return t?r.addClass(e,n):r.removeClass(e,n),r},classes:function(e){var t=this._classes[e||"control"];return t?t.join(" "):""},getEl:function(e,t){var n,i=e?this._id+"-"+e:this._id;return n=s[i]=(t===!0?null:s[i])||r.get(i)},visible:function(e){var t=this,n;return"undefined"!=typeof e?(t._visible!==e&&(t._rendered&&(t.getEl().style.display=e?"":"none"),t._visible=e,n=t.parent(),n&&(n._lastRect=null),t.fire(e?"show":"hide")),t):t._visible},show:function(){return this.visible(!0)},hide:function(){return this.visible(!1)},focus:function(){try{this.getEl().focus()}catch(e){}return this},blur:function(){return this.getEl().blur(),this},aria:function(e,t){var n=this,r=n.getEl();return"undefined"==typeof t?n._aria[e]:(n._aria[e]=t,n._rendered&&("label"==e&&r.setAttribute("aria-labeledby",n._id),r.setAttribute("role"==e?e:"aria-"+e,t)),n)},encode:function(e,t){return t!==!1&&a.translate&&(e=a.translate(e)),(e||"").replace(/[&<>"]/g,function(e){return"&#"+e.charCodeAt(0)+";"})},before:function(e){var t=this,n=t.parent();return n&&n.insert(e,n.items().indexOf(t),!0),t},after:function(e){var t=this,n=t.parent();return n&&n.insert(e,n.items().indexOf(t)),t},remove:function(){var e=this,t=e.getEl(),n=e.parent(),i;if(e.items)for(var s=e.items().toArray(),o=s.length;o--;)s[o].remove();return n&&n.items&&(i=[],n.items().each(function(t){t!==e&&i.push(t)}),n.items().set(i),n._lastRect=null),e._eventsRoot&&e._eventsRoot==e&&r.off(t),delete a.controlIdLookup[e._id],t.parentNode&&t.parentNode.removeChild(t),e},renderBefore:function(e){var t=this;return e.parentNode.insertBefore(r.createFragment(t.renderHtml()),e),t.postRender(),t},renderTo:function(e){var t=this;return e=e||t.getContainerElm(),e.appendChild(r.createFragment(t.renderHtml())),t.postRender(),t},postRender:function(){var e=this,t=e.settings,n,i,s,o,u;for(o in t)0===o.indexOf("on")&&e.on(o.substr(2),t[o]);if(e._eventsRoot){for(s=e.parent();!u&&s;s=s.parent())u=s._eventsRoot;if(u)for(o in u._nativeEvents)e._nativeEvents[o]=!0}e.bindPendingEvents(),t.style&&(n=e.getEl(),n&&(n.setAttribute("style",t.style),n.style.cssText=t.style)),e._visible||r.css(e.getEl(),"display","none"),e.settings.border&&(i=e.borderBox(),r.css(e.getEl(),{"border-top-width":i.top,"border-right-width":i.right,"border-bottom-width":i.bottom,"border-left-width":i.left})),a.controlIdLookup[e._id]=e;for(var f in e._aria)e.aria(f,e._aria[f]);e.fire("postrender",{},!1)},scrollIntoView:function(e){function t(e,t){var n,r,i=e;for(n=r=0;i&&i!=t&&i.nodeType;)n+=i.offsetLeft||0,r+=i.offsetTop||0,i=i.offsetParent;return{x:n,y:r}}var n=this.getEl(),r=n.parentNode,i,s,o,u,a,f,l=t(n,r);return i=l.x,s=l.y,o=n.offsetWidth,u=n.offsetHeight,a=r.clientWidth,f=r.clientHeight,"end"==e?(i-=a-o,s-=f-u):"center"==e&&(i-=a/2-o/2,s-=f/2-u/2),r.scrollLeft=i,r.scrollTop=s,this},bindPendingEvents:function(){function e(e){var t=s.getParentCtrl(e.target);t&&t.fire(e.type,e)}function t(){var e=c._lastHoverCtrl;e&&(e.fire("mouseleave",{target:e.getEl()}),e.parents().each(function(e){e.fire("mouseleave",{target:e.getEl()})}),c._lastHoverCtrl=null)}function n(e){var t=s.getParentCtrl(e.target),n=c._lastHoverCtrl,r=0,i,o,u;if(t!==n){if(c._lastHoverCtrl=t,o=t.parents().toArray().reverse(),o.push(t),n){for(u=n.parents().toArray().reverse(),u.push(n),r=0;r<u.length&&o[r]===u[r];r++);for(i=u.length-1;i>=r;i--)n=u[i],n.fire("mouseleave",{target:n.getEl()})}for(i=r;i<o.length;i++)t=o[i],t.fire("mouseenter",{target:t.getEl()})}}function i(e){e.preventDefault(),"mousewheel"==e.type?(e.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(e.deltaX=-1/40*e.wheelDeltaX)):(e.deltaX=0,e.deltaY=e.detail),e=s.fire("wheel",e)}var s=this,a,f,l,c,h,p;if(s._rendered=!0,h=s._nativeEvents){for(l=s.parents().toArray(),l.unshift(s),a=0,f=l.length;!c&&f>a;a++)c=l[a]._eventsRoot;for(c||(c=l[l.length-1]||s),s._eventsRoot=c,f=a,a=0;f>a;a++)l[a]._eventsRoot=c;for(p in h){if(!h)return!1;"wheel"!==p||u?("mouseenter"===p||"mouseleave"===p?c._hasMouseEnter||(r.on(c.getEl(),"mouseleave",t),r.on(c.getEl(),"mouseover",n),c._hasMouseEnter=1):c[p]||(r.on(c.getEl(),p,e),c[p]=!0),h[p]=!1):o?r.on(s.getEl(),"mousewheel",i):r.on(s.getEl(),"DOMMouseScroll",i)}}},reflow:function(){return this.repaint(),this}});return a}),r(z,[],function(){var e={},t;return{add:function(t,n){e[t.toLowerCase()]=n},has:function(t){return!!e[t.toLowerCase()]},create:function(n,r){var i,s,o;if(!t){o=tinymce.ui;for(s in o)e[s.toLowerCase()]=o[s];t=!0}if("string"==typeof n?(r=r||{},r.type=n):(r=n,n=r.type),n=n.toLowerCase(),i=e[n],!i)throw new Error("Could not find control by type: "+n);return i=new i(r),i.type=n,i}}}),r(W,[U,q,I,z,p,R],function(e,t,n,r,i,s){var o={};return e.extend({layout:"",innerClass:"container-inner",init:function(e){var n=this;n._super(e),e=n.settings,n._fixed=e.fixed,n._items=new t,n.addClass("container"),n.addClass("container-body","body"),e.containerCls&&n.addClass(e.containerCls),n._layout=r.create((e.layout||n.layout)+"layout"),n.settings.items&&n.add(n.settings.items),n._hasBody=!0},items:function(){return this._items},find:function(e){return e=o[e]=o[e]||new n(e),e.find(this)},add:function(e){var t=this;return t.items().add(t.create(e)).parent(t),t},focus:function(){var e=this;return e.keyNav?e.keyNav.focusFirst():e._super(),e},replace:function(e,t){for(var n,r=this.items(),i=r.length;i--;)if(r[i]===e){r[i]=t;break}i>=0&&(n=t.getEl(),n&&n.parentNode.removeChild(n),n=e.getEl(),n&&n.parentNode.removeChild(n)),t.parent(this)},create:function(t){var n=this,s,o=[];return i.isArray(t)||(t=[t]),i.each(t,function(t){t&&(t instanceof e||("string"==typeof t&&(t={type:t}),s=i.extend({},n.settings.defaults,t),t.type=s.type=s.type||t.type||n.settings.defaultType||(s.defaults?s.defaults.type:null),t=r.create(s)),o.push(t))}),o},renderNew:function(){var e=this;return e.items().each(function(t,n){var r,i;t.parent(e),t._rendered||(r=e.getEl("body"),i=s.createFragment(t.renderHtml()),r.hasChildNodes()&&n<=r.childNodes.length-1?r.insertBefore(i,r.childNodes[n]):r.appendChild(i),t.postRender())}),e._layout.applyClasses(e),e._lastRect=null,e},append:function(e){return this.add(e).renderNew()},prepend:function(e){var t=this;return t.items().set(t.create(e).concat(t.items().toArray())),t.renderNew()},insert:function(e,t,n){var r=this,i,s,o;return e=r.create(e),i=r.items(),!n&&t<i.length-1&&(t+=1),t>=0&&t<i.length&&(s=i.slice(0,t).toArray(),o=i.slice(t).toArray(),i.set(s.concat(e,o))),r.renderNew()},fromJSON:function(e){var t=this;for(var n in e)t.find("#"+n).value(e[n]);return t},toJSON:function(){var e=this,t={};return e.find("*").each(function(e){var n=e.name(),r=e.value();n&&"undefined"!=typeof r&&(t[n]=r)}),t},preRender:function(){},renderHtml:function(){var e=this,t=e._layout;return e.preRender(),t.preRender(e),'<div id="'+e._id+'" class="'+e.classes()+'" role="'+this.settings.role+'">'+'<div id="'+e._id+'-body" class="'+e.classes("body")+'">'+(e.settings.html||"")+t.renderHtml(e)+"</div>"+"</div>"},postRender:function(){var e=this,t;return e.items().exec("postRender"),e._super(),e._layout.postRender(e),e._rendered=!0,e.settings.style&&s.css(e.getEl(),e.settings.style),e.settings.border&&(t=e.borderBox(),s.css(e.getEl(),{"border-top-width":t.top,"border-right-width":t.right,"border-bottom-width":t.bottom,"border-left-width":t.left})),e},initLayoutRect:function(){var e=this,t=e._super();return e._layout.recalc(e),t},recalc:function(){var e=this,t=e._layoutRect,n=e._lastRect;return n&&n.w==t.w&&n.h==t.h?void 0:(e._layout.recalc(e),t=e.layoutRect(),e._lastRect={x:t.x,y:t.y,w:t.w,h:t.h},!0)},reflow:function(){var t,n;if(this.visible()){for(e.repaintControls=[],e.repaintControls.map={},n=this.recalc(),t=e.repaintControls.length;t--;)e.repaintControls[t].repaint();"flow"!==this.settings.layout&&"stack"!==this.settings.layout&&this.repaint(),e.repaintControls=[]}return this}})}),r(X,[R],function(e){function t(){var e=document,t,n,r,i,s,o,u,a,f=Math.max;return t=e.documentElement,n=e.body,r=f(t.scrollWidth,n.scrollWidth),i=f(t.clientWidth,n.clientWidth),s=f(t.offsetWidth,n.offsetWidth),o=f(t.scrollHeight,n.scrollHeight),u=f(t.clientHeight,n.clientHeight),a=f(t.offsetHeight,n.offsetHeight),{width:s>r?i:r,height:a>o?u:o}}return function(n,r){function i(){return o.getElementById(r.handle||n)}var s,o=document,u,a,f,l,c,h;r=r||{},a=function(n){var a=t(),p,d;n.preventDefault(),u=n.button,p=i(),c=n.screenX,h=n.screenY,d=window.getComputedStyle?window.getComputedStyle(p,null).getPropertyValue("cursor"):p.runtimeStyle.cursor,s=o.createElement("div"),e.css(s,{position:"absolute",top:0,left:0,width:a.width,height:a.height,zIndex:2147483647,opacity:1e-4,background:"red",cursor:d}),o.body.appendChild(s),e.on(o,"mousemove",l),e.on(o,"mouseup",f),r.start(n)},l=function(e){return e.button!==u?f(e):(e.deltaX=e.screenX-c,e.deltaY=e.screenY-h,e.preventDefault(),r.drag(e),void 0)},f=function(t){e.off(o,"mousemove",l),e.off(o,"mouseup",f),s.parentNode.removeChild(s),r.stop&&r.stop(t)},this.destroy=function(){e.off(i())},e.on(i(),"mousedown",a)}}),r(V,[R,X],function(e,t){return{init:function(){var e=this;e.on("repaint",e.renderScroll)},renderScroll:function(){function n(){function t(t,o,u,a,f,l){var c,h,p,d,v,m,g,y,b;if(h=i.getEl("scroll"+t)){if(y=o.toLowerCase(),b=u.toLowerCase(),i.getEl("absend")&&e.css(i.getEl("absend"),y,i.layoutRect()[a]-1),!f)return e.css(h,"display","none"),void 0;e.css(h,"display","block"),c=i.getEl("body"),p=i.getEl("scroll"+t+"t"),d=c["client"+u]-2*s,d-=n&&r?h["client"+l]:0,v=c["scroll"+u],m=d/v,g={},g[y]=c["offset"+o]+s,g[b]=d,e.css(h,g),g={},g[y]=c["scroll"+o]*m,g[b]=d*m,e.css(p,g)}}var n,r,o;o=i.getEl("body"),n=o.scrollWidth>o.clientWidth,r=o.scrollHeight>o.clientHeight,t("h","Left","Width","contentW",n,"Height"),t("v","Top","Height","contentH",r,"Width")}function r(){function n(n,r,o,u,a){var f,l=i._id+"-scroll"+n,c=i.classPrefix;i.getEl().appendChild(e.createFragment('<div id="'+l+'" class="'+c+"scrollbar "+c+"scrollbar-"+n+'">'+'<div id="'+l+'t" class="'+c+'scrollbar-thumb"></div>'+"</div>")),i.draghelper=new t(l+"t",{start:function(){f=i.getEl("body")["scroll"+r],e.addClass(e.get(l),c+"active")},drag:function(e){var t,l,c,h,p=i.layoutRect();l=p.contentW>p.innerW,c=p.contentH>p.innerH,h=i.getEl("body")["client"+o]-2*s,h-=l&&c?i.getEl("scroll"+n)["client"+a]:0,t=h/i.getEl("body")["scroll"+o],i.getEl("body")["scroll"+r]=f+e["delta"+u]/t},stop:function(){e.removeClass(e.get(l),c+"active")}})}i.addClass("scroll"),n("v","Top","Height","Y","Width"),n("h","Left","Width","X","Height")}var i=this,s=2;i.settings.autoScroll&&(i._hasScroll||(i._hasScroll=!0,r(),i.on("wheel",function(e){var t=i.getEl("body");t.scrollLeft+=10*(e.deltaX||0),t.scrollTop+=10*e.deltaY,n()}),e.on(i.getEl("body"),"scroll",n)),n())}}}),r($,[W,V],function(e,t){return e.extend({Defaults:{layout:"fit",containerCls:"panel"},Mixins:[t],renderHtml:function(){var e=this,t=e._layout,n=e.settings.html;return e.preRender(),t.preRender(e),"undefined"==typeof n?n='<div id="'+e._id+'-body" class="'+e.classes("body")+'">'+t.renderHtml(e)+"</div>":("function"==typeof n&&(n=n.call(e)),e._hasBody=!1),'<div id="'+e._id+'" class="'+e.classes()+'" hideFocus="1" tabIndex="-1">'+(e._preBodyHtml||"")+n+"</div>"}})}),r(J,[R],function(e){function t(t,n,r){var i,s,o,u,a,f,l,c,h;return h=e.getViewPort(),s=e.getPos(n),o=s.x,u=s.y,t._fixed&&(o-=h.x,u-=h.y),i=t.getEl(),a=i.offsetWidth,f=i.offsetHeight,l=n.offsetWidth,c=n.offsetHeight,r=(r||"").split(""),"b"===r[0]&&(u+=c),"r"===r[1]&&(o+=l),"c"===r[0]&&(u+=Math.round(c/2)),"c"===r[1]&&(o+=Math.round(l/2)),"b"===r[3]&&(u-=f),"r"===r[4]&&(o-=a),"c"===r[3]&&(u-=Math.round(f/2)),"c"===r[4]&&(o-=Math.round(a/2)),{x:o,y:u,w:a,h:f}}return{testMoveRel:function(n,r){for(var i=e.getViewPort(),s=0;s<r.length;s++){var o=t(this,n,r[s]);if(this._fixed){if(o.x>0&&o.x+o.w<i.w&&o.y>0&&o.y+o.h<i.h)return r[s]}else if(o.x>i.x&&o.x+o.w<i.w+i.x&&o.y>i.y&&o.y+o.h<i.h+i.y)return r[s]}return r[0]},moveRel:function(e,n){"string"!=typeof n&&(n=this.testMoveRel(e,n));var r=t(this,e,n);return this.moveTo(r.x,r.y)},moveBy:function(e,t){var n=this,r=n.layoutRect();return n.moveTo(r.x+e,r.y+t),n},moveTo:function(t,n){function r(e,t,n){return 0>e?0:e+n>t?(e=t-n,0>e?0:e):e}var i=this;if(i.settings.constrainToViewport){var s=e.getViewPort(window),o=i.layoutRect();t=r(t,s.w+s.x,o.w),n=r(n,s.h+s.y,o.h)}return i._rendered?i.layoutRect({x:t,y:n}).repaint():(i.settings.x=t,i.settings.y=n),i.fire("move",{x:t,y:n}),i}}}),r(K,[R],function(e){return{resizeToContent:function(){this._layoutRect.autoResize=!0,this._lastRect=null,this.reflow()},resizeTo:function(t,n){if(1>=t||1>=n){var r=e.getWindowSize();t=1>=t?t*r.w:t,n=1>=n?n*r.h:n}return this._layoutRect.autoResize=!1,this.layoutRect({minW:t,minH:n,w:t,h:n}).reflow()},resizeBy:function(e,t){var n=this,r=n.layoutRect();return n.resizeTo(r.w+e,r.h+t)}}}),r(Q,[$,J,K,R],function(e,t,n,r){function i(e){var t;for(t=u.length;t--;)u[t]===e&&u.splice(t,1)}var s,o,u=[],a=[],f,l=e.extend({Mixins:[t,n],init:function(e){function t(){var e,t=l.zIndex||65535,n;if(a.length)for(e=0;e<a.length;e++)a[e].modal&&(t++,n=a[e]),a[e].getEl().style.zIndex=t,a[e].zIndex=t,t++;var i=document.getElementById(c.classPrefix+"modal-block");n?r.css(i,"z-index",n.zIndex-1):i&&(i.parentNode.removeChild(i),f=!1),l.currentZIndex=t}function n(e,t){for(;e;){if(e==t)return!0;e=e.parent()}}function i(e){function t(t,n){for(var r,i=0;i<u.length;i++)if(u[i]!=e)for(r=u[i].parent();r&&(r=r.parent());)r==e&&u[i].fixed(t).moveBy(0,n).repaint()}var n=r.getViewPort().y;e.settings.autofix&&(e._fixed?e._autoFixY>n&&(e.fixed(!1).layoutRect({y:e._autoFixY}).repaint(),t(!1,e._autoFixY-n)):(e._autoFixY=e.layoutRect().y,e._autoFixY<n&&(e.fixed(!0).layoutRect({y:0}).repaint(),t(!0,n-e._autoFixY))))}var c=this;c._super(e),c._eventsRoot=c,c.addClass("floatpanel"),e.autohide&&(s||(s=function(e){var t,r=c.getParentCtrl(e.target);for(t=u.length;t--;){var i=u[t];if(i.settings.autohide){if(r&&(n(r,i)||i.parent()===r))continue;e=i.fire("autohide",{target:e.target}),e.isDefaultPrevented()||i.hide()}}},r.on(document,"click",s)),u.push(c)),e.autofix&&(o||(o=function(){var e;for(e=u.length;e--;)i(u[e])},r.on(window,"scroll",o)),c.on("move",function(){i(this)})),c.on("postrender show",function(e){if(e.control==c){var n,i=c.classPrefix;c.modal&&!f&&(n=r.createFragment('<div id="'+i+'modal-block" class="'+i+"reset "+i+'fade"></div>'),n=n.firstChild,c.getContainerElm().appendChild(n),setTimeout(function(){r.addClass(n,i+"in"),r.addClass(c.getEl(),i+"in")},0),f=!0),a.push(c),t()}}),c.on("close hide",function(e){if(e.control==c){for(var n=a.length;n--;)a[n]===c&&a.splice(n,1);t()}}),c.on("show",function(){c.parents().each(function(e){return e._fixed?(c.fixed(!0),!1):void 0})}),e.popover&&(c._preBodyHtml='<div class="'+c.classPrefix+'arrow"></div>',c.addClass("popover").addClass("bottom").addClass("start"))},fixed:function(e){var t=this;if(t._fixed!=e){if(t._rendered){var n=r.getViewPort();e?t.layoutRect().y-=n.y:t.layoutRect().y+=n.y}t.toggleClass("fixed",e),t._fixed=e}return t},show:function(){var e=this,t,n=e._super();for(t=u.length;t--&&u[t]!==e;);return-1===t&&u.push(e),n},hide:function(){return i(this),this._super()},hideAll:function(){l.hideAll()},close:function(){var e=this;return e.fire("close"),e.remove()},remove:function(){i(this),this._super()}});return l.hideAll=function(){for(var e=u.length;e--;){var t=u[e];t.settings.autohide&&(t.fire("cancel",{},!1),t.hide(),u.splice(e,1))}},l}),r(G,[R],function(e){return function(t){function n(){if(!d)if(d=[],c.find)c.find("*").each(function(e){e.canFocus&&d.push(e.getEl())});else for(var e=c.getEl().getElementsByTagName("*"),t=0;t<e.length;t++)e[t].id&&e[t]&&d.push(e[t])}function r(){return document.getElementById(v)}function i(e){return e=e||r(),e&&e.getAttribute("role")}function s(e){for(var t,n=e||r();n=n.parentNode;)if(t=i(n))return t}function o(e){var t=document.getElementById(v);return t?t.getAttribute("aria-"+e):void 0}function u(){var n=r();if(!n||"TEXTAREA"!=n.nodeName&&"text"!=n.type)return t.onAction?t.onAction(v):e.fire(r(),"click",{keyboard:!0}),!0}function a(){var e;t.onCancel?((e=r())&&e.blur(),t.onCancel()):t.root.fire("cancel")}function f(e){function r(e){for(var t=c?c.getEl():document.body;e&&e!=t;){if("none"==e.style.display)return!1;e=e.parentNode}return!0}var i=-1,s,o,a=[];for(n(),o=a.length,o=0;o<d.length;o++)r(d[o])&&a.push(d[o]);for(o=a.length;o--;)if(a[o].id===v){i=o;break}i+=e,0>i?i=a.length-1:i>=a.length&&(i=0),s=a[i],s.focus(),v=s.id,t.actOnFocus&&u()}function l(){var e,r;for(r=i(t.root.getEl()),n(),e=d.length;e--;)if("toolbar"==r&&d[e].id===v)return d[e].focus(),void 0;d[0].focus()}var c=t.root,h=t.enableUpDown!==!1,p=t.enableLeftRight!==!1,d=t.items,v;return c.on("keydown",function(e){var n=37,r=39,l=38,c=40,d=27,v=14,m=13,g=32,y=9,b;switch(e.keyCode){case n:p&&(t.leftAction?t.leftAction():f(-1),b=!0);break;case r:p&&("menuitem"==i()&&"menu"==s()?o("haspopup")&&u():f(1),b=!0);break;case l:h&&(f(-1),b=!0);break;case c:h&&("menuitem"==i()&&"menubar"==s()?u():"button"==i()&&o("haspopup")?u():f(1),b=!0);break;case y:b=!0,e.shiftKey?f(-1):f(1);break;case d:b=!0,a();break;case v:case m:case g:b=u()}b&&(e.stopPropagation(),e.preventDefault())}),c.on("focusin",function(e){n(),v=e.target.id}),{moveFocus:f,focusFirst:l,cancel:a}}}),r(Y,[Q,$,R,G,X],function(e,t,n,r,i){var s=e.extend({modal:!0,Defaults:{border:1,layout:"flex",containerCls:"panel",role:"dialog",callbacks:{submit:function(){this.fire("submit",{data:this.toJSON()})},close:function(){this.close()}}},init:function(e){var n=this;n._super(e),n.addClass("window"),n._fixed=!0,e.buttons&&(n.statusbar=new t({layout:"flex",border:"1 0 0 0",spacing:3,padding:10,align:"center",pack:"end",defaults:{type:"button"},items:e.buttons}),n.statusbar.addClass("foot"),n.statusbar.parent(n)),n.on("click",function(e){-1!=e.target.className.indexOf(n.classPrefix+"close")&&n.close()}),n.aria("label",e.title),n._fullscreen=!1},recalc:function(){var e=this,t=e.statusbar,r,i,s;e._fullscreen&&(e.layoutRect(n.getWindowSize()),e.layoutRect().contentH=e.layoutRect().innerH),e._super(),r=e.layoutRect(),e.settings.title&&!e._fullscreen&&(i=r.headerW,i>r.w&&(e.layoutRect({w:i}),s=!0)),t&&(t.layoutRect({w:e.layoutRect().innerW}).recalc(),i=t.layoutRect().minW+r.deltaW,i>r.w&&(e.layoutRect({w:i}),s=!0)),s&&e.recalc()},initLayoutRect:function(){var e=this,t=e._super(),r=0,i;e.settings.title&&!e._fullscreen&&(i=e.getEl("head"),t.headerW=i.offsetWidth,t.headerH=i.offsetHeight,r+=t.headerH),e.statusbar&&(r+=e.statusbar.layoutRect().h),t.deltaH+=r,t.minH+=r,t.h+=r;var s=n.getWindowSize();return t.x=Math.max(0,s.w/2-t.w/2),t.y=Math.max(0,s.h/2-t.h/2),t},renderHtml:function(){var e=this,t=e._layout,n=e._id,r=e.classPrefix,i=e.settings,s="",o="",u=i.html;return e.preRender(),t.preRender(e),i.title&&(s='<div id="'+n+'-head" class="'+r+'window-head">'+'<div class="'+r+'title">'+e.encode(i.title)+"</div>"+'<button type="button" class="'+r+'close" aria-hidden="true">&times;</button>'+'<div id="'+n+'-dragh" class="'+r+'dragh"></div>'+"</div>"),i.url&&(u='<iframe src="'+i.url+'" tabindex="-1"></iframe>'),"undefined"==typeof u&&(u=t.renderHtml(e)),e.statusbar&&(o=e.statusbar.renderHtml()),'<div id="'+n+'" class="'+e.classes()+'" hideFocus="1" tabIndex="-1">'+s+'<div id="'+n+'-body" class="'+e.classes("body")+'">'+u+"</div>"+o+"</div>"},fullscreen:function(e){var t=this,r=document.documentElement,i,s=t.classPrefix,o;if(e!=t._fullscreen)if(n.on(window,"resize",function(){var e;if(t._fullscreen)if(i)t._timer||(t._timer=setTimeout(function(){var e=n.getWindowSize();t.moveTo(0,0).resizeTo(e.w,e.h),t._timer=0},50));else{e=(new Date).getTime();var r=n.getWindowSize();t.moveTo(0,0).resizeTo(r.w,r.h),(new Date).getTime()-e>50&&(i=!0)}}),o=t.layoutRect(),t._fullscreen=e,e){t._initial={x:o.x,y:o.y,w:o.w,h:o.h},t._borderBox=t.parseBox("0"),t.getEl("head").style.display="none",o.deltaH-=o.headerH+2,n.addClass(r,s+"fullscreen"),n.addClass(document.body,s+"fullscreen"),t.addClass("fullscreen");var u=n.getWindowSize();t.moveTo(0,0).resizeTo(u.w,u.h)}else t._borderBox=t.parseBox(t.settings.border),t.getEl("head").style.display="",o.deltaH+=o.headerH,n.removeClass(r,s+"fullscreen"),n.removeClass(document.body,s+"fullscreen"),t.removeClass("fullscreen"),t.moveTo(t._initial.x,t._initial.y).resizeTo(t._initial.w,t._initial.h);return t.reflow()},postRender:function(){var e=this,t=[],n,s,o;setTimeout(function(){e.addClass("in")},0),e.keyboardNavigation=new r({root:e,enableLeftRight:!1,enableUpDown:!1,items:t,onCancel:function(){e.close()}}),e.find("*").each(function(e){e.canFocus&&(s=s||e.settings.autofocus,n=n||e,"filepicker"==e.type?(t.push(e.getEl("inp")),e.getEl("open")&&t.push(e.getEl("open").firstChild)):t.push(e.getEl()))}),e.statusbar&&e.statusbar.find("*").each(function(e){e.canFocus&&(s=s||e.settings.autofocus,n=n||e,t.push(e.getEl()))}),e._super(),e.statusbar&&e.statusbar.postRender(),!s&&n&&n.focus(),this.dragHelper=new i(e._id+"-dragh",{start:function(){o={x:e.layoutRect().x,y:e.layoutRect().y}},drag:function(t){e.moveTo(o.x+t.deltaX,o.y+t.deltaY)}}),e.on("submit",function(t){t.isDefaultPrevented()||e.close()})},submit:function(){var e=this.getParentCtrl(document.activeElement);return e&&e.blur(),this.fire("submit",{data:this.toJSON()})},remove:function(){var e=this;e._super(),e.dragHelper.destroy(),e.statusbar&&this.statusbar.remove()}});return s}),r(Z,[Y],function(e){var t=e.extend({init:function(e){e={border:1,padding:20,layout:"flex",pack:"center",align:"center",containerCls:"panel",autoScroll:!0,buttons:{type:"button",text:"Ok",action:"ok"},items:{type:"label",multiline:!0,maxWidth:500,maxHeight:200}},this._super(e)},Statics:{OK:1,OK_CANCEL:2,YES_NO:3,YES_NO_CANCEL:4,msgBox:function(n){var r,i=n.callback||function(){};switch(n.buttons){case t.OK_CANCEL:r=[{type:"button",text:"Ok",subtype:"primary",onClick:function(e){e.control.parents()[1].close(),i(!0)}},{type:"button",text:"Cancel",onClick:function(e){e.control.parents()[1].close(),i(!1)}}];break;case t.YES_NO:r=[{type:"button",text:"Ok",subtype:"primary",onClick:function(e){e.control.parents()[1].close(),i(!0)}}];break;case t.YES_NO_CANCEL:r=[{type:"button",text:"Ok",subtype:"primary",onClick:function(e){e.control.parents()[1].close()}}];break;default:r=[{type:"button",text:"Ok",subtype:"primary",onClick:function(e){e.control.parents()[1].close()}}]}return(new e({padding:20,x:n.x,y:n.y,minWidth:300,minHeight:100,layout:"flex",pack:"center",align:"center",buttons:r,title:n.title,items:{type:"label",multiline:!0,maxWidth:500,maxHeight:200,text:n.text},onClose:n.onClose})).renderTo(document.body).reflow()},alert:function(e,n){return"string"==typeof e&&(e={text:e}),e.callback=n,t.msgBox(e)},confirm:function(e,n){return"string"==typeof e&&(e={text:e}),e.callback=n,e.buttons=t.OK_CANCEL,t.msgBox(e)}}});return t}),r(et,[Y,Z],function(e,t){return function(n){var r=this,i=[];r.windows=i,r.open=function(t,r){var s;return t.url=t.url||t.file,t.url&&(t.width=parseInt(t.width||320,10),t.height=parseInt(t.height||240,10)),t.body&&(t.items={defaults:t.defaults,type:t.bodyType||"form",items:t.body}),t.url||t.buttons||(t.buttons=[{text:"Ok",subtype:"primary",onclick:function(){s.find("form")[0].submit(),s.close()}},{text:"Cancel",onclick:function(){s.close()}}]),s=new e(t),i.push(s),s.on("close",function(){for(var e=i.length;e--;)i[e]===s&&i.splice(e,1);n.focus()}),t.data&&s.on("postRender",function(){this.find("*").each(function(e){var n=e.name();n in t.data&&e.value(t.data[n])})}),s.params=r||{},n.nodeChanged(),s.renderTo(document.body).reflow()},r.alert=function(e,n,r){t.alert(e,function(){n.call(r||this)})},r.confirm=function(e,n,r){t.confirm(e,function(e){n.call(r||this,e)})},r.close=function(){i.length&&i[i.length-1].close()},r.getParams=function(){return i.length?i[i.length-1].params:null},r.setParams=function(e){i.length&&(i[i.length-1].params=e)}}}),r(tt,[L,M,w,v,m,p],function(e,t,n,r,i,s){return function(o){function u(e,t){try{o.getDoc().execCommand(e,!1,t)}catch(n){}}function a(){var e=o.getDoc().documentMode;return e?e:6}function f(e){return e.isDefaultPrevented()}function l(){function t(e){function t(){if(3==a.nodeType){if(e&&f==a.length)return!0;if(!e&&0===f)return!0}}var n,r,i,u,a,f,l;n=I.getRng();var c=[n.startContainer,n.startOffset,n.endContainer,n.endOffset];if(n.collapsed||(e=!0),a=n[(e?"start":"end")+"Container"],f=n[(e?"start":"end")+"Offset"],3==a.nodeType&&(r=F.getParent(n.startContainer,F.isBlock),e&&(r=F.getNext(r,F.isBlock)),!r||!t()&&n.collapsed||(i=F.create("em",{id:"__mceDel"}),H(s.grep(r.childNodes),function(e){i.appendChild(e)}),r.appendChild(i))),n=F.createRng(),n.setStart(c[0],c[1]),n.setEnd(c[2],c[3]),I.setRng(n),o.getDoc().execCommand(e?"ForwardDelete":"Delete",!1,null),i){for(u=I.getBookmark();l=F.get("__mceDel");)F.remove(l,!0);I.moveToBookmark(u)}}o.on("keydown",function(n){var r;r=n.keyCode==j,f(n)||!r&&n.keyCode!=B||e.modifierPressed(n)||(n.preventDefault(),t(r))}),o.addCommand("Delete",function(){t()})}function c(){function e(e){var t=F.create("body"),n=e.cloneContents();return t.appendChild(n),I.serializer.serialize(t,{format:"html"})}function t(t){var n=e(t),r=F.createRng();r.selectNode(o.getBody());var i=e(r);return n===i}o.on("keydown",function(e){var n=e.keyCode,r;if(!f(e)&&(n==j||n==B)){if(r=o.selection.isCollapsed(),r&&!F.isEmpty(o.getBody()))return;if(W&&!r)return;if(!r&&!t(o.selection.getRng()))return;e.preventDefault(),o.setContent(""),o.selection.setCursorLocation(o.getBody(),0),o.nodeChanged()}})}function h(){o.on("keydown",function(t){!f(t)&&65==t.keyCode&&e.metaKeyPressed(t)&&(t.preventDefault(),o.execCommand("SelectAll"))})}function p(){o.settings.content_editable||(F.bind(o.getDoc(),"focusin",function(){I.setRng(I.getRng())}),F.bind(o.getDoc(),"mousedown",function(e){e.target==o.getDoc().documentElement&&(o.getWin().focus(),I.setRng(I.getRng()))}))}function d(){o.on("keydown",function(e){if(!f(e)&&e.keyCode===B&&I.isCollapsed()&&0===I.getRng(!0).startOffset){var t=I.getNode(),n=t.previousSibling;n&&n.nodeName&&"hr"===n.nodeName.toLowerCase()&&(F.remove(n),e.preventDefault())}})}function v(){window.Range.prototype.getClientRects||o.on("mousedown",function(e){if(!f(e)&&"HTML"===e.target.nodeName){var t=o.getBody();t.blur(),setTimeout(function(){t.focus()},0)}})}function m(){o.on("click",function(e){e=e.target,/^(IMG|HR)$/.test(e.nodeName)&&I.getSel().setBaseAndExtent(e,0,e,1),"A"==e.nodeName&&F.hasClass(e,"mceItemAnchor")&&I.select(e),o.nodeChanged()})}function g(){function e(){var e=F.getAttribs(I.getStart().cloneNode(!1));return function(){var t=I.getStart();t!==o.getBody()&&(F.setAttrib(t,"style",null),H(e,function(e){t.setAttributeNode(e.cloneNode(!0))}))}}function t(){return!I.isCollapsed()&&F.getParent(I.getStart(),F.isBlock)!=F.getParent(I.getEnd(),F.isBlock)}o.on("keypress",function(n){var r;return f(n)||8!=n.keyCode&&46!=n.keyCode||!t()?void 0:(r=e(),o.getDoc().execCommand("delete",!1,null),r(),n.preventDefault(),!1)}),F.bind(o.getDoc(),"cut",function(n){var r;!f(n)&&t()&&(r=e(),setTimeout(function(){r()},0))})}function y(){var e,n;o.on("selectionchange",function(){n&&(clearTimeout(n),n=0),n=window.setTimeout(function(){var n=I.getRng();e&&t.compareRanges(n,e)||(o.nodeChanged(),e=n)},50)})}function b(){document.body.setAttribute("role","application")}function w(){o.on("keydown",function(e){if(!f(e)&&e.keyCode===B&&I.isCollapsed()&&0===I.getRng(!0).startOffset){var t=I.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}})}function E(){a()>7||(u("RespectVisibilityInDesign",!0),o.contentStyles.push(".mceHideBrInPre pre br {display: none}"),F.addClass(o.getBody(),"mceHideBrInPre"),R.addNodeFilter("pre",function(e){for(var t=e.length,r,i,s,o;t--;)for(r=e[t].getAll("br"),i=r.length;i--;)s=r[i],o=s.prev,o&&3===o.type&&"\n"!=o.value.charAt(o.value-1)?o.value+="\n":s.parent.insert(new n("#text",3),s,!0).value="\n"}),U.addNodeFilter("pre",function(e){for(var t=e.length,n,r,i,s;t--;)for(n=e[t].getAll("br"),r=n.length;r--;)i=n[r],s=i.prev,s&&3==s.type&&(s.value=s.value.replace(/\r?\n$/,""))}))}function S(){F.bind(o.getBody(),"mouseup",function(){var e,t=I.getNode();"IMG"==t.nodeName&&((e=F.getStyle(t,"width"))&&(F.setAttrib(t,"width",e.replace(/[^0-9%]+/g,"")),F.setStyle(t,"width","")),(e=F.getStyle(t,"height"))&&(F.setAttrib(t,"height",e.replace(/[^0-9%]+/g,"")),F.setStyle(t,"height","")))})}function x(){o.on("keydown",function(t){var n,r,i,s,u,a,l,c;if(n=t.keyCode==j,!f(t)&&(n||t.keyCode==B)&&!e.modifierPressed(t)&&(r=I.getRng(),i=r.startContainer,s=r.startOffset,l=r.collapsed,3==i.nodeType&&i.nodeValue.length>0&&(0===s&&!l||l&&s===(n?0:1)))){if(a=i.previousSibling,a&&"IMG"==a.nodeName)return;c=o.schema.getNonEmptyElements(),t.preventDefault(),u=F.create("br",{id:"__tmp"}),i.parentNode.insertBefore(u,i),o.getDoc().execCommand(n?"ForwardDelete":"Delete",!1,null),i=I.getRng().startContainer,a=i.previousSibling,a&&1==a.nodeType&&!F.isBlock(a)&&F.isEmpty(a)&&!c[a.nodeName.toLowerCase()]&&F.remove(a),F.remove("__tmp")}})}function T(){o.on("keydown",function(t){var n,r,i,s,u;if(!f(t)&&t.keyCode==e.BACKSPACE&&(n=I.getRng(),r=n.startContainer,i=n.startOffset,s=F.getRoot(),u=r,n.collapsed&&0===i)){for(;u&&u.parentNode&&u.parentNode.firstChild==u&&u.parentNode!=s;)u=u.parentNode;"BLOCKQUOTE"===u.tagName&&(o.formatter.toggle("blockquote",null,u),n=F.createRng(),n.setStart(r,0),n.setEnd(r,0),I.setRng(n))}})}function N(){function e(){o._refreshContentEditable(),u("StyleWithCSS",!1),u("enableInlineTableEditing",!1),q.object_resizing||u("enableObjectResizing",!1)}q.readonly||o.on("BeforeExecCommand MouseDown",e)}function C(){function e(){H(F.select("a"),function(e){var t=e.parentNode,n=F.getRoot();if(t.lastChild===e){for(;t&&!F.isBlock(t);){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}F.add(t,"br",{"data-mce-bogus":1})}})}o.on("SetContent ExecCommand",function(t){("setcontent"==t.type||"mceInsertLink"===t.command)&&e()})}function k(){q.forced_root_block&&o.on("init",function(){u("DefaultParagraphSeparator",q.forced_root_block)})}function L(){o.on("Undo Redo SetContent",function(e){e.initial||o.execCommand("mceRepaint")})}function A(){o.on("keydown",function(e){var t;f(e)||e.keyCode!=B||(t=o.getDoc().selection.createRange(),t&&t.item&&(e.preventDefault(),o.undoManager.beforeChange(),F.remove(t.item(0)),o.undoManager.add()))})}function O(){var e;a()>=10&&(e="",H("p div h1 h2 h3 h4 h5 h6".split(" "),function(t,n){e+=(n>0?",":"")+t+":empty"}),o.contentStyles.push(e+"{padding-right: 1px !important}"))}function M(){a()<9&&(R.addNodeFilter("noscript",function(e){for(var t=e.length,n,r;t--;)n=e[t],r=n.firstChild,r&&n.attr("data-mce-innertext",r.value)}),U.addNodeFilter("noscript",function(e){for(var t=e.length,i,s,o;t--;)i=e[t],s=e[t].firstChild,s?s.value=r.decode(s.value):(o=i.attributes.map["data-mce-innertext"],o&&(i.attr("data-mce-innertext",null),s=new n("#text",3),s.value=o,s.raw=!0,i.append(s)))}))}function _(){function e(e,t){var n=i.createTextRange();try{n.moveToPoint(e,t)}catch(r){n=null}return n}function t(t){var r;t.button?(r=e(t.x,t.y),r&&(r.compareEndPoints("StartToStart",o)>0?r.setEndPoint("StartToStart",o):r.setEndPoint("EndToEnd",o),r.select())):n()}function n(){var e=r.selection.createRange();o&&!e.item&&0===e.compareEndPoints("StartToEnd",e)&&o.select(),F.unbind(r,"mouseup",n),F.unbind(r,"mousemove",t),o=s=0}var r=F.doc,i=r.body,s,o,u;r.documentElement.unselectable=!0,F.bind(r,"mousedown contextmenu",function(i){if("HTML"===i.target.nodeName){if(s&&n(),u=r.documentElement,u.scrollHeight>u.clientHeight)return;s=1,o=e(i.x,i.y),o&&(F.bind(r,"mouseup",n),F.bind(r,"mousemove",t),F.win.focus(),o.select())}})}function D(){o.on("keyup focusin",function(t){65==t.keyCode&&e.metaKeyPressed(t)||I.normalize()})}function P(){o.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")}var H=s.each,B=e.BACKSPACE,j=e.DELETE,F=o.dom,I=o.selection,q=o.settings,R=o.parser,U=o.serializer,z=i.gecko,W=i.ie,X=i.webkit;w(),T(),c(),D(),X&&(x(),l(),p(),m(),k(),i.iOS?y():h()),W&&(d(),b(),E(),S(),A(),O(),M(),_()),z&&(d(),v(),g(),N(),C(),L(),P())}}),r(nt,[p],function(e){function t(){return!1}function n(){return!0}var r="__bindings",i=e.makeMap("focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave keydown keypress keyup contextmenu dragend dragover draggesture dragdrop drop drag"," ");return{fire:function(e,i,s){var o=this,u,a,f,l,c;if(e=e.toLowerCase(),i=i||{},i.type=e,i.target||(i.target=o),i.preventDefault||(i.preventDefault=function(){i.isDefaultPrevented=n},i.stopPropagation=function(){i.isPropagationStopped=n},i.stopImmediatePropagation=function(){i.isImmediatePropagationStopped=n},i.isDefaultPrevented=t,i.isPropagationStopped=t,i.isImmediatePropagationStopped=t),o[r]&&(u=o[r][e]))for(a=0,f=u.length;f>a&&(u[a]=l=u[a],!i.isImmediatePropagationStopped());a++)if(l.call(o,i)===!1)return i.preventDefault(),i;if(s!==!1&&o.parent)for(c=o.parent();c&&!i.isPropagationStopped();)c.fire(e,i,!1),c=c.parent();return i},on:function(e,t){var n=this,s,o,u,a;if(t===!1&&(t=function(){return!1}),t)for(u=e.toLowerCase().split(" "),a=u.length;a--;)e=u[a],s=n[r],s||(s=n[r]={}),o=s[e],o||(o=s[e]=[],n.bindNative&&i[e]&&n.bindNative(e)),o.push(t);return n},off:function(e,t){var n=this,s,o=n[r],u,a,f,l;if(o)if(e)for(f=e.toLowerCase().split(" "),s=f.length;s--;){if(e=f[s],u=o[e],!e){for(a in o)o[e].length=0;return n}if(u){if(t)for(l=u.length;l--;)u[l]===t&&u.splice(l,1);else u.length=0;!u.length&&n.unbindNative&&i[e]&&(n.unbindNative(e),delete o[e])}}else{if(n.unbindNative)for(e in o)n.unbindNative(e);n[r]=[]}return n}}}),r(rt,[p,m],function(e,t){var n=e.each,r=e.explode,i={f9:120,f10:121,f11:122};return function(s){var o=this,u={};s.on("keyup keypress keydown",function(e){(e.altKey||e.ctrlKey||e.metaKey)&&n(u,function(n){var r=t.mac?e.ctrlKey||e.metaKey:e.ctrlKey;if(n.ctrl==r&&n.alt==e.altKey&&n.shift==e.shiftKey)return e.keyCode==n.keyCode||e.charCode&&e.charCode==n.charCode?(e.preventDefault(),"keydown"==e.type&&n.func.call(n.scope),!0):void 0})}),o.add=function(t,o,a,f){var l;return l=a,"string"==typeof a?a=function(){s.execCommand(l,!1,null)}:e.isArray(l)&&(a=function(){s.execCommand(l[0],l[1],l[2])}),n(r(t.toLowerCase()),function(e){var t={func:a,scope:f||s,desc:s.translate(o),alt:!1,ctrl:!1,shift:!1};n(r(e,"+"),function(e){switch(e){case"alt":case"ctrl":case"shift":t[e]=!0;break;default:t.charCode=e.charCodeAt(0),t.keyCode=i[e]||e.toUpperCase().charCodeAt(0)}}),u[(t.ctrl?"ctrl":"")+","+(t.alt?"alt":"")+","+(t.shift?"shift":"")+","+t.keyCode]=t}),!0}}}),r(it,[g,b,w,C,N,O,_,D,P,H,B,j,y,a,et,E,x,tt,m,p,nt,rt],function(e,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){function x(e,t){return"selectionchange"==t||"drop"==t?e.getDoc():!e.inline&&/^mouse|click|contextmenu/.test(t)?e.getDoc():e.getBody()}function T(e,t,r){var i=this,s,o;s=i.documentBaseUrl=r.documentBaseURL,o=r.baseURI,i.settings=t=L({id:e,theme:"modern",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:s,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,padd_empty_editor:!0,render_ui:!0,indentation:"30px",inline_styles:!0,convert_fonts_to_spans:!0,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",validate:!0,entity_encoding:"named",url_converter:i.convertURL,url_converter_scope:i,ie7_compat:!0},t),n.settings=t,n.baseURL=r.baseURL,i.id=t.id=e,i.isNotDirty=!0,i.plugins={},i.documentBaseURI=new h(t.document_base_url||s,{base_uri:o}),i.baseURI=o,i.contentCSS=[],i.contentStyles=[],i.shortcuts=new S(i),i.execCommands={},i.queryStateCommands={},i.queryValueCommands={},i.loadedCSS={},i.suffix=r.suffix,i.editorManager=r,i.inline=t.inline,i.execCallback("setup",i)}var N=e.DOM,C=n.ThemeManager,k=n.PluginManager,L=w.extend,A=w.each,O=w.explode,M=w.inArray,_=w.trim,D=w.resolve,P=d.Event,H=b.gecko,B=b.ie,j=b.opera;return T.prototype={render:function(){function e(){var e=p.ScriptLoader;n.language&&"en"!=n.language&&(n.language_url=t.editorManager.baseURL+"/langs/"+n.language+".js"),n.language_url&&e.add(n.language_url),n.theme&&"function"!=typeof n.theme&&"-"!=n.theme.charAt(0)&&!C.urls[n.theme]&&C.load(n.theme,"themes/"+n.theme+"/theme"+i+".js"),w.isArray(n.plugins)&&(n.plugins=n.plugins.join(" ")),A(n.external_plugins,function(e,t){k.load(t,e),n.plugins+=" "+t}),A(n.plugins.split(/[ ,]/),function(e){if(e=_(e),e&&!k.urls[e])if("-"==e.charAt(0)){e=e.substr(1,e.length);var t=k.dependencies(e);A(t,function(e){var t={prefix:"plugins/",resource:e,suffix:"/plugin"+i+".js"};e=k.createUrl(t,e),k.load(e.resource,e)})}else k.load(e,{prefix:"plugins/",resource:e,suffix:"/plugin"+i+".js"})}),e.loadQueue(function(){t.removed||t.init()})}var t=this,n=t.settings,r=t.id,i=t.suffix;if(!P.domLoaded)return N.bind(window,"ready",function(){t.render()}),void 0;if(t.editorManager.settings=n,t.getElement()&&b.contentEditable){n.inline?t.inline=!0:(t.orgVisibility=t.getElement().style.visibility,t.getElement().style.visibility="hidden");var s=t.getElement().form||N.getParent(r,"form");s&&(t.formElement=s,n.hidden_input&&!/TEXTAREA|INPUT/i.test(t.getElement().nodeName)&&N.insertAfter(N.create("input",{type:"hidden",name:r}),r),t.formEventDelegate=function(e){t.fire(e.type,e)},N.bind(s,"submit reset",t.formEventDelegate),t.on("reset",function(){t.setContent(t.startContent,{format:"raw"})}),!n.submit_patch||s.submit.nodeType||s.submit.length||s._mceOldSubmit||(s._mceOldSubmit=s.submit,s.submit=function(){return t.editorManager.triggerSave(),t.isNotDirty=!0,s._mceOldSubmit(s)})),t.windowManager=new v(t),"xml"==n.encoding&&t.on("GetContent",function(e){e.save&&(e.content=N.encode(e.content))}),n.add_form_submit_trigger&&t.on("submit",function(){t.initialized&&(t.save(),t.isNotDirty=!0)}),n.add_unload_trigger&&(t._beforeUnload=function(){!t.initialized||t.destroyed||t.isHidden()||t.save({format:"raw",no_events:!0})},t.editorManager.on("BeforeUnload",t._beforeUnload)),e()}},init:function(){function e(n){var r=k.get(n),i,s;i=k.urls[n]||t.documentBaseUrl.replace(/\/$/,""),n=_(n),r&&-1===M(d,n)&&(A(k.dependencies(n),function(t){e(t)}),s=new r(t,i),t.plugins[n]=s,s.init&&(s.init(t,i),d.push(n)))}var t=this,n=t.settings,r=t.getElement(),i,s,o,u,a,f,l,c,h,p,d=[];if(t.editorManager.add(t),n.aria_label=n.aria_label||N.getAttrib(r,"aria-label",t.getLang("aria.rich_text_area")),n.theme&&("function"!=typeof n.theme?(n.theme=n.theme.replace(/-/,""),a=C.get(n.theme),t.theme=new a(t,C.urls[n.theme]),t.theme.init&&t.theme.init(t,C.urls[n.theme]||t.documentBaseUrl.replace(/\/$/,""))):t.theme=n.theme),A(n.plugins.replace(/\-/g,"").split(/[ ,]/),e),t.fire("BeforeRenderUI"),n.render_ui&&t.theme&&(t.orgDisplay=r.style.display,"function"!=typeof n.theme?(i=n.width||r.style.width||r.offsetWidth,s=n.height||r.style.height||r.offsetHeight,o=n.min_height||100,h=/^[0-9\.]+(|px)$/i,h.test(""+i)&&(i=Math.max(parseInt(i,10)+(a.deltaWidth||0),100)),h.test(""+s)&&(s=Math.max(parseInt(s,10)+(a.deltaHeight||0),o)),a=t.theme.renderUI({targetNode:r,width:i,height:s,deltaWidth:n.delta_width,deltaHeight:n.delta_height}),n.content_editable||(N.setStyles(a.sizeContainer||a.editorContainer,{wi2dth:i,h2eight:s}),s=(a.iframeHeight||s)+("number"==typeof s?a.deltaHeight||0:""),o>s&&(s=o))):(a=n.theme(t,r),a.editorContainer.nodeType&&(a.editorContainer=a.editorContainer.id=a.editorContainer.id||t.id+"_parent"),a.iframeContainer.nodeType&&(a.iframeContainer=a.iframeContainer.id=a.iframeContainer.id||t.id+"_iframecontainer"),s=a.iframeHeight||r.offsetHeight),t.editorContainer=a.editorContainer),n.content_css&&A(O(n.content_css),function(e){t.contentCSS.push(t.documentBaseURI.toAbsolute(e))}),n.content_style&&t.contentStyles.push(n.content_style),n.content_editable)return r=u=a=null,t.initContentBody();for(document.domain&&location.hostname!=document.domain&&(t.editorManager.relaxedDomain=document.domain),t.iframeHTML=n.doctype+"<html><head>",n.document_base_url!=t.documentBaseUrl&&(t.iframeHTML+='<base href="'+t.documentBaseURI.getURI()+'" />'),!b.caretAfter&&n.ie7_compat&&(t.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=7" />'),t.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',p=0;p<t.contentCSS.length;p++){var v=t.contentCSS[p];t.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+v+'" />',t.loadedCSS[v]=!0}l=n.body_id||"tinymce",-1!=l.indexOf("=")&&(l=t.getParam("body_id","","hash"),l=l[t.id]||l),c=n.body_class||"",-1!=c.indexOf("=")&&(c=t.getParam("body_class","","hash"),c=c[t.id]||""),t.iframeHTML+='</head><body id="'+l+'" class="mce-content-body '+c+'" '+"onload=\"window.parent.tinymce.get('"+t.id+"').fire('load');\"><br></body></html>",t.editorManager.relaxedDomain&&(B||j&&parseFloat(window.opera.version())<11)&&(f='javascript:(function(){document.open();document.domain="'+document.domain+'";'+'var ed = window.parent.tinymce.get("'+t.id+'");document.write(ed.iframeHTML);'+"document.close();ed.initContentBody();})()"),u=N.add(a.iframeContainer,"iframe",{id:t.id+"_ifr",src:f||'javascript:""',frameBorder:"0",allowTransparency:"true",title:t.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"),style:{width:"100%",height:s,display:"block"}}),t.contentAreaContainer=a.iframeContainer,a.editorContainer&&(N.get(a.editorContainer).style.display=t.orgDisplay),N.get(t.id).style.display="none",N.setAttrib(t.id,"aria-hidden",!0),t.editorManager.relaxedDomain&&f||t.initContentBody(),r=u=a=null},initContentBody:function(){var t=this,n=t.settings,s=N.get(t.id),h=t.getDoc(),p,d;n.inline||(t.getElement().style.visibility=t.orgVisibility),B&&t.editorManager.relaxedDomain||n.content_editable||(h.open(),h.write(t.iframeHTML),h.close(),t.editorManager.relaxedDomain&&(h.domain=t.editorManager.relaxedDomain)),n.content_editable&&(t.on("remove",function(){var e=this.getBody();N.removeClass(e,"mce-content-body"),N.removeClass(e,"mce-edit-focus"),N.setAttrib(e,"tabIndex",null),N.setAttrib(e,"contentEditable",null)}),N.addClass(s,"mce-content-body"),s.tabIndex=-1,t.contentDocument=h=n.content_document||document,t.contentWindow=n.content_window||window,t.bodyElement=s,n.content_document=n.content_window=null,n.root_name=s.nodeName.toLowerCase()),p=t.getBody(),p.disabled=!0,n.readonly||(p.contentEditable=t.getParam("content_editable_state",!0)),p.disabled=!1,t.schema=new m(n),t.dom=new e(h,{keep_values:!0,url_converter:t.convertURL,url_converter_scope:t,hex_colors:n.force_hex_style_colors,class_filter:n.class_filter,update_styles:!0,root_element:n.content_editable?t.id:null,schema:t.schema,onSetAttrib:function(e){t.fire("SetAttrib",e)}}),t.parser=new g(n,t.schema),t.parser.addAttributeFilter("src,href,style",function(e,n){for(var r=e.length,i,s=t.dom,o,u;r--;)i=e[r],o=i.attr(n),u="data-mce-"+n,i.attributes.map[u]||("style"===n?i.attr(u,s.serializeStyle(s.parseStyle(o),i.name)):i.attr(u,t.convertURL(o,n,i.name)))}),t.parser.addNodeFilter("script",function(e){for(var t=e.length,n;t--;)n=e[t],n.attr("type","mce-"+(n.attr("type")||"text/javascript"))}),t.parser.addNodeFilter("#cdata",function(e){for(var t=e.length,n;t--;)n=e[t],n.type=8,n.name="#comment",n.value="[CDATA["+n.value+"]]"}),t.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(e){for(var n=e.length,i,s=t.schema.getNonEmptyElements();n--;)i=e[n],i.isEmpty(s)&&(i.empty().append(new r("br",1)).shortEnded=!0)}),t.serializer=new i(n,t),t.selection=new o(t.dom,t.getWin(),t.serializer,t),t.formatter=new u(t),t.undoManager=new a(t),t.forceBlocks=new l(t),t.enterKey=new f(t),t.editorCommands=new c(t),t.fire("PreInit"),n.browser_spellcheck||n.gecko_spellcheck||(h.body.spellcheck=!1,N.setAttrib(p,"spellcheck","false")),t.fire("PostRender"),t.quirks=y(t),n.directionality&&(p.dir=n.directionality),n.nowrap&&(p.style.whiteSpace="nowrap"),n.protect&&t.on("BeforeSetContent",function(e){A(n.protect,function(t){e.content=e.content.replace(t,function(e){return"<!--mce:protected "+escape(e)+"-->"})})}),t.on("SetContent",function(){t.addVisual(t.getBody())}),n.padd_empty_editor&&t.on("PostProcess",function(e){e.content=e.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")}),t.load({initial:!0,format:"html"}),t.startContent=t.getContent({format:"raw"}),t.initialized=!0,A(t._pendingNativeEvents,function(e){t.dom.bind(x(t,e),e,function(e){t.fire(e.type,e)})}),t.fire("init"),t.focus(!0),t.nodeChanged({initial:!0}),t.execCallback("init_instance_callback",t),t.contentStyles.length>0&&(d="",A(t.contentStyles,function(e){d+=e+"\r\n"}),t.dom.addStyle(d)),A(t.contentCSS,function(e){t.loadedCSS[e]||(t.dom.loadCSS(e),t.loadedCSS[e]=!0)}),n.auto_focus&&setTimeout(function(){var e=t.editorManager.get(n.auto_focus);e.selection.select(e.getBody(),1),e.selection.collapse(1),e.getBody().focus(),e.getWin().focus()},100),s=h=p=null},focus:function(e){var t,n=this,r=n.selection,i=n.settings.content_editable,s,o,u=n.getDoc(),a;e||(s=r.getRng(),s.item&&(o=s.item(0)),n._refreshContentEditable(),i||(n.getBody().focus(),n.getWin().focus()),(H||i)&&(a=n.getBody(),a.setActive?a.setActive():a.focus(),i&&r.normalize()),o&&o.ownerDocument==u&&(s=u.body.createControlRange(),s.addElement(o),s.select())),n.editorManager.activeEditor!=n&&((t=n.editorManager.activeEditor)&&t.fire("deactivate",{relatedTarget:n}),n.fire("activate",{relatedTarget:t})),n.editorManager.activeEditor=n},execCallback:function(e){var t=this,n=t.settings[e],r;if(n)return t.callbackLookup&&(r=t.callbackLookup[e])&&(n=r.func,r=r.scope),"string"==typeof n&&(r=n.replace(/\.\w+$/,""),r=r?D(r):0,n=D(n),t.callbackLookup=t.callbackLookup||{},t.callbackLookup[e]={func:n,scope:r}),n.apply(r||t,Array.prototype.slice.call(arguments,1))},translate:function(e){var t=this.settings.language||"en",n=this.editorManager.i18n;return e?n[t+"."+e]||e.replace(/\{\#([^\}]+)\}/g,function(e,r){return n[t+"."+r]||"{#"+r+"}"}):""},getLang:function(e,n){return this.editorManager.i18n[(this.settings.language||"en")+"."+e]||(n!==t?n:"{#"+e+"}")},getParam:function(e,t,n){var r=e in this.settings?this.settings[e]:t,i;return"hash"===n?(i={},"string"==typeof r?A(r.indexOf("=")>0?r.split(/[;,](?![^=;,]*(?:[;,]|$))/):r.split(","),function(e){e=e.split("="),i[_(e[0])]=e.length>1?_(e[1]):_(e)}):i=r,i):r},nodeChanged:function(){var e=this,t=e.selection,n,r,i;e.initialized&&!e.settings.disable_nodechange&&(i=e.getBody(),n=t.getStart()||i,n=B&&n.ownerDocument!=e.getDoc()?e.getBody():n,"IMG"==n.nodeName&&t.isCollapsed()&&(n=n.parentNode),r=[],e.dom.getParent(n,function(e){return e===i?!0:(r.push(e),void 0)}),e.fire("NodeChange",{element:n,parents:r}))},addButton:function(e,t){var n=this;t.cmd&&(t.onclick=function(){n.execCommand(t.cmd)}),t.text||t.icon||(t.icon=e),n.buttons=n.buttons||{},t.tooltip=t.tooltip||t.title,n.buttons[e]=t},addMenuItem:function(e,t){var n=this;t.cmd&&(t.onclick=function(){n.execCommand(t.cmd)}),n.menuItems=n.menuItems||{},n.menuItems[e]=t},addCommand:function(e,t,n){this.execCommands[e]={func:t,scope:n||this}},addQueryStateHandler:function(e,t,n){this.queryStateCommands[e]={func:t,scope:n||this}},addQueryValueHandler:function(e,t,n){this.queryValueCommands[e]={func:t,scope:n||this}},addShortcut:function(e,t,n,r){this.shortcuts.add(e,t,n,r)},execCommand:function(e,t,n,r){var i=this,s=0,o;return/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(e)||r&&r.skip_focus||i.focus(),r=L({},r),r=i.fire("BeforeExecCommand",{command:e,ui:t,value:n}),r.isDefaultPrevented()?!1:(o=i.execCommands[e])&&o.func.call(o.scope,t,n)!==!0?(i.fire("ExecCommand",{command:e,ui:t,value:n}),!0):(A(i.plugins,function(r){return r.execCommand&&r.execCommand(e,t,n)?(i.fire("ExecCommand",{command:e,ui:t,value:n}),s=!0,!1):void 0}),s?s:i.theme&&i.theme.execCommand&&i.theme.execCommand(e,t,n)?(i.fire("ExecCommand",{command:e,ui:t,value:n}),!0):i.editorCommands.execCommand(e,t,n)?(i.fire("ExecCommand",{command:e,ui:t,value:n}),!0):(i.getDoc().execCommand(e,t,n),i.fire("ExecCommand",{command:e,ui:t,value:n}),void 0))},queryCommandState:function(e){var t=this,n,r;if(!t._isHidden()){if((n=t.queryStateCommands[e])&&(r=n.func.call(n.scope),r!==!0))return r;if(r=t.editorCommands.queryCommandState(e),-1!==r)return r;try{return t.getDoc().queryCommandState(e)}catch(i){}}},queryCommandValue:function(e){var n=this,r,i;if(!n._isHidden()){if((r=n.queryValueCommands[e])&&(i=r.func.call(r.scope),i!==!0))return i;if(i=n.editorCommands.queryCommandValue(e),i!==t)return i;try{return n.getDoc().queryCommandValue(e)}catch(s){}}},show:function(){var e=this;N.show(e.getContainer()),N.hide(e.id),e.load(),e.fire("show")},hide:function(){var e=this,t=e.getDoc();B&&t&&t.execCommand("SelectAll"),e.save(),N.hide(e.getContainer()),N.setStyle(e.id,"display",e.orgDisplay),e.fire("hide")},isHidden:function(){return!N.isHidden(this.id)},setProgressState:function(e,t){this.fire("ProgressState",{state:e,time:t})},load:function(e){var n=this,r=n.getElement(),i;return r?(e=e||{},e.load=!0,i=n.setContent(r.value!==t?r.value:r.innerHTML,e),e.element=r,e.no_events||n.fire("LoadContent",e),e.element=r=null,i):void 0},save:function(e){var t=this,n=t.getElement(),r,i;if(n&&t.initialized)return e=e||{},e.save=!0,e.element=n,r=e.content=t.getContent(e),e.no_events||t.fire("SaveContent",e),r=e.content,/TEXTAREA|INPUT/i.test(n.nodeName)?n.value=r:(n.innerHTML=r,(i=N.getParent(t.id,"form"))&&A(i.elements,function(e){return e.name==t.id?(e.value=r,!1):void 0})),e.element=n=null,t.isNotDirty=!0,r},setContent:function(e,t){var n=this,r=n.getBody(),i;return t=t||{},t.format=t.format||"html",t.set=!0,t.content=e,t.no_events||n.fire("BeforeSetContent",t),e=t.content,B||0!==e.length&&!/^\s+$/.test(e)?("raw"!==t.format&&(e=(new s({},n.schema)).serialize(n.parser.parse(e,{isRootContent:!0}))),t.content=_(e),n.dom.setHTML(r,t.content),t.no_events||n.fire("SetContent",t),n.settings.content_editable&&document.activeElement!==n.getBody()||n.selection.normalize(),t.content):(i=n.settings.forced_root_block,e=i&&n.schema.isValidChild(r.nodeName.toLowerCase(),i.toLowerCase())?"<"+i+'><br data-mce-bogus="1"></'+i+">":'<br data-mce-bogus="1">',r.innerHTML=e,n.selection.select(r,!0),n.selection.collapse(!0),n.fire("SetContent",t),void 0)},getContent:function(e){var t=this,n,r=t.getBody();return e=e||{},e.format=e.format||"html",e.get=!0,e.getInner=!0,e.no_events||t.fire("BeforeGetContent",e),n="raw"==e.format?r.innerHTML:"text"==e.format?r.innerText||r.textContent:t.serializer.serialize(r,e),e.content="text"!=e.format?_(n):n,e.no_events||t.fire("GetContent",e),e.content},insertContent:function(e){this.execCommand("mceInsertContent",!1,e)},isDirty:function(){return!this.isNotDirty},getContainer:function(){var e=this;return e.container||(e.container=N.get(e.editorContainer||e.id+"_parent")),e.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return N.get(this.settings.content_element||this.id)},getWin:function(){var e=this,t;return e.contentWindow||(t=N.get(e.id+"_ifr"),t&&(e.contentWindow=t.contentWindow)),e.contentWindow},getDoc:function(){var e=this,t;return e.contentDocument||(t=e.getWin(),t&&(e.contentDocument=t.document)),e.contentDocument},getBody:function(){return this.bodyElement||this.getDoc().body},convertURL:function(e,t,n){var r=this,i=r.settings;return i.urlconverter_callback?r.execCallback("urlconverter_callback",e,n,!0,t):!i.convert_urls||n&&"LINK"==n.nodeName||0===e.indexOf("file:")||0===e.length?e:i.relative_urls?r.documentBaseURI.toRelative(e):e=r.documentBaseURI.toAbsolute(e,i.remove_script_host)},addVisual:function(e){var n=this,r=n.settings,i=n.dom,s;e=e||n.getBody(),n.hasVisual===t&&(n.hasVisual=r.visual),A(i.select("table,a",e),function(e){var t;switch(e.nodeName){case"TABLE":return s=r.visual_table_class||"mce-item-table",t=i.getAttrib(e,"border"),t&&"0"!=t||(n.hasVisual?i.addClass(e,s):i.removeClass(e,s)),void 0;case"A":return i.getAttrib(e,"href",!1)||(t=i.getAttrib(e,"name")||e.id,s="mce-item-anchor",t&&(n.hasVisual?i.addClass(e,s):i.removeClass(e,s))),void 0}}),n.fire("VisualAid",{element:e,hasVisual:n.hasVisual})},remove:function(){var e=this,t=e.getContainer(),n=e.getDoc();e.removed||(e.removed=1,B&&n&&n.execCommand("SelectAll"),e.save(),N.setStyle(e.id,"display",e.orgDisplay),e.settings.content_editable||(P.unbind(e.getWin()),P.unbind(e.getDoc())),P.unbind(e.getBody()),P.unbind(t),e.fire("remove"),e.editorManager.remove(e),N.remove(t))},bindNative:function(e){var t=this;t.initialized?t.dom.bind(x(t,e),e,function(n){t.fire(e,n)}):t._pendingNativeEvents?t._pendingNativeEvents.push(e):t._pendingNativeEvents=[e]},unbindNative:function(e){var t=this;t.initialized&&t.dom.unbind(e)},destroy:function(e){var t=this,n;t.destroyed||(H&&(P.unbind(t.getDoc()),P.unbind(t.getWin()),P.unbind(t.getBody())),e||(t.editorManager.off("beforeunload",t._beforeUnload),t.theme&&t.theme.destroy&&t.theme.destroy(),t.selection.destroy(),t.dom.destroy()),n=t.formElement,n&&(n.submit=n._mceOldSubmit,n._mceOldSubmit=null,N.unbind(n,"submit reset",t.formEventDelegate)),t.contentAreaContainer=t.formElement=t.container=null,t.settings.content_element=t.bodyElement=t.contentDocument=t.contentWindow=null,t.selection&&(t.selection=t.selection.win=t.selection.dom=t.selection.dom.doc=null),t.destroyed=1)},_refreshContentEditable:function(){var e=this,t,n;e._isHidden()&&(t=e.getBody(),n=t.parentNode,n.removeChild(t),n.appendChild(t),t.focus())},_isHidden:function(){var e;return H?(e=this.selection.getSel(),!e||!e.rangeCount||0===e.rangeCount):0}},L(T.prototype,E),T}),r(st,[],function(){var e={};return{add:function(t,n){for(var r in n)e[r]=n[r]},translate:function(t){if("undefined"==typeof t)return t;if("string"!=typeof t&&t.raw)return t.raw;if(t.push){var n=t.slice(1);t=(e[t[0]]||t[0]).replace(/\{([^\}]+)\}/g,function(e,t){return n[t]})}return e[t]||t},data:e}}),r(ot,[g,m],function(e,t){function n(r){function i(){try{return document.activeElement}catch(e){return document.body}}function s(s){function o(t){return!!e.DOM.getParent(t,n.isEditorUIElement)}var u=s.editor,a,f;u.on("init",function(){"onbeforedeactivate"in document?u.dom.bind(u.getBody(),"beforedeactivate",function(){var e=u.getDoc().selection;a=e&&e.createRange?e.createRange():u.selection.getRng()}):u.inline&&(u.on("nodechange",function(){for(var e,t=document.activeElement;t;){if(t==u.getBody()){e=!0;break}t=t.parentNode}e&&(a=u.selection.getRng())}),t.webkit&&(f=function(){var e=u.selection.getRng();e.collapsed||(a=e)},e.DOM.bind(document,"selectionchange",f),u.on("remove",function(){e.DOM.unbind(document,"selectionchange",f)})))}),u.on("focusin",function(){var e=r.focusedEditor;u.selection.restoreRng&&(u.selection.setRng(u.selection.restoreRng),u.selection.restoreRng=null),e!=u&&(e&&e.fire("blur",{focusedEditor:u}),u.fire("focus",{blurredEditor:e}),u.focus(!1),r.focusedEditor=u)}),u.on("focusout",function(){u.selection.restoreRng=a,window.setTimeout(function(){var e=r.focusedEditor;e!=u&&(u.selection.restoreRng=null),o(i())||e!=u||(u.fire("blur",{focusedEditor:null}),r.focusedEditor=null,u.selection.restoreRng=null)},0)})}r.on("AddEditor",s)}return n.isEditorUIElement=function(e){return-1!==e.className.indexOf("mce-")},n}),r(ut,[it,g,j,m,p,nt,st,ot],function(e,n,r,i,s,o,u,a){var f=n.DOM,l=s.explode,c=s.each,h=s.extend,p=0,d,v={majorVersion:"4",minorVersion:"0",releaseDate:"2013-06-26",editors:[],i18n:u,activeEditor:null,setup:function(){var e=this,t,n,i="",s;if(n=document.location.href.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/"),s=window.tinymce||window.tinyMCEPreInit)t=s.base||s.baseURL,i=s.suffix;else for(var o=document.getElementsByTagName("script"),u=0;u<o.length;u++){var f=o[u].src;if(/tinymce(\.jquery|)(\.min|\.dev|)\.js/.test(f)){-1!=f.indexOf(".min")&&(i=".min"),t=f.substring(0,f.lastIndexOf("/"));break}}e.baseURL=(new r(n)).toAbsolute(t),e.documentBaseURL=n,e.baseURI=new r(e.baseURL),e.suffix=i,e.focusManager=new a(e)},init:function(t){function n(e){var t=e.id;return t||(t=e.name,t=t&&!f.get(t)?e.name:f.uniqueId(),e.setAttribute("id",t)),t}function r(e,t,n){var r=e[t];if(r)return r.apply(n||this,Array.prototype.slice.call(arguments,2))}function i(e,t){return t.constructor===RegExp?t.test(e.className):f.hasClass(e,t)}var s=this,o=[],u;s.settings=t,f.bind(window,"ready",function(){var a,d;if(r(t,"onpageload"),t.types)return c(t.types,function(r){c(f.select(r.selector),function(i){var u=new e(n(i),h({},t,r),s);o.push(u),u.render(1)})}),void 0;if(t.selector)return c(f.select(t.selector),function(r){var i=new e(n(r),t,s);o.push(i),i.render(1)}),void 0;switch(t.mode){case"exact":a=t.elements||"",a.length>0&&c(l(a),function(n){f.get(n)?(u=new e(n,t,s),o.push(u),u.render(!0)):c(document.forms,function(r){c(r.elements,function(r){r.name===n&&(n="mce_editor_"+p++,f.setAttrib(r,"id",n),u=new e(n,t,s),o.push(u),u.render(1))})})});break;case"textareas":case"specific_textareas":c(f.select("textarea"),function(r){t.editor_deselector&&i(r,t.editor_deselector)||(!t.editor_selector||i(r,t.editor_selector))&&(u=new e(n(r),t,s),o.push(u),u.render(!0))})}t.oninit&&(a=d=0,c(o,function(e){d++,e.initialized?a++:e.on("init",function(){a++,a==d&&r(t,"oninit")}),a==d&&r(t,"oninit")}))})},get:function(e){return e===t?this.editors:this.editors[e]},add:function(e){var t=this,n=t.editors;return n[e.id]=e,n.push(e),t.activeEditor=e,t.fire("AddEditor",{editor:e}),d||(d=function(){t.fire("BeforeUnload")},f.bind(window,"beforeunload",d)),e},createEditor:function(t,n){return this.add(new e(t,n,this))},remove:function(e){var t=this,n,r=t.editors,i;if(e){if("string"==typeof e)return e=e.selector||e,c(f.select(e),function(e){t.remove(r[e.id])}),void 0;if(i=e,!r[i.id])return null;for(delete r[i.id],n=0;n<r.length;n++)if(r[n]==i){r.splice(n,1);break}if(t.activeEditor==i&&(t.activeEditor=r[0]),i&&!i.removed)return i.remove(),i.destroy(),t.fire("RemoveEditor",{editor:i}),r.length||f.unbind(window,"beforeunload",d),i}else for(n=r.length-1;n>=0;n--)t.remove(r[n])},execCommand:function(t,n,r){var i=this,s=i.get(r);switch(t){case"mceAddEditor":return i.get(r)||(new e(r,i.settings,i)).render(),!0;case"mceRemoveEditor":return s&&s.remove(),!0;case"mceToggleEditor":return s?(s.isHidden()?s.show():s.hide(),!0):(i.execCommand("mceAddEditor",0,r),!0)}return i.activeEditor?i.activeEditor.execCommand(t,n,r):!1},triggerSave:function(){c(this.editors,function(e){e.save()})},addI18n:function(e,t){u.add(e,t)},translate:function(e){return u.translate(e)}};return h(v,o),v.setup(),window.tinymce=window.tinyMCE=v,v}),r(at,[ut,p],function(e,t){var n=t.each,r=t.explode;e.on("AddEditor",function(e){var t=e.editor;t.on("preInit",function(){function e(e,t){n(t,function(t,n){t&&u.setStyle(e,n,t)}),u.rename(e,"span")}function i(e){u=t.dom,a.convert_fonts_to_spans&&n(u.select("font,u,strike",e.node),function(e){s[e.nodeName.toLowerCase()](u,e)})}var s,o,u,a=t.settings;a.inline_styles&&(o=r(a.font_size_legacy_values),s={font:function(t,n){e(n,{backgroundColor:n.style.backgroundColor,color:n.color,fontFamily:n.face,fontSize:o[parseInt(n.size,10)-1]})},u:function(t,n){e(n,{textDecoration:"underline"})},strike:function(t,n){e(n,{textDecoration:"line-through"})}},t.on("PreProcess SetContent",i))})})}),r(ft,[],function(){return{send:function(e){function t(){!e.async||4==n.readyState||r++>1e4?(e.success&&1e4>r&&200==n.status?e.success.call(e.success_scope,""+n.responseText,n,e):e.error&&e.error.call(e.error_scope,r>1e4?"TIMED_OUT":"GENERAL",n,e),n=null):setTimeout(t,10)}var n,r=0;if(e.scope=e.scope||this,e.success_scope=e.success_scope||e.scope,e.error_scope=e.error_scope||e.scope,e.async=e.async===!1?!1:!0,e.data=e.data||"",n=new XMLHttpRequest){if(n.overrideMimeType&&n.overrideMimeType(e.content_type),n.open(e.type||(e.data?"POST":"GET"),e.url,e.async),e.content_type&&n.setRequestHeader("Content-Type",e.content_type),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(e.data),!e.async)return t();setTimeout(t,10)}}}}),r(lt,[],function(){function e(t,n){var r,i,s,o;if(n=n||'"',null===t)return"null";if(s=typeof t,"string"==s)return i="\bb	t\nn\ff\rr\"\"''\\\\",n+t.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(e,t){return'"'===n&&"'"===e?e:(r=i.indexOf(t),r+1?"\\"+i.charAt(r+1):(e=t.charCodeAt().toString(16),"\\u"+"0000".substring(e.length)+e))})+n;if("object"==s){if(t.hasOwnProperty&&"[object Array]"===Object.prototype.toString.call(t)){for(r=0,i="[";r<t.length;r++)i+=(r>0?",":"")+e(t[r],n);return i+"]"}i="{";for(o in t)t.hasOwnProperty(o)&&(i+="function"!=typeof t[o]?(i.length>1?","+n:n)+o+n+":"+e(t[o],n):"");return i+"}"}return""+t}return{serialize:e,parse:function(e){try{return window[String.fromCharCode(101)+"val"]("("+e+")")}catch(t){}}}}),r(ct,[lt,ft,p],function(e,t,n){function r(e){this.settings=i({},e),this.count=0}var i=n.extend;return r.sendRPC=function(e){return(new r).send(e)},r.prototype={send:function(n){var r=n.error,s=n.success;n=i(this.settings,n),n.success=function(t,i){t=e.parse(t),"undefined"==typeof t&&(t={error:"JSON Parse error."}),t.error?r.call(n.error_scope||n.scope,t.error,i):s.call(n.success_scope||n.scope,t.result)},n.error=function(e,t){r&&r.call(n.error_scope||n.scope,e,t)},n.data=e.serialize({id:n.id||"c"+this.count++,method:n.method,params:n.params}),n.content_type="application/json",t.send(n)}},r}),r(ht,[g],function(e){return{callbacks:{},count:0,send:function(n){var r=this,i=e.DOM,s=n.count!==t?n.count:r.count,o="tinymce_jsonp_"+s;r.callbacks[s]=function(e){i.remove(o),delete r.callbacks[s],n.callback(e)},i.add(i.doc.body,"script",{id:o,src:n.url,type:"text/javascript"}),r.count++}}}),r(pt,[],function(){function e(){u=[];for(var e in o)u.push(e);i.length=u.length}function n(){function n(e){var n,r;return r=e!==t?f+e:i.indexOf(",",f),-1===r||r>i.length?null:(n=i.substring(f,r),f=r+1,n)}var r,i,u,f=0;o={},s.load(a),i=s.getAttribute(a)||"";do r=n(parseInt(n(),32)||0),null!==r&&(u=n(parseInt(n(),32)||0),o[r]=u);while(null!==r);e()}function r(){var t,n="";for(var r in o)t=o[r],n+=(n?",":"")+r.length.toString(32)+","+r+","+t.length.toString(32)+","+t;s.setAttribute(a,n),s.save(a),e()}var i,s,o,u,a;return window.localStorage?localStorage:(a="tinymce",s=document.documentElement,s.addBehavior("#default#userData"),i={key:function(e){return u[e]},getItem:function(e){return e in o?o[e]:null},setItem:function(e,t){o[e]=""+t,r()},removeItem:function(e){delete o[e],r()},clear:function(){o={},r()}},n(),i)}),r(dt,[g,a,y,b,p,m],function(e,t,n,r,i,s){var o=window.tinymce;return o.DOM=e.DOM,o.ScriptLoader=n.ScriptLoader,o.PluginManager=r.PluginManager,o.ThemeManager=r.ThemeManager,o.dom=o.dom||{},o.dom.Event=t.Event,i.each(i,function(e,t){o[t]=e}),i.each("isOpera isWebKit isIE isGecko isMac".split(" "),function(e){o[e]=s[e.substr(2).toLowerCase()]}),{}}),r(vt,[F,p],function(e,t){return e.extend({Defaults:{firstControlClass:"first",lastControlClass:"last"},init:function(e){this.settings=t.extend({},this.Defaults,e)},preRender:function(e){e.addClass(this.settings.containerClass,"body")},applyClasses:function(e){var t=this,n=t.settings,r,i,s;r=e.items().filter(":visible"),i=n.firstControlClass,s=n.lastControlClass,r.each(function(e){e.removeClass(i).removeClass(s),n.controlClass&&e.addClass(n.controlClass)}),r.eq(0).addClass(i),r.eq(-1).addClass(s)},renderHtml:function(e){var t=this,n=t.settings,r,i="";return r=e.items(),r.eq(0).addClass(n.firstControlClass),r.eq(-1).addClass(n.lastControlClass),r.each(function(e){n.controlClass&&e.addClass(n.controlClass),i+=e.renderHtml()}),i},recalc:function(){},postRender:function(){}})}),r(mt,[vt],function(e){return e.extend({Defaults:{containerClass:"abs-layout",controlClass:"abs-layout-item"},recalc:function(e){e.items().filter(":visible").each(function(e){var t=e.settings;e.layoutRect({x:t.x,y:t.y,w:t.w,h:t.h}),e.recalc&&e.recalc()})},renderHtml:function(e){return'<div id="'+e._id+'-absend" class="'+e.classPrefix+'abs-end"></div>'+this._super(e)}})}),r(gt,[U,J],function(e,t){return e.extend({Mixins:[t],Defaults:{classes:"widget tooltip tooltip-n"},text:function(e){var t=this;return"undefined"!=typeof e?(t._value=e,t._rendered&&(t.getEl().lastChild.innerHTML=t.encode(e)),t):t._value},renderHtml:function(){var e=this,t=e.classPrefix;return'<div id="'+e._id+'" class="'+e.classes()+'" role="presentation">'+'<div class="'+t+'tooltip-arrow"></div>'+'<div class="'+t+'tooltip-inner">'+e.encode(e._text)+"</div>"+"</div>"},repaint:function(){var e=this,t,n;t=e.getEl().style,n=e._layoutRect,t.left=n.x+"px",t.top=n.y+"px",t.zIndex=131070}})}),r(yt,[U,gt],function(e,t){var n,r=e.extend({init:function(e){var t=this;t._super(e),t.canFocus=!0,e.tooltip&&r.tooltips!==!1&&t.on("mouseenter mouseleave",function(n){var r=t.tooltip().moveTo(-65535);if(n.control==t&&"mouseenter"==n.type){var i=r.text(e.tooltip).show().testMoveRel(t.getEl(),["bc-tc","bc-tl","bc-tr"]);r.toggleClass("tooltip-n","bc-tc"==i),r.toggleClass("tooltip-nw","bc-tl"==i),r.toggleClass("tooltip-ne","bc-tr"==i),r.moveRel(t.getEl(),i)}else r.hide()}),t.aria("label",e.tooltip)},tooltip:function(){var e=this;return n||(n=new t({type:"tooltip"}),n.renderTo(e.getContainerElm())),n},active:function(e){var t=this,n;return e!==n&&(t.aria("pressed",e),t.toggleClass("active",e)),t._super(e)},disabled:function(e){var t=this,n;return e!==n&&(t.aria("disabled",e),t.toggleClass("disabled",e)),t._super(e)},postRender:function(){var e=this,t=e.settings;e._rendered=!0,e._super(),e.parent()||!t.width&&!t.height||(e.initLayoutRect(),e.repaint()),t.autofocus&&setTimeout(function(){e.focus()},0)},remove:function(){this._super(),n&&(n.remove(),n=null)}});return r}),r(bt,[yt],function(e){return e.extend({Defaults:{classes:"widget btn",role:"button"},init:function(e){var t=this,n;t.on("click mousedown",function(e){e.preventDefault()}),t._super(e),n=e.size,e.subtype&&t.addClass(e.subtype),n&&t.addClass("btn-"+n)},repaint:function(){var e=this.getEl().firstChild.style;e.width=e.height="100%",this._super()},renderHtml:function(){var e=this,t=e._id,n=e.classPrefix,r=e.settings.icon,i="";return e.settings.image&&(r="none",i=" style=\"background-image: url('"+e.settings.image+"')\""),r=e.settings.icon?n+"ico "+n+"i-"+r:"",'<div id="'+t+'" class="'+e.classes()+'" tabindex="-1">'+'<button role="presentation" type="button" tabindex="-1">'+(r?'<i class="'+r+'"'+i+"></i>":"")+(e._text?(r?" ":"")+e.encode(e._text):"")+"</button>"+"</div>"}})}),r(wt,[W],function(e){return e.extend({Defaults:{defaultType:"button",role:"toolbar"},renderHtml:function(){var e=this,t=e._layout;return e.addClass("btn-group"),e.preRender(),t.preRender(e),'<div id="'+e._id+'" class="'+e.classes()+'">'+'<div id="'+e._id+'-body">'+(e.settings.html||"")+t.renderHtml(e)+"</div>"+"</div>"}})}),r(Et,[yt],function(e){return e.extend({Defaults:{classes:"checkbox",role:"checkbox",checked:!1},init:function(e){var t=this;t._super(e),t.on("click mousedown",function(e){e.preventDefault()}),t.on("click",function(e){e.preventDefault(),t.disabled()||t.checked(!t.checked())}),t.checked(t.settings.checked)},checked:function(e){var t=this;return"undefined"!=typeof e?(e?t.addClass("checked"):t.removeClass("checked"),t._checked=e,t.aria("checked",e),t):t._checked},value:function(e){return this.checked(e)},renderHtml:function(){var e=this,t=e._id,n=e.classPrefix;return'<div id="'+t+'" class="'+e.classes()+'" unselectable="on" aria-labeledby="'+t+'-al" tabindex="-1">'+'<i class="'+n+"ico "+n+'i-checkbox"></i>'+'<span id="'+t+'-al" class="'+n+'label">'+e.encode(e._text)+"</span>"+"</div>"}})}),r(St,[bt,Q],function(e,t){return e.extend({showPanel:function(){var e=this,n=e.settings;n.panel.popover=!0,n.panel.autohide=!0,e.active(!0),e.panel?e.panel.show():(e.panel=(new t(n.panel)).on("hide",function(){e.active(!1)}).parent(e).renderTo(e.getContainerElm()),e.panel.fire("show"),e.panel.reflow()),e.panel.moveRel(e.getEl(),n.popoverAlign||"bc-tc")},hidePanel:function(){var e=this;e.panel&&e.panel.hide()},postRender:function(){var e=this;return e.on("click",function(t){t.control===e&&(e.panel&&e.panel.visible()?e.hidePanel():e.showPanel())}),e._super()}})}),r(xt,[St,g],function(e,t){var n=t.DOM;return e.extend({init:function(e){this._super(e),this.addClass("colorbutton")},color:function(e){return e?(this._color=e,this.getEl("preview").style.backgroundColor=e,this):this._color},renderHtml:function(){var e=this,t=e._id,n=e.classPrefix,r=e.settings.icon?n+"ico "+n+"i-"+e.settings.icon:"",i=e.settings.image?" style=\"background-image: url('"+e.settings.image+"')\"":"";return'<div id="'+t+'" class="'+e.classes()+'">'+'<button role="presentation" hidefocus type="button" tabindex="-1">'+(r?'<i class="'+r+'"'+i+"></i>":"")+'<span id="'+t+'-preview" class="'+n+'preview"></span>'+(e._text?(r?" ":"")+e._text:"")+"</button>"+'<button type="button" class="'+n+'open" hidefocus tabindex="-1">'+' <i class="'+n+'caret"></i>'+"</button>"+"</div>"},postRender:function(){var e=this,t=e.settings.onclick;return e.on("click",function(r){r.control!=e||n.getParent(r.target,"."+e.classPrefix+"open")||(r.stopImmediatePropagation(),t.call(e,r))}),delete e.settings.onclick,e._super()}})}),r(Tt,[yt,R],function(e,t){return e.extend({init:function(e){var n=this;n._super(e),n.addClass("combobox"),n.on("click",function(e){for(var t=e.target;t;)t.id&&-1!=t.id.indexOf("-open")&&n.fire("action"),t=t.parentNode}),n.on("keydown",function(e){"INPUT"==e.target.nodeName&&13==e.keyCode&&n.parents().reverse().each(function(t){return e.preventDefault(),n.fire("change"),t.submit?(t.submit(),!1):void 0})}),e.placeholder&&(n.addClass("placeholder"),n.on("focusin",function(){n._hasOnChange||(t.on(n.getEl("inp"),"change",function(){n.fire("change")}),n._hasOnChange=!0),n.hasClass("placeholder")&&(n.getEl("inp").value="",n.removeClass("placeholder"))}),n.on("focusout",function(){0===n.value().length&&(n.getEl("inp").value=e.placeholder,n.addClass("placeholder"))}))},value:function(e){var t=this;return"undefined"!=typeof e?(t._value=e,t.removeClass("placeholder"),t._rendered&&(t.getEl("inp").value=e),t):t._rendered?(e=t.getEl("inp").value,e!=t.settings.placeholder?e:""):t._value},disabled:function(e){var t=this;t._super(e),t._rendered&&(t.getEl("inp").disabled=e)},focus:function(){this.getEl("inp").focus()},repaint:function(){var e=this,n=e.getEl(),r=e.getEl("open"),i=e.layoutRect(),s,o;s=r?i.w-r.offsetWidth-10:i.w-10;var u=document;return u.all&&(!u.documentMode||u.documentMode<=8)&&(o=e.layoutRect().h-2+"px"),t.css(n.firstChild,{width:s,lineHeight:o}),e._super(),e},postRender:function(){var e=this;return t.on(this.getEl("inp"),"change",function(){e.fire("change")}),e._super()},renderHtml:function(){var e=this,t=e._id,n=e.settings,r=e.classPrefix,i=n.value||n.placeholder||"",s,o,u="";return s=n.icon?r+"ico "+r+"i-"+n.icon:"",o=e._text,(s||o)&&(u='<div id="'+t+'-open" class="'+r+"btn "+r+'open" tabIndex="-1">'+'<button id="'+t+'-action" type="button" hidefocus tabindex="-1">'+(s?'<i class="'+s+'"></i>':'<i class="'+r+'caret"></i>')+(o?(s?" ":"")+o:"")+"</button>"+"</div>",e.addClass("has-open")),'<div id="'+t+'" class="'+e.classes()+'">'+'<input id="'+t+'-inp" class="'+r+"textbox "+r+'placeholder" value="'+i+'" hidefocus="true">'+u+"</div>"}})}),r(Nt,[U,G],function(e,t){return e.extend({Defaults:{delimiter:""},init:function(e){var t=this;t._super(e),t.addClass("path"),t.canFocus=!0,t.on("click",function(e){var n,r=e.target;(n=r.getAttribute("data-index"))&&t.fire("select",{value:t.data()[n],index:n})})},focus:function(){var e=this;return e.keyNav=new t({root:e,enableLeftRight:!0}),e.keyNav.focusFirst(),e},data:function(e){var t=this;return"undefined"!=typeof e?(t._data=e,t.update(),t):t._data},update:function(){this.getEl().innerHTML=this._getPathHtml()},postRender:function(){var e=this;e._super(),e.data(e.settings.data)},renderHtml:function(){var e=this;return'<div id="'+e._id+'" class="'+e.classPrefix+'path">'+e._getPathHtml()+"</div>"},_getPathHtml:function(){var e=this,t=e._data||[],n,r,i="",s=e.classPrefix;for(n=0,r=t.length;r>n;n++)i+=(n>0?'<div class="'+s+'divider" aria-hidden="true"> '+e.settings.delimiter+" </div>":"")+'<div role="button" class="'+s+"path-item"+(n==r-1?" "+s+"last":"")+'" data-index="'+n+'" tabindex="-1" id="'+e._id+"-"+n+'">'+t[n].name+"</div>";return i||(i='<div class="'+s+'path-item">&nbsp;</div>'),i}})}),r(Ct,[Nt,ut],function(e,t){return e.extend({postRender:function(){function e(e){return 1===e.nodeType&&("BR"==e.nodeName||!!e.getAttribute("data-mce-bogus"))}var n=this,r=t.activeEditor;return n.on("select",function(t){var n=[],i,s=r.getBody();for(r.focus(),i=r.selection.getStart();i&&i!=s;)e(i)||n.push(i),i=i.parentNode;r.selection.select(n[n.length-1-t.index]),r.nodeChanged()}),r.on("nodeChange",function(t){for(var i=[],s=t.parents,o=s.length;o--;)if(1==s[o].nodeType&&!e(s[o])){var u=r.fire("ResolveName",{name:s[o].nodeName.toLowerCase(),target:s[o]});i.push({name:u.name})}n.data(i)}),n._super()}})}),r(kt,[W],function(e){return e.extend({Defaults:{layout:"flex",align:"center",defaults:{flex:1}},renderHtml:function(){var e=this,t=e._layout,n=e.classPrefix;return e.addClass("formitem"),t.preRender(e),'<div id="'+e._id+'" class="'+e.classes()+'" hideFocus="1" tabIndex="-1">'+(e.settings.title?'<div id="'+e._id+'-title" class="'+n+'title">'+e.settings.title+"</div>":"")+'<div id="'+e._id+'-body" class="'+e.classes("body")+'">'+(e.settings.html||"")+t.renderHtml(e)+"</div>"+"</div>"}})}),r(Lt,[W,kt],function(e,t){return e.extend({Defaults:{containerCls:"form",layout:"flex",direction:"column",align:"stretch",flex:1,padding:20,labelGap:30,spacing:10},preRender:function(){var e=this,n=e.items();n.each(function(n){var r,i=n.settings.label;i&&(r=new t({layout:"flex",autoResize:"overflow",defaults:{flex:1},items:[{type:"label",text:i,flex:0,forId:n._id}]}),r.type="formitem","undefined"==typeof n.settings.flex&&(n.settings.flex=1),e.replace(n,r),r.add(n))})},recalcLabels:function(){var e=this,t=0,n=[],r,i;if(e.settings.labelGapCalc!==!1)for(e.items().filter("formitem").each(function(e){var r=e.items()[0],i=r.getEl().clientWidth;t=i>t?i:t,n.push(r)}),i=e.settings.labelGap||0,r=n.length;r--;)n[r].settings.minWidth=t+i},visible:function(e){var t=this._super(e);return e===!0&&this._rendered&&this.recalcLabels(),t},submit:function(){var e=this.getParentCtrl(document.activeElement);return e&&e.blur(),this.fire("submit",{data:this.toJSON()})},postRender:function(){var e=this;e._super(),e.recalcLabels(),e.fromJSON(e.settings.data)}})}),r(At,[Lt],function(e){return e.extend({Defaults:{containerCls:"fieldset",layout:"flex",direction:"column",align:"stretch",flex:1,padding:"25 15 5 15",labelGap:30,spacing:10,border:1},renderHtml:function(){var e=this,t=e._layout,n=e.classPrefix;return e.preRender(),t.preRender(e),'<fieldset id="'+e._id+'" class="'+e.classes()+'" hideFocus="1" tabIndex="-1">'+(e.settings.title?'<legend id="'+e._id+'-title" class="'+n+'fieldset-title">'+e.settings.title+"</legend>":"")+'<div id="'+e._id+'-body" class="'+e.classes("body")+'">'+(e.settings.html||"")+t.renderHtml(e)+"</div>"+"</fieldset>"}})}),r(Ot,[Tt],function(e){return e.extend({init:function(e){var t=this,n=tinymce.activeEditor,r;e.spellcheck=!1,r=n.settings.file_browser_callback,r&&(e.icon="browse",e.onaction=function(){r(t.getEl("inp").id,t.getEl("inp").value,e.filetype,window)}),t._super(e)}})}),r(Mt,[mt],function(e){return e.extend({recalc:function(e){var t=e.layoutRect(),n=e.paddingBox();e.items().filter(":visible").each(function(e){e.layoutRect({x:n.left,y:n.top,w:t.innerW-n.right-n.left,h:t.innerH-n.top-n.bottom}),e.recalc&&e.recalc()})}})}),r(_t,[mt],function(e){return e.extend({recalc:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g=[],y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U=Math.max,z=Math.min;for(r=e.items().filter(":visible"),i=e.layoutRect(),s=e._paddingBox,o=e.settings,h=o.direction,u=o.align,a=o.pack,f=o.spacing||0,("row-reversed"==h||"column-reverse"==h)&&(r=r.set(r.toArray().reverse()),h=h.split("-")[0]),"column"==h?(C="y",T="h",N="minH",k="maxH",A="innerH",L="top",O="bottom",M="deltaH",_="contentH",F="left",H="w",D="x",P="innerW",B="minW",j="maxW",I="right",q="deltaW",R="contentW"):(C="x",T="w",N="minW",k="maxW",A="innerW",L="left",O="right",M="deltaW",_="contentW",F="top",H="h",D="y",P="innerH",B="minH",j="maxH",I="bottom",q="deltaH",R="contentH"),c=i[A]-s[L]-s[L],x=l=0,t=0,n=r.length;n>t;t++)p=r[t],d=p.layoutRect(),v=p.settings,m=v.flex,c-=n-1>t?f:0,m>0&&(l+=m,d[k]&&g.push(p),d.flex=m),c-=d[N],y=s[F]+d[B]+s[I],y>x&&(x=y);if(E={},E[N]=0>c?i[N]-c+i[M]:i[A]-c+i[M],E[B]=x+i[q],E[_]=i[A]-c,E[R]=x,E.minW=z(E.minW,i.maxW),E.minH=z(E.minH,i.maxH),E.minW=U(E.minW,i.startMinWidth),E.minH=U(E.minH,i.startMinHeight),!i.autoResize||E.minW==i.minW&&E.minH==i.minH){for(w=c/l,t=0,n=g.length;n>t;t++)p=g[t],d=p.layoutRect(),b=d[k],y=d[N]+Math.ceil(d.flex*w),y>b?(c-=d[k]-d[N],l-=d.flex,d.flex=0,d.maxFlexSize=b):d.maxFlexSize=0;for(w=c/l,S=s[L],E={},0===l&&("end"==a?S=c+s[L]:"center"==a?(S=Math.round(i[A]/2-(i[A]-c)/2)+s[L],0>S&&(S=s[L])):"justify"==a&&(S=s[L],f=Math.floor(c/(r.length-1)))),E[D]=s[F],t=0,n=r.length;n>t;t++)p=r[t],d=p.layoutRect(),y=d.maxFlexSize||d[N],"center"===u?E[D]=Math.round(i[P]/2-d[H]/2):"stretch"===u?(E[H]=U(d[B]||0,i[P]-s[F]-s[I]),E[D]=s[F]):"end"===u&&(E[D]=i[P]-d[H]-s.top),d.flex>0&&(y+=Math.ceil(d.flex*w)),E[T]=y,E[C]=S,p.layoutRect(E),p.recalc&&p.recalc(),S+=y+f}else if(E.w=E.minW,E.h=E.minH,e.layoutRect(E),this.recalc(e),null===e._lastRect){var W=e.parent();W&&(W._lastRect=null,W.recalc())}}})}),r(Dt,[vt],function(e){return e.extend({Defaults:{containerClass:"flow-layout",controlClass:"flow-layout-item",endClass:"break"},recalc:function(e){e.items().filter(":visible").each(function(e){e.recalc&&e.recalc()})}})}),r(Pt,[z,U,yt,Q,p,ut,m],function(e,t,n,r,i,s,o){function u(e){function t(e){return e.replace(/%(\w+)/g,"")}var n=s.activeEditor,r,i,o=n.dom,u="",a,f;return f=n.settings.preview_styles,f===!1?"":(f||(f="font-family font-size font-weight text-decoration text-transform color background-color border border-radius"),(e=n.formatter.get(e))?(e=e[0],r=e.block||e.inline||"span",i=o.create(r),l(e.styles,function(e,n){e=t(e),e&&o.setStyle(i,n,e)}),l(e.attributes,function(e,n){e=t(e),e&&o.setAttrib(i,n,e)}),l(e.classes,function(e){e=t(e),o.hasClass(i,e)||o.addClass(i,e)}),n.fire("PreviewFormats"),o.setStyles(i,{position:"absolute",left:-65535}),n.getBody().appendChild(i),a=o.getStyle(n.getBody(),"fontSize",!0),a=/px$/.test(a)?parseInt(a,10):0,l(f.split(" "),function(e){var t=o.getStyle(i,e,!0);if(!("background-color"==e&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(t)&&(t=o.getStyle(n.getBody(),e,!0),"#ffffff"==o.toHex(t).toLowerCase())||"color"==e&&"#000000"==o.toHex(t).toLowerCase())){if("font-size"==e&&/em|%$/.test(t)){if(0===a)return;t=parseFloat(t,10)/(/%$/.test(t)?100:1),t=t*a+"px"}"border"==e&&t&&(u+="padding:0 2px;"),u+=e+":"+t+";"}}),n.fire("AfterPreviewFormats"),o.remove(i),u):void 0)}function a(e,t){return function(){var n=this;s.activeEditor.on("nodeChange",function(r){var i=s.activeEditor.formatter,o=null;l(r.parents,function(n){return l(e,function(e){return t?i.matchNode(n,t,{value:e.value})&&(o=e.value):i.matchNode(n,e.value)&&(o=e.value),o?!1:void 0}),o?!1:void 0}),n.value(o)})}}function f(e){e=e.split(";");for(var t=e.length;t--;)e[t]=e[t].split("=");return e}var l=i.each;t.translate=function(e){return s.translate(e)},n.tooltips=!o.iOS,s.on("AddEditor",function(t){function n(){function e(r){var i=[];if(r)return l(r,function(r){var s={text:r.title,icon:r.icon,preview:!0};if(r.items)s.menu=e(r.items);else{var o=r.format||"custom"+t++;r.format||(r.name=o,n.push(r)),s.textStyle=function(){return u(o)},s.onclick=function(){v(o)},s.onPostRender=function(){var e=this;e.parent().on("show",function(){e.disabled(!m.formatter.canApply(o)),e.active(m.formatter.match(o))})}}i.push(s)}),i}var t=0,n=[],r=[{title:"Headers",items:[{title:"Header 1",format:"h1"},{title:"Header 2",format:"h2"},{title:"Header 3",format:"h3"},{title:"Header 4",format:"h4"},{title:"Header 5",format:"h5"},{title:"Header 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}];m.on("init",function(){l(n,function(e){m.formatter.register(e.name,e)})});var i=e(m.settings.style_formats||r);return i}function o(){return m.undoManager?m.undoManager.hasUndo():!1}function c(){return m.undoManager?m.undoManager.hasRedo():!1}function h(){var e=this;e.disabled(!o()),m.on("Undo Redo AddUndo TypingUndo",function(){e.disabled(!o())})}function p(){var e=this;e.disabled(!c()),m.on("Undo Redo AddUndo TypingUndo",function(){e.disabled(!c())})}function d(){var e=this;m.on("VisualAid",function(t){e.active(t.hasVisual)}),e.active(m.hasVisual)}function v(e){e.control&&(e=e.control.value()),e&&s.activeEditor.execCommand("mceToggleFormat",!1,e)}var m=t.editor,g;g=n(),l({bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript"},function(e,t){m.addButton(t,{tooltip:e,onPostRender:function(){var e=this;m.formatter?m.formatter.formatChanged(t,function(t){e.active(t)}):m.on("init",function(){m.formatter.formatChanged(t,function(t){e.active(t)})})},onclick:function(){v(t)}})}),l({outdent:["Decrease indent","Outdent"],indent:["Increase indent","Indent"],cut:["Cut","Cut"],copy:["Copy","Copy"],paste:["Paste","Paste"],help:["Help","mceHelp"],selectall:["Select all","SelectAll"],hr:["Insert horizontal rule","InsertHorizontalRule"],removeformat:["Clear formatting","RemoveFormat"],visualaid:["Visual aids","mceToggleVisualAid"],newdocument:["New document","mceNewDocument"]},function(e,t){m.addButton(t,{tooltip:e[0],cmd:e[1]})}),l({blockquote:["Toggle blockquote","mceBlockQuote"],numlist:["Numbered list","InsertOrderedList"],bullist:["Bulleted list","InsertUnorderedList"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],alignleft:["Align left","JustifyLeft"],aligncenter:["Align center","JustifyCenter"],alignright:["Align right","JustifyRight"],alignjustify:["Justify","JustifyFull"]},function(e,t){m.addButton(t,{tooltip:e[0],cmd:e[1],onPostRender:function(){var e=this;m.formatter?m.formatter.formatChanged(t,function(t){e.active(t)}):m.on("init",function(){m.formatter.formatChanged(t,function(t){e.active(t)})})}})}),m.addButton("undo",{tooltip:"Undo",onPostRender:h,cmd:"undo"}),m.addButton("redo",{tooltip:"Redo",onPostRender:p,cmd:"redo"}),m.addMenuItem("newdocument",{text:"New document",shortcut:"Ctrl+N",icon:"newdocument",cmd:"mceNewDocument"}),m.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Ctrl+Z",onPostRender:h,cmd:"undo"}),m.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Ctrl+Y",onPostRender:p,cmd:"redo"}),m.addMenuItem("visualaid",{text:"Visual aids",selectable:!0,onPostRender:d,cmd:"mceToggleVisualAid"}),l({cut:["Cut","Cut","Ctrl+X"],copy:["Copy","Copy","Ctrl+C"],paste:["Paste","Paste","Ctrl+V"],selectall:["Select all","SelectAll","Ctrl+A"],bold:["Bold","Bold","Ctrl+B"],italic:["Italic","Italic","Ctrl+I"],underline:["Underline","Underline"],strikethrough:["Strikethrough","Strikethrough"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],removeformat:["Clear formatting","RemoveFormat"]},function(e,t){m.addMenuItem(t,{text:e[0],icon:t,shortcut:e[2],cmd:e[1]})}),m.on("mousedown",function(){r.hideAll()}),e.add("styleselect",function(t){var n=[].concat(g);return e.create("menubutton",i.extend({text:"Formats",menu:n},t))}),e.add("formatselect",function(t){var n=[],r=f(m.settings.block_formats||"Paragraph=p;Address=address;Pre=pre;Header 1=h1;Header 2=h2;Header 3=h3;Header 4=h4;Header 5=h5;Header 6=h6");return l(r,function(e){n.push({text:{raw:e[0]},value:e[1],textStyle:function(){return u(e[1])}})}),e.create("listbox",i.extend({text:{raw:r[0][0]},values:n,fixedWidth:!0,onselect:v,onPostRender:a(n)},t))}),e.add("fontselect",function(t){var n="Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",r=[],o=f(m.settings.font_formats||n);return l(o,function(e){r.push({text:{raw:e[0]},value:e[1],textStyle:-1==e[1].indexOf("dings")?"font-family:"+e[1]:""})}),e.create("listbox",i.extend({text:"Font Family",tooltip:"Font Family",values:r,fixedWidth:!0,onPostRender:a(r,"fontname"),onselect:function(e){e.control.settings.value&&s.activeEditor.execCommand("FontName",!1,e.control.settings.value)}},t))}),e.add("fontsizeselect",function(t){var n=[],r="8pt 10pt 12pt 14pt 18pt 24pt 36pt",o=m.settings.fontsize_formats||r;return l(o.split(" "),function(e){n.push({text:e,value:e})}),e.create("listbox",i.extend({text:"Font Sizes",tooltip:"Font Sizes",values:n,fixedWidth:!0,onPostRender:a(n,"fontsize"),onclick:function(e){e.control.settings.value&&s.activeEditor.execCommand("FontSize",!1,e.control.settings.value)}},t))}),m.addMenuItem("formats",{text:"Formats",menu:g})})}),r(Ht,[mt],function(e){return e.extend({recalc:function(e){var t=e.settings,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T=[],N=[],C,k,L,A,O,M;for(t=e.settings,i=e.items().filter(":visible"),s=e.layoutRect(),r=t.columns||Math.ceil(Math.sqrt(i.length)),n=Math.ceil(i.length/r),y=t.spacingH||t.spacing||0,b=t.spacingV||t.spacing||0,w=t.alignH||t.align,E=t.alignV||t.align,m=e._paddingBox,w&&"string"==typeof w&&(w=[w]),E&&"string"==typeof E&&(E=[E]),c=0;r>c;c++)T.push(0);for(h=0;n>h;h++)N.push(0);for(h=0;n>h;h++)for(c=0;r>c&&(l=i[h*r+c],l);c++)f=l.layoutRect(),C=f.minW,k=f.minH,T[c]=C>T[c]?C:T[c],N[h]=k>N[h]?k:N[h];for(O=s.innerW-m.left-m.right,S=0,c=0;r>c;c++)S+=T[c]+(c>0?y:0),O-=(c>0?y:0)+T[c];for(M=s.innerH-m.top-m.bottom,x=0,h=0;n>h;h++)x+=N[h]+(h>0?b:0),M-=(h>0?b:0)+N[h];if(S+=m.left+m.right,x+=m.top+m.bottom,a={},a.minW=S+(s.w-s.innerW),a.minH=x+(s.h-s.innerH),a.contentW=a.minW-s.deltaW,a.contentH=a.minH-s.deltaH,a.minW=Math.min(a.minW,s.maxW),a.minH=Math.min(a.minH,s.maxH),a.minW=Math.max(a.minW,s.startMinWidth),a.minH=Math.max(a.minH,s.startMinHeight),!s.autoResize||a.minW==s.minW&&a.minH==s.minH){s.autoResize&&(a=e.layoutRect(a),a.contentW=a.minW-s.deltaW,a.contentH=a.minH-s.deltaH);var _;_="start"==t.packV?0:M>0?Math.floor(M/n):0;var D=0,P=t.flexWidths;if(P)for(c=0;c<P.length;c++)D+=P[c];else D=r;var H=O/D;for(c=0;r>c;c++)T[c]+=P?Math.ceil(P[c]*H):H;for(d=m.top,h=0;n>h;h++){for(p=m.left,u=N[h]+_,c=0;r>c&&(l=i[h*r+c],l);c++)v=l.settings,f=l.layoutRect(),o=T[c],L=A=0,f.x=p,f.y=d,g=v.alignH||(w?w[c]||w[0]:null),"center"==g?f.x=p+o/2-f.w/2:"right"==g?f.x=p+o-f.w:"stretch"==g&&(f.w=o),g=v.alignV||(E?E[c]||E[0]:null),"center"==g?f.y=d+u/2-f.h/2:"bottom"==g?f.y=d+u-f.h:"stretch"==g&&(f.h=u),l.layoutRect(f),p+=o+y,l.recalc&&l.recalc();d+=u+b}}else if(a.w=a.minW,a.h=a.minH,e.layoutRect(a),this.recalc(e),null===e._lastRect){var B=e.parent();B&&(B._lastRect=null,B.recalc())}}})}),r(Bt,[yt],function(e){return e.extend({renderHtml:function(){var e=this;return e.addClass("iframe"),e.canFocus=!1,'<iframe id="'+e._id+'" class="'+e.classes()+'" tabindex="-1" src="'+(e.settings.url||"javascript:''")+'" frameborder="0"></iframe>'},src:function(e){this.getEl().src=e},html:function(e){return this.getEl().contentWindow.document.body.innerHTML=e,this}})}),r(jt,[yt],function(e){return e.extend({init:function(e){var t=this;t._super(e),t.addClass("widget"),t.addClass("label"),t.canFocus=!1,e.multiline&&t.addClass("autoscroll"),e.strong&&t.addClass("strong")},initLayoutRect:function(){var e=this,t=e._super();return e.settings.multiline&&(e.getEl().offsetWidth>t.maxW&&(t.minW=t.maxW,e.addClass("multiline")),e.getEl().style.width=t.minW+"px",t.startMinH=t.h=t.minH=Math.min(t.maxH,e.getEl().offsetHeight)),t},disabled:function(e){var t=this,n;return e!==n&&(t.toggleClass("label-disabled",e),t._rendered&&(t.getEl()[0].className=t.classes())),t._super(e)},repaint:function(){var e=this;return e.settings.multiline||(e.getEl().style.lineHeight=e.layoutRect().h+"px"),e._super()},text:function(e){var t=this;return t._rendered&&e&&(t.getEl().innerHTML=t.encode(e)),t._super(e)},renderHtml:function(){var e=this,t=e.settings.forId;return'<label id="'+e._id+'" class="'+e.classes()+'"'+(t?' for="'+t:"")+'">'+e.encode(e._text)+"</label>"}})}),r(Ft,[W,G],function(e,t){return e.extend({Defaults:{role:"toolbar",layout:"flow"},init:function(e){var t=this;t._super(e),t.addClass("toolbar")},postRender:function(){var e=this;return e.items().addClass("toolbar-item"),e.keyNav=new t({root:e,enableLeftRight:!0}),e._super()}})}),r(It,[Ft],function(e){return e.extend({Defaults:{role:"menubar",containerCls:"menubar",defaults:{type:"menubutton"}}})}),r(qt,[bt,z,It],function(e,t,n){function r(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1}var i=e.extend({init:function(e){var t=this;t._renderOpen=!0,t._super(e),t.addClass("menubtn"),e.fixedWidth&&t.addClass("fixed-width"),t.aria("haspopup",!0),t.hasPopup=!0},showMenu:function(){var e=this,n=e.settings,r;return e.menu&&e.menu.visible()?e.hideMenu():(e.menu||(r=n.menu||[],r.length?r={type:"menu",items:r}:r.type=r.type||"menu",e.menu=t.create(r).parent(e).renderTo(e.getContainerElm()),e.fire("createmenu"),e.menu.reflow(),e.menu.on("cancel",function(t){t.control===e.menu&&e.focus()}),e.menu.on("show hide",function(t){t.control==e.menu&&e.activeMenu("show"==t.type)}).fire("show"),e.aria("expanded",!0)),e.menu.show(),e.menu.layoutRect({w:e.layoutRect().w}),e.menu.moveRel(e.getEl(),["bl-tl","tl-bl"]),void 0)},hideMenu:function(){var e=this;e.menu&&(e.menu.items().each(function(e){e.hideMenu&&e.hideMenu()}),e.menu.hide(),e.aria("expanded",!1))},activeMenu:function(e){this.toggleClass("active",e)},renderHtml:function(){var e=this,t=e._id,r=e.classPrefix,i=e.settings.icon?r+"ico "+r+"i-"+e.settings.icon:"";return e.aria("role",e.parent()instanceof n?"menuitem":"button"),'<div id="'+t+'" class="'+e.classes()+'" tabindex="-1">'+'<button id="'+t+'-open" role="presentation" type="button" tabindex="-1">'+(i?'<i class="'+i+'"></i>':"")+"<span>"+(e._text?(i?" ":"")+e.encode(e._text):"")+"</span>"+' <i class="'+r+'caret"></i>'+"</button>"+"</div>"},postRender:function(){var e=this;return e.on("click",function(t){t.control===e&&r(t.target,e.getEl())&&(e.showMenu(),t.keyboard&&e.menu.items()[0].focus())}),e.on("mouseenter",function(t){var n=t.control,r=e.parent(),s;n&&r&&n instanceof i&&n.parent()==r&&(r.items().filter("MenuButton").each(function(e){e.hideMenu&&e!=n&&(e.menu&&e.menu.visible()&&(s=!0),e.hideMenu())}),s&&n.showMenu())}),e._super()},text:function(e){var t=this,n,r;if(t._rendered)for(r=t.getEl("open").getElementsByTagName("span"),n=0;n<r.length;n++)r[n].innerHTML=t.encode(e);return this._super(e)},remove:function(){this._super(),this.menu&&this.menu.remove()}});return i}),r(Rt,[qt],function(e){return e.extend({init:function(e){var t=this,n,r,i,s,o;if(t._values=n=e.values,n){for(r=0;r<n.length;r++)i=n[r].selected||e.value===n[r].value,i&&(s=s||n[r].text,t._value=n[r].value);e.menu=n}e.text=e.text||s||n[0].text,t._super(e),t.addClass("listbox"),t.on("select",function(n){var r=n.control;o&&(n.lastControl=o),e.multiple?r.active(!r.active()):t.value(n.control.settings.value),o=r})},value:function(e){function t(e,n){e.items().each(function(e){r=e.value()===n,r&&(i=i||e.text()),e.active(r),e.menu&&t(e.menu,n)})}var n=this,r,i,s,o;if("undefined"!=typeof e){if(n.menu)t(n.menu,e);else for(s=n.settings.menu,o=0;o<s.length;o++)r=s[o].value==e,r&&(i=i||s[o].text),s[o].active=r;n.text(i||this.settings.text)}return n._super(e)}})}),r(Ut,[yt,z],function(e,t){return e.extend({Defaults:{border:0,role:"menuitem"},init:function(e){var t=this;t.hasPopup=!0,t._super(e),e=t.settings,t.addClass("menu-item"),e.menu&&t.addClass("menu-item-expand"),e.preview&&t.addClass("menu-item-preview"),("-"===t._text||"|"===t._text)&&(t.addClass("menu-item-sep"),t.aria("role","separator"),t.canFocus=!1,t._text="-"),e.selectable&&(t.aria("role","menuitemcheckbox"),t.aria("checked",!0),t.addClass("menu-item-checkbox"),e.icon="selected"),t.on("mousedown",function(e){e.preventDefault()}),t.on("mouseenter click",function(n){n.control===t&&(e.menu||"click"!==n.type?(t.showMenu(),n.keyboard&&setTimeout(function(){t.menu.items()[0].focus()},0)):(t.parent().hideAll(),t.fire("cancel"),t.fire("select")))}),e.menu&&t.aria("haspopup",!0)},hasMenus:function(){return!!this.settings.menu},showMenu:function(){var e=this,n=e.settings,r;if(e.parent().items().each(function(t){t!==e&&t.hideMenu()}),n.menu){r=e.menu,r?r.show():(r=n.menu,r.length?r={type:"menu",items:r}:r.type=r.type||"menu",r=e.menu=t.create(r).parent(e).renderTo(e.getContainerElm()),r.reflow(),r.fire("show"),r.on("cancel",function(){e.focus()}),r.on("hide",function(t){t.control===r&&e.removeClass("selected")})),r._parentMenu=e.parent(),r.addClass("menu-sub");var i=r.testMoveRel(e.getEl(),["tr-tl","br-bl","tl-tr","bl-br"]);r.moveRel(e.getEl(),i),i="menu-sub-"+i,r.removeClass(r._lastRel),r.addClass(i),r._lastRel=i,e.addClass("selected"),e.aria("expanded",!0)}},hideMenu:function(){var e=this;return e.menu&&(e.menu.items().each(function(e){e.hideMenu&&e.hideMenu()}),e.menu.hide(),e.aria("expanded",!1)),e},renderHtml:function(){var e=this,t=e._id,n=e.settings,r=e.classPrefix,i=e.encode(e._text),s=e.settings.icon;return s&&e.parent().addClass("menu-has-icons"),s=r+"ico "+r+"i-"+(e.settings.icon||"none"),'<div id="'+t+'" class="'+e.classes()+'" tabindex="-1">'+("-"!==i?'<i class="'+s+'"></i>&nbsp;':"")+("-"!==i?'<span id="'+t+'-text" class="'+r+'text">'+i+"</span>":"")+(n.shortcut?'<div id="'+t+'-shortcut" class="'+r+'menu-shortcut">'+n.shortcut+"</div>":"")+(n.menu?'<div class="'+r+'caret"></div>':"")+"</div>"},postRender:function(){var e=this,t=e.settings,n=t.textStyle;if("function"==typeof n&&(n=n()),n){var r=e.getEl("text");r&&r.setAttribute("style",n)}return e._super()},remove:function(){this._super(),this.menu&&this.menu.remove()}})}),r(zt,[Q,G,Ut],function(e,t,n){var r=e.extend({Defaults:{defaultType:"menuitem",border:1,layout:"stack",role:"menu"},init:function(e){var r=this;e.autohide=!0,e.constrainToViewport=!0,r._super(e),r.addClass("menu"),r.keyNav=new t({root:r,enableUpDown:!0,enableLeftRight:!0,leftAction:function(){r.parent()instanceof n&&r.keyNav.cancel()},onCancel:function(){r.fire("cancel",{},!1),r.hide()}})},repaint:function(){return this.toggleClass("menu-align",!0),this._super(),this.getEl().style.height="",this.getEl("body").style.height="",this},cancel:function(){var e=this;e.hideAll(),e.fire("cancel"),e.fire("select")},hideAll:function(){var e=this;return this.find("menuitem").exec("hideMenu"),e._super()},preRender:function(){var e=this;return e.items().each(function(t){var n=t.settings;return n.icon||n.selectable?(e._hasIcons=!0,!1):void 0}),e._super()}});return r}),r(Wt,[Et],function(e){return e.extend({Defaults:{classes:"radio",role:"radio"}})}),r(Xt,[yt,X],function(e,t){return e.extend({renderHtml:function(){var e=this,t=e.classPrefix;return e.addClass("resizehandle"),"both"==e.settings.direction&&e.addClass("resizehandle-both"),e.canFocus=!1,'<div id="'+e._id+'" class="'+e.classes()+'">'+'<i class="'+t+"ico "+t+'i-resize"></i>'+"</div>"},postRender:function(){var e=this;e._super(),e.resizeDragHelper=new t(this._id,{start:function(){e.fire("ResizeStart")},drag:function(t){"both"!=e.settings.direction&&(t.deltaX=0),e.fire("Resize",t)},end:function(){e.fire("ResizeEnd")}})}})}),r(Vt,[yt],function(e){return e.extend({renderHtml:function(){var e=this;return e.addClass("spacer"),e.canFocus=!1,'<div id="'+e._id+'" class="'+e.classes()+'"></div>'}})}),r($t,[qt,g],function(e,t){var n=t.DOM;return e.extend({Defaults:{classes:"widget btn splitbtn",role:"splitbutton"},repaint:function(){var e=this,t=e.getEl(),r=e.layoutRect(),i,s,o;return e._super(),i=t.firstChild,s=t.lastChild,n.css(i,{width:r.w-s.offsetWidth,height:r.h-2}),n.css(s,{height:r.h-2}),o=i.firstChild.style,o.width=o.height="100%",o=s.firstChild.style,o.width=o.height="100%",e},activeMenu:function(e){var t=this;n.toggleClass(t.getEl().lastChild,t.classPrefix+"active",e)},renderHtml:function(){var e=this,t=e._id,n=e.classPrefix,r=e.settings.icon?n+"ico "+n+"i-"+e.settings.icon:"";return'<div id="'+t+'" class="'+e.classes()+'">'+'<button type="button" hidefocus tabindex="-1">'+(r?'<i class="'+r+'"></i>':"")+(e._text?(r?" ":"")+e._text:"")+"</button>"+'<button type="button" class="'+n+'open" hidefocus tabindex="-1">'+(e._menuBtnText?(r?" ":"")+e._menuBtnText:"")+' <i class="'+n+'caret"></i>'+"</button>"+"</div>"},postRender:function(){var e=this,t=e.settings.onclick;return e.on("click",function(e){e.control!=this||n.getParent(e.target,"."+this.classPrefix+"open")||(e.stopImmediatePropagation(),t.call(this,e))}),delete e.settings.onclick,e._super()}})}),r(Jt,[Dt],function(e){return e.extend({Defaults:{containerClass:"stack-layout",controlClass:"stack-layout-item",endClass:"break"}})}),r(Kt,[$,R],function(e,t){"use stict";return e.extend({lastIdx:0,Defaults:{layout:"absolute",defaults:{type:"panel"}},activateTab:function(e){this.activeTabId&&t.removeClass(this.getEl(this.activeTabId),this.classPrefix+"active"),this.activeTabId="t"+e,t.addClass(this.getEl("t"+e),this.classPrefix+"active"),e!=this.lastIdx&&(this.items()[this.lastIdx].hide(),this.lastIdx=e),this.items()[e].show().fire("showtab"),this.reflow()},renderHtml:function(){var e=this,t=e._layout,n="",r=e.classPrefix;return e.preRender(),t.preRender(e),e.items().each(function(t,i){n+='<div id="'+e._id+"-t"+i+'" class="'+r+'tab" unselectable="on">'+e.encode(t.settings.title)+"</div>"}),'<div id="'+e._id+'" class="'+e.classes()+'" hideFocus="1" tabIndex="-1">'+'<div id="'+e._id+'-head" class="'+r+'tabs">'+n+"</div>"+'<div id="'+e._id+'-body" class="'+e.classes("body")+'">'+t.renderHtml(e)+"</div>"+"</div>"},postRender:function(){var e=this;e._super(),e.settings.activeTab=e.settings.activeTab||0,e.activateTab(e.settings.activeTab),this.on("click",function(t){var n=t.target.parentNode;if(t.target.parentNode.id==e._id+"-head")for(var r=n.childNodes.length;r--;)n.childNodes[r]==t.target&&e.activateTab(r)})},initLayoutRect:function(){var e=this,t,n,r;n=r=0,e.items().each(function(t,i){n=Math.max(n,t.layoutRect().minW),r=Math.max(r,t.layoutRect().minH),e.settings.activeTab!=i&&t.hide()}),e.items().each(function(e){e.settings.x=0,e.settings.y=0,e.settings.w=n,e.settings.h=r,e.layoutRect({x:0,y:0,w:n,h:r})});var i=e.getEl("head").offsetHeight;return e.settings.minWidth=n,e.settings.minHeight=r+i,t=e._super(),t.deltaH+=e.getEl("head").offsetHeight,t.innerH=t.h-t.deltaH,t}})}),r(Qt,[yt,R],function(e,t){return e.extend({init:function(e){var t=this;t._super(e),t._value=e.value||"",t.addClass("textbox"),e.multiline?t.addClass("multiline"):t.on("keydown",function(e){13==e.keyCode&&t.parents().reverse().each(function(t){return e.preventDefault(),t.submit?(t.submit(),!1):void 0})})},value:function(e){var t=this;return"undefined"!=typeof e?(t._value=e,t._rendered&&(t.getEl().value=e),t):t._rendered?t.getEl().value:t._value},repaint:function(){var e=this,t,n,r,i=0,s=0,o;t=e.getEl().style,n=e._layoutRect,o=e._lastRepaintRect||{};var u=document;return!e.settings.multiline&&u.all&&(!u.documentMode||u.documentMode<=8)&&(t.lineHeight=n.h-s+"px"),r=e._borderBox,i=r.left+r.right+8,s=r.top+r.bottom+(e.settings.multiline?8:0),n.x!==o.x&&(t.left=n.x+"px",o.x=n.x),n.y!==o.y&&(t.top=n.y+"px",o.y=n.y),n.w!==o.w&&(t.width=n.w-i+"px",o.w=n.w),n.h!==o.h&&(t.height=n.h-s+"px",o.h=n.h),e._lastRepaintRect=o,e.fire("repaint",{},!1),e},renderHtml:function(){var e=this,t=e._id,n=e.settings,r=e.encode(e._value,!1),i="";return"spellcheck"in n&&(i+=' spellcheck="'+n.spellcheck+'"'),n.maxLength&&(i+=' maxlength="'+n.maxLength+'"'),n.size&&(i+=' size="'+n.size+'"'),n.subtype&&(i+=' type="'+n.subtype+'"'),n.multiline?'<textarea id="'+t+'" class="'+e.classes()+'" '+(n.rows?' rows="'+n.rows+'"':"")+' hidefocus="true"'+i+">"+r+"</textarea>":'<input id="'+t+'" class="'+e.classes()+'" value="'+r+'" hidefocus="true"'+i+">"},postRender:function(){var e=this;return t.on(e.getEl(),"change",function(t){e.fire("change",t)}),e._super()}})}),r(Gt,[R],function(e){return function(t){var n=this,r;n.show=function(i){return n.hide(),r=!0,window.setTimeout(function(){r&&t.appendChild(e.createFragment('<div class="mce-throbber"></div>'))},i||0),n},n.hide=function(){var e=t.lastChild;return e&&-1!=e.className.indexOf("throbber")&&e.parentNode.removeChild(e),r=!1,n}}}),o([a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St,xt,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt,Pt,Ht,Bt,jt,Ft,It,qt,Rt,Ut,zt,Wt,Xt,Vt,$t,Jt,Kt,Qt,Gt])}(this),tinymce.PluginManager.add("advlist",function(e){function t(e,t){var n=[];return tinymce.each(t.split(/[ ,]/),function(e){n.push({text:e.replace(/\-/g," ").replace(/\b\w/g,function(e){return e.toUpperCase()}),data:"default"==e?"":e})}),n}function n(t,n){var r,i=e.dom,s=e.selection;r=i.getParent(s.getNode(),"ol,ul"),r&&r.nodeName==t&&n!==!1||e.execCommand("UL"==t?"InsertUnorderedList":"InsertOrderedList"),n=n===!1?o[t]:n,o[t]=n,r=i.getParent(s.getNode(),"ol,ul"),r&&(i.setStyle(r,"listStyleType",n),r.removeAttribute("data-mce-style")),e.focus()}function r(t){var n=e.dom.getStyle(e.dom.getParent(e.selection.getNode(),"ol,ul"),"listStyleType")||"";t.control.items().each(function(e){e.active(e.settings.data===n)})}var i,s,o={};i=t("OL",e.getParam("advlist_number_styles","default,lower-alpha,lower-greek,lower-roman,upper-alpha,upper-roman")),s=t("UL",e.getParam("advlist_bullet_styles","default,circle,disc,square")),e.addButton("numlist",{type:"splitbutton",tooltip:"Numbered list",menu:i,onshow:r,onselect:function(e){n("OL",e.control.settings.data)},onclick:function(){n("OL",!1)}}),e.addButton("bullist",{type:"splitbutton",tooltip:"Bullet list",menu:s,onshow:r,onselect:function(e){n("UL",e.control.settings.data)},onclick:function(){n("UL",!1)}})}),tinymce.PluginManager.add("anchor",function(e){function t(){e.windowManager.open({title:"Anchor",body:{type:"textbox",name:"name",size:40,label:"Name",value:e.selection.getNode().id},onsubmit:function(t){e.execCommand("mceInsertContent",!1,e.dom.createHTML("a",{id:t.data.name}))}})}e.addButton("anchor",{icon:"anchor",tooltip:"Anchor",onclick:t,stateSelector:"a:not([href])"}),e.addMenuItem("anchor",{icon:"anchor",text:"Anchor",context:"insert",onclick:t})}),tinymce.PluginManager.add("autolink",function(e){function t(e){i(e,-1,"(",!0)}function n(e){i(e,0,"",!0)}function r(e){i(e,-1,"",!1)}function i(e,t,n){var r,i,s,o,u,a,f,l,c;if(r=e.selection.getRng(!0).cloneRange(),r.startOffset<5){if(l=r.endContainer.previousSibling,!l){if(!r.endContainer.firstChild||!r.endContainer.firstChild.nextSibling)return;l=r.endContainer.firstChild.nextSibling}if(c=l.length,r.setStart(l,c),r.setEnd(l,c),r.endOffset<5)return;i=r.endOffset,o=l}else{if(o=r.endContainer,3!=o.nodeType&&o.firstChild){for(;3!=o.nodeType&&o.firstChild;)o=o.firstChild;3==o.nodeType&&(r.setStart(o,0),r.setEnd(o,o.nodeValue.length))}i=1==r.endOffset?2:r.endOffset-1-t}s=i;do r.setStart(o,i>=2?i-2:0),r.setEnd(o,i>=1?i-1:0),i-=1;while(" "!=r.toString()&&""!==r.toString()&&160!=r.toString().charCodeAt(0)&&i-2>=0&&r.toString()!=n);if(r.toString()==n||160==r.toString().charCodeAt(0)?(r.setStart(o,i),r.setEnd(o,s),i+=1):0===r.startOffset?(r.setStart(o,0),r.setEnd(o,s)):(r.setStart(o,i),r.setEnd(o,s)),a=r.toString(),"."==a.charAt(a.length-1)&&r.setEnd(o,s-1),a=r.toString(),f=a.match(/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i),f&&("www."==f[1]?f[1]="http://www.":/@$/.test(f[1])&&!/^mailto:/.test(f[1])&&(f[1]="mailto:"+f[1]),u=e.selection.getBookmark(),e.selection.setRng(r),e.execCommand("createlink",!1,f[1]+f[2]),e.selection.moveToBookmark(u),e.nodeChanged(),tinymce.Env.webkit)){e.selection.collapse(!1);var h=Math.min(o.length,s+1);r.setStart(o,h),r.setEnd(o,h),e.selection.setRng(r)}}e.on("keydown",function(t){return 13==t.keyCode?r(e):void 0}),tinymce.Env.ie||(e.on("keypress",function(n){return 41==n.which?t(e):void 0}),e.on("keyup",function(t){return 32==t.keyCode?n(e):void 0}))}),tinymce.PluginManager.add("autoresize",function(e){function t(s){var o,u,a=e.getDoc(),f=a.body,l=a.documentElement,c=tinymce.DOM,h=n.autoresize_min_height;"setcontent"==s.type&&s.initial||e.plugins.fullscreen&&e.plugins.fullscreen.isFullscreen()||(u=tinymce.Env.ie?f.scrollHeight:tinymce.Env.webkit&&0===f.clientHeight?0:f.offsetHeight,u>n.autoresize_min_height&&(h=u),n.autoresize_max_height&&u>n.autoresize_max_height?(h=n.autoresize_max_height,f.style.overflowY="auto",l.style.overflowY="auto"):(f.style.overflowY="hidden",l.style.overflowY="hidden",f.scrollTop=0),h!==r&&(o=h-r,c.setStyle(c.get(e.id+"_ifr"),"height",h+"px"),r=h,tinymce.isWebKit&&0>o&&t(s)))}var n=e.settings,r=0;e.settings.inline||(n.autoresize_min_height=parseInt(e.getParam("autoresize_min_height",e.getElement().offsetHeight),10),n.autoresize_max_height=parseInt(e.getParam("autoresize_max_height",0),10),e.on("init",function(){e.dom.setStyle(e.getBody(),"paddingBottom",e.getParam("autoresize_bottom_margin",50)+"px")}),e.on("change setcontent paste keyup",t),e.getParam("autoresize_on_init",!0)&&e.on("load",t),e.addCommand("mceAutoResize",t))}),tinymce.PluginManager.add("autosave",function(e){function t(e,t){var n={s:1e3,m:6e4};return e=/^(\d+)([ms]?)$/.exec(""+(e||t)),(e[2]?n[e[2]]:1)*parseInt(e,10)}function n(){var e=parseInt(h.getItem(p+"autosave.time"),10)||0;return(new Date).getTime()-e>c.autosave_retention?(r(),!1):!0}function r(){h.removeItem(p+"autosave.draft"),h.removeItem(p+"autosave.time")}function i(){l&&e.isDirty()&&(h.setItem(p+"autosave.draft",e.getContent({format:"raw",no_events:!0})),h.setItem(p+"autosave.time",(new Date).getTime()),e.fire("StoreDraft"))}function s(){n()&&(e.setContent(h.getItem(p+"autosave.draft"),{format:"raw"}),r(),e.fire("RestoreDraft"))}function o(){l||(setInterval(function(){e.removed||i()},c.autosave_interval),l=!0)}function u(){var t=this;t.disabled(!n()),e.on("StoreDraft RestoreDraft",function(){t.disabled(!n())}),o()}function a(){e.undoManager.beforeChange(),s(),e.undoManager.add()}function f(){var e;return tinymce.each(tinymce.editors,function(t){t.plugins.autosave&&t.plugins.autosave.storeDraft(),!e&&t.isDirty()&&t.getParam("autosave_ask_before_unload",!0)&&(e=t.translate("You have unsaved changes are you sure you want to navigate away?"))}),e}var l,c=e.settings,h=tinymce.util.LocalStorage,p=e.id;c.autosave_interval=t(c.autosave_interval,"30s"),c.autosave_retention=t(c.autosave_retention,"20m"),e.addButton("restoredraft",{title:"Restore last draft",onclick:a,onPostRender:u}),e.addMenuItem("restoredraft",{text:"Restore last draft",onclick:a,onPostRender:u,context:"file"}),this.storeDraft=i,window.onbeforeunload=f}),!function(){tinymce.create("tinymce.plugins.BBCodePlugin",{init:function(e){var t=this,n=e.getParam("bbcode_dialect","punbb").toLowerCase();e.on("beforeSetContent",function(e){e.content=t["_"+n+"_bbcode2html"](e.content)}),e.on("postProcess",function(e){e.set&&(e.content=t["_"+n+"_bbcode2html"](e.content)),e.get&&(e.content=t["_"+n+"_html2bbcode"](e.content))})},getInfo:function(){return{longname:"BBCode Plugin",author:"Moxiecode Systems AB",authorurl:"http://www.tinymce.com",infourl:"http://www.tinymce.com/wiki.php/Plugin:bbcode"}},_punbb_html2bbcode:function(e){function t(t,n){e=e.replace(t,n)}return e=tinymce.trim(e),t(/<a.*?href=\"(.*?)\".*?>(.*?)<\/a>/gi,"[url=$1]$2[/url]"),t(/<font.*?color=\"(.*?)\".*?class=\"codeStyle\".*?>(.*?)<\/font>/gi,"[code][color=$1]$2[/color][/code]"),t(/<font.*?color=\"(.*?)\".*?class=\"quoteStyle\".*?>(.*?)<\/font>/gi,"[quote][color=$1]$2[/color][/quote]"),t(/<font.*?class=\"codeStyle\".*?color=\"(.*?)\".*?>(.*?)<\/font>/gi,"[code][color=$1]$2[/color][/code]"),t(/<font.*?class=\"quoteStyle\".*?color=\"(.*?)\".*?>(.*?)<\/font>/gi,"[quote][color=$1]$2[/color][/quote]"),t(/<span style=\"color: ?(.*?);\">(.*?)<\/span>/gi,"[color=$1]$2[/color]"),t(/<font.*?color=\"(.*?)\".*?>(.*?)<\/font>/gi,"[color=$1]$2[/color]"),t(/<span style=\"font-size:(.*?);\">(.*?)<\/span>/gi,"[size=$1]$2[/size]"),t(/<font>(.*?)<\/font>/gi,"$1"),t(/<img.*?src=\"(.*?)\".*?\/>/gi,"[img]$1[/img]"),t(/<span class=\"codeStyle\">(.*?)<\/span>/gi,"[code]$1[/code]"),t(/<span class=\"quoteStyle\">(.*?)<\/span>/gi,"[quote]$1[/quote]"),t(/<strong class=\"codeStyle\">(.*?)<\/strong>/gi,"[code][b]$1[/b][/code]"),t(/<strong class=\"quoteStyle\">(.*?)<\/strong>/gi,"[quote][b]$1[/b][/quote]"),t(/<em class=\"codeStyle\">(.*?)<\/em>/gi,"[code][i]$1[/i][/code]"),t(/<em class=\"quoteStyle\">(.*?)<\/em>/gi,"[quote][i]$1[/i][/quote]"),t(/<u class=\"codeStyle\">(.*?)<\/u>/gi,"[code][u]$1[/u][/code]"),t(/<u class=\"quoteStyle\">(.*?)<\/u>/gi,"[quote][u]$1[/u][/quote]"),t(/<\/(strong|b)>/gi,"[/b]"),t(/<(strong|b)>/gi,"[b]"),t(/<\/(em|i)>/gi,"[/i]"),t(/<(em|i)>/gi,"[i]"),t(/<\/u>/gi,"[/u]"),t(/<span style=\"text-decoration: ?underline;\">(.*?)<\/span>/gi,"[u]$1[/u]"),t(/<u>/gi,"[u]"),t(/<blockquote[^>]*>/gi,"[quote]"),t(/<\/blockquote>/gi,"[/quote]"),t(/<br \/>/gi,"\n"),t(/<br\/>/gi,"\n"),t(/<br>/gi,"\n"),t(/<p>/gi,""),t(/<\/p>/gi,"\n"),t(/&nbsp;|\u00a0/gi," "),t(/&quot;/gi,'"'),t(/&lt;/gi,"<"),t(/&gt;/gi,">"),t(/&amp;/gi,"&"),e},_punbb_bbcode2html:function(e){function t(t,n){e=e.replace(t,n)}return e=tinymce.trim(e),t(/\n/gi,"<br />"),t(/\[b\]/gi,"<strong>"),t(/\[\/b\]/gi,"</strong>"),t(/\[i\]/gi,"<em>"),t(/\[\/i\]/gi,"</em>"),t(/\[u\]/gi,"<u>"),t(/\[\/u\]/gi,"</u>"),t(/\[url=([^\]]+)\](.*?)\[\/url\]/gi,'<a href="$1">$2</a>'),t(/\[url\](.*?)\[\/url\]/gi,'<a href="$1">$1</a>'),t(/\[img\](.*?)\[\/img\]/gi,'<img src="$1" />'),t(/\[color=(.*?)\](.*?)\[\/color\]/gi,'<font color="$1">$2</font>'),t(/\[code\](.*?)\[\/code\]/gi,'<span class="codeStyle">$1</span>&nbsp;'),t(/\[quote.*?\](.*?)\[\/quote\]/gi,'<span class="quoteStyle">$1</span>&nbsp;'),e}}),tinymce.PluginManager.add("bbcode",tinymce.plugins.BBCodePlugin)}(),tinymce.PluginManager.add("charmap",function(e){function t(){function t(e){for(;e;){if("TD"==e.nodeName)return e;e=e.parentNode}}var r,i,s,o;r='<table role="presentation" cellspacing="0" class="mce-charmap"><tbody>';var u=25;for(s=0;10>s;s++){for(r+="<tr>",i=0;u>i;i++){var a=n[s*u+i],f="g"+(s*u+i);r+='<td title="'+a[1]+'"><div id="'+f+'" tabIndex="-1">'+(a?String.fromCharCode(parseInt(a[0],10)):"&nbsp;")+"</div></td>"}r+="</tr>"}r+="</tbody></table>";var l={type:"container",html:r,onclick:function(t){var n=t.target;"DIV"==n.nodeName&&e.execCommand("mceInsertContent",!1,n.firstChild.nodeValue)},onmouseover:function(e){var n=t(e.target);n&&o.find("#preview").text(n.firstChild.firstChild.data)}};o=e.windowManager.open({title:"Special character",spacing:10,padding:10,items:[l,{type:"label",name:"preview",text:" ",style:"font-size: 40px; text-align: center",border:1,minWidth:100,minHeight:80}],buttons:[{text:"Close",onclick:function(){o.close()}}]})}var n=[["160","no-break space"],["38","ampersand"],["34","quotation mark"],["162","cent sign"],["8364","euro sign"],["163","pound sign"],["165","yen sign"],["169","copyright sign"],["174","registered sign"],["8482","trade mark sign"],["8240","per mille sign"],["181","micro sign"],["183","middle dot"],["8226","bullet"],["8230","three dot leader"],["8242","minutes / feet"],["8243","seconds / inches"],["167","section sign"],["182","paragraph sign"],["223","sharp s / ess-zed"],["8249","single left-pointing angle quotation mark"],["8250","single right-pointing angle quotation mark"],["171","left pointing guillemet"],["187","right pointing guillemet"],["8216","left single quotation mark"],["8217","right single quotation mark"],["8220","left double quotation mark"],["8221","right double quotation mark"],["8218","single low-9 quotation mark"],["8222","double low-9 quotation mark"],["60","less-than sign"],["62","greater-than sign"],["8804","less-than or equal to"],["8805","greater-than or equal to"],["8211","en dash"],["8212","em dash"],["175","macron"],["8254","overline"],["164","currency sign"],["166","broken bar"],["168","diaeresis"],["161","inverted exclamation mark"],["191","turned question mark"],["710","circumflex accent"],["732","small tilde"],["176","degree sign"],["8722","minus sign"],["177","plus-minus sign"],["247","division sign"],["8260","fraction slash"],["215","multiplication sign"],["185","superscript one"],["178","superscript two"],["179","superscript three"],["188","fraction one quarter"],["189","fraction one half"],["190","fraction three quarters"],["402","function / florin"],["8747","integral"],["8721","n-ary sumation"],["8734","infinity"],["8730","square root"],["8764","similar to"],["8773","approximately equal to"],["8776","almost equal to"],["8800","not equal to"],["8801","identical to"],["8712","element of"],["8713","not an element of"],["8715","contains as member"],["8719","n-ary product"],["8743","logical and"],["8744","logical or"],["172","not sign"],["8745","intersection"],["8746","union"],["8706","partial differential"],["8704","for all"],["8707","there exists"],["8709","diameter"],["8711","backward difference"],["8727","asterisk operator"],["8733","proportional to"],["8736","angle"],["180","acute accent"],["184","cedilla"],["170","feminine ordinal indicator"],["186","masculine ordinal indicator"],["8224","dagger"],["8225","double dagger"],["192","A - grave"],["193","A - acute"],["194","A - circumflex"],["195","A - tilde"],["196","A - diaeresis"],["197","A - ring above"],["198","ligature AE"],["199","C - cedilla"],["200","E - grave"],["201","E - acute"],["202","E - circumflex"],["203","E - diaeresis"],["204","I - grave"],["205","I - acute"],["206","I - circumflex"],["207","I - diaeresis"],["208","ETH"],["209","N - tilde"],["210","O - grave"],["211","O - acute"],["212","O - circumflex"],["213","O - tilde"],["214","O - diaeresis"],["216","O - slash"],["338","ligature OE"],["352","S - caron"],["217","U - grave"],["218","U - acute"],["219","U - circumflex"],["220","U - diaeresis"],["221","Y - acute"],["376","Y - diaeresis"],["222","THORN"],["224","a - grave"],["225","a - acute"],["226","a - circumflex"],["227","a - tilde"],["228","a - diaeresis"],["229","a - ring above"],["230","ligature ae"],["231","c - cedilla"],["232","e - grave"],["233","e - acute"],["234","e - circumflex"],["235","e - diaeresis"],["236","i - grave"],["237","i - acute"],["238","i - circumflex"],["239","i - diaeresis"],["240","eth"],["241","n - tilde"],["242","o - grave"],["243","o - acute"],["244","o - circumflex"],["245","o - tilde"],["246","o - diaeresis"],["248","o slash"],["339","ligature oe"],["353","s - caron"],["249","u - grave"],["250","u - acute"],["251","u - circumflex"],["252","u - diaeresis"],["253","y - acute"],["254","thorn"],["255","y - diaeresis"],["913","Alpha"],["914","Beta"],["915","Gamma"],["916","Delta"],["917","Epsilon"],["918","Zeta"],["919","Eta"],["920","Theta"],["921","Iota"],["922","Kappa"],["923","Lambda"],["924","Mu"],["925","Nu"],["926","Xi"],["927","Omicron"],["928","Pi"],["929","Rho"],["931","Sigma"],["932","Tau"],["933","Upsilon"],["934","Phi"],["935","Chi"],["936","Psi"],["937","Omega"],["945","alpha"],["946","beta"],["947","gamma"],["948","delta"],["949","epsilon"],["950","zeta"],["951","eta"],["952","theta"],["953","iota"],["954","kappa"],["955","lambda"],["956","mu"],["957","nu"],["958","xi"],["959","omicron"],["960","pi"],["961","rho"],["962","final sigma"],["963","sigma"],["964","tau"],["965","upsilon"],["966","phi"],["967","chi"],["968","psi"],["969","omega"],["8501","alef symbol"],["982","pi symbol"],["8476","real part symbol"],["978","upsilon - hook symbol"],["8472","Weierstrass p"],["8465","imaginary part"],["8592","leftwards arrow"],["8593","upwards arrow"],["8594","rightwards arrow"],["8595","downwards arrow"],["8596","left right arrow"],["8629","carriage return"],["8656","leftwards double arrow"],["8657","upwards double arrow"],["8658","rightwards double arrow"],["8659","downwards double arrow"],["8660","left right double arrow"],["8756","therefore"],["8834","subset of"],["8835","superset of"],["8836","not a subset of"],["8838","subset of or equal to"],["8839","superset of or equal to"],["8853","circled plus"],["8855","circled times"],["8869","perpendicular"],["8901","dot operator"],["8968","left ceiling"],["8969","right ceiling"],["8970","left floor"],["8971","right floor"],["9001","left-pointing angle bracket"],["9002","right-pointing angle bracket"],["9674","lozenge"],["9824","black spade suit"],["9827","black club suit"],["9829","black heart suit"],["9830","black diamond suit"],["8194","en space"],["8195","em space"],["8201","thin space"],["8204","zero width non-joiner"],["8205","zero width joiner"],["8206","left-to-right mark"],["8207","right-to-left mark"],["173","soft hyphen"]];e.addButton("charmap",{icon:"charmap",tooltip:"Special character",onclick:t}),e.addMenuItem("charmap",{icon:"charmap",text:"Special character",onclick:t,context:"insert"})}),tinymce.PluginManager.add("code",function(e){function t(){e.windowManager.open({title:"Source code",body:{type:"textbox",name:"code",multiline:!0,minWidth:600,minHeight:500,value:e.getContent({source_view:!0}),spellcheck:!1},onSubmit:function(t){e.setContent(t.data.code)}})}e.addButton("code",{icon:"code",tooltip:"Source code",onclick:t}),e.addMenuItem("code",{icon:"code",text:"Source code",context:"tools",onclick:t})}),tinymce.PluginManager.add("contextmenu",function(e){var t;e.on("contextmenu",function(n){var r;if(n.preventDefault(),r=e.settings.contextmenu||"link image inserttable | cell row column deletetable",t)t.show();else{var i=[];tinymce.each(r.split(/[ ,]/),function(t){var n=e.menuItems[t];"|"==t&&(n={text:t}),n&&(n.shortcut="",i.push(n))});for(var s=0;s<i.length;s++)"|"==i[s].text&&(0===s||s==i.length-1)&&i.splice(s,1);t=new tinymce.ui.Menu({items:i,context:"contextmenu"}),t.renderTo(document.body)}var o={x:n.pageX,y:n.pageY};e.inline||(o=tinymce.DOM.getPos(e.getContentAreaContainer()),o.x+=n.clientX,o.y+=n.clientY),t.moveTo(o.x,o.y),e.on("remove",function(){t.remove(),t=null})})}),tinymce.PluginManager.add("directionality",function(e){function t(t){var n,r=e.dom,i=e.selection.getSelectedBlocks();i.length&&(n=r.getAttrib(i[0],"dir"),tinymce.each(i,function(e){r.getParent(e.parentNode,"*[dir='"+t+"']",r.getRoot())||(n!=t?r.setAttrib(e,"dir",t):r.setAttrib(e,"dir",null))}),e.nodeChanged())}function n(e){var t=[];return tinymce.each("h1 h2 h3 h4 h5 h6 div p".split(" "),function(n){t.push(n+"[dir="+e+"]")}),t.join(",")}e.addCommand("mceDirectionLTR",function(){t("ltr")}),e.addCommand("mceDirectionRTL",function(){t("rtl")}),e.addButton("ltr",{title:"Left to right",cmd:"mceDirectionLTR",stateSelector:n("ltr")}),e.addButton("rtl",{title:"Right to left",cmd:"mceDirectionRTL",stateSelector:n("rtl")})}),tinymce.PluginManager.add("emoticons",function(e,t){function n(){var e;return e='<table role="presentation" class="mce-grid">',tinymce.each(r,function(n){e+="<tr>",tinymce.each(n,function(n){var r=t+"/img/smiley-"+n+".gif";e+='<td><a href="#" data-mce-url="'+r+'" tabindex="-1"><img src="'+r+'" style="width: 18px; height: 18px"></a></td>'}),e+="</tr>"}),e+="</table>"}var r=[["cool","cry","embarassed","foot-in-mouth"],["frown","innocent","kiss","laughing"],["money-mouth","sealed","smile","surprised"],["tongue-out","undecided","wink","yell"]];e.addButton("emoticons",{type:"panelbutton",popoverAlign:"bc-tl",panel:{autohide:!0,html:n,onclick:function(t){var n=e.dom.getParent(t.target,"a");n&&(e.insertContent('<img src="'+n.getAttribute("data-mce-url")+'" />'),this.hide())}},tooltip:"Emoticons"})}),tinymce.PluginManager.add("fullpage",function(e){function t(){var t=n();e.windowManager.open({title:"Document properties",data:t,defaults:{type:"textbox",size:40},body:[{name:"title",label:"Title"},{name:"keywords",label:"Keywords"},{name:"description",label:"Description"},{name:"robots",label:"Robots"},{name:"author",label:"Author"},{name:"docencoding",label:"Encoding"}],onSubmit:function(e){r(tinymce.extend(t,e.data))}})}function n(){function t(e,t){var n=e.attr(t);return n||""}var n,r,s=i(),o={};return o.fontface=e.getParam("fullpage_default_fontface",""),o.fontsize=e.getParam("fullpage_default_fontsize",""),n=s.firstChild,7==n.type&&(o.xml_pi=!0,r=/encoding="([^"]+)"/.exec(n.value),r&&(o.docencoding=r[1])),n=s.getAll("#doctype")[0],n&&(o.doctype="<!DOCTYPE"+n.value+">"),n=s.getAll("title")[0],n&&n.firstChild&&(o.title=n.firstChild.value),l(s.getAll("meta"),function(e){var t,n=e.attr("name"),r=e.attr("http-equiv");n?o[n.toLowerCase()]=e.attr("content"):"Content-Type"==r&&(t=/charset\s*=\s*(.*)\s*/gi.exec(e.attr("content")),t&&(o.docencoding=t[1]))}),n=s.getAll("html")[0],n&&(o.langcode=t(n,"lang")||t(n,"xml:lang")),n=s.getAll("link")[0],n&&"stylesheet"==n.attr("rel")&&(o.stylesheet=n.attr("href")),n=s.getAll("body")[0],n&&(o.langdir=t(n,"dir"),o.style=t(n,"style"),o.visited_color=t(n,"vlink"),o.link_color=t(n,"link"),o.active_color=t(n,"alink")),o}function r(t){function n(e,t,n){e.attr(t,n?n:void 0)}function r(e){o.firstChild?o.insert(e,o.firstChild):o.append(e)}var s,o,u,f,h,p=e.dom;s=i(),o=s.getAll("head")[0],o||(f=s.getAll("html")[0],o=new c("head",1),f.firstChild?f.insert(o,f.firstChild,!0):f.append(o)),f=s.firstChild,t.xml_pi?(h='version="1.0"',t.docencoding&&(h+=' encoding="'+t.docencoding+'"'),7!=f.type&&(f=new c("xml",7),s.insert(f,s.firstChild,!0)),f.value=h):f&&7==f.type&&f.remove(),f=s.getAll("#doctype")[0],t.doctype?(f||(f=new c("#doctype",10),t.xml_pi?s.insert(f,s.firstChild):r(f)),f.value=t.doctype.substring(9,t.doctype.length-1)):f&&f.remove(),t.docencoding&&(f=null,l(s.getAll("meta"),function(e){"Content-Type"==e.attr("http-equiv")&&(f=e)}),f||(f=new c("meta",1),f.attr("http-equiv","Content-Type"),f.shortEnded=!0,r(f)),f.attr("content","text/html; charset="+t.docencoding)),f=s.getAll("title")[0],t.title?f||(f=new c("title",1),f.append(new c("#text",3)).value=t.title,r(f)):f&&f.remove(),l("keywords,description,author,copyright,robots".split(","),function(e){var n,i,o=s.getAll("meta"),u=t[e];for(n=0;n<o.length;n++)if(i=o[n],i.attr("name")==e)return u?i.attr("content",u):i.remove(),void 0;u&&(f=new c("meta",1),f.attr("name",e),f.attr("content",u),f.shortEnded=!0,r(f))}),f=s.getAll("link")[0],f&&"stylesheet"==f.attr("rel")?t.stylesheet?f.attr("href",t.stylesheet):f.remove():t.stylesheet&&(f=new c("link",1),f.attr({rel:"stylesheet",text:"text/css",href:t.stylesheet}),f.shortEnded=!0,r(f)),f=s.getAll("body")[0],f&&(n(f,"dir",t.langdir),n(f,"style",t.style),n(f,"vlink",t.visited_color),n(f,"link",t.link_color),n(f,"alink",t.active_color),p.setAttribs(e.getBody(),{style:t.style,dir:t.dir,vLink:t.visited_color,link:t.link_color,aLink:t.active_color})),f=s.getAll("html")[0],f&&(n(f,"lang",t.langcode),n(f,"xml:lang",t.langcode)),o.firstChild||o.remove(),u=(new tinymce.html.Serializer({validate:!1,indent:!0,apply_source_formatting:!0,indent_before:"head,html,body,meta,title,script,link,style",indent_after:"head,html,body,meta,title,script,link,style"})).serialize(s),a=u.substring(0,u.indexOf("</body>"))}function i(){return(new tinymce.html.DomParser({validate:!1,root_name:"#document"})).parse(a)}function s(t){function n(e){return e.replace(/<\/?[A-Z]+/g,function(e){return e.toLowerCase()})}var r,s,u,c,h=t.content,p="",v=e.dom;t.selection||"raw"==t.format&&a||t.source_view&&e.getParam("fullpage_hide_in_source_view")||(h=h.replace(/<(\/?)BODY/gi,"<$1body"),r=h.indexOf("<body"),-1!=r?(r=h.indexOf(">",r),a=n(h.substring(0,r+1)),s=h.indexOf("</body",r),-1==s&&(s=h.length),t.content=h.substring(r+1,s),f=n(h.substring(s))):(a=o(),f="\n</body>\n</html>"),u=i(),l(u.getAll("style"),function(e){e.firstChild&&(p+=e.firstChild.value)}),c=u.getAll("body")[0],c&&v.setAttribs(e.getBody(),{style:c.attr("style")||"",dir:c.attr("dir")||"",vLink:c.attr("vlink")||"",link:c.attr("link")||"",aLink:c.attr("alink")||""}),v.remove("fullpage_styles"),p&&(v.add(e.getDoc().getElementsByTagName("head")[0],"style",{id:"fullpage_styles"},p),c=v.get("fullpage_styles"),c.styleSheet&&(c.styleSheet.cssText=p)))}function o(){var t,n="",r="";return e.getParam("fullpage_default_xml_pi")&&(n+='<?xml version="1.0" encoding="'+e.getParam("fullpage_default_encoding","ISO-8859-1")+'" ?>\n'),n+=e.getParam("fullpage_default_doctype","<!DOCTYPE html>"),n+="\n<html>\n<head>\n",(t=e.getParam("fullpage_default_title"))&&(n+="<title>"+t+"</title>\n"),(t=e.getParam("fullpage_default_encoding"))&&(n+='<meta http-equiv="Content-Type" content="text/html; charset='+t+'" />\n'),(t=e.getParam("fullpage_default_font_family"))&&(r+="font-family: "+t+";"),(t=e.getParam("fullpage_default_font_size"))&&(r+="font-size: "+t+";"),(t=e.getParam("fullpage_default_text_color"))&&(r+="color: "+t+";"),n+="</head>\n<body"+(r?' style="'+r+'"':"")+">\n"}function u(t){t.selection||t.source_view&&e.getParam("fullpage_hide_in_source_view")||(t.content=tinymce.trim(a)+"\n"+tinymce.trim(t.content)+"\n"+tinymce.trim(f))}var a,f,l=tinymce.each,c=tinymce.html.Node;e.addCommand("mceFullPageProperties",t),e.addButton("fullpage",{title:"Document properties",cmd:"mceFullPageProperties"}),e.addMenuItem("fullpage",{text:"Document properties",cmd:"mceFullPageProperties",context:"file"}),e.on("BeforeSetContent",s),e.on("GetContent",u)}),tinymce.PluginManager.add("fullscreen",function(e){function t(){var e,t,n=window,r=document,i=r.body;return i.offsetWidth&&(e=i.offsetWidth,t=i.offsetHeight),n.innerWidth&&n.innerHeight&&(e=n.innerWidth,t=n.innerHeight),{w:e,h:t}}function n(){function n(){u.setStyle(c,"height",t().h-(f.clientHeight-c.clientHeight))}var f,c,h,p=document.body,d=document.documentElement;o=!o,f=e.getContainer().firstChild,c=e.getContentAreaContainer().firstChild,h=c.style,o?(r=h.width,i=h.height,h.width=h.height="100%",u.addClass(p,"mce-fullscreen"),u.addClass(d,"mce-fullscreen"),u.addClass(f,"mce-fullscreen"),u.bind(window,"resize",n),n(),s=n):(h.width=r,h.height=i,u.removeClass(p,"mce-fullscreen"),u.removeClass(d,"mce-fullscreen"),u.removeClass(f,"mce-fullscreen"),u.unbind(window,"resize",s)),e.fire("FullscreenStateChanged",{state:o})}var r,i,s,o=!1,u=tinymce.DOM;if(!e.settings.inline)return e.on("init",function(){e.addShortcut("Ctrl+Alt+F","",n)}),e.on("remove",function(){s&&u.unbind(window,"resize",s)}),e.addCommand("mceFullScreen",n),e.addMenuItem("fullscreen",{text:"Fullscreen",shortcut:"Ctrl+Alt+F",selectable:!0,onClick:n,onPostRender:function(){var t=this;e.on("FullscreenStateChanged",function(e){t.active(e.state)})},context:"view"}),e.addButton("fullscreen",{tooltip:"Fullscreen",shortcut:"Ctrl+Alt+F",onClick:n,onPostRender:function(){var t=this;e.on("FullscreenStateChanged",function(e){t.active(e.state)})}}),{isFullscreen:function(){return o}}}),tinymce.PluginManager.add("hr",function(e){e.addCommand("InsertHorizontalRule",function(){e.execCommand("mceInsertContent",!1,"<hr />")}),e.addButton("hr",{icon:"hr",tooltip:"Insert horizontal ruler",cmd:"InsertHorizontalRule"}),e.addMenuItem("hr",{icon:"hr",text:"Horizontal line",cmd:"InsertHorizontalRule",context:"insert"})}),tinymce.PluginManager.add("image",function(e){function t(e,t){function n(e,n){r.parentNode.removeChild(r),t({width:e,height:n})}var r=new Image;r.onload=function(){n(r.clientWidth,r.clientHeight)},r.onerror=function(){n()},r.src=e;var i=r.style;i.visibility="hidden",i.position="fixed",i.bottom=i.left=0,i.width=i.height="auto",document.body.appendChild(r)}function n(t){return function(){var n=e.settings.image_list;"string"==typeof n?tinymce.util.XHR.send({url:n,success:function(e){t(tinymce.util.JSON.parse(e))}}):t(n)}}function r(n){function r(){var e=[{text:"None",value:""}];return tinymce.each(n,function(t){e.push({text:t.text||t.title,value:t.value||t.url,menu:t.menu})}),e}function i(e){var t,n,r,i;t=f.find("#width")[0],n=f.find("#height")[0],r=t.value(),i=n.value(),f.find("#constrain")[0].checked()&&c&&h&&r&&i&&(e.control==t?(i=Math.round(r/c*i),n.value(i)):(r=Math.round(i/h*r),t.value(r))),c=r,h=i}function s(){function t(t){function r(){t.onload=t.onerror=null,e.selection.select(t),e.nodeChanged()}t.onload=function(){n.width||n.height||d.setAttribs(t,{width:t.clientWidth,height:t.clientHeight}),r()},t.onerror=r}var n=f.toJSON();""===n.width&&(n.width=null),""===n.height&&(n.height=null),""===n.style&&(n.style=null),n={src:n.src,alt:n.alt,width:n.width,height:n.height,style:n.style},v?d.setAttribs(v,n):(n.id="__mcenew",e.insertContent(d.createHTML("img",n)),v=d.get("__mcenew"),d.setAttrib(v,"id",null)),t(v)}function o(e){return e&&(e=e.replace(/px$/,"")),e}function u(){t(this.value(),function(e){e.width&&e.height&&(c=e.width,h=e.height,f.find("#width").value(c),f.find("#height").value(h))})}function a(){function e(e){return e.length>0&&/^[0-9]+$/.test(e)&&(e+="px"),e}var t=f.toJSON(),n=d.parseStyle(t.style);delete n.margin,n["margin-top"]=n["margin-bottom"]=e(t.vspace),n["margin-left"]=n["margin-right"]=e(t.hspace),n["border-width"]=e(t.border),f.find("#style").value(d.serializeStyle(d.parseStyle(d.serializeStyle(n))))}var f,l,c,h,p,d=e.dom,v=e.selection.getNode();c=d.getAttrib(v,"width"),h=d.getAttrib(v,"height"),"IMG"!=v.nodeName||v.getAttribute("data-mce-object")?v=null:l={src:d.getAttrib(v,"src"),alt:d.getAttrib(v,"alt"),width:c,height:h},n&&(p={name:"target",type:"listbox",label:"Image list",values:r(),onselect:function(e){var t=f.find("#alt");(!t.value()||e.lastControl&&t.value()==e.lastControl.text())&&t.value(e.control.text()),f.find("#src").value(e.control.value())}});var m=[{name:"src",type:"filepicker",filetype:"image",label:"Source",autofocus:!0,onchange:u},p,{name:"alt",type:"textbox",label:"Image description"},{type:"container",label:"Dimensions",layout:"flex",direction:"row",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:3,size:3,onchange:i},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:3,size:3,onchange:i},{name:"constrain",type:"checkbox",checked:!0,text:"Constrain proportions"}]}];e.settings.image_advtab?(v&&(l.hspace=o(v.style.marginLeft||v.style.marginRight),l.vspace=o(v.style.marginTop||v.style.marginBottom),l.border=o(v.style.borderWidth),l.style=e.dom.serializeStyle(e.dom.parseStyle(e.dom.getAttrib(v,"style")))),f=e.windowManager.open({title:"Insert/edit image",data:l,bodyType:"tabpanel",body:[{title:"General",type:"form",items:m},{title:"Advanced",type:"form",pack:"start",items:[{label:"Style",name:"style",type:"textbox"},{type:"form",layout:"grid",packV:"start",columns:2,padding:0,alignH:["left","right"],defaults:{type:"textbox",maxWidth:50,onchange:a},items:[{label:"Vertical space",name:"vspace"},{label:"Horizontal space",name:"hspace"},{label:"Border",name:"border"}]}]}],onSubmit:s})):f=e.windowManager.open({title:"Edit image",data:l,body:m,onSubmit:s})}e.addButton("image",{icon:"image",tooltip:"Insert/edit image",onclick:n(r),stateSelector:"img:not([data-mce-object])"}),e.addMenuItem("image",{icon:"image",text:"Insert image",onclick:n(r),context:"insert",prependToContext:!0})}),tinymce.PluginManager.add("insertdatetime",function(e){function t(t,n){function r(e,t){if(e=""+e,e.length<t)for(var n=0;n<t-e.length;n++)e="0"+e;return e}return n=n||new Date,t=t.replace("%D","%m/%d/%Y"),t=t.replace("%r","%I:%M:%S %p"),t=t.replace("%Y",""+n.getFullYear()),t=t.replace("%y",""+n.getYear()),t=t.replace("%m",r(n.getMonth()+1,2)),t=t.replace("%d",r(n.getDate(),2)),t=t.replace("%H",""+r(n.getHours(),2)),t=t.replace("%M",""+r(n.getMinutes(),2)),t=t.replace("%S",""+r(n.getSeconds(),2)),t=t.replace("%I",""+((n.getHours()+11)%12+1)),t=t.replace("%p",""+(n.getHours()<12?"AM":"PM")),t=t.replace("%B",""+e.translate(u[n.getMonth()])),t=t.replace("%b",""+e.translate(o[n.getMonth()])),t=t.replace("%A",""+e.translate(s[n.getDay()])),t=t.replace("%a",""+e.translate(i[n.getDay()])),t=t.replace("%%","%")}function n(n){var r=t(n);if(e.settings.insertdatetime_element){var i;i=/%[HMSIp]/.test(n)?t("%Y-%m-%dT%H:%M"):t("%Y-%m-%d"),r='<time datetime="'+i+'">'+r+"</time>";var s=e.dom.getParent(e.selection.getStart(),"time");if(s)return e.dom.setOuterHTML(s,r),void 0}e.insertContent(r)}var r,i="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),s="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),o="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),u="January February March April May June July August September October November December".split(" "),a=[];e.addCommand("mceInsertDate",function(){n(e.getParam("insertdate_dateformat",e.translate("%Y-%m-%d")))}),e.addCommand("mceInsertTime",function(){n(e.getParam("insertdate_timeformat",e.translate("%H:%M:%S")))}),e.addButton("inserttime",{type:"splitbutton",title:"Insert time",onclick:function(){n(r||"%H:%M:%S")},menu:a}),tinymce.each(e.settings.insertdate_formats||["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"],function(e){a.push({text:t(e),onclick:function(){r=e,n(e)}})}),e.addMenuItem("insertdatetime",{icon:"date",text:"Insert date/time",menu:a,context:"insert"})}),!function(e){e.on("AddEditor",function(e){e.editor.settings.inline_styles=!1}),e.PluginManager.add("legacyoutput",function(t){t.on("init",function(){var n="p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img",r=e.explode(t.settings.font_size_style_values),i=t.schema;t.formatter.register({alignleft:{selector:n,attributes:{align:"left"}},aligncenter:{selector:n,attributes:{align:"center"}},alignright:{selector:n,attributes:{align:"right"}},alignjustify:{selector:n,attributes:{align:"justify"}},bold:[{inline:"b",remove:"all"},{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}}],italic:[{inline:"i",remove:"all"},{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}}],underline:[{inline:"u",remove:"all"},{inline:"span",styles:{textDecoration:"underline"},exact:!0}],strikethrough:[{inline:"strike",remove:"all"},{inline:"span",styles:{textDecoration:"line-through"},exact:!0}],fontname:{inline:"font",attributes:{face:"%value"}},fontsize:{inline:"font",attributes:{size:function(t){return e.inArray(r,t.value)+1}}},forecolor:{inline:"font",attributes:{color:"%value"}},hilitecolor:{inline:"font",styles:{backgroundColor:"%value"}}}),e.each("b,i,u,strike".split(","),function(e){i.addValidElements(e+"[*]")}),i.getElementRule("font")||i.addValidElements("font[face|size|color|style]"),e.each(n.split(","),function(e){var t=i.getElementRule(e);t&&(t.attributes.align||(t.attributes.align={},t.attributesOrder.push("align")))})})})}(tinymce),tinymce.PluginManager.add("link",function(e){function t(t){return function(){var n=e.settings.link_list;"string"==typeof n?tinymce.util.XHR.send({url:n,success:function(e){t(tinymce.util.JSON.parse(e))}}):t(n)}}function n(t){function n(){var e=[{text:"None",value:""}];return tinymce.each(t,function(t){e.push({text:t.text||t.title,value:t.value||t.url,menu:t.menu})}),e}function r(t){var n=[{text:"None",value:""}];return tinymce.each(e.settings.rel_list,function(e){n.push({text:e.text||e.title,value:e.value,selected:t===e.value})}),n}function i(t){var n=[{text:"None",value:""}];return e.settings.target_list||n.push({text:"New window",value:"_blank"}),tinymce.each(e.settings.target_list,function(e){n.push({text:e.text||e.title,value:e.value,selected:t===e.value})}),n}function s(){a||0!==p.text.length||this.parent().parent().find("#text")[0].value(this.value())}var o,u,a,f,l,c,h,p={},d=e.selection,v=e.dom;e.focus(),o=d.getNode(),u=v.getParent(o,"a[href]"),u&&d.select(u),p.text=a=d.getContent({format:"text"}),p.href=u?v.getAttrib(u,"href"):"",p.target=u?v.getAttrib(u,"target"):"",p.rel=u?v.getAttrib(u,"rel"):"","IMG"==o.nodeName&&(p.text=a=" "),t&&(l={type:"listbox",label:"Link list",values:n(),onselect:function(e){var t=f.find("#text");(!t.value()||e.lastControl&&t.value()==e.lastControl.text())&&t.value(e.control.text()),f.find("#href").value(e.control.value())}}),e.settings.target_list!==!1&&(h={name:"target",type:"listbox",label:"Target",values:i(p.target)}),e.settings.rel_list&&(c={name:"rel",type:"listbox",label:"Rel",values:r(p.rel)}),f=e.windowManager.open({title:"Insert link",data:p,body:[{name:"href",type:"filepicker",filetype:"file",size:40,autofocus:!0,label:"Url",onchange:s,onkeyup:s},{name:"text",type:"textbox",size:40,label:"Text to display",onchange:function(){p.text=this.value()}},l,c,h],onSubmit:function(t){function n(t,n){window.setTimeout(function(){e.windowManager.confirm(t,n)},0)}function r(){i.text!=a?u?(e.focus(),u.innerHTML=i.text,v.setAttribs(u,{href:s,target:i.target?i.target:null,rel:i.rel?i.rel:null}),d.select(u)):e.insertContent(v.createHTML("a",{href:s,target:i.target?i.target:null,rel:i.rel?i.rel:null},i.text)):e.execCommand("mceInsertLink",!1,{href:s,target:i.target,rel:i.rel?i.rel:null})}var i=t.data,s=i.href;return s?s.indexOf("@")>0&&-1==s.indexOf("//")&&-1==s.indexOf("mailto:")?(n("The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",function(e){e&&(s="mailto:"+s),r()}),void 0):/^\s*www\./i.test(s)?(n("The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",function(e){e&&(s="http://"+s),r()}),void 0):(r(),void 0):(e.execCommand("unlink"),void 0)}})}e.addButton("link",{icon:"link",tooltip:"Insert/edit link",shortcut:"Ctrl+K",onclick:t(n),stateSelector:"a[href]"}),e.addButton("unlink",{icon:"unlink",tooltip:"Remove link",cmd:"unlink",stateSelector:"a[href]"}),e.addShortcut("Ctrl+K","",n),this.showDialog=n,e.addMenuItem("link",{icon:"link",text:"Insert link",shortcut:"Ctrl+K",onclick:t(n),stateSelector:"a[href]",context:"insert",prependToContext:!0})}),tinymce.PluginManager.add("lists",function(e){var t=this;e.on("init",function(){function n(e){function t(t){var r,i,s;i=e[t?"startContainer":"endContainer"],s=e[t?"startOffset":"endOffset"],1==i.nodeType&&(r=b.create("span",{"data-mce-type":"bookmark"}),i.hasChildNodes()?(s=Math.min(s,i.childNodes.length-1),i.insertBefore(r,i.childNodes[s])):i.appendChild(r),i=r,s=0),n[t?"startContainer":"endContainer"]=i,n[t?"startOffset":"endOffset"]=s}var n={};return t(!0),t(),n}function r(e){function t(t){function n(e){for(var t=e.parentNode.firstChild,n=0;t;){if(t==e)return n;(1!=t.nodeType||"bookmark"!=t.getAttribute("data-mce-type"))&&n++,t=t.nextSibling}return-1}var r,i,s;r=s=e[t?"startContainer":"endContainer"],i=e[t?"startOffset":"endOffset"],1==r.nodeType&&(t?(i=n(r),r=r.parentNode):(i=n(r),r=r.parentNode),b.remove(s)),e[t?"startContainer":"endContainer"]=r,e[t?"startOffset":"endOffset"]=i}t(!0),t();var n=b.createRng();n.setStart(e.startContainer,e.startOffset),n.setEnd(e.endContainer,e.endOffset),w.setRng(n)}function i(e){return e&&/^(OL|UL)$/.test(e.nodeName)}function s(e){return e.parentNode.firstChild==e}function o(e){return e.parentNode.lastChild==e}function u(t){return t&&!!e.schema.getTextBlockElements()[t.nodeName]}function a(t,n){var r,i;if(e.settings.forced_root_block&&(n=n||e.settings.forced_root_block),i=n?b.create(n):b.createFragment(),t)for(;r=t.firstChild;)i.appendChild(r);return e.settings.forced_root_block||i.appendChild(b.create("br")),i.hasChildNodes()||tinymce.isIE||(i.innerHTML='<br data-mce-bogus="1">'),i}function f(){return tinymce.grep(w.getSelectedBlocks(),function(e){return"LI"==e.nodeName})}function l(){return tinymce.grep(w.getSelectedBlocks(),u)}function c(e,t,n){var r,i;n=n||a(t),r=b.createRng(),r.setStartAfter(t),r.setEndAfter(e),i=r.extractContents(),b.isEmpty(i)||b.insertAfter(i,e),b.isEmpty(n)||b.insertAfter(n,e),b.isEmpty(t.parentNode)&&b.remove(t.parentNode),b.remove(t)}function h(e){var t,n;if(t=e.nextSibling,t&&i(t)&&t.nodeName==e.nodeName){for(;n=t.firstChild;)e.appendChild(n);b.remove(t)}if(t=e.previousSibling,t&&i(t)&&t.nodeName==e.nodeName){for(;n=t.firstChild;)e.insertBefore(n,e.firstChild);b.remove(t)}}function p(e){tinymce.each(tinymce.grep(b.select("ol,ul",e)),function(e){var t,n=e.parentNode;"LI"==n.nodeName&&n.firstChild==e&&(t=n.previousSibling,t&&"LI"==t.nodeName&&(t.appendChild(e),b.isEmpty(n)&&b.remove(n))),i(n)&&(t=n.previousSibling,t&&"LI"==t.nodeName&&t.appendChild(e))})}function d(){var e,t=n(w.getRng(!0));return tinymce.each(f(),function(t){var n,r;return n=t.previousSibling,n&&"UL"==n.nodeName?(n.appendChild(t),void 0):n&&"LI"==n.nodeName&&i(n.lastChild)?(n.lastChild.appendChild(t),void 0):(n=t.nextSibling,n&&"UL"==n.nodeName?(n.insertBefore(t,n.firstChild),void 0):(n&&"LI"==n.nodeName&&i(t.lastChild)||(n=t.previousSibling,n&&"LI"==n.nodeName&&(r=b.create(t.parentNode.nodeName),n.appendChild(r),r.appendChild(t)),e=!0),void 0))}),r(t),e}function v(){function e(e){b.isEmpty(e)&&b.remove(e)}var t,u=n(w.getRng(!0));return tinymce.each(f(),function(n){var r,u=n.parentNode,f=u.parentNode;if(s(n)&&o(n))if("LI"==f.nodeName)b.insertAfter(n,f),e(f);else{if(!i(f))return;b.remove(u,!0)}else if(s(n))if("LI"==f.nodeName)b.insertAfter(n,f),r=b.create("LI"),r.appendChild(u),b.insertAfter(r,n),e(f);else{if(!i(f))return;f.insertBefore(n,u)}else if(o(n))if("LI"==f.nodeName)b.insertAfter(n,f);else{if(!i(f))return;b.insertAfter(n,u)}else{if("LI"==f.nodeName)u=f,r=a(n,"LI");else{if(!i(f))return;r=a(n,"LI")}c(u,n,r),p(u.parentNode)}t=!0}),r(u),t}function m(t){function s(){function t(t){var n,r,i=e.getBody();for(n=o[t?"startContainer":"endContainer"],r=o[t?"startOffset":"endOffset"],1==n.nodeType&&(n=n.childNodes[Math.min(r,n.childNodes.length-1)]||n);n.parentNode!=i;){if(u(n))return n;if(/^(TD|TH)$/.test(n.parentNode.nodeName))return n;n=n.parentNode}return n}function n(e,t){var n,r=[];if(!u(e)){for(;e&&(n=e[t?"previousSibling":"nextSibling"],!b.isBlock(n)&&n);)e=n;for(;e;)r.push(e),e=e[t?"nextSibling":"previousSibling"]}return r}var r,i,s=t(!0),a=t();i=n(s,!0),s!=a&&(i=i.concat(n(a).reverse())),tinymce.each(i,function(e){if(!b.isBlock(e)||"BR"==e.nodeName){if(!r||"BR"==e.nodeName){if("BR"==e.nodeName&&(!e.nextSibling||b.isBlock(e.nextSibling)&&"BR"!=e.nextSibling.nodeName))return b.remove(e),!1;r=b.create("p"),f.push(r),e.parentNode.insertBefore(r,e)}return"BR"!=e.nodeName?r.appendChild(e):b.remove(e),e==a?!1:void 0}})}var o=w.getRng(!0),a=n(o),f=l();s(),tinymce.each(f,function(e){var n,r;r=e.previousSibling,r&&i(r)&&r.nodeName==t?(n=r,e=b.rename(e,"LI"),r.appendChild(e)):(n=b.create(t),e.parentNode.insertBefore(n,e),n.appendChild(e),e=b.rename(e,"LI")),h(n)}),r(a)}function g(){var e=n(w.getRng(!0));tinymce.each(f(),function(e){var t,n;for(t=e;t;t=t.parentNode)i(t)&&(n=t);c(n,e)}),r(e)}function y(e){var t=b.getParent(w.getStart(),"OL,UL");if(t)if(t.nodeName==e)g(e);else{var i=n(w.getRng(!0));h(b.rename(t,e)),r(i)}else m(e)}var b=e.dom,w=e.selection;t.backspaceDelete=function(e){function t(e,t){var n=e.startContainer,r=e.startOffset;if(3==n.nodeType&&(t?r<n.data.length:r>0))return n;for(var i=new tinymce.dom.TreeWalker(e.startContainer);n=i[t?"next":"prev"]();)if(3==n.nodeType&&n.data.length>0)return n}function s(e,t){var n,r,s=e.parentNode;for(i(t.lastChild)&&(r=t.lastChild),n=t.lastChild,n&&"BR"==n.nodeName&&e.hasChildNodes()&&b.remove(n);n=e.firstChild;)t.appendChild(n);r&&t.appendChild(r),b.remove(e),b.isEmpty(s)&&b.remove(s)}if(w.isCollapsed()){var o=b.getParent(w.getStart(),"LI");if(o){var u=w.getRng(!0),a=b.getParent(t(u,e),"LI");if(a&&a!=o){var f=n(u);return e?s(a,o):s(o,a),r(f),!0}if(!a&&!e&&g(o.parentNode.nodeName))return!0}}},e.addCommand("Indent",function(){return d()?void 0:!0}),e.addCommand("Outdent",function(){return v()?void 0:!0}),e.addCommand("InsertUnorderedList",function(){y("UL")}),e.addCommand("InsertOrderedList",function(){y("OL")})}),e.on("keydown",function(e){e.keyCode==tinymce.util.VK.BACKSPACE?t.backspaceDelete()&&e.preventDefault():e.keyCode==tinymce.util.VK.DELETE&&t.backspaceDelete(!0)&&e.preventDefault()})}),tinymce.PluginManager.add("media",function(e,t){function n(e){return-1!=e.indexOf(".mp3")?"audio/mpeg":-1!=e.indexOf(".wav")?"audio/wav":-1!=e.indexOf(".mp4")?"video/mp4":-1!=e.indexOf(".webm")?"video/webm":-1!=e.indexOf(".ogg")?"video/ogg":""}function r(){function t(e){var t,i,s,o;t=n.find("#width")[0],i=n.find("#height")[0],s=t.value(),o=i.value(),n.find("#constrain")[0].checked()&&r&&a&&s&&o&&(e.control==t?(o=Math.round(s/r*o),i.value(o)):(s=Math.round(o/a*s),t.value(s))),r=s,a=o}var n,r,a,f;f=u(e.selection.getNode()),r=f.width,a=f.height,n=e.windowManager.open({title:"Insert/edit video",data:f,bodyType:"tabpanel",body:[{title:"General",type:"form",onShowTab:function(){this.fromJSON(o(this.next().find("#embed").value()))},items:[{name:"source1",type:"filepicker",filetype:"media",size:40,autofocus:!0,label:"Source"},{name:"source2",type:"filepicker",filetype:"media",size:40,label:"Alternative source"},{name:"poster",type:"filepicker",filetype:"image",size:40,label:"Poster"},{type:"container",label:"Dimensions",layout:"flex",direction:"row",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:3,size:3,onchange:t},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:3,size:3,onchange:t},{name:"constrain",type:"checkbox",checked:!0,text:"Constrain proportions"}]}]},{title:"Embed",type:"panel",layout:"flex",direction:"column",align:"stretch",padding:10,spacing:10,onShowTab:function(){this.find("#embed").value(s(this.parent().toJSON()))},items:[{type:"label",text:"Paste your embed code below:"},{type:"textbox",flex:1,name:"embed",value:i(),multiline:!0,label:"Source"}]}],onSubmit:function(){e.insertContent(s(this.toJSON()))}})}function i(){var t=e.selection.getNode();return t.getAttribute("data-mce-object")?e.selection.getContent():void 0}function s(r){var i="";return r.source1||(tinymce.extend(r,o(r.embed)),r.source1)?(r.source1=e.convertURL(r.source1,"source"),r.source2=e.convertURL(r.source2,"source"),r.source1mime=n(r.source1),r.source2mime=n(r.source2),r.poster=e.convertURL(r.poster,"poster"),r.flashPlayerUrl=e.convertURL(t+"/moxieplayer.swf","movie"),r.embed?i=a(r.embed,r,!0):(tinymce.each(f,function(e){var t,n,i;if(t=e.regex.exec(r.source1)){for(i=e.url,n=0;t[n];n++)i=i.replace("$"+n,function(){return t[n]});r.source1=i,r.type=e.type,r.width=e.w,r.height=e.h}}),r.width=r.width||300,r.height=r.height||150,tinymce.each(r,function(t,n){r[n]=e.dom.encode(t)}),"iframe"==r.type?i+='<iframe src="'+r.source1+'" width="'+r.width+'" height="'+r.height+'"></iframe>':-1!=r.source1mime.indexOf("audio")?e.settings.audio_template_callback?i=e.settings.audio_template_callback(r):i+='<audio controls="controls" src="'+r.source1+'">'+(r.source2?'\n<source src="'+r.source2+'"'+(r.source2mime?' type="'+r.source2mime+'"':"")+" />\n":"")+"</audio>":i=e.settings.video_template_callback?e.settings.video_template_callback(r):'<video width="'+r.width+'" height="'+r.height+'"'+(r.poster?' poster="'+r.poster+'"':"")+' controls="controls">\n'+'<source src="'+r.source1+'"'+(r.source1mime?' type="'+r.source1mime+'"':"")+" />\n"+(r.source2?'<source src="'+r.source2+'"'+(r.source2mime?' type="'+r.source2mime+'"':"")+" />\n":"")+"</video>"),i):""}function o(e){var t={};return(new tinymce.html.SaxParser({validate:!1,special:"script,noscript",start:function(e,n){t.source1||"param"!=e||(t.source1=n.map.movie),("iframe"==e||"object"==e||"embed"==e||"video"==e||"audio"==e)&&(t=tinymce.extend(n.map,t)),"source"==e&&(t.source1?t.source2||(t.source2=n.map.src):t.source1=n.map.src)}})).parse(e),t.source1=t.source1||t.src||t.data,t.source2=t.source2||"",t.poster=t.poster||"",t}function u(t){return t.getAttribute("data-mce-object")?o(e.serializer.serialize(t,{selection:!0})):{}}function a(e,t,n){function r(e,t){var n,r,i,s;for(n in t)if(i=""+t[n],e.map[n])for(r=e.length;r--;)s=e[r],s.name==n&&(i?(e.map[n]=i,s.value=i):(delete e.map[n],e.splice(r,1)));else i&&(e.push({name:n,value:i}),e.map[n]=i)}var i=new tinymce.html.Writer,s=0;return(new tinymce.html.SaxParser({validate:!1,special:"script,noscript",comment:function(e){i.comment(e)},cdata:function(e){i.cdata(e)},text:function(e,t){i.text(e,t)},start:function(e,o,u){switch(e){case"video":case"object":case"img":case"iframe":r(o,{width:t.width,height:t.height})}if(n)switch(e){case"video":r(o,{poster:t.poster,src:""}),t.source2&&r(o,{src:""});break;case"iframe":r(o,{src:t.source1});break;case"source":if(s++,2>=s&&(r(o,{src:t["source"+s],type:t["source"+s+"mime"]}),!t["source"+s]))return}i.start(e,o,u)},end:function(e){if("video"==e&&n)for(var o=1;2>=o;o++)if(t["source"+o]){var u=[];u.map={},o>s&&(r(u,{src:t["source"+o],type:t["source"+o+"mime"]}),i.start("source",u,!0))}i.end(e)}},new tinymce.html.Schema({}))).parse(e),i.getContent()}var f=[{regex:/youtu\.be\/([a-z1-9.-_]+)/,type:"iframe",w:425,h:350,url:"http://www.youtube.com/embed/$1"},{regex:/youtube\.com(.+)v=([^&]+)/,type:"iframe",w:425,h:350,url:"http://www.youtube.com/embed/$2"},{regex:/vimeo\.com\/([0-9]+)/,type:"iframe",w:425,h:350,url:"http://player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc"},{regex:/maps\.google\.([a-z]{2,3})\/maps\/(.+)msid=(.+)/,type:"iframe",w:425,h:350,url:'http://maps.google.com/maps/ms?msid=$2&output=embed"'}];e.on("ResolveName",function(e){var t;1==e.target.nodeType&&(t=e.target.getAttribute("data-mce-object"))&&(e.name=t)}),e.on("preInit",function(){var t=e.schema.getSpecialElements();tinymce.each("video audio iframe object".split(" "),function(e){t[e]=new RegExp("</"+e+"[^>]*>","gi")}),e.schema.addValidElements("object[id|style|width|height|classid|codebase|*],embed[id|style|width|height|type|src|*],video[*],audio[*]");var n=e.schema.getBoolAttrs();tinymce.each("webkitallowfullscreen mozallowfullscreen allowfullscreen".split(" "),function(e){n[e]={}}),e.parser.addNodeFilter("iframe,video,audio,object,embed",function(t,n){for(var r,i,s,o,u,a,f,l=t.length;l--;){for(i=t[l],s=new tinymce.html.Node("img",1),s.shortEnded=!0,a=i.attributes,r=a.length;r--;)o=a[r].name,u=a[r].value,"width"!==o&&"height"!==o&&"style"!==o&&(("data"==o||"src"==o)&&(u=e.convertURL(u,o)),s.attr("data-mce-p-"+o,u));f=i.firstChild&&i.firstChild.value,f&&(s.attr("data-mce-html",escape(f)),s.firstChild=null),s.attr({width:i.attr("width")||"300",height:i.attr("height")||("audio"==n?"30":"150"),style:i.attr("style"),src:tinymce.Env.transparentSrc,"data-mce-object":n,"class":"mce-object mce-object-"+n}),i.replace(s)}}),e.serializer.addAttributeFilter("data-mce-object",function(e,t){for(var n,r,i,s,o,u,a=e.length;a--;){for(n=e[a],r=new tinymce.html.Node(n.attr(t),1),"audio"!=n.attr(t)&&r.attr({width:n.attr("width"),height:n.attr("height")}),r.attr({style:n.attr("style")}),s=n.attributes,i=s.length;i--;){var f=s[i].name;0===f.indexOf("data-mce-p-")&&r.attr(f.substr(11),s[i].value)}o=n.attr("data-mce-html"),o&&(u=new tinymce.html.Node("#text",3),u.raw=!0,u.value=unescape(o),r.append(u)),n.replace(r)}})}),e.on("ObjectSelected",function(e){"audio"==e.target.getAttribute("data-mce-object")&&e.preventDefault()}),e.on("objectResized",function(e){var t,n=e.target;n.getAttribute("data-mce-object")&&(t=n.getAttribute("data-mce-html"),t&&(t=unescape(t),n.setAttribute("data-mce-html",escape(a(t,{width:e.width,height:e.height})))))}),e.addButton("media",{tooltip:"Insert/edit video",onclick:r,stateSelector:"img[data-mce-object=video]"}),e.addMenuItem("media",{icon:"media",text:"Insert video",onclick:r,context:"insert",prependToContext:!0})}),tinymce.PluginManager.add("nonbreaking",function(e){var t=e.getParam("nonbreaking_force_tab");if(e.addCommand("mceNonBreaking",function(){e.insertContent(e.plugins.visualchars&&e.plugins.visualchars.state?'<span data-mce-bogus="1" class="mce-nbsp">&nbsp;</span>':"&nbsp;")}),e.addButton("nonbreaking",{title:"Insert nonbreaking space",cmd:"mceNonBreaking"}),e.addMenuItem("nonbreaking",{text:"Nonbreaking space",cmd:"mceNonBreaking",context:"insert"}),t){var n=+t>1?+t:3;e.on("keydown",function(t){if(9==t.keyCode){if(t.shiftKey)return;t.preventDefault();for(var r=0;n>r;r++)e.execCommand("mceNonBreaking")}})}}),tinymce.PluginManager.add("noneditable",function(e){function t(){function t(e){var t;if(1===e.nodeType){if(t=e.getAttribute(a),t&&"inherit"!==t)return t;if(t=e.contentEditable,"inherit"!==t)return t}return null}function n(e){for(var n;e;){if(n=t(e))return"false"===n?e:null;e=e.parentNode}}function r(e){for(;e;){if(e.id===v)return e;e=e.parentNode}}function i(e){var t;if(e)for(t=new o(e,e),e=t.current();e;e=t.next())if(3===e.nodeType)return e}function s(n,r){var i,s;return"false"===t(n)&&p.isBlock(n)?(d.select(n),void 0):(s=p.createRng(),"true"===t(n)&&(n.firstChild||n.appendChild(e.getDoc().createTextNode("")),n=n.firstChild,r=!0),i=p.create("span",{id:v,"data-mce-bogus":!0},m),r?n.parentNode.insertBefore(i,n):p.insertAfter(i,n),s.setStart(i.firstChild,1),s.collapse(!0),d.setRng(s),i)}function u(e){var t,n,s,o;if(e)t=d.getRng(!0),t.setStartBefore(e),t.setEndBefore(e),n=i(e),n&&n.nodeValue.charAt(0)==m&&(n=n.deleteData(0,1)),p.remove(e,!0),d.setRng(t);else for(s=r(d.getStart());(e=p.get(v))&&e!==o;)s!==e&&(n=i(e),n&&n.nodeValue.charAt(0)==m&&(n=n.deleteData(0,1)),p.remove(e,!0)),o=e}function l(){function e(e,n){var r,i,s,u,a;if(r=f.startContainer,i=f.startOffset,3==r.nodeType){if(a=r.nodeValue.length,i>0&&a>i||(n?i==a:0===i))return}else{if(!(i<r.childNodes.length))return n?null:e;var l=!n&&i>0?i-1:i;r=r.childNodes[l],r.hasChildNodes()&&(r=r.firstChild)}for(s=new o(r,e);u=s[n?"prev":"next"]();){if(3===u.nodeType&&u.nodeValue.length>0)return;if("true"===t(u))return u}return e}var r,i,a,f,l;u(),a=d.isCollapsed(),r=n(d.getStart()),i=n(d.getEnd()),(r||i)&&(f=d.getRng(!0),a?(r=r||i,(l=e(r,!0))?s(l,!0):(l=e(r,!1))?s(l,!1):d.select(r)):(f=d.getRng(!0),r&&f.setStartBefore(r),i&&f.setEndAfter(i),d.setRng(f)))}function h(i){function s(e,t){for(;e=e[t?"previousSibling":"nextSibling"];)if(3!==e.nodeType||e.nodeValue.length>0)return e}function a(e,t){d.select(e),d.collapse(t)}function h(i){function s(e){for(var t=a;t;){if(t===e)return;t=t.parentNode}p.remove(e),l()}function o(){var r,o,u=e.schema.getNonEmptyElements();for(o=new tinymce.dom.TreeWalker(a,e.getBody());(r=i?o.prev():o.next())&&!u[r.nodeName.toLowerCase()]&&!(3===r.nodeType&&tinymce.trim(r.nodeValue).length>0);)if("false"===t(r))return s(r),!0;return n(r)?!0:!1}var u,a,f,c;if(d.isCollapsed()){if(u=d.getRng(!0),a=u.startContainer,f=u.startOffset,a=r(a)||a,c=n(a))return s(c),!1;if(3==a.nodeType&&(i?f>0:f<a.nodeValue.length))return!0;if(1==a.nodeType&&(a=a.childNodes[f]||a),o())return!1}return!0}var v,m,g,y,b=i.keyCode;if(g=d.getStart(),y=d.getEnd(),v=n(g)||n(y),v&&(112>b||b>124)&&b!=f.DELETE&&b!=f.BACKSPACE){if((tinymce.isMac?i.metaKey:i.ctrlKey)&&(67==b||88==b||86==b))return;if(i.preventDefault(),b==f.LEFT||b==f.RIGHT){var w=b==f.LEFT;if(e.dom.isBlock(v)){var E=w?v.previousSibling:v.nextSibling,S=new o(E,E),x=w?S.prev():S.next();a(x,!w)}else a(v,w)}}else if(b==f.LEFT||b==f.RIGHT||b==f.BACKSPACE||b==f.DELETE){if(m=r(g)){if(b==f.LEFT||b==f.BACKSPACE)if(v=s(m,!0),v&&"false"===t(v)){if(i.preventDefault(),b!=f.LEFT)return p.remove(v),void 0;a(v,!0)}else u(m);if(b==f.RIGHT||b==f.DELETE)if(v=s(m),v&&"false"===t(v)){if(i.preventDefault(),b!=f.RIGHT)return p.remove(v),void 0;a(v,!1)}else u(m)}if((b==f.BACKSPACE||b==f.DELETE)&&!h(b==f.BACKSPACE))return i.preventDefault(),!1}}var p=e.dom,d=e.selection,v="mce_noneditablecaret",m="";e.on("mousedown",function(n){var r=e.selection.getNode();"false"===t(r)&&r==n.target&&l()}),e.on("mouseup keyup",l),e.on("keydown",h)}function n(t){var n=s.length,r=t.content,o=tinymce.trim(i);if("raw"!=t.format){for(;n--;)r=r.replace(s[n],function(t){var n=arguments,i=n[n.length-2];return i>0&&'"'==r.charAt(i-1)?t:'<span class="'+o+'" data-mce-content="'+e.dom.encode(n[0])+'">'+e.dom.encode("string"==typeof n[1]?n[1]:n[0])+"</span>"});t.content=r}}var r,i,s,o=tinymce.dom.TreeWalker,u="contenteditable",a="data-mce-"+u,f=tinymce.util.VK;r=" "+tinymce.trim(e.getParam("noneditable_editable_class","mceEditable"))+" ",i=" "+tinymce.trim(e.getParam("noneditable_noneditable_class","mceNonEditable"))+" ",s=e.getParam("noneditable_regexp"),s&&!s.length&&(s=[s]),e.on("PreInit",function(){t(),s&&e.on("BeforeSetContent",n),e.parser.addAttributeFilter("class",function(e){for(var t,n,s=e.length;s--;)n=e[s],t=" "+n.attr("class")+" ",-1!==t.indexOf(r)?n.attr(a,"true"):-1!==t.indexOf(i)&&n.attr(a,"false")}),e.serializer.addAttributeFilter(a,function(e){for(var t,n=e.length;n--;)t=e[n],s&&t.attr("data-mce-content")?(t.name="#text",t.type=3,t.raw=!0,t.value=t.attr("data-mce-content")):(t.attr(u,null),t.attr(a,null))}),e.parser.addAttributeFilter(u,function(e){for(var t,n=e.length;n--;)t=e[n],t.attr(a,t.attr(u)),t.attr(u,null)})})}),tinymce.PluginManager.add("pagebreak",function(e){var t,n="mce-pagebreak",r=e.getParam("pagebreak_separator","<!-- pagebreak -->"),i='<img src="'+tinymce.Env.transparentSrc+'" class="'+n+'" data-mce-resize="false" />';t=new RegExp(r.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi"),e.addCommand("mcePageBreak",function(){e.execCommand("mceInsertContent",0,i)}),e.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),e.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"}),e.on("ResolveName",function(t){"IMG"==t.target.nodeName&&e.dom.hasClass(t.target,n)&&(t.name="pagebreak")}),e.on("click",function(t){t=t.target,"IMG"===t.nodeName&&e.dom.hasClass(t,n)&&e.selection.select(t)}),e.on("BeforeSetContent",function(e){e.content=e.content.replace(t,i)}),e.on("PreInit",function(){e.serializer.addNodeFilter("img",function(e){for(var t,n,i=e.length;i--;)t=e[i],n=t.attr("class"),n&&-1!==n.indexOf("mce-pagebreak")&&(t.type=3,t.value=r,t.raw=!0)})})}),!function(e,t){function n(e,t){for(var n,r=[],i=0;i<e.length;++i){if(n=u[e[i]]||s(e[i]),!n)throw"module definition dependecy not found: "+e[i];r.push(n)}t.apply(null,r)}function r(e,r,i){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(r===t)throw"invalid module definition, dependencies must be specified";if(i===t)throw"invalid module definition, definition function must be specified";n(r,function(){u[e]=i.apply(null,arguments)})}function i(e){return!!u[e]}function s(t){for(var n=e,r=t.split(/[.\/]/),i=0;i<r.length;++i){if(!n[r[i]])return;n=n[r[i]]}return n}function o(n){for(var r=0;r<n.length;r++){for(var i=e,s=n[r],o=s.split(/[.\/]/),a=0;a<o.length-1;++a)i[o[a]]===t&&(i[o[a]]={}),i=i[o[a]];i[o[o.length-1]]=u[s]}}var u={},a="tinymce/pasteplugin/Clipboard",f="tinymce/Env",l="tinymce/util/Tools",c="tinymce/util/VK",h="tinymce/pasteplugin/WordFilter",p="tinymce/html/DomParser",d="tinymce/html/Schema",v="tinymce/html/Serializer",m="tinymce/html/Node",g="tinymce/pasteplugin/Quirks",y="tinymce/pasteplugin/Plugin",b="tinymce/PluginManager";r(a,[f,l,c],function(e,t,n){function r(){return!e.gecko&&("ClipboardEvent"in window||e.webkit&&"FocusEvent"in window)}return function(i){function s(){return(new Date).getTime()}function o(e){return n.metaKeyPressed(e)&&86==e.keyCode||e.shiftKey&&45==e.keyCode}function u(e){return e.innerText||e.textContent}function a(){return s()-v<100||"text"==d.pasteFormat}function f(e,n){return t.each(n,function(t){e=t.constructor==RegExp?e.replace(t,""):e.replace(t[0],t[1])}),e}function l(t){var n=i.fire("PastePreProcess",{content:t});t=n.content,i.settings.paste_data_images||(t=t.replace(/<img src=\"data:image[^>]+>/g,"")),(i.settings.paste_remove_styles||i.settings.paste_remove_styles_if_webkit!==!1&&e.webkit)&&(t=t.replace(/ style=\"[^\"]+\"/g,"")),n.isDefaultPrevented()||i.insertContent(t)}function c(e){e=i.dom.encode(e).replace(/\r\n/g,"\n");var t=i.dom.getParent(i.selection.getStart(),i.dom.isBlock);e=t&&/^(PRE|DIV)$/.test(t.nodeName)||!i.settings.forced_root_block?f(e,[[/\n/g,"<br>"]]):f(e,[[/\n\n/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"],[/\n/g,"<br />"]]);var n=i.fire("PastePreProcess",{content:e});n.isDefaultPrevented()||i.insertContent(n.content)}function h(){var e=i.dom.getViewPort().y,t=i.dom.add(i.getBody(),"div",{contentEditable:!1,"data-mce-bogus":"1",style:"position: absolute; top: "+e+"px; left: 0; width: 1px; height: 1px; overflow: hidden"},'<div contentEditable="true" data-mce-bogus="1">X</div>');return i.dom.bind(t,"beforedeactivate focusin focusout",function(e){e.stopPropagation()}),t}function p(e){i.dom.unbind(e),i.dom.remove(e)}var d=this,v;i.on("keydown",function(e){n.metaKeyPressed(e)&&e.shiftKey&&86==e.keyCode&&(v=s())}),r()?i.on("paste",function(e){function t(e,t){for(var r=0;r<n.types.length;r++)if(n.types[r]==e)return t(n.getData(e)),!0}var n=e.clipboardData;n&&(e.preventDefault(),a()?t("text/plain",c)||t("text/html",l):t("text/html",l)||t("text/plain",c))}):(e.ie?i.on("init",function(){var e=i.dom,t=0;i.on("keydown",function(n){if(o(n)&&!n.isDefaultPrevented()){var r=h();t=s(),e.bind(r,"paste",function(){setTimeout(function(){p(r),i.selection.setRng(f),a()?c(u(r.firstChild)):l(r.firstChild.innerHTML)},0)});var f=i.selection.getRng();r.firstChild.focus(),r.firstChild.innerText=""}}),i.dom.bind(i.getBody(),"paste",function(n){if(s()-t>100){var r,o=h();n.preventDefault(),e.bind(o,"paste",function(e){e.stopPropagation(),r=!0});var f=i.selection.getRng(),d=e.doc.body.createTextRange();if(d.moveToElementText(o.firstChild),d.execCommand("Paste"),p(o),!r)return i.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."),void 0;i.selection.setRng(f),a()?c(u(o.firstChild)):l(o.firstChild.innerHTML)}})}):(i.on("init",function(){i.dom.bind(i.getBody(),"paste",function(e){e.preventDefault(),i.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.")})}),i.on("keydown",function(e){if(o(e)&&!e.isDefaultPrevented()){var t=h(),n=i.selection.getRng();i.selection.select(t,!0),i.dom.bind(t,"paste",function(e){e.stopPropagation(),setTimeout(function(){p(t),i.lastRng=n,i.selection.setRng(n);var e=t.firstChild;e.lastChild&&"BR"==e.lastChild.nodeName&&e.removeChild(e.lastChild),a()?c(u(e)):l(e.innerHTML)},0)})}})),i.settings.paste_data_images||i.on("drop",function(e){var t=e.dataTransfer;t&&t.files&&t.files.length>0&&e.preventDefault()})),i.paste_block_drop&&i.on("dragend dragover draggesture dragdrop drop drag",function(e){e.preventDefault(),e.stopPropagation()}),this.paste=l,this.pasteText=c}}),r(h,[l,p,d,v,m],function(e,t,n,r,i){return function(s){var o=e.each;s.on("PastePreProcess",function(u){function a(e){o(e,function(e){c=e.constructor==RegExp?c.replace(e,""):c.replace(e[0],e[1])})}function f(e){function t(e,t,o,u){var a=e._listLevel||s;a!=s&&(s>a?n&&(n=n.parent.parent):(r=n,n=null)),n&&n.name==o?n.append(e):(r=r||n,n=new i(o,1),u>1&&n.attr("start",""+u),e.wrap(n)),e.name="li",t.value="";var f=t.next;f&&3==f.type&&(f.value=f.value.replace(/^\u00a0+/,"")),a>s&&r.lastChild.append(n),s=a}for(var n,r,s=1,o=e.getAll("p"),u=0;u<o.length;u++)if(e=o[u],"p"==e.name&&e.firstChild){for(var a="",f=e.firstChild;f&&!(a=f.value);)f=f.firstChild;if(/^\s*[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*$/.test(a)){t(e,f,"ul");continue}if(/^\s*\w+\./.test(a)){var l=/([0-9])\./.exec(a),c=1;l&&(c=parseInt(l[1],10)),t(e,f,"ol",c);continue}n=null}}function l(t,n){if("p"===t.name){var r=/mso-list:\w+ \w+([0-9]+)/.exec(n);r&&(t._listLevel=parseInt(r[1],10))}if(s.getParam("paste_retain_style_properties","none")){var i="";if(e.each(s.dom.parseStyle(n),function(e,t){switch(t){case"horiz-align":return t="text-align",void 0;case"vert-align":return t="vertical-align",void 0;case"font-color":case"mso-foreground":return t="color",void 0;case"mso-background":case"mso-highlight":t="background"}("all"==h||p&&p[t])&&(i+=t+":"+e+";")}),i)return i}return null}var c=u.content,h,p;if(h=s.settings.paste_retain_style_properties,h&&(p=e.makeMap(h)),s.settings.paste_enable_default_filters!==!1&&/class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(u.content)){u.wordContent=!0,a([/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,""],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(""):""}]]);var d=new n({valid_elements:"@[style],-strong/b,-em/i,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-table,-tr,-td[colspan|rowspan],-th,-thead,-tfoot,-tbody,-a[!href]"}),v=new t({},d);v.addAttributeFilter("style",function(e){for(var t=e.length,n;t--;)n=e[t],n.attr("style",l(n,n.attr("style"))),"span"!=n.name||n.attributes.length||n.unwrap()});var m=v.parse(c);f(m),u.content=(new r({},d)).serialize(m)}})}}),r(g,[f,l],function(e,t){return function(n){function r(e){n.on("PastePreProcess",function(t){t.content=e(t.content)})}function i(e,n){return t.each(n,function(t){e=t.constructor==RegExp?e.replace(t,""):e.replace(t[0],t[1])}),e}function s(e){return e=i(e,[/^[\s\S]*<!--StartFragment-->|<!--EndFragment-->[\s\S]*$/g,[/<span class="Apple-converted-space">\u00a0<\/span>/g,""],/<br>$/])}function o(e){if(!u){var r=[];t.each(n.schema.getBlockElements(),function(e,t){r.push(t)}),u=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+r.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g")}return e=i(e,[[u,"$1"]]),e=i(e,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}var u;e.webkit&&r(s),e.ie&&r(o)}}),r(y,[b,a,h,g],function(e,t,n,r){var i;e.add("paste",function(e){var s=this,o;s.clipboard=o=new t(e),s.quirks=new r(e),s.wordFilter=new n(e),e.settings.paste_as_text&&(s.clipboard.pasteFormat="text"),e.addCommand("mceInsertClipboardContent",function(e,t){t.content&&s.clipboard.paste(t.content),t.text&&s.clipboard.pasteText(t.text)}),e.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:o.pasteFormat,onclick:function(){"text"==o.pasteFormat?(this.active(!1),o.pasteFormat="html"):(o.pasteFormat="text",this.active(!0),i||(e.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),i=!0))}})})}),o([a,h,g,y])}(this),tinymce.PluginManager.add("preview",function(e){var t=e.settings;e.addCommand("mcePreview",function(){e.windowManager.open({title:"Preview",width:parseInt(e.getParam("plugin_preview_width","650"),10),height:parseInt(e.getParam("plugin_preview_height","500"),10),html:'<iframe src="javascript:\'\'" frameborder="0"></iframe>',buttons:{text:"Close",onclick:function(){this.parent().parent().close()}},onPostRender:function(){var n,r=this.getEl("body").firstChild.contentWindow.document,i="";tinymce.each(e.contentCSS,function(t){i+='<link type="text/css" rel="stylesheet" href="'+e.documentBaseURI.toAbsolute(t)+'">'});var s=t.body_id||"tinymce";-1!=s.indexOf("=")&&(s=e.getParam("body_id","","hash"),s=s[e.id]||s);var o=t.body_class||"";-1!=o.indexOf("=")&&(o=e.getParam("body_class","","hash"),o=o[e.id]||""),n="<!DOCTYPE html><html><head>"+i+"</head>"+'<body id="'+s+'" class="mce-content-body '+o+'">'+e.getContent()+"</body>"+"</html>",r.open(),r.write(n),r.close()}})}),e.addButton("preview",{title:"Preview",cmd:"mcePreview"}),e.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})}),tinymce.PluginManager.add("print",function(e){e.addCommand("mcePrint",function(){e.getWin().print()}),e.addButton("print",{title:"Print",cmd:"mcePrint"}),e.addMenuItem("print",{text:"Print",cmd:"mcePrint",icon:"print",shortcut:"Ctrl+P",context:"file"})}),tinymce.PluginManager.add("save",function(e){function t(){var t,n;return t=tinymce.DOM.getParent(e.id,"form"),!e.getParam("save_enablewhendirty")||e.isDirty()?(tinymce.triggerSave(),(n=e.getParam("save_onsavecallback"))?(e.execCallback("save_onsavecallback",e)&&(e.startContent=tinymce.trim(e.getContent({format:"raw"})),e.nodeChanged()),void 0):(t?(e.isNotDirty=!0,(!t.onsubmit||t.onsubmit())&&("function"==typeof t.submit?t.submit():e.windowManager.alert("Error: Form submit field collision.")),e.nodeChanged()):e.windowManager.alert("Error: No form element found."),void 0)):void 0}function n(){var t,n=tinymce.trim(e.startContent);return(t=e.getParam("save_oncancelcallback"))?(e.execCallback("save_oncancelcallback",e),void 0):(e.setContent(n),e.undoManager.clear(),e.nodeChanged(),void 0)}function r(){var t=this;e.on("nodeChange",function(){t.disabled(!e.isDirty())})}e.addCommand("mceSave",t),e.addCommand("mceCancel",n),e.addButton("save",{icon:"save",text:"Save",cmd:"mceSave",disabled:!0,onPostRender:r}),e.addButton("cancel",{text:"Cancel",icon:!1,cmd:"mceCancel",disabled:!0,onPostRender:r}),e.addShortcut("ctrl+s","","mceSave")}),!function(){function e(e,t,n,r,i){function s(e,t){if(t=t||0,!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";var n=e.index;if(t>0){var r=e[t];if(!r)throw"Invalid capture group";n+=e[0].indexOf(r),e[0]=r}return[n,n+e[0].length,[e[0]]]}function o(e){var t;if(3===e.nodeType)return e.data;if(p[e.nodeName])return"";if(t="",(h[e.nodeName]||d[e.nodeName])&&(t+="\n"),e=e.firstChild)do t+=o(e);while(e=e.nextSibling);return t}function u(e,t,n){var r,i,s,o,u=[],a=0,f=e,l=t.shift(),c=0;e:for(;;){if((h[f.nodeName]||d[f.nodeName])&&a++,3===f.nodeType&&(!i&&f.length+a>=l[1]?(i=f,o=l[1]-a):r&&u.push(f),!r&&f.length+a>l[0]&&(r=f,s=l[0]-a),a+=f.length),r&&i){if(f=n({startNode:r,startNodeIndex:s,endNode:i,endNodeIndex:o,innerNodes:u,match:l[2],matchIndex:c}),a-=i.length-o,r=null,i=null,u=[],l=t.shift(),c++,!l)break}else{if(!p[f.nodeName]&&f.firstChild){f=f.firstChild;continue}if(f.nextSibling){f=f.nextSibling;continue}}for(;;){if(f.nextSibling){f=f.nextSibling;break}if(f.parentNode===e)break e;f=f.parentNode}}}function a(e){var t;if("function"!=typeof e){var n=e.nodeType?e:c.createElement(e);t=function(e,t){var r=n.cloneNode(!1);return r.setAttribute("data-mce-index",t),e&&r.appendChild(c.createTextNode(e)),r}}else t=e;return function(e){var n,r,i,s=e.startNode,o=e.endNode,u=e.matchIndex;if(s===o){var a=s;i=a.parentNode,e.startNodeIndex>0&&(n=c.createTextNode(a.data.substring(0,e.startNodeIndex)),i.insertBefore(n,a));var f=t(e.match[0],u);return i.insertBefore(f,a),e.endNodeIndex<a.length&&(r=c.createTextNode(a.data.substring(e.endNodeIndex)),i.insertBefore(r,a)),a.parentNode.removeChild(a),f}n=c.createTextNode(s.data.substring(0,e.startNodeIndex)),r=c.createTextNode(o.data.substring(e.endNodeIndex));for(var l=t(s.data.substring(e.startNodeIndex),u),h=[],p=0,d=e.innerNodes.length;d>p;++p){var v=e.innerNodes[p],m=t(v.data,u);v.parentNode.replaceChild(m,v),h.push(m)}var g=t(o.data.substring(0,e.endNodeIndex),u);return i=s.parentNode,i.insertBefore(n,s),i.insertBefore(l,s),i.removeChild(s),i=o.parentNode,i.insertBefore(g,o),i.insertBefore(r,o),i.removeChild(o),g}}var f,l,c,h,p,d,v=[],m=0;if(c=t.ownerDocument,h=i.getBlockElements(),p=i.getWhiteSpaceElements(),d=i.getShortEndedElements(),l=o(t)){if(e.global)for(;f=e.exec(l);)v.push(s(f,r));else f=l.match(e),v.push(s(f,r));return v.length&&(m=v.length,u(t,v,a(n))),m}}function t(t){function n(){var e=tinymce.ui.Factory.create({type:"window",layout:"flex",pack:"center",align:"center",onClose:function(){t.focus(),o=!1,u.unmarkAllMatches()},buttons:[{text:"Find",onclick:function(){e.find("form")[0].submit()}},{text:"Replace",disabled:!0,onclick:function(){u.replace(e.find("#replace").value())||e.statusbar.items().slice(1).disabled(!0)}},{text:"Replace all",disabled:!0,onclick:function(){u.replaceAll(e.find("#replace").value()),e.statusbar.items().slice(1).disabled(!0)}},{type:"spacer",flex:1},{text:"Prev",disabled:!0,onclick:function(){u.prev()}},{text:"Next",disabled:!0,onclick:function(){u.next()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,onsubmit:function(t){var n,r,i,s,o;return t.preventDefault(),i=e.find("#case").checked(),o=e.find("#words").checked(),s=e.find("#find").value(),s.length?(s=s.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),s=o?"\\b"+s+"\\b":s,r=new RegExp(s,i?"g":"gi"),n=u.markAllMatches(r),n?u.first():tinymce.ui.MessageBox.alert("Could not find the specified string."),e.statusbar.items().slice(1).disabled(0===n),void 0):(u.unmarkAllMatches(),e.statusbar.items().slice(1).disabled(!0),void 0)},items:[{type:"textbox",name:"find",size:40,label:"Find",value:t.selection.getNode().src},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}}).renderTo().reflow();o=!0}function r(e){var t=e.parentNode;t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)}function i(e,n){function r(){var r,o;for(r=n?t.getBody()[e?"firstChild":"lastChild"]:u[e?"endContainer":"startContainer"],o=new tinymce.dom.TreeWalker(r,t.getBody());r=o.current();){if(1==r.nodeType&&"SPAN"==r.nodeName&&null!==r.getAttribute("data-mce-index"))for(a=r.getAttribute("data-mce-index"),i=r.firstChild;r=o.current();){if(1==r.nodeType&&"SPAN"==r.nodeName&&null!==r.getAttribute("data-mce-index")){if(r.getAttribute("data-mce-index")!==a)return;s=r.firstChild}o[e?"next":"prev"]()}o[e?"next":"prev"]()}}var i,s,o=t.selection,u=o.getRng(!0),a=-1;return e=e!==!1,r(),i&&s&&(t.focus(),e?(u.setStart(i,0),u.setEnd(s,s.length)):(u.setStart(s,0),u.setEnd(i,i.length)),o.scrollIntoView(i.parentNode),o.setRng(u)),a}function s(e){e.parentNode.removeChild(e)}var o,u=this,a=-1;u.init=function(e){e.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Ctrl+F",onclick:n,separator:"before",context:"edit"}),e.addButton("searchreplace",{tooltip:"Find and replace",shortcut:"Ctrl+F",onclick:n}),e.shortcuts.add("Ctrl+F","",n)},u.markAllMatches=function(n){var r,i;return i=t.dom.create("span",{"class":"mce-match-marker","data-mce-bogus":1}),r=t.getBody(),u.unmarkAllMatches(r),e(n,r,i,!1,t.schema)},u.first=function(){return a=i(!0,!0),-1!==a},u.next=function(){return a=i(!0),-1!==a},u.prev=function(){return a=i(!1),-1!==a},u.replace=function(e,n,o){var u,f,l,h,p,d;if(-1===a&&(a=i(n)),d=i(n),l=t.getBody(),f=tinymce.toArray(l.getElementsByTagName("span")),f.length)for(u=0;u<f.length;u++){var v=f[u].getAttribute("data-mce-index");if(null!==v&&v.length&&(h=p=f[u].getAttribute("data-mce-index"),o||h===a))for(e.length?(f[u].firstChild.nodeValue=e,r(f[u])):s(f[u]);f[++u];)if(h=f[u].getAttribute("data-mce-index"),null!==v&&v.length){if(h!==p){u--;break}s(f[u])}}return-1==d&&(d=i(n,!0)),a=d,o&&t.selection.setCursorLocation(t.getBody(),0),t.undoManager.add(),-1!==a},u.replaceAll=function(e){u.replace(e,!0,!0)},u.unmarkAllMatches=function(){var e,n,i;for(i=t.getBody(),n=i.getElementsByTagName("span"),e=n.length;e--;)i=n[e],i.getAttribute("data-mce-index")&&r(i)},t.on("beforeaddundo keydown",function(e){return o?(e.preventDefault(),!1):void 0})}tinymce.PluginManager.add("searchreplace",t)}(),!function(e,t){function n(e,t){for(var n,r=[],i=0;i<e.length;++i){if(n=u[e[i]]||s(e[i]),!n)throw"module definition dependecy not found: "+e[i];r.push(n)}t.apply(null,r)}function r(e,r,i){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(r===t)throw"invalid module definition, dependencies must be specified";if(i===t)throw"invalid module definition, definition function must be specified";n(r,function(){u[e]=i.apply(null,arguments)})}function i(e){return!!u[e]}function s(t){for(var n=e,r=t.split(/[.\/]/),i=0;i<r.length;++i){if(!n[r[i]])return;n=n[r[i]]}return n}function o(n){for(var r=0;r<n.length;r++){for(var i=e,s=n[r],o=s.split(/[.\/]/),a=0;a<o.length-1;++a)i[o[a]]===t&&(i[o[a]]={}),i=i[o[a]];i[o[o.length-1]]=u[s]}}var u={},a="tinymce/spellcheckerplugin/DomTextMatcher",f="tinymce/spellcheckerplugin/Plugin",l="tinymce/PluginManager",c="tinymce/util/Tools",h="tinymce/ui/Menu",p="tinymce/dom/DOMUtils",d="tinymce/util/JSONRequest",v="tinymce/util/URI";r(a,[],function(){return function(e,t,n){function r(e){if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";var t=e.index;return[t,t+e[0].length,[e[0]]]}function i(e){var t;if(3===e.nodeType)return e.data;if(m[e.nodeName])return"";if(t="",(v[e.nodeName]||g[e.nodeName])&&(t+="\n"),e=e.firstChild)do t+=i(e);while(e=e.nextSibling);return t}function s(e,t,n){var r,i,s,o,u=[],a=0,f=e,l=t.shift(),c=0;e:for(;;){if((v[f.nodeName]||g[f.nodeName])&&a++,3===f.nodeType&&(!i&&f.length+a>=l[1]?(i=f,o=l[1]-a):r&&u.push(f),!r&&f.length+a>l[0]&&(r=f,s=l[0]-a),a+=f.length),r&&i){if(f=n({startNode:r,startNodeIndex:s,endNode:i,endNodeIndex:o,innerNodes:u,match:l[2],matchIndex:c}),a-=i.length-o,r=null,i=null,u=[],l=t.shift(),c++,!l)break}else{if(!m[f.nodeName]&&f.firstChild){f=f.firstChild;continue}if(f.nextSibling){f=f.nextSibling;continue}}for(;;){if(f.nextSibling){f=f.nextSibling;break}if(f.parentNode===e)break e;f=f.parentNode}}}function o(e){var t;if("function"!=typeof e){var n=e.nodeType?e:d.createElement(e);t=function(e,t){var r=n.cloneNode(!1);return r.setAttribute("data-mce-index",t),e&&r.appendChild(d.createTextNode(e)),r}}else t=e;return function r(e){var n,r,i,s=e.startNode,o=e.endNode,u=e.matchIndex;if(s===o){var a=s;i=a.parentNode,e.startNodeIndex>0&&(n=d.createTextNode(a.data.substring(0,e.startNodeIndex)),i.insertBefore(n,a));var f=t(e.match[0],u);return i.insertBefore(f,a),e.endNodeIndex<a.length&&(r=d.createTextNode(a.data.substring(e.endNodeIndex)),i.insertBefore(r,a)),a.parentNode.removeChild(a),f}n=d.createTextNode(s.data.substring(0,e.startNodeIndex)),r=d.createTextNode(o.data.substring(e.endNodeIndex));for(var l=t(s.data.substring(e.startNodeIndex),u),c=[],h=0,p=e.innerNodes.length;p>h;++h){var v=e.innerNodes[h],m=t(v.data,u);v.parentNode.replaceChild(m,v),c.push(m)}var g=t(o.data.substring(0,e.endNodeIndex),u);return i=s.parentNode,i.insertBefore(n,s),i.insertBefore(l,s),i.removeChild(s),i=o.parentNode,i.insertBefore(g,o),i.insertBefore(r,o),i.removeChild(o),g}}function u(e){var t=[];return a(function(n,r){e(n,r)&&t.push(n)}),c=t,this}function a(e){for(var t=0,n=c.length;n>t&&e(c[t],t)!==!1;t++);return this}function f(e){return c.length&&(p=c.length,s(t,c,o(e))),this}var l,c=[],h,p=0,d,v,m,g;if(d=t.ownerDocument,v=n.getBlockElements(),m=n.getWhiteSpaceElements(),g=n.getShortEndedElements(),h=i(t),h&&e.global)for(;l=e.exec(h);)c.push(r(l));return{text:h,count:p,matches:c,each:a,filter:u,mark:f}}}),r(f,[a,l,c,h,p,d,v],function(e,t,n,r,i,s,o){t.add("spellchecker",function(t,u){function a(e){for(var t in e)return!1;return!0}function f(e,s){var o=[],u=m[s];n.each(u,function(e){o.push({text:e,onclick:function(){t.insertContent(e),c()}})}),o.push.apply(o,[{text:"-"},{text:"Ignore",onclick:function(){p(e,s)}},{text:"Ignore all",onclick:function(){p(e,s,!0)}},{text:"Finish",onclick:d}]),y=new r({items:o,context:"contextmenu",onautohide:function(e){-1!=e.target.className.indexOf("spellchecker")&&e.preventDefault()},onhide:function(){y.remove(),y=null}}),y.renderTo(document.body);var a=i.DOM.getPos(t.getContentAreaContainer()),f=t.dom.getPos(e);a.x+=f.x,a.y+=f.y,y.moveTo(a.x,a.y+e.offsetHeight)}function l(){function n(e){return t.setProgressState(!1),a(e)?(t.windowManager.alert("No misspellings found"),g=!1,void 0):(m=e,i.filter(function(t){return!!e[t[2][0]]}).mark(t.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1})),i=null,t.fire("SpellcheckStart"),void 0)}function r(e,n,r){s.sendRPC({url:(new o(u)).toAbsolute(b.spellchecker_rpc_url),method:e,params:{lang:b.spellchecker_language||"en",words:n},success:function(e){r(e)},error:function(e,n){e="JSON Parse error."==e?"Non JSON response:"+n.responseText:"Error: "+e,t.windowManager.alert(e),t.setProgressState(!1),i=null,g=!1}})}var i,f=[],l={};if(g)return d(),void 0;g=!0;var c=t.getParam("spellchecker_wordchar_pattern")||new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`]+',"g");i=(new e(c,t.getBody(),t.schema)).each(function(e){var t=e[2][0];if(!l[t]){if(/^\d+$/.test(t)||1==t.length)return;f.push(t),l[t]=!0}}),t.setProgressState(!0);var h=b.spellchecker_callback||r;h("spellcheck",f,n)}function c(){t.dom.select("span.mce-spellchecker-word").length||d()}function h(e){var t=e.parentNode;t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)}function p(e,r,i){i?n.each(t.dom.select("span.mce-spellchecker-word"),function(e){var t=e.innerText||e.textContent;t==r&&h(e)}):h(e),c()}function d(){var e,n,r;for(g=!1,r=t.getBody(),n=r.getElementsByTagName("span"),e=n.length;e--;)r=n[e],r.getAttribute("data-mce-index")&&h(r);t.fire("SpellcheckEnd")}function v(e){var n,r,i,s=-1,o,u;for(e=""+e,n=t.getBody().getElementsByTagName("span"),r=0;r<n.length&&(i=n[r],"mce-spellchecker-word"!=i.className||(s=i.getAttribute("data-mce-index"),s===e&&(s=e,o||(o=i.firstChild),u=i.firstChild),s===e||!u));r++);var a=t.dom.createRng();return a.setStart(o,0),a.setEnd(u,u.length),t.selection.setRng(a),a}var m,g,y,b=t.settings;t.on("click",function(e){if("mce-spellchecker-word"==e.target.className){e.preventDefault();var t=v(e.target.getAttribute("data-mce-index"));f(e.target,t.toString())}}),t.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:l,selectable:!0,onPostRender:function(){var e=this;t.on("SpellcheckStart SpellcheckEnd",function(){e.active(g)})}}),t.addButton("spellchecker",{tooltip:"Spellcheck",onclick:l,onPostRender:function(){var e=this;t.on("SpellcheckStart SpellcheckEnd",function(){e.active(g)})}}),t.on("remove",function(){y&&(y.remove(),y=null)})})}),o([a,f])}(this),tinymce.PluginManager.add("tabfocus",function(e){function t(e){9===e.keyCode&&e.preventDefault()}function n(t){function n(t){function n(e){return"BODY"===e.nodeName||"hidden"!=e.type&&"none"!=e.style.display&&"hidden"!=e.style.visibility&&n(e.parentNode)}function s(e){return e.tabIndex||"INPUT"==e.nodeName||"TEXTAREA"==e.nodeName}function a(e){return!s(e)&&"-1"!=e.getAttribute("tabindex")&&n(e)}if(u=r.select(":input:enabled,*[tabindex]:not(iframe)"),i(u,function(t,n){return t.id==e.id?(o=n,!1):void 0}),t>0){for(l=o+1;l<u.length;l++)if(a(u[l]))return u[l]}else for(l=o-1;l>=0;l--)if(a(u[l]))return u[l];return null}var o,u,f,l;if(9===t.keyCode&&(f=s(e.getParam("tab_focus",e.getParam("tabfocus_elements",":prev,:next"))),1==f.length&&(f[1]=f[0],f[0]=":prev"),u=t.shiftKey?":prev"==f[0]?n(-1):r.get(f[0]):":next"==f[1]?n(1):r.get(f[1]))){var c=tinymce.get(u.id||u.name);u.id&&c?c.focus():window.setTimeout(function(){tinymce.Env.webkit||window.focus(),u.focus()},10),t.preventDefault()}}var r=tinymce.DOM,i=tinymce.each,s=tinymce.explode;e.on("init",function(){e.inline&&tinymce.DOM.setAttrib(e.getBody(),"tabIndex",null)}),e.on("keyup",t),tinymce.Env.gecko?e.on("keypress keydown",n):e.on("keydown",n)}),!function(e,t){function n(e,t){for(var n,r=[],i=0;i<e.length;++i){if(n=u[e[i]]||s(e[i]),!n)throw"module definition dependecy not found: "+e[i];r.push(n)}t.apply(null,r)}function r(e,r,i){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(r===t)throw"invalid module definition, dependencies must be specified";if(i===t)throw"invalid module definition, definition function must be specified";n(r,function(){u[e]=i.apply(null,arguments)})}function i(e){return!!u[e]}function s(t){for(var n=e,r=t.split(/[.\/]/),i=0;i<r.length;++i){if(!n[r[i]])return;n=n[r[i]]}return n}function o(n){for(var r=0;r<n.length;r++){for(var i=e,s=n[r],o=s.split(/[.\/]/),a=0;a<o.length-1;++a)i[o[a]]===t&&(i[o[a]]={}),i=i[o[a]];i[o[o.length-1]]=u[s]}}var u={},a="tinymce/tableplugin/TableGrid",f="tinymce/util/Tools",l="tinymce/Env",c="tinymce/tableplugin/Quirks",h="tinymce/util/VK",p="tinymce/tableplugin/CellSelection",d="tinymce/dom/TreeWalker",v="tinymce/tableplugin/Plugin",m="tinymce/PluginManager";r(a,[f,l],function(e,t){function n(e,t){return parseInt(e.getAttribute(t)||1,10)}var r=e.each;return function(i,s){function o(){var e=0;A=[],r(["thead","tbody","tfoot"],function(t){var i=P.select("> "+t+" tr",s);r(i,function(i,s){s+=e,r(P.select("> td, > th",i),function(e,r){var i,o,u,a;if(A[s])for(;A[s][r];)r++;for(u=n(e,"rowspan"),a=n(e,"colspan"),o=s;s+u>o;o++)for(A[o]||(A[o]=[]),i=r;r+a>i;i++)A[o][i]={part:t,real:o==s&&i==r,elm:e,rowspan:u,colspan:a}})}),e+=i.length})}function u(e,t){return e=e.cloneNode(t),e.removeAttribute("id"),e}function a(e,t){var n;return n=A[t],n?n[e]:void 0}function f(e,t,n){e&&(n=parseInt(n,10),1===n?e.removeAttribute(t,1):e.setAttribute(t,n,1))}function l(e){return e&&(P.hasClass(e.elm,"mce-item-selected")||e==_)}function c(){var e=[];return r(s.rows,function(t){r(t.cells,function(n){return P.hasClass(n,"mce-item-selected")||n==_.elm?(e.push(t),!1):void 0})}),e}function h(){var e=P.createRng();e.setStartAfter(s),e.setEndAfter(s),D.setRng(e),P.remove(s)}function p(n){var s,o={};return i.settings.table_clone_elements!==!1&&(o=e.makeMap((i.settings.table_clone_elements||"strong em b i span font h1 h2 h3 h4 h5 h6 p div").toUpperCase(),/[ ,]/)),e.walk(n,function(e){var i;return 3==e.nodeType?(r(P.getParents(e.parentNode,null,n).reverse(),function(e){o[e.nodeName]&&(e=u(e,!1),s?i&&i.appendChild(e):s=i=e,i=e)}),i&&(i.innerHTML=t.ie?"&nbsp;":'<br data-mce-bogus="1" />'),!1):void 0},"childNodes"),n=u(n,!1),f(n,"rowSpan",1),f(n,"colSpan",1),s?n.appendChild(s):t.ie||(n.innerHTML='<br data-mce-bogus="1" />'),n}function d(){var e=P.createRng(),t;return r(P.select("tr",s),function(e){0===e.cells.length&&P.remove(e)}),0===P.select("tr",s).length?(e.setStartBefore(s),e.setEndBefore(s),D.setRng(e),P.remove(s),void 0):(r(P.select("thead,tbody,tfoot",s),function(e){0===e.rows.length&&P.remove(e)}),o(),t=A[Math.min(A.length-1,O.y)],t&&(D.select(t[Math.min(t.length-1,O.x)].elm,!0),D.collapse(!0)),void 0)}function v(e,t,n,r){var i,s,o,u,a;for(i=A[t][e].elm.parentNode,o=1;n>=o;o++)if(i=P.getNext(i,"tr")){for(s=e;s>=0;s--)if(a=A[t+o][s].elm,a.parentNode==i){for(u=1;r>=u;u++)P.insertAfter(p(a),a);break}if(-1==s)for(u=1;r>=u;u++)i.insertBefore(p(i.cells[0]),i.cells[0])}}function m(){r(A,function(e,t){r(e,function(e,r){var i,s,o;if(l(e)&&(e=e.elm,i=n(e,"colspan"),s=n(e,"rowspan"),i>1||s>1)){for(f(e,"rowSpan",1),f(e,"colSpan",1),o=0;i-1>o;o++)P.insertAfter(p(e),e);v(r,t,s-1,i)}})})}function g(t,n,i){var s,u,c,h,p,v,g,y,b,w,E;if(t?(s=N(t),u=s.x,c=s.y,h=u+(n-1),p=c+(i-1)):(O=M=null,r(A,function(e,t){r(e,function(e,n){l(e)&&(O||(O={x:n,y:t}),M={x:n,y:t})})}),u=O.x,c=O.y,h=M.x,p=M.y),y=a(u,c),b=a(h,p),y&&b&&y.part==b.part){for(m(),o(),y=a(u,c).elm,f(y,"colSpan",h-u+1),f(y,"rowSpan",p-c+1),g=c;p>=g;g++)for(v=u;h>=v;v++)A[g]&&A[g][v]&&(t=A[g][v].elm,t!=y&&(w=e.grep(t.childNodes),r(w,function(e){y.appendChild(e)}),w.length&&(w=e.grep(y.childNodes),E=0,r(w,function(e){"BR"==e.nodeName&&P.getAttrib(e,"data-mce-bogus")&&E++<w.length-1&&y.removeChild(e)})),P.remove(t)));d()}}function y(e){var t,i,s,o,a,c,h,d,v;for(r(A,function(n,i){return r(n,function(n){return l(n)&&(n=n.elm,a=n.parentNode,c=u(a,!1),t=i,e)?!1:void 0}),e?!t:void 0}),o=0;o<A[0].length;o++)if(A[t][o]&&(i=A[t][o].elm,i!=s)){if(e){if(t>0&&A[t-1][o]&&(d=A[t-1][o].elm,v=n(d,"rowSpan"),v>1)){f(d,"rowSpan",v+1);continue}}else if(v=n(i,"rowspan"),v>1){f(i,"rowSpan",v+1);continue}h=p(i),f(h,"colSpan",i.colSpan),c.appendChild(h),s=i}c.hasChildNodes()&&(e?a.parentNode.insertBefore(c,a):P.insertAfter(c,a))}function b(e){var t,i;r(A,function(n){return r(n,function(n,r){return l(n)&&(t=r,e)?!1:void 0}),e?!t:void 0}),r(A,function(r,s){var o,u,a;r[t]&&(o=r[t].elm,o!=i&&(a=n(o,"colspan"),u=n(o,"rowspan"),1==a?e?(o.parentNode.insertBefore(p(o),o),v(t,s,u-1,a)):(P.insertAfter(p(o),o),v(t,s,u-1,a)):f(o,"colSpan",o.colSpan+1),i=o))})}function w(){var t=[];r(A,function(i){r(i,function(i,s){l(i)&&-1===e.inArray(t,s)&&(r(A,function(e){var t=e[s].elm,r;r=n(t,"colSpan"),r>1?f(t,"colSpan",r-1):P.remove(t)}),t.push(s))})}),d()}function E(){function e(e){var t,i,s;t=P.getNext(e,"tr"),r(e.cells,function(e){var t=n(e,"rowSpan");t>1&&(f(e,"rowSpan",t-1),i=N(e),v(i.x,i.y,1,1))}),i=N(e.cells[0]),r(A[i.y],function(e){var t;e=e.elm,e!=s&&(t=n(e,"rowSpan"),1>=t?P.remove(e):f(e,"rowSpan",t-1),s=e)})}var t;t=c(),r(t.reverse(),function(t){e(t)}),d()}function S(){var e=c();return P.remove(e),d(),e}function x(){var e=c();return r(e,function(t,n){e[n]=u(t,!0)}),e}function T(e,t){var n=c(),i=n[t?0:n.length-1],s=i.cells.length;e&&(r(A,function(e){var t;return s=0,r(e,function(e){e.real&&(s+=e.colspan),e.elm.parentNode==i&&(t=1)}),t?!1:void 0}),t||e.reverse(),r(e,function(e){var n,r=e.cells.length,o;for(n=0;r>n;n++)o=e.cells[n],f(o,"colSpan",1),f(o,"rowSpan",1);for(n=r;s>n;n++)e.appendChild(p(e.cells[r-1]));for(n=s;r>n;n++)P.remove(e.cells[n]);t?i.parentNode.insertBefore(e,i):P.insertAfter(e,i)}),P.removeClass(P.select("td.mce-item-selected,th.mce-item-selected"),"mce-item-selected"))}function N(e){var t;return r(A,function(n,i){return r(n,function(n,r){return n.elm==e?(t={x:r,y:i},!1):void 0}),!t}),t}function C(e){O=N(e)}function k(){var e,t;return e=t=0,r(A,function(n,i){r(n,function(n,r){var s,o;l(n)&&(n=A[i][r],r>e&&(e=r),i>t&&(t=i),n.real&&(s=n.colspan-1,o=n.rowspan-1,s&&r+s>e&&(e=r+s),o&&i+o>t&&(t=i+o)))})}),{x:e,y:t}}function L(e){var t,n,r,i,s,o,u,a,f,l;if(M=N(e),O&&M){for(t=Math.min(O.x,M.x),n=Math.min(O.y,M.y),r=Math.max(O.x,M.x),i=Math.max(O.y,M.y),s=r,o=i,l=n;o>=l;l++)e=A[l][t],e.real||t-(e.colspan-1)<t&&(t-=e.colspan-1);for(f=t;s>=f;f++)e=A[n][f],e.real||n-(e.rowspan-1)<n&&(n-=e.rowspan-1);for(l=n;i>=l;l++)for(f=t;r>=f;f++)e=A[l][f],e.real&&(u=e.colspan-1,a=e.rowspan-1,u&&f+u>s&&(s=f+u),a&&l+a>o&&(o=l+a));for(P.removeClass(P.select("td.mce-item-selected,th.mce-item-selected"),"mce-item-selected"),l=n;o>=l;l++)for(f=t;s>=f;f++)A[l][f]&&P.addClass(A[l][f].elm,"mce-item-selected")}}var A,O,M,_,D=i.selection,P=D.dom;s=s||P.getParent(D.getStart(),"table"),o(),_=P.getParent(D.getStart(),"th,td"),_&&(O=N(_),M=k(),_=a(O.x,O.y)),e.extend(this,{deleteTable:h,split:m,merge:g,insertRow:y,insertCol:b,deleteCols:w,deleteRows:E,cutRows:S,copyRows:x,pasteRows:T,getPos:N,setStartCell:C,setEndCell:L})}}),r(c,[h,l,f],function(e,t,n){function r(e,t){return parseInt(e.getAttribute(t)||1,10)}var i=n.each;return function(n){function s(){function t(t){function s(e,r){var i=e?"previousSibling":"nextSibling",s=n.dom.getParent(r,"tr"),u=s[i];if(u)return m(n,r,u,e),t.preventDefault(),!0;var l=n.dom.getParent(s,"table"),c=s.parentNode,h=c.nodeName.toLowerCase();if("tbody"===h||h===(e?"tfoot":"thead")){var p=o(e,l,c,"tbody");if(null!==p)return a(e,p,r)}return f(e,s,i,l)}function o(e,t,r,i){var s=n.dom.select(">"+i,t),o=s.indexOf(r);if(e&&0===o||!e&&o===s.length-1)return u(e,t);if(-1===o){var a="thead"===r.tagName.toLowerCase()?0:s.length-1;return s[a]}return s[o+(e?-1:1)]}function u(e,t){var r=e?"thead":"tfoot",i=n.dom.select(">"+r,t);return 0!==i.length?i[0]:null}function a(e,r,i){var s=l(r,e);return s&&m(n,i,s,e),t.preventDefault(),!0}function f(e,r,i,o){var u=o[i];if(u)return c(u),!0;var a=n.dom.getParent(o,"td,th");if(a)return s(e,a,t);var f=l(r,!e);return c(f),t.preventDefault(),!1}function l(e,t){var r=e&&e[t?"lastChild":"firstChild"];return r&&"BR"===r.nodeName?n.dom.getParent(r,"td,th"):r}function c(e){n.selection.setCursorLocation(e,0)}function h(){return b==e.UP||b==e.DOWN}function p(e){var t=e.selection.getNode(),n=e.dom.getParent(t,"tr");return null!==n}function d(e){for(var t=0,n=e;n.previousSibling;)n=n.previousSibling,t+=r(n,"colspan");return t}function v(e,t){var n=0,s=0;return i(e.children,function(e,i){return n+=r(e,"colspan"),s=i,n>t?!1:void 0}),s}function m(e,t,r,i){var s=d(n.dom.getParent(t,"td,th")),o=v(r,s),u=r.childNodes[o],a=l(u,i);c(a||u)}function g(e){var t=n.selection.getNode(),r=n.dom.getParent(t,"td,th"),i=n.dom.getParent(e,"td,th");return r&&r!==i&&y(r,i)}function y(e,t){return n.dom.getParent(e,"TABLE")===n.dom.getParent(t,"TABLE")}var b=t.keyCode;if(h()&&p(n)){var w=n.selection.getNode();setTimeout(function(){g(w)&&s(!t.shiftKey&&b===e.UP,w,t)},0)}}n.on("KeyDown",function(e){t(e)})}function o(){function e(e,t){var n=t.ownerDocument,r=n.createRange(),i;return r.setStartBefore(t),r.setEnd(e.endContainer,e.endOffset),i=n.createElement("body"),i.appendChild(r.cloneContents()),0===i.innerHTML.replace(/<(br|img|object|embed|input|textarea)[^>]*>/gi,"-").replace(/<[^>]+>/g,"").length}n.on("KeyDown",function(t){var r,i,s=n.dom;(37==t.keyCode||38==t.keyCode)&&(r=n.selection.getRng(),i=s.getParent(r.startContainer,"table"),i&&n.getBody().firstChild==i&&e(r,i)&&(r=s.createRng(),r.setStartBefore(i),r.setEndBefore(i),n.selection.setRng(r),t.preventDefault()))})}function u(){n.on("KeyDown SetContent VisualAid",function(){var e;for(e=n.getBody().lastChild;e;e=e.previousSibling)if(3==e.nodeType){if(e.nodeValue.length>0)break}else if(1==e.nodeType&&!e.getAttribute("data-mce-bogus"))break;e&&"TABLE"==e.nodeName&&(n.settings.forced_root_block?n.dom.add(n.getBody(),n.settings.forced_root_block,null,t.ie?"&nbsp;":'<br data-mce-bogus="1" />'):n.dom.add(n.getBody(),"br",{"data-mce-bogus":"1"}))}),n.on("PreProcess",function(e){var t=e.node.lastChild;t&&("BR"==t.nodeName||1==t.childNodes.length&&("BR"==t.firstChild.nodeName||""==t.firstChild.nodeValue))&&t.previousSibling&&"TABLE"==t.previousSibling.nodeName&&n.dom.remove(t)})}function a(){function e(e,t,n,r){var i=3,s=e.dom.getParent(t.startContainer,"TABLE"),o,u,a;return s&&(o=s.parentNode),u=t.startContainer.nodeType==i&&0===t.startOffset&&0===t.endOffset&&r&&("TR"==n.nodeName||n==o),a=("TD"==n.nodeName||"TH"==n.nodeName)&&!r,u||a}function t(){var t=n.selection.getRng(),r=n.selection.getNode(),i=n.dom.getParent(t.startContainer,"TD,TH");if(e(n,t,r,i)){i||(i=r);for(var s=i.lastChild;s.lastChild;)s=s.lastChild;t.setEnd(s,s.nodeValue.length),n.selection.setRng(t)}}n.on("KeyDown",function(){t()}),n.on("MouseDown",function(e){2!=e.button&&t()})}t.webkit&&(s(),a()),t.gecko&&(o(),u())}}),r(p,[a,d,f],function(e,t,n){return function(r){function i(){r.getBody().style.webkitUserSelect="",f&&(r.dom.removeClass(r.dom.select("td.mce-item-selected,th.mce-item-selected"),"mce-item-selected"),f=!1)}var s=r.dom,o,u,a,f=!0;return r.on("MouseDown",function(e){2!=e.button&&(i(),u=s.getParent(e.target,"td,th"),a=s.getParent(u,"table"))}),s.bind(r.getDoc(),"mouseover",function(t){var n,i,l=t.target;if(u&&(o||l!=u)&&("TD"==l.nodeName||"TH"==l.nodeName)){i=s.getParent(l,"table"),i==a&&(o||(o=new e(r,i),o.setStartCell(u),r.getBody().style.webkitUserSelect="none"),o.setEndCell(l),f=!0),n=r.selection.getSel();try{n.removeAllRanges?n.removeAllRanges():n.empty()}catch(c){}t.preventDefault()}}),r.on("MouseUp",function(){function e(e,r){var s=new t(e,e);do{if(3==e.nodeType&&0!==n.trim(e.nodeValue).length)return r?i.setStart(e,0):i.setEnd(e,e.nodeValue.length),void 0;if("BR"==e.nodeName)return r?i.setStartBefore(e):i.setEndBefore(e),void 0}while(e=r?s.next():s.prev())}var i,f=r.selection,l,c,h,p,d;if(u){if(o&&(r.getBody().style.webkitUserSelect=""),l=s.select("td.mce-item-selected,th.mce-item-selected"),l.length>0){i=s.createRng(),h=l[0],d=l[l.length-1],i.setStartBefore(h),i.setEndAfter(h),e(h,1),c=new t(h,s.getParent(l[0],"table"));do if("TD"==h.nodeName||"TH"==h.nodeName){if(!s.hasClass(h,"mce-item-selected"))break;p=h}while(h=c.next());e(p),f.setRng(i)}r.nodeChanged(),u=o=a=null}}),r.on("KeyUp",function(){i()}),{clear:i}}}),r(v,[a,c,p,f,d,l,m],function(e,t,n,r,i,s,o){function u(r){function i(e){return e?e.replace(/px$/,""):""}function o(e){return/^[0-9]+$/.test(e)&&(e+="px"),e}function u(e){a("left center right".split(" "),function(t){r.formatter.remove("align"+t,{},e)})}function f(){var e=r.dom,t,n,f;t=r.dom.getParent(r.selection.getStart(),"table"),f=!1,n={width:i(e.getStyle(t,"width")||e.getAttrib(t,"width")),height:i(e.getStyle(t,"height")||e.getAttrib(t,"height")),cellspacing:e.getAttrib(t,"cellspacing"),cellpadding:e.getAttrib(t,"cellpadding"),border:e.getAttrib(t,"border"),caption:!!e.select("caption",t)[0]},a("left center right".split(" "),function(e){r.formatter.matchNode(t,"align"+e)&&(n.align=e)}),r.windowManager.open({title:"Table properties",items:{type:"form",layout:"grid",columns:2,data:n,defaults:{type:"textbox",maxWidth:50},items:[f?{label:"Cols",name:"cols",disabled:!0}:null,f?{label:"Rows",name:"rows",disabled:!0}:null,{label:"Width",name:"width"},{label:"Height",name:"height"},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"},{label:"Alignment",minWidth:90,name:"align",type:"listbox",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]},onsubmit:function(){var n=this.toJSON(),i;r.undoManager.transact(function(){r.dom.setAttribs(t,{cellspacing:n.cellspacing,cellpadding:n.cellpadding,border:n.border}),r.dom.setStyles(t,{width:o(n.width),height:o(n.height)}),i=e.select("caption",t)[0],i&&!n.caption&&e.remove(i),!i&&n.caption&&(i=e.create("caption"),s.ie||(i.innerHTML='<br data-mce-bogus="1"/>'),t.insertBefore(i,t.firstChild)),u(t),n.align&&r.formatter.apply("align"+n.align,{},t),r.focus(),r.addVisual()})}})}function l(e,t){r.windowManager.open({title:"Merge cells",body:[{label:"Cols",name:"cols",type:"textbox",size:10},{label:"Rows",name:"rows",type:"textbox",size:10}],onsubmit:function(){var n=this.toJSON();r.undoManager.transact(function(){e.merge(t,n.cols,n.rows)})}})}function c(){var e=r.dom,t,n,s=[];s=r.dom.select("td.mce-item-selected,th.mce-item-selected"),t=r.dom.getParent(r.selection.getStart(),"td,th"),!s.length&&t&&s.push(t),t=t||s[0],n={width:i(e.getStyle(t,"width")||e.getAttrib(t,"width")),height:i(e.getStyle(t,"height")||e.getAttrib(t,"height")),scope:e.getAttrib(t,"scope")},n.type=t.nodeName.toLowerCase(),a("left center right".split(" "),function(e){r.formatter.matchNode(t,"align"+e)&&(n.align=e)}),r.windowManager.open({title:"Cell properties",items:{type:"form",data:n,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width"},{label:"Height",name:"height"},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,menu:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,menu:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"Alignment",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]},onsubmit:function(){var t=this.toJSON();r.undoManager.transact(function(){a(s,function(n){r.dom.setAttrib(n,"scope",t.scope),r.dom.setStyles(n,{width:o(t.width),height:o(t.height)}),t.type&&n.nodeName.toLowerCase()!=t.type&&(n=e.rename(n,t.type)),u(n),t.align&&r.formatter.apply("align"+t.align,{},n)}),r.focus()})}})}function h(){var e=r.dom,t,n,s,f,l=[];t=r.dom.getParent(r.selection.getStart(),"table"),n=r.dom.getParent(r.selection.getStart(),"td,th"),a(t.rows,function(t){a(t.cells,function(r){return e.hasClass(r,"mce-item-selected")||r==n?(l.push(t),!1):void 0})}),s=l[0],f={height:i(e.getStyle(s,"height")||e.getAttrib(s,"height")),scope:e.getAttrib(s,"scope")},f.type=s.parentNode.nodeName.toLowerCase(),a("left center right".split(" "),function(e){r.formatter.matchNode(s,"align"+e)&&(f.align=e)}),r.windowManager.open({title:"Row properties",items:{type:"form",data:f,columns:2,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"None",maxWidth:null,menu:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,menu:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"}]},onsubmit:function(){var t=this.toJSON(),n,i,s;r.undoManager.transact(function(){var f=t.type;a(l,function(a){r.dom.setAttrib(a,"scope",t.scope),r.dom.setStyles(a,{height:o(t.height)}),f!=a.parentNode.nodeName.toLowerCase()&&(n=e.getParent(a,"table"),i=a.parentNode,s=e.select(f,n)[0],s||(s=e.create(f),n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s)),s.appendChild(a),i.hasChildNodes()||e.remove(i)),u(a),t.align&&r.formatter.apply("align"+t.align,{},a)}),r.focus()})}})}function p(e){return function(){r.execCommand(e)}}function d(e,t){var n,i,o;for(o="<table><tbody>",n=0;t>n;n++){for(o+="<tr>",i=0;e>i;i++)o+="<td>"+(s.ie?" ":"<br>")+"</td>";o+="</tr>"}o+="</tbody></table>",r.insertContent(o)}function v(e,t){function n(){e.disabled(!r.dom.getParent(r.selection.getStart(),t)),r.selection.selectorChanged(t,function(t){e.disabled(!t)})}r.initialized?n():r.on("init",n)}function m(){v(this,"table")}function g(){v(this,"td,th")}function y(){var e="";e='<table role="presentation" class="mce-grid mce-grid-border">';for(var t=0;10>t;t++){e+="<tr>";for(var n=0;10>n;n++)e+='<td><a href="#" data-mce-index="'+n+","+t+'"></a></td>';e+="</tr>"}return e+="</table>",e+='<div class="mce-text-center">0 x 0</div>'}var b,w,E=this;r.addMenuItem("inserttable",{text:"Insert table",icon:"table",context:"table",onhide:function(){r.dom.removeClass(this.menu.items()[0].getEl().getElementsByTagName("a"),"mce-active")},menu:[{type:"container",html:y(),onmousemove:function(e){var t=e.target;if("A"==t.nodeName){var n=r.dom.getParent(t,"table"),i=t.getAttribute("data-mce-index");if(i!=this.lastPos){i=i.split(","),i[0]=parseInt(i[0],10),i[1]=parseInt(i[1],10);for(var s=0;10>s;s++)for(var o=0;10>o;o++)r.dom.toggleClass(n.rows[s].childNodes[o].firstChild,"mce-active",o<=i[0]&&s<=i[1]);n.nextSibling.innerHTML=i[0]+1+" x "+(i[1]+1),this.lastPos=i}}},onclick:function(e){"A"==e.target.nodeName&&this.lastPos&&(e.preventDefault(),d(this.lastPos[0]+1,this.lastPos[1]+1),this.parent().cancel())}}]}),r.addMenuItem("tableprops",{text:"Table properties",context:"table",onPostRender:m,onclick:f}),r.addMenuItem("deletetable",{text:"Delete table",context:"table",onPostRender:m,cmd:"mceTableDelete"}),r.addMenuItem("cell",{separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:p("mceTableCellProps"),onPostRender:g},{text:"Merge cells",onclick:p("mceTableMergeCells"),onPostRender:g},{text:"Split cell",onclick:p("mceTableSplitCells"),onPostRender:g}]}),r.addMenuItem("row",{text:"Row",context:"table",menu:[{text:"Insert row before",onclick:p("mceTableInsertRowBefore"),onPostRender:g},{text:"Insert row after",onclick:p("mceTableInsertRowAfter"),onPostRender:g},{text:"Delete row",onclick:p("mceTableDeleteRow"),onPostRender:g},{text:"Row properties",onclick:p("mceTableRowProps"),onPostRender:g},{text:"-"},{text:"Cut row",onclick:p("mceTableCutRow"),onPostRender:g},{text:"Copy row",onclick:p("mceTableCopyRow"),onPostRender:g},{text:"Paste row before",onclick:p("mceTablePasteRowBefore"),onPostRender:g},{text:"Paste row after",onclick:p("mceTablePasteRowAfter"),onPostRender:g}]}),r.addMenuItem("column",{text:"Column",context:"table",menu:[{text:"Insert column before",onclick:p("mceTableInsertColBefore"),onPostRender:g},{text:"Insert column after",onclick:p("mceTableInsertColAfter"),onPostRender:g},{text:"Delete column",onclick:p("mceTableDeleteCol"),onPostRender:g}]});var S=[];a("inserttable tableprops deletetable | cell row column".split(" "),function(e){"|"==e?S.push({text:"-"}):S.push(r.menuItems[e])}),r.addButton("table",{type:"menubutton",title:"Table",menu:S}),s.isIE||r.on("click",function(e){e=e.target,"TABLE"===e.nodeName&&(r.selection.select(e),r.nodeChanged())}),E.quirks=new t(r),r.on("Init",function(){b=r.windowManager,E.cellSelection=new n(r)}),a({mceTableSplitCells:function(e){e.split()},mceTableMergeCells:function(e){var t,n,i;i=r.dom.getParent(r.selection.getStart(),"th,td"),i&&(t=i.rowSpan,n=i.colSpan),r.dom.select("td.mce-item-selected,th.mce-item-selected").length?e.merge():l(e,i)},mceTableInsertRowBefore:function(e){e.insertRow(!0)},mceTableInsertRowAfter:function(e){e.insertRow()},mceTableInsertColBefore:function(e){e.insertCol(!0)},mceTableInsertColAfter:function(e){e.insertCol()},mceTableDeleteCol:function(e){e.deleteCols()},mceTableDeleteRow:function(e){e.deleteRows()},mceTableCutRow:function(e){w=e.cutRows()},mceTableCopyRow:function(e){w=e.copyRows()},mceTablePasteRowBefore:function(e){e.pasteRows(w,!0)},mceTablePasteRowAfter:function(e){e.pasteRows(w)},mceTableDelete:function(e){e.deleteTable()}},function(t,n){r.addCommand(n,function(){var n=new e(r);n&&(t(n),r.execCommand("mceRepaint"),E.cellSelection.clear())})}),a({mceInsertTable:function(){f()},mceTableRowProps:h,mceTableCellProps:c},function(e,t){r.addCommand(t,function(t,n){e(n)})})}var a=r.each;o.add("table",u)}),o([a,c,p,v])}(this),tinymce.PluginManager.add("template",function(e){function t(){function t(e){var t=e.control.value();t.url?tinymce.util.XHR.send({url:t.url,success:function(e){r=e,n.find("iframe")[0].html(e)}}):(r=t.content,n.find("iframe")[0].html(t.content)),n.find("#description")[0].text(e.control.value().description)}var n,r,s=[];return e.settings.templates?(tinymce.each(e.settings.templates,function(e){s.push({selected:!s.length,text:e.title,value:{url:e.url,content:e.content,description:e.description}})}),n=e.windowManager.open({title:"Insert template",body:[{type:"listbox",name:"template",flex:0,label:"Templates",values:s,onselect:t},{type:"label",name:"description",label:"Description",text:""},{type:"iframe",minWidth:600,minHeight:400,border:1}],onsubmit:function(){i(!1,r)}}),n.find("listbox")[0].fire("select"),void 0):(e.windowManager.alert("No templates defined"),void 0)}function n(t,n){function r(e,t){if(e=""+e,e.length<t)for(var n=0;n<t-e.length;n++)e="0"+e;return e}var i="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),s="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),o="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),u="January February March April May June July August September October November December".split(" ");return n=n||new Date,t=t.replace("%D","%m/%d/%Y"),t=t.replace("%r","%I:%M:%S %p"),t=t.replace("%Y",""+n.getFullYear()),t=t.replace("%y",""+n.getYear()),t=t.replace("%m",r(n.getMonth()+1,2)),t=t.replace("%d",r(n.getDate(),2)),t=t.replace("%H",""+r(n.getHours(),2)),t=t.replace("%M",""+r(n.getMinutes(),2)),t=t.replace("%S",""+r(n.getSeconds(),2)),t=t.replace("%I",""+((n.getHours()+11)%12+1)),t=t.replace("%p",""+(n.getHours()<12?"AM":"PM")),t=t.replace("%B",""+e.translate(u[n.getMonth()])),t=t.replace("%b",""+e.translate(o[n.getMonth()])),t=t.replace("%A",""+e.translate(s[n.getDay()])),t=t.replace("%a",""+e.translate(i[n.getDay()])),t=t.replace("%%","%")}function r(t){var n=e.dom,r=e.getParam("template_replace_values");s(n.select("*",t),function(e){s(r,function(t,i){n.hasClass(e,i)&&"function"==typeof r[i]&&r[i](e)})})}function i(t,i){function o(e,t){return(new RegExp("\\b"+t+"\\b","g")).test(e.className)}var u,f,l=e.dom,c=e.selection.getContent();s(e.getParam("template_replace_values"),function(e,t){"function"!=typeof e&&(i=i.replace(new RegExp("\\{\\$"+t+"\\}","g"),e))}),u=l.create("div",null,i),f=l.select(".mceTmpl",u),f&&f.length>0&&(u=l.create("div",null),u.appendChild(f[0].cloneNode(!0))),s(l.select("*",u),function(t){o(t,e.getParam("template_cdate_classes","cdate").replace(/\s+/g,"|"))&&(t.innerHTML=n(e.getParam("template_cdate_format",e.getLang("template.cdate_format")))),o(t,e.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(t.innerHTML=n(e.getParam("template_mdate_format",e.getLang("template.mdate_format")))),o(t,e.getParam("template_selected_content_classes","selcontent").replace(/\s+/g,"|"))&&(t.innerHTML=c)}),r(u),e.execCommand("mceInsertContent",!1,u.innerHTML),e.addVisual()}var s=tinymce.each;e.addCommand("mceInsertTemplate",i),e.addButton("template",{title:"Insert template",onclick:t}),e.addMenuItem("template",{text:"Insert template",onclick:t,context:"insert"}),e.on("PreProcess",function(t){var i=e.dom;s(i.select("div",t.node),function(t){i.hasClass(t,"mceTmpl")&&(s(i.select("*",t),function(t){i.hasClass(t,e.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(t.innerHTML=n(e.getParam("template_mdate_format",e.getLang("template.mdate_format"))))}),r(t))})})}),tinymce.PluginManager.add("visualblocks",function(e,t){function n(){var t=this;e.on("VisualBlocks",function(){t.active(e.dom.hasClass(e.getBody(),"mce-visualblocks"))})}var r,i,s;window.NodeList&&(e.addCommand("mceVisualBlocks",function(){var n,u=e.dom;r||(r=u.uniqueId(),n=u.create("link",{id:r,rel:"stylesheet",href:t+"/css/visualblocks.css"}),e.getDoc().getElementsByTagName("head")[0].appendChild(n)),e.on("PreviewFormats AfterPreviewFormats",function(t){s&&u.toggleClass(e.getBody(),"mce-visualblocks","afterpreviewformats"==t.type)}),u.toggleClass(e.getBody(),"mce-visualblocks"),s=e.dom.hasClass(e.getBody(),"mce-visualblocks"),i&&i.active(u.hasClass(e.getBody(),"mce-visualblocks")),e.fire("VisualBlocks")}),e.addButton("visualblocks",{title:"Show blocks",cmd:"mceVisualBlocks",onPostRender:n}),e.addMenuItem("visualblocks",{text:"Show blocks",cmd:"mceVisualBlocks",onPostRender:n,selectable:!0,context:"view",prependToContext:!0}),e.on("init",function(){e.settings.visualblocks_default_state&&e.execCommand("mceVisualBlocks",!1,null,{skip_focus:!0})}),e.on("remove",function(){e.dom.removeClass(e.getBody(),"mce-visualblocks")}))}),tinymce.PluginManager.add("visualchars",function(e){function t(t){var n,s,o,u,a,f,l=e.getBody(),c=e.selection;if(r=!r,e.fire("VisualChars",{state:r}),t&&(f=c.getBookmark()),r)for(s=[],tinymce.walk(l,function(e){3==e.nodeType&&e.nodeValue&&-1!=e.nodeValue.indexOf("")&&s.push(e)},"childNodes"),o=0;o<s.length;o++){for(u=s[o].nodeValue,u=u.replace(/(\u00a0)/g,'<span data-mce-bogus="1" class="mce-nbsp">$1</span>'),a=e.dom.create("div",null,u);n=a.lastChild;)e.dom.insertAfter(n,s[o]);e.dom.remove(s[o])}else for(s=e.dom.select("span.mce-nbsp",l),o=s.length-1;o>=0;o--)e.dom.remove(s[o],1);c.moveToBookmark(f)}function n(){var t=this;e.on("VisualChars",function(e){t.active(e.state)})}var r;e.addCommand("mceVisualChars",t),e.addButton("visualchars",{title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:n}),e.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:n,selectable:!0,context:"view",prependToContext:!0}),e.on("beforegetcontent",function(e){r&&"raw"!=e.format&&!e.draft&&(r=!0,t(!1))})}),tinymce.PluginManager.add("wordcount",function(e){function t(){e.theme.panel.find("#wordcount").text(["Words: {0}",i.getCount()])}var n,r,i=this;n=e.getParam("wordcount_countregex",/[\w\u2019\x27\-]+/g),r=e.getParam("wordcount_cleanregex",/[0-9.(),;:!?%#$?\x27\x22_+=\\\/\-]*/g),e.on("init",function(){var n=e.theme.panel&&e.theme.panel.find("#statusbar")[0];n&&window.setTimeout(function(){n.insert({type:"label",name:"wordcount",text:["Words: {0}",i.getCount()],classes:"wordcount"},0),e.on("setcontent beforeaddundo",t),e.on("keyup",function(e){32==e.keyCode&&t()})},0)}),i.getCount=function(){var t=e.getContent({format:"raw"}),i=0;if(t){t=t.replace(/\.\.\./g," "),t=t.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," "),t=t.replace(/(\w+)(&.+?;)+(\w+)/,"$1$3").replace(/&.+?;/g," "),t=t.replace(r,"");var s=t.match(n);s&&(i=s.length)}return i}}),tinymce.PluginManager.add("textcolor",function(e){function t(){var t,n,r=[];for(n=e.settings.textcolor_map||["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Brown","C0C0C0","Silver","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum","FFFFFF","White"],t=0;t<n.length;t+=2)r.push({text:n[t+1],color:n[t]});return r}function n(){var n,r,i,s,o,u,a,f,l,c=this;for(n=t(),i='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="presentation" cellspacing="0"><tbody>',s=n.length-1,o=e.settings.textcolor_rows||5,u=e.settings.textcolor_cols||8,f=0;o>f;f++){for(i+="<tr>",a=0;u>a;a++)l=f*u+a,l>s?i+="<td></td>":(r=n[l],i+='<td><div id="'+c._id+"-"+l+'"'+' data-mce-color="'+r.color+'"'+' role="option"'+' tabIndex="-1"'+' style="'+(r?"background-color: #"+r.color:"")+'"'+' title="'+r.text+'">'+"</div>"+"</td>");i+="</tr>"}return i+="</tbody></table>"}function r(t){var n,r=this.parent();(n=t.target.getAttribute("data-mce-color"))&&(r.hidePanel(),n="#"+n,r.color(n),e.execCommand(r.settings.selectcmd,!1,n))}function i(){var t=this;t._color&&e.execCommand(t.settings.selectcmd,!1,t._color)}e.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",popoverAlign:"bc-tl",selectcmd:"ForeColor",panel:{html:n,onclick:r},onclick:i}),e.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",popoverAlign:"bc-tl",selectcmd:"HiliteColor",panel:{html:n,onclick:r},onclick:i})}),tinymce.ThemeManager.add("modern",function(e){function t(){function t(t){var r,i=[];if(t)return c(t.split(/[ ,]/),function(t){function n(){var n=e.selection;"bullist"==s&&n.selectorChanged("ul > li",function(e,n){for(var r,i=n.parents.length;i--&&(r=n.parents[i].nodeName,"OL"!=r&&"UL"!=r););t.active("UL"==r)}),"numlist"==s&&n.selectorChanged("ol > li",function(e,n){for(var r,i=n.parents.length;i--&&(r=n.parents[i].nodeName,"OL"!=r&&"UL"!=r););t.active("OL"==r)}),t.settings.stateSelector&&n.selectorChanged(t.settings.stateSelector,function(e){t.active(e)},!0),t.settings.disabledStateSelector&&n.selectorChanged(t.settings.disabledStateSelector,function(e){t.disabled(e)})}var s;"|"==t?r=null:l.has(t)?(t={type:t},f.toolbar_items_size&&(t.size=f.toolbar_items_size),i.push(t),r=null):(r||(r={type:"buttongroup",items:[]},i.push(r)),e.buttons[t]&&(s=t,t=e.buttons[s],t.type=t.type||"button",f.toolbar_items_size&&(t.size=f.toolbar_items_size),t=l.create(t),r.items.push(t),e.initialized?n():e.on("init",n)))}),n.push({type:"toolbar",layout:"flow",items:i}),!0}for(var n=[],r=1;10>r&&t(f["toolbar"+r]);r++);return n.length||t(f.toolbar||d),n}function n(){function t(t){var n;return"|"==t?{text:"|"}:n=e.menuItems[t]}function n(n){var r,i,s,o,u;if(u=tinymce.makeMap((f.removed_menuitems||"").split(/[ ,]/)),f.menu?(i=f.menu[n],o=!0):i=p[n],i){r={text:i.title},s=[],c((i.items||"").split(/[ ,]/),function(e){var n=t(e);n&&!u[e]&&s.push(t(e))}),o||c(e.menuItems,function(e){e.context==n&&("before"==e.separator&&s.push({text:"|"}),e.prependToContext?s.unshift(e):s.push(e),"after"==e.separator&&s.push({text:"|"}))});for(var a=0;a<s.length;a++)"|"==s[a].text&&(0===a||a==s.length-1)&&s.splice(a,1);if(r.menu=s,!r.menu.length)return null}return r}var r,i=[],s=[];if(f.menu)for(r in f.menu)s.push(r);else for(r in p)s.push(r);for(var o=f.menubar?f.menubar.split(/[ ,]/):s,u=0;u<o.length;u++){var a=o[u];a=n(a),a&&i.push(a)}return i}function r(t){function n(e){var n=t.find(e)[0];n&&n.focus()}e.shortcuts.add("Alt+F9","",function(){n("menubar")}),e.shortcuts.add("Alt+F10","",function(){n("toolbar")}),e.shortcuts.add("Alt+F11","",function(){n("elementpath")}),t.on("cancel",function(){e.focus()})}function i(t,n){function r(e){return{width:e.clientWidth,height:e.clientHeight}}var i,s,o,u;i=e.getContainer(),s=e.getContentAreaContainer().firstChild,o=r(i),u=r(s),t=Math.max(f.min_width||100,t),n=Math.max(f.min_height||100,n),t=Math.min(f.max_width||65535,t),n=Math.min(f.max_height||65535,n),h.css(i,"width",t+(o.width-u.width)),h.css(s,"width",t),h.css(s,"height",n),e.fire("ResizeEditor")}function s(t,n){var r=e.getContentAreaContainer();a.resizeTo(r.clientWidth+t,r.clientHeight+n)}function o(){function i(){c&&c.moveRel&&c.visible()&&!c._fixed&&c.moveRel(e.getBody(),["tl-bl","bl-tl"])}function s(){c&&(c.show(),i(),h.addClass(e.getBody(),"mce-edit-focus"))}function o(){c&&(c.hide(),h.removeClass(e.getBody(),"mce-edit-focus"))}function u(){return c?(c.visible()||s(),void 0):(c=a.panel=l.create({type:p?"panel":"floatpanel",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",autohide:!1,autofix:!0,fixed:!!p,border:1,items:[f.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:n()},f.toolbar===!1?null:{type:"panel",name:"toolbar",layout:"stack",items:t()}]}),c.renderTo(p||document.body).reflow(),r(c),s(),e.on("nodeChange",i),e.on("activate",s),e.on("deactivate",o),void 0)}var c,p;return f.fixed_toolbar_container&&(p=h.select(f.fixed_toolbar_container)[0]),f.content_editable=!0,e.on("focus",u),e.on("blur",o),e.on("remove",function(){c&&(c.remove(),c=null)}),{}}function u(s){var o,u,c;return o=a.panel=l.create({type:"panel",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[f.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:n()},f.toolbar===!1?null:{type:"panel",layout:"stack",items:t()},{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",html:"",border:"1 0 0 0"}]}),f.resize!==!1&&(u={type:"resizehandle",direction:f.resize,onResizeStart:function(){var t=e.getContentAreaContainer().firstChild;c={width:t.clientWidth,height:t.clientHeight}},onResize:function(e){i(c.width+e.deltaX,c.height+e.deltaY)}}),f.statusbar!==!1&&o.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",items:[{type:"elementpath"},u]}),o.renderBefore(s.targetNode).reflow(),f.width&&tinymce.DOM.setStyle(o.getEl(),"width",f.width),e.on("remove",function(){o.remove(),o=null}),r(o),{iframeContainer:o.find("#iframe")[0].getEl(),editorContainer:o.getEl()}}var a=this,f=e.settings,l=tinymce.ui.Factory,c=tinymce.each,h=tinymce.DOM,p={file:{title:"File",items:"newdocument"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},insert:{title:"Insert",items:"|"},view:{title:"View",items:"visualaid |"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"},table:{title:"Table"},tools:{title:"Tools"}},d="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";a.renderUI=function(t){var n=f.skin!==!1?f.skin||"lightgray":!1;return n&&(tinymce.Env.documentMode<=7?tinymce.DOM.loadCSS(tinymce.baseURL+"/skins/"+n+"/skin.ie7.min.css"):tinymce.DOM.loadCSS(tinymce.baseURL+"/skins/"+n+"/skin.min.css"),e.contentCSS.push(tinymce.baseURL+"/skins/"+n+"/content"+(e.inline?".inline":"")+".min.css")),e.on("ProgressState",function(e){a.throbber=a.throbber||new tinymce.ui.Throbber(a.panel.getEl("body")),e.state?a.throbber.show(e.time):a.throbber.hide()}),f.inline?o(t):u(t)},a.resizeTo=i,a.resizeBy=s}),define("tinymce",function(e){return function(){var t,n;return n=function(){return this.tinyMCE.DOM.events.domLoaded=!0,this.tinyMCE},t=n.apply(e,arguments),t||e.window.tinyMCE}}(this)),define("mockup-patterns-autotoc",["jquery","mockup-patterns-base"],function(e,t){var n=t.extend({name:"autotoc",defaults:{section:"section",levels:"h1,h2,h3",IDPrefix:"autotoc-item-",classTOCName:"autotoc-nav",classSectionName:"autotoc-section",classLevelPrefixName:"autotoc-level-",classActiveName:"active",scrollDuration:"slow",scrollEasing:"swing"},init:function(){var t=this;t.$toc=e("<nav/>").addClass(t.options.classTOCName),t.options.prependTo?t.$toc.prependTo(t.options.prependTo):t.options.appendTo?t.$toc.appendTo(t.options.appendTo):t.$toc.prependTo(t.$el),t.options.className&&t.$el.addClass(t.options.className),e(t.options.section,t.$el).addClass(t.options.classSectionName);var n=t.$el.hasClass("autotabs");e(t.options.levels,t.$el).each(function(r){var i=e(this),s=i.prop("id")?"#"+i.prop("id"):i.parents(t.options.section).prop("id");s||(s=t.options.IDPrefix+t.name+"-"+r,i.prop("id",s)),e("<a/>").appendTo(t.$toc).text(i.text()).prop("href",s).addClass(t.options.classLevelPrefixName+t.getLevel(i)).on("click",function(r,s){r.stopPropagation(),r.preventDefault(),t.$toc.children("."+t.options.classActiveName).removeClass(t.options.classActiveName),t.$el.children("."+t.options.classActiveName).removeClass(t.options.classActiveName),e(r.target).addClass(t.options.classActiveName),i.parents(t.options.section).addClass(t.options.classActiveName),s!==!1&&t.options.scrollDuration&&i&&!n&&e("body,html").animate({scrollTop:i.offset().top},t.options.scrollDuration,t.options.scrollEasing),t.$el.parents(".modal").size()!==0&&t.$el.trigger("resize.modal.patterns"),e(this).trigger("clicked")})}),t.$toc.find("a").first().trigger("click",!1)},getLevel:function(t){var n=0;return e.each(this.options.levels.split(","),function(e,r){if(t.filter(r).size()===1)return n=e+1,!1}),n}});return n}),function(e){typeof define=="function"&&define.amd?define("dropzone",["jquery"],e):e(jQuery)}(function(e){function n(e){if(e)return r(e)}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}var t={exports:{}};return t.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){function r(){n.off(e,r),t.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},r.fn=t,this.on(e,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;var r;for(var i=0;i<n.length;i++){r=n[i];if(r===t||r.fn===t){n.splice(i,1);break}}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length},function(){var r,i,s,o,u,a,f,l,c={}.hasOwnProperty,h=function(e,t){function r(){this.constructor=e}for(var n in t)c.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},p=[].slice;i=typeof n!="undefined"&&n!==null?n:require("emitter"),f=function(){},r=function(e){function n(e,r){var i,s,o;this.element=e,this.version=n.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],typeof this.element=="string"&&(this.element=document.querySelector(this.element));if(!this.element||this.element.nodeType==null)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");n.instances.push(this),this.element.dropzone=this,i=(o=n.optionsForElement(this.element))!=null?o:{},this.options=t({},this.defaultOptions,i,r!=null?r:{});if(this.options.forceFallback||!n.isBrowserSupported())return this.options.fallback.call(this);this.options.url==null&&(this.options.url=this.element.getAttribute("action"));if(!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(s=this.getExistingFallback())&&s.parentNode&&s.parentNode.removeChild(s),this.options.previewsContainer?this.previewsContainer=n.getElement(this.options.previewsContainer,"previewsContainer"):this.previewsContainer=this.element,this.options.clickable&&(this.options.clickable===!0?this.clickableElements=[this.element]:this.clickableElements=n.getElements(this.options.clickable,"clickable")),this.init()}var t;return h(n,e),n.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached"],n.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,maxFiles:null,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,addRemoveLinks:!1,previewsContainer:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(e,t){return t()},init:function(){return f},forceFallback:!1,fallback:function(){var e,t,r,i,s,o;this.element.className=""+this.element.className+" dz-browser-not-supported",o=this.element.getElementsByTagName("div");for(i=0,s=o.length;i<s;i++){e=o[i];if(/(^| )dz-message($| )/.test(e.className)){t=e,e.className="dz-message";continue}}return t||(t=n.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(t)),r=t.getElementsByTagName("span")[0],r&&(r.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(e){var t,n,r;return t={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},n=e.width/e.height,r=this.options.thumbnailWidth/this.options.thumbnailHeight,e.height<this.options.thumbnailHeight||e.width<this.options.thumbnailWidth?(t.trgHeight=t.srcHeight,t.trgWidth=t.srcWidth):n>r?(t.srcHeight=e.height,t.srcWidth=t.srcHeight*r):(t.srcWidth=e.width,t.srcHeight=t.srcWidth/r),t.srcX=(e.width-t.srcWidth)/2,t.srcY=(e.height-t.srcHeight)/2,t},drop:function(e){return this.element.classList.remove("dz-drag-hover")},dragstart:f,dragend:function(e){return this.element.classList.remove("dz-drag-hover")},dragenter:function(e){return this.element.classList.add("dz-drag-hover")},dragover:function(e){return this.element.classList.add("dz-drag-hover")},dragleave:function(e){return this.element.classList.remove("dz-drag-hover")},paste:f,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(e){var t,r,i,s,o,u,a,f,l,c,h,p,d,v=this;this.element===this.previewsContainer&&this.element.classList.add("dz-started"),e.previewElement=n.createElement(this.options.previewTemplate.trim()),e.previewTemplate=e.previewElement,this.previewsContainer.appendChild(e.previewElement),c=e.previewElement.querySelectorAll("[data-dz-name]");for(s=0,a=c.length;s<a;s++)t=c[s],t.textContent=e.name;h=e.previewElement.querySelectorAll("[data-dz-size]");for(o=0,f=h.length;o<f;o++)t=h[o],t.innerHTML=this.filesize(e.size);this.options.addRemoveLinks&&(e._removeLink=n.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),e.previewElement.appendChild(e._removeLink)),r=function(t){return t.preventDefault(),t.stopPropagation(),e.status===n.UPLOADING?n.confirm(v.options.dictCancelUploadConfirmation,function(){return v.removeFile(e)}):v.options.dictRemoveFileConfirmation?n.confirm(v.options.dictRemoveFileConfirmation,function(){return v.removeFile(e)}):v.removeFile(e)},p=e.previewElement.querySelectorAll("[data-dz-remove]"),d=[];for(u=0,l=p.length;u<l;u++)i=p[u],d.push(i.addEventListener("click",r));return d},removedfile:function(e){var t;return(t=e.previewElement)!=null&&t.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){var n,r,i,s,o;e.previewElement.classList.remove("dz-file-preview"),e.previewElement.classList.add("dz-image-preview"),s=e.previewElement.querySelectorAll("[data-dz-thumbnail]"),o=[];for(r=0,i=s.length;r<i;r++)n=s[r],n.alt=e.name,o.push(n.src=t);return o},error:function(e,t){var n,r,i,s,o;e.previewElement.classList.add("dz-error"),typeof t!="String"&&t.error&&(t=t.error),s=e.previewElement.querySelectorAll("[data-dz-errormessage]"),o=[];for(r=0,i=s.length;r<i;r++)n=s[r],o.push(n.textContent=t);return o},errormultiple:f,processing:function(e){e.previewElement.classList.add("dz-processing");if(e._removeLink)return e._removeLink.textContent=this.options.dictCancelUpload},processingmultiple:f,uploadprogress:function(e,t,n){var r,i,s,o,u;o=e.previewElement.querySelectorAll("[data-dz-uploadprogress]"),u=[];for(i=0,s=o.length;i<s;i++)r=o[i],u.push(r.style.width=""+t+"%");return u},totaluploadprogress:f,sending:f,sendingmultiple:f,success:function(e){return e.previewElement.classList.add("dz-success")},successmultiple:f,canceled:function(e){return this.emit("error",e,"Upload canceled.")},canceledmultiple:f,complete:function(e){if(e._removeLink)return e._removeLink.textContent=this.options.dictRemoveFile},completemultiple:f,maxfilesexceeded:f,maxfilesreached:f,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-details">\n    <div class="dz-filename"><span data-dz-name></span></div>\n    <div class="dz-size" data-dz-size></div>\n    <img data-dz-thumbnail />\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-success-mark"><span></span></div>\n  <div class="dz-error-mark"><span></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n</div>'},t=function(){var e,t,n,r,i,s,o;r=arguments[0],n=2<=arguments.length?p.call(arguments,1):[];for(s=0,o=n.length;s<o;s++){t=n[s];for(e in t)i=t[e],r[e]=i}return r},n.prototype.getAcceptedFiles=function(){var e,t,n,r,i;r=this.files,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],e.accepted&&i.push(e);return i},n.prototype.getRejectedFiles=function(){var e,t,n,r,i;r=this.files,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],e.accepted||i.push(e);return i},n.prototype.getQueuedFiles=function(){var e,t,r,i,s;i=this.files,s=[];for(t=0,r=i.length;t<r;t++)e=i[t],e.status===n.QUEUED&&s.push(e);return s},n.prototype.getUploadingFiles=function(){var e,t,r,i,s;i=this.files,s=[];for(t=0,r=i.length;t<r;t++)e=i[t],e.status===n.UPLOADING&&s.push(e);return s},n.prototype.init=function(){var e,t,r,i,s,o,u,a=this;this.element.tagName==="form"&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(n.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(r=function(){return a.hiddenFileInput&&document.body.removeChild(a.hiddenFileInput),a.hiddenFileInput=document.createElement("input"),a.hiddenFileInput.setAttribute("type","file"),(a.options.maxFiles==null||a.options.maxFiles>1)&&a.hiddenFileInput.setAttribute("multiple","multiple"),a.options.acceptedFiles!=null&&a.hiddenFileInput.setAttribute("accept",a.options.acceptedFiles),a.hiddenFileInput.style.visibility="hidden",a.hiddenFileInput.style.position="absolute",a.hiddenFileInput.style.top="0",a.hiddenFileInput.style.left="0",a.hiddenFileInput.style.height="0",a.hiddenFileInput.style.width="0",document.body.appendChild(a.hiddenFileInput),a.hiddenFileInput.addEventListener("change",function(){var e,t,n,i;t=a.hiddenFileInput.files;if(t.length)for(n=0,i=t.length;n<i;n++)e=t[n],a.addFile(e);return r()})},r()),this.URL=(o=window.URL)!=null?o:window.webkitURL,u=this.events;for(i=0,s=u.length;i<s;i++)e=u[i],this.on(e,this.options[e]);return this.on("uploadprogress",function(){return a.updateTotalUploadProgress()}),this.on("removedfile",function(){return a.updateTotalUploadProgress()}),this.on("canceled",function(e){return a.emit("complete",e)}),this.on("complete",function(e){if(a.getUploadingFiles().length===0&&a.getQueuedFiles().length===0)return setTimeout(function(){return a.emit("queuecomplete")},0)}),t=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(e){return a.emit("dragstart",e)},dragenter:function(e){return t(e),a.emit("dragenter",e)},dragover:function(e){var n;try{n=e.dataTransfer.effectAllowed}catch(r){}return e.dataTransfer.dropEffect="move"===n||"linkMove"===n?"move":"copy",t(e),a.emit("dragover",e)},dragleave:function(e){return a.emit("dragleave",e)},drop:function(e){return t(e),a.drop(e)},dragend:function(e){return a.emit("dragend",e)},paste:function(e){return t(e),a.paste(e)}}}],this.clickableElements.forEach(function(e){return a.listeners.push({element:e,events:{click:function(t){if(e!==a.element||t.target===a.element||n.elementInside(t.target,a.element.querySelector(".dz-message")))return a.hiddenFileInput.click()}}})}),this.enable(),this.options.init.call(this)},n.prototype.destroy=function(){var e;this.disable(),this.removeAllFiles(!0);if((e=this.hiddenFileInput)!=null?e.parentNode:void 0)this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null;return delete this.element.dropzone,n.instances.splice(n.instances.indexOf(this),1)},n.prototype.updateTotalUploadProgress=function(){var e,t,n,r,i,s,o,u;r=0,n=0,e=this.getAcceptedFiles();if(e.length){u=this.getAcceptedFiles();for(s=0,o=u.length;s<o;s++)t=u[s],r+=t.upload.bytesSent,n+=t.upload.total;i=100*r/n}else i=100;return this.emit("totaluploadprogress",i,n,r)},n.prototype.getFallbackForm=function(){var e,t,r,i;return(e=this.getExistingFallback())?e:(r='<div class="dz-fallback">',this.options.dictFallbackText&&(r+="<p>"+this.options.dictFallbackText+"</p>"),r+='<input type="file" name="'+this.options.paramName+(this.options.uploadMultiple?"[]":"")+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',t=n.createElement(r),this.element.tagName!=="FORM"?(i=n.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),i.appendChild(t)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),i!=null?i:t)},n.prototype.getExistingFallback=function(){var e,t,n,r,i,s;t=function(e){var t,n,r;for(n=0,r=e.length;n<r;n++){t=e[n];if(/(^| )fallback($| )/.test(t.className))return t}},s=["div","form"];for(r=0,i=s.length;r<i;r++){n=s[r];if(e=t(this.element.getElementsByTagName(n)))return e}},n.prototype.setupEventListeners=function(){var e,t,n,r,i,s,o;s=this.listeners,o=[];for(r=0,i=s.length;r<i;r++)e=s[r],o.push(function(){var r,i;r=e.events,i=[];for(t in r)n=r[t],i.push(e.element.addEventListener(t,n,!1));return i}());return o},n.prototype.removeEventListeners=function(){var e,t,n,r,i,s,o;s=this.listeners,o=[];for(r=0,i=s.length;r<i;r++)e=s[r],o.push(function(){var r,i;r=e.events,i=[];for(t in r)n=r[t],i.push(e.element.removeEventListener(t,n,!1));return i}());return o},n.prototype.disable=function(){var e,t,n,r,i;this.clickableElements.forEach(function(e){return e.classList.remove("dz-clickable")}),this.removeEventListeners(),r=this.files,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.cancelUpload(e));return i},n.prototype.enable=function(){return this.clickableElements.forEach(function(e){return e.classList.add("dz-clickable")}),this.setupEventListeners()},n.prototype.filesize=function(e){var t;return e>=109951162777.6?(e/=109951162777.6,t="TiB"):e>=107374182.4?(e/=107374182.4,t="GiB"):e>=104857.6?(e/=104857.6,t="MiB"):e>=102.4?(e/=102.4,t="KiB"):(e*=10,t="b"),"<strong>"+Math.round(e)/10+"</strong> "+t},n.prototype._updateMaxFilesReachedClass=function(){return this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},n.prototype.drop=function(e){var t,n;if(!e.dataTransfer)return;this.emit("drop",e),t=e.dataTransfer.files,t.length&&(n=e.dataTransfer.items,n&&n.length&&n[0].webkitGetAsEntry!=null?this._addFilesFromItems(n):this.handleFiles(t))},n.prototype.paste=function(e){var t,n;return},n.prototype.handleFiles=function(e){var t,n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(this.addFile(t));return i},n.prototype._addFilesFromItems=function(e){var t,n,r,i,s;s=[];for(r=0,i=e.length;r<i;r++)n=e[r],n.webkitGetAsEntry!=null&&(t=n.webkitGetAsEntry())?t.isFile?s.push(this.addFile(n.getAsFile())):t.isDirectory?s.push(this._addFilesFromDirectory(t,t.name)):s.push(void 0):n.getAsFile!=null?n.kind==null||n.kind==="file"?s.push(this.addFile(n.getAsFile())):s.push(void 0):s.push(void 0);return s},n.prototype._addFilesFromDirectory=function(e,t){var n,r,i=this;return n=e.createReader(),r=function(e){var n,r,s;for(r=0,s=e.length;r<s;r++)n=e[r],n.isFile?n.file(function(e){if(i.options.ignoreHiddenFiles&&e.name.substring(0,1)===".")return;return e.fullPath=""+t+"/"+e.name,i.addFile(e)}):n.isDirectory&&i._addFilesFromDirectory(n,""+t+"/"+n.name)},n.readEntries(r,function(e){return typeof console!="undefined"&&console!==null?typeof console.log=="function"?console.log(e):void 0:void 0})},n.prototype.accept=function(e,t){return e.size>this.options.maxFilesize*1024*1024?t(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(e.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):n.isValidFile(e,this.options.acceptedFiles)?this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles?(t(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",e)):this.options.accept.call(this,e,t):t(this.options.dictInvalidFileType)},n.prototype.addFile=function(e){var t=this;return e.upload={progress:0,total:e.size,bytesSent:0},this.files.push(e),e.status=n.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,function(n){return n?(e.accepted=!1,t._errorProcessing([e],n)):t.enqueueFile(e),t._updateMaxFilesReachedClass()})},n.prototype.enqueueFiles=function(e){var t,n,r;for(n=0,r=e.length;n<r;n++)t=e[n],this.enqueueFile(t);return null},n.prototype.enqueueFile=function(e){var t=this;e.accepted=!0;if(e.status!==n.ADDED)throw new Error("This file can't be queued because it has already been processed or was rejected.");e.status=n.QUEUED;if(this.options.autoProcessQueue)return setTimeout(function(){return t.processQueue()},0)},n.prototype._thumbnailQueue=[],n.prototype._processingThumbnail=!1,n.prototype._enqueueThumbnail=function(e){var t=this;if(this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=this.options.maxThumbnailFilesize*1024*1024)return this._thumbnailQueue.push(e),setTimeout(function(){return t._processThumbnailQueue()},0)},n.prototype._processThumbnailQueue=function(){var e=this;if(this._processingThumbnail||this._thumbnailQueue.length===0)return;return this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(){return e._processingThumbnail=!1,e._processThumbnailQueue()})},n.prototype.removeFile=function(e){e.status===n.UPLOADING&&this.cancelUpload(e),this.files=l(this.files,e),this.emit("removedfile",e);if(this.files.length===0)return this.emit("reset")},n.prototype.removeAllFiles=function(e){var t,r,i,s;e==null&&(e=!1),s=this.files.slice();for(r=0,i=s.length;r<i;r++)t=s[r],(t.status!==n.UPLOADING||e)&&this.removeFile(t);return null},n.prototype.createThumbnail=function(e,t){var n,r=this;return n=new FileReader,n.onload=function(){var i;return i=document.createElement("img"),i.onload=function(){var n,s,o,u,f,l,c,h;e.width=i.width,e.height=i.height,o=r.options.resize.call(r,e),o.trgWidth==null&&(o.trgWidth=r.options.thumbnailWidth),o.trgHeight==null&&(o.trgHeight=r.options.thumbnailHeight),n=document.createElement("canvas"),s=n.getContext("2d"),n.width=o.trgWidth,n.height=o.trgHeight,a(s,i,(f=o.srcX)!=null?f:0,(l=o.srcY)!=null?l:0,o.srcWidth,o.srcHeight,(c=o.trgX)!=null?c:0,(h=o.trgY)!=null?h:0,o.trgWidth,o.trgHeight),u=n.toDataURL("image/png"),r.emit("thumbnail",e,u);if(t!=null)return t()},i.src=n.result},n.readAsDataURL(e)},n.prototype.processQueue=function(){var e,t,n,r;t=this.options.parallelUploads,n=this.getUploadingFiles().length,e=n;if(n>=t)return;r=this.getQueuedFiles();if(!(r.length>0))return;if(this.options.uploadMultiple)return this.processFiles(r.slice(0,t-n));while(e<t){if(!r.length)return;this.processFile(r.shift()),e++}},n.prototype.processFile=function(e){return this.processFiles([e])},n.prototype.processFiles=function(e){var t,r,i;for(r=0,i=e.length;r<i;r++)t=e[r],t.processing=!0,t.status=n.UPLOADING,this.emit("processing",t);return this.options.uploadMultiple&&this.emit("processingmultiple",e),this.uploadFiles(e)},n.prototype._getFilesWithXhr=function(e){var t,n;return n=function(){var n,r,i,s;i=this.files,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],t.xhr===e&&s.push(t);return s}.call(this)},n.prototype.cancelUpload=function(e){var t,r,i,s,o,u,a;if(e.status===n.UPLOADING){r=this._getFilesWithXhr(e.xhr);for(i=0,o=r.length;i<o;i++)t=r[i],t.status=n.CANCELED;e.xhr.abort();for(s=0,u=r.length;s<u;s++)t=r[s],this.emit("canceled",t);this.options.uploadMultiple&&this.emit("canceledmultiple",r)}else if((a=e.status)===n.ADDED||a===n.QUEUED)e.status=n.CANCELED,this.emit("canceled",e),this.options.uploadMultiple&&this.emit("canceledmultiple",[e]);if(this.options.autoProcessQueue)return this.processQueue()},n.prototype.uploadFile=function(e){return this.uploadFiles([e])},n.prototype.uploadFiles=function(e){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P=this;y=new XMLHttpRequest;for(b=0,x=e.length;b<x;b++)r=e[b],r.xhr=y;y.open(this.options.method,this.options.url,!0),y.withCredentials=!!this.options.withCredentials,v=null,s=function(){var t,n,i;i=[];for(t=0,n=e.length;t<n;t++)r=e[t],i.push(P._errorProcessing(e,v||P.options.dictResponseError.replace("{{statusCode}}",y.status),y));return i},m=function(t){var n,i,s,o,u,a,f,l,c;if(t!=null){i=100*t.loaded/t.total;for(s=0,a=e.length;s<a;s++)r=e[s],r.upload={progress:i,total:t.total,bytesSent:t.loaded}}else{n=!0,i=100;for(o=0,f=e.length;o<f;o++){r=e[o];if(r.upload.progress!==100||r.upload.bytesSent!==r.upload.total)n=!1;r.upload.progress=i,r.upload.bytesSent=r.upload.total}if(n)return}c=[];for(u=0,l=e.length;u<l;u++)r=e[u],c.push(P.emit("uploadprogress",r,i,r.upload.bytesSent));return c},y.onload=function(t){var r;if(e[0].status===n.CANCELED)return;if(y.readyState!==4)return;v=y.responseText;if(y.getResponseHeader("content-type")&&~y.getResponseHeader("content-type").indexOf("application/json"))try{v=JSON.parse(v)}catch(i){t=i,v="Invalid JSON response from server."}return m(),200<=(r=y.status)&&r<300?P._finished(e,v,t):s()},y.onerror=function(){if(e[0].status===n.CANCELED)return;return s()},d=(A=y.upload)!=null?A:y,d.onprogress=m,a={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&t(a,this.options.headers);for(o in a)u=a[o],y.setRequestHeader(o,u);i=new FormData;if(this.options.params){O=this.options.params;for(h in O)g=O[h],i.append(h,g)}for(w=0,T=e.length;w<T;w++)r=e[w],this.emit("sending",r,y,i);this.options.uploadMultiple&&this.emit("sendingmultiple",e,y,i);if(this.element.tagName==="FORM"){M=this.element.querySelectorAll("input, textarea, select, button");for(E=0,N=M.length;E<N;E++){f=M[E],l=f.getAttribute("name"),c=f.getAttribute("type");if(f.tagName==="SELECT"&&f.hasAttribute("multiple")){_=f.options;for(S=0,C=_.length;S<C;S++)p=_[S],p.selected&&i.append(l,p.value)}else(!c||(D=c.toLowerCase())!=="checkbox"&&D!=="radio"||f.checked)&&i.append(l,f.value)}}for(L=0,k=e.length;L<k;L++)r=e[L],i.append(""+this.options.paramName+(this.options.uploadMultiple?"[]":""),r,r.name);return y.send(i)},n.prototype._finished=function(e,t,r){var i,s,o;for(s=0,o=e.length;s<o;s++)i=e[s],i.status=n.SUCCESS,this.emit("success",i,t,r),this.emit("complete",i);this.options.uploadMultiple&&(this.emit("successmultiple",e,t,r),this.emit("completemultiple",e));if(this.options.autoProcessQueue)return this.processQueue()},n.prototype._errorProcessing=function(e,t,r){var i,s,o;for(s=0,o=e.length;s<o;s++)i=e[s],i.status=n.ERROR,this.emit("error",i,t,r),this.emit("complete",i);this.options.uploadMultiple&&(this.emit("errormultiple",e,t,r),this.emit("completemultiple",e));if(this.options.autoProcessQueue)return this.processQueue()},n}(i),r.version="3.8.3",r.options={},r.optionsForElement=function(e){return e.getAttribute("id")?r.options[s(e.getAttribute("id"))]:void 0},r.instances=[],r.forElement=function(e){typeof e=="string"&&(e=document.querySelector(e));if((e!=null?e.dropzone:void 0)==null)throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return e.dropzone},r.autoDiscover=!0,r.discover=function(){var e,t,n,i,s,o;document.querySelectorAll?n=document.querySelectorAll(".dropzone"):(n=[],e=function(e){var t,r,i,s;s=[];for(r=0,i=e.length;r<i;r++)t=e[r],/(^| )dropzone($| )/.test(t.className)?s.push(n.push(t)):s.push(void 0);return s},e(document.getElementsByTagName("div")),e(document.getElementsByTagName("form"))),o=[];for(i=0,s=n.length;i<s;i++)t=n[i],r.optionsForElement(t)!==!1?o.push(new r(t)):o.push(void 0);return o},r.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],r.isBrowserSupported=function(){var e,t,n,i,s;e=!0;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a")){s=r.blacklistedBrowsers;for(n=0,i=s.length;n<i;n++){t=s[n];if(t.test(navigator.userAgent)){e=!1;continue}}}else e=!1;else e=!1;return e},l=function(e,t){var n,r,i,s;s=[];for(r=0,i=e.length;r<i;r++)n=e[r],n!==t&&s.push(n);return s},s=function(e){return e.replace(/[\-_](\w)/g,function(e){return e[1].toUpperCase()})},r.createElement=function(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.childNodes[0]},r.elementInside=function(e,t){if(e===t)return!0;while(e=e.parentNode)if(e===t)return!0;return!1},r.getElement=function(e,t){var n;typeof e=="string"?n=document.querySelector(e):e.nodeType!=null&&(n=e);if(n==null)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector or a plain HTML element.");return n},r.getElements=function(e,t){var n,r,i,s,o,u,a,f;if(e instanceof Array){i=[];try{for(s=0,u=e.length;s<u;s++)r=e[s],i.push(this.getElement(r,t))}catch(l){n=l,i=null}}else if(typeof e=="string"){i=[],f=document.querySelectorAll(e);for(o=0,a=f.length;o<a;o++)r=f[o],i.push(r)}else e.nodeType!=null&&(i=[e]);if(i==null||!i.length)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return i},r.confirm=function(e,t,n){if(window.confirm(e))return t();if(n!=null)return n()},r.isValidFile=function(e,t){var n,r,i,s,o;if(!t)return!0;t=t.split(","),r=e.type,n=r.replace(/\/.*$/,"");for(s=0,o=t.length;s<o;s++){i=t[s],i=i.trim();if(i.charAt(0)==="."){if(e.name.toLowerCase().indexOf(i.toLowerCase(),e.name.length-i.length)!==-1)return!0}else if(/\/\*$/.test(i)){if(n===i.replace(/\/.*$/,""))return!0}else if(r===i)return!0}return!1},typeof e!="undefined"&&e!==null&&(e.fn.dropzone=function(e){return this.each(function(){return new r(this,e)})}),typeof t!="undefined"&&t!==null?t.exports=r:window.Dropzone=r,r.ADDED="added",r.QUEUED="queued",r.ACCEPTED=r.QUEUED,r.UPLOADING="uploading",r.PROCESSING=r.UPLOADING,r.CANCELED="canceled",r.ERROR="error",r.SUCCESS="success",u=function(e){var t,n,r,i,s,o,u,a,f,l;u=e.naturalWidth,o=e.naturalHeight,n=document.createElement("canvas"),n.width=1,n.height=o,r=n.getContext("2d"),r.drawImage(e,0,0),i=r.getImageData(0,0,1,o).data,l=0,s=o,a=o;while(a>l)t=i[(a-1)*4+3],t===0?s=a:l=a,a=s+l>>1;return f=a/o,f===0?1:f},a=function(e,t,n,r,i,s,o,a,f,l){var c;return c=u(t),e.drawImage(t,n,r,i,s,o,a,f,l/c)},o=function(e,t){var n,r,i,s,o,u,a,f,l;i=!1,l=!0,r=e.document,f=r.documentElement,n=r.addEventListener?"addEventListener":"attachEvent",a=r.addEventListener?"removeEventListener":"detachEvent",u=r.addEventListener?"":"on",s=function(n){if(n.type==="readystatechange"&&r.readyState!=="complete")return;(n.type==="load"?e:r)[a](u+n.type,s,!1);if(!i&&(i=!0))return t.call(e,n.type||n)},o=function(){var e;try{f.doScroll("left")}catch(t){e=t,setTimeout(o,50);return}return s("poll")};if(r.readyState!=="complete"){if(r.createEventObject&&f.doScroll){try{l=!e.frameElement}catch(c){}l&&o()}return r[n](u+"DOMContentLoaded",s,!1),r[n](u+"readystatechange",s,!1),e[n](u+"load",s,!1)}},r._autoDiscoverFunction=function(){if(r.autoDiscover)return r.discover()},o(window,r._autoDiscoverFunction)}.call(this),t.exports}),define("mockup-patterns-dropzone",["jquery","mockup-patterns-base","dropzone","underscore"],function(e,t,n,r){n.autoDiscover=!1;var i=t.extend({name:"dropzone",defaults:{url:null,className:"dropzone",paramName:"file",uploadMultiple:!1,clickable:!1,wrap:!1,addRemoveLinks:!1,wrapperTemplate:'<div class="dropzone-container"/>',autoCleanResults:!1,previewsContainer:".dropzone-previews",previewsTemplate:'<div class="dropzone-previews"></div>',fileaddedClassName:"dropping",useTus:!1,maxFilesize:99999999},init:function(){function c(){l=!0;if(t.dropzone.files.length===0){l=!1,t.$dropzone.removeClass(o);return}var r=t.dropzone.files[0],i=e(r.previewElement);if([n.SUCCESS,n.ERROR,n.CANCELED].indexOf(r.status)!==-1)t.dropzone.removeFile(r),c();else if(r.status!==n.UPLOADING){if(u&&window.tus){var s=i.find("[data-dz-uploadprogress]");r.status=n.UPLOADING,window.tus.upload(r,{endpoint:t.options.url,headers:{FILENAME:r.name},chunkSize:5242880}).fail(function(){alert("Error uploading with TUS resumable uploads"),r.status=n.ERROR}).progress(function(e,n,r){var o=n/r*100;s.css("width",o+"%"),s.parent().css("display","block");var u=i.find(".dz-size");u.html("uploading...<br />"+t.formatBytes(n)+" / "+t.formatBytes(r))}).done(function(e,r){r.status=n.SUCCESS,t.dropzone.emit("success",r),t.dropzone.emit("complete",r)})}else t.dropzone.processFile(r);setTimeout(c,100)}else setTimeout(c,100)}var t=this;typeof t.options.clickable=="string"&&(t.options.clickable==="true"?t.options.clickable=!0:t.options.clickable=!1);if(!t.options.url&&t.$el[0].tagName==="FORM"){var r=t.$el.attr("action");r||(r=window.location.href),t.options.url=r}var i=t.$el;t.options.wrap&&(t.options.wrap==="inner"?(i.wrapInner(t.options.wrapperTemplate),i=i.children().eq(0)):(i.wrap(t.options.wrapperTemplate),i=i.parent())),i.append('<div class="dz-notice"><p>Drop files here...</p></div>'),t.options.previewsContainer===".dropzone-previews"&&i.append(t.options.previewsTemplate);var s=t.options.autoCleanResults;i.addClass(t.options.className);var o=t.options.fileaddedClassName,u=t.options.useTus,a=e.extend({},t.options);delete a.wrap,delete a.wrapperTemplate,delete a.resultTemplate,delete a.autoCleanResults,delete a.previewsTemplate,delete a.fileaddedClassName,delete a.useTus;if(t.options.previewsContainer){var f=i.find(t.options.previewsContainer);f.length>0&&(a.previewsContainer=f[0])}a.autoProcessQueue=!1,t.dropzone=new n(i[0],a),t.$dropzone=i,s&&t.dropzone.on("complete",function(t){setTimeout(function(){e(t.previewElement).fadeOut()},3e3)});var l=!1;t.dropzone.on("addedfile",function(){t.$dropzone.addClass(o),setTimeout(function(){l||c()},100)})},formatBytes:function(e){var t=Math.round(e/1024);if(t<1024)return t+" KiB";var n=Math.round(t/1024);return n<1024?n+" MB":Math.round(n/1024)+" GB"}});return i}),define("text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.10",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}d.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!js/patterns/tinymce/templates/result.xml",[],function(){return'<div class="pattern-relateditems-result pattern-relateditems-type-<%= Type %> <% if (selected) { %>pattern-active<% } %>">\n  <a href="#" class="pattern-relateditems-result-select <% if (selectable) { %>selectable<% } %>">\n    <% if (!folderish) { %>\n    <span class="pattern-relateditems-result-image">\n      <img src="<%= generateImageUrl(_item, \'thumb\') %>" />\n    </span>\n    <% } %>\n    <span class="pattern-relateditems-result-title"><%= Title %></span>\n    <span class="pattern-relateditems-result-path"><%= path %></span>\n  </a>\n  <span class="pattern-relateditems-buttons">\n    <% if (folderish) { %>\n      <a class="pattern-relateditems-result-browse" href="#" data-path="<%= path %>"></a>\n    <% } %>\n  </span>\n</div>\n'}),define("text!js/patterns/tinymce/templates/selection.xml",[],function(){return'<span class="pattern-relateditems-item pattern-relateditems-type-<%= Type %>">\n <span class="pattern-relateditems-result-image">\n   <img src="<%= generateImageUrl(_item, \'thumb\') %>" />\n </span>\n <span class="pattern-relateditems-item-title"><%= Title %></span>\n <span class="pattern-relateditems-item-path"><%= path %></span>\n</span>\'\n'}),define("text!js/patterns/tinymce/templates/link.xml",[],function(){return'<div>\n  <div class="linkModal">\n    <h1><%- insertHeading %></h1>\n    <p class="info">Drag and drop files from your desktop onto dialog to upload</p>\n\n    <div class="linkTypes pat-autotoc autotabs"\n         data-pat-autotoc="section:fieldset;levels:legend;">\n\n      <fieldset class="linkType internal">\n        <legend>Internal</legend>\n        <div>\n          <div class="form-group main">\n            <input type="text" name="internal" />\n          </div>\n        </div>\n      </fieldset>\n\n      <fieldset class="linkType external">\n        <legend>External</legend>\n        <div class="form-group main">\n          <label for="external"><%- externalText %></label>\n          <input type="text" name="external" />\n        </div>\n      </fieldset>\n\n      <fieldset class="linkType email">\n        <legend>Email</legend>\n        <div class="form-inline">\n          <div class="form-group main">\n            <label><%- emailText %></label>\n            <input type="text" name="email" />\n          </div>\n          <div class="form-group">\n            <label><%- subjectText %></label>\n            <input type="text" name="subject" />\n          </div>\n        </div>\n      </fieldset>\n\n      <fieldset class="linkType anchor">\n        <legend>Anchor</legend>\n        <div>\n          <div class="form-group main">\n            <label>Select an anchor</label>\n            <div class="input-wrapper">\n              <select name="anchor" class="pat-select2" data-pat-select2="width:500px" />\n            </div>\n          </div>\n        </div>\n      </fieldset>\n\n    </div><!-- / tabs -->\n\n    <div class="common-controls">\n      <div class="form-group">\n        <label>Target</label>\n        <select name="target">\n          <% _.each(targetList, function(target){ %>\n            <option value="<%- target.value %>"><%- target.text %></option>\n          <% }); %>\n        </select>\n      </div>\n      <div class="form-group">\n        <label><%- titleText %></label>\n        <input type="text" name="title" />\n      </div>\n    </div>\n\n    <input type="submit" class="btn" name="cancel" value="<%- cancelBtn %>" />\n    <input type="submit" class="btn btn-primary" name="insert" value="<%- insertBtn %>" />\n  </div>\n</div>\n'}),define("text!js/patterns/tinymce/templates/image.xml",[],function(){return'<div>\n  <div class="linkModal">\n    <h1><%- insertHeading %></h1>\n    <p class="info">Drag and drop files from your desktop onto dialog to upload</p>\n\n    <div class="linkTypes pat-autotoc autotabs"\n         data-pat-autotoc="section:fieldset;levels:legend;">\n\n      <fieldset class="linkType image">\n        <legend>Image</legend>\n        <div class="form-inline">\n          <div class="form-group main">\n            <input type="text" name="image" />\n          </div>\n          <div class="form-group scale">\n            <label><%- scaleText %></label>\n            <select name="scale">\n              <option value="">Original</option>\n                <% _.each(scales.split(\',\'), function(scale){ %>\n                  <% var scale = scale.split(\':\'); %>\n                  <option value="<%- scale[1] %>">\n                    <%- scale[0] %>\n                  </option>\n                <% }); %>\n            </select>\n          </div>\n        </div>\n      </fieldset>\n\n      <fieldset class="linkType externalImage">\n        <legend>External image</legend>\n        <div>\n          <div class="form-group main">\n            <label><%- externalImageText %></label>\n            <input type="text" name="externalImage" />\n          </div>\n        </div>\n      </fieldset>\n\n    </div><!-- / tabs -->\n\n    <div class="common-controls">\n      <div class="form-group title">\n        <label><%- titleText %></label>\n        <input type="text" name="title" />\n      </div>\n      <div class="form-group text">\n        <label><%- altText %></label>\n        <input type="text" name="alt" />\n      </div>\n      <div class="form-group align">\n        <label><%- imageAlignText %></label>\n        <select name="align">\n          <% _.each([\'inline\', \'right\', \'left\'], function(align){ %>\n              <option value="<%- align %>">\n              <%- align.charAt(0).toUpperCase() + align.slice(1) %>\n              </option>\n          <% }); %>\n        <select>\n      </div>\n    </div>\n\n    <input type="submit" class="btn" name="cancel" value="<%- cancelBtn %>" />\n    <input type="submit" class="btn btn-primary" name="insert" value="<%- insertBtn %>" />\n\n  </div>\n</div>\n'}),define("js/patterns/tinymce/links",["jquery","underscore","mockup-patterns-base","mockup-patterns-relateditems","mockup-patterns-modal","tinymce","mockup-patterns-dropzone","text!js/patterns/tinymce/templates/link.xml","text!js/patterns/tinymce/templates/image.xml"],function(e,t,n,r,i,s,o,u,a){var f=n.extend({defaults:{linkModal:null},init:function(){this.linkModal=this.options.linkModal,this.tinypattern=this.options.tinypattern,this.tiny=this.tinypattern.tiny,this.dom=this.tiny.dom,this.$input=this.$el.find("input")},value:function(){return this.$input.val()},toUrl:function(){return this.value()},load:function(e){this.$input.attr("value",this.tiny.dom.getAttrib(e,"data-val"))},set:function(e){this.$input.attr("value",e)},attributes:function(){return{"data-val":this.value()}}}),l=f.extend({init:function(){var e=this;f.prototype.init.call(e),e.$input.addClass("pat-relateditems"),e.createRelatedItems()},createRelatedItems:function(){this.relatedItems=new r(this.$input,this.linkModal.options.relatedItems)},value:function(){var e=this,t=e.$input.select2("data");return t&&typeof t=="object"&&(t=t[0]),t},toUrl:function(){var e=this.value();return e?this.tinypattern.generateUrl(e):null},load:function(e){var t=this.tiny.dom.getAttrib(e,"data-val");t&&this.set(t)},set:function(e){this.$input.select2("destroy"),this.$input.attr("data-relateditems",undefined),this.$input.parent().replaceWith(this.$input),this.$input.attr("value",e),this.createRelatedItems()},attributes:function(){var e=this.value();return e?{"data-val":e.UID}:{}}}),c=l.extend({toUrl:function(){var e=this.value();return this.tinypattern.generateImageUrl(e,this.linkModal.$scale.val())}}),h=f.extend({toUrl:function(){var e=this,t=e.value();if(t){var n=e.getSubject(),r="mailto:"+t;return n&&(r+="?subject="+n),r}return null},load:function(e){f.prototype.load.apply(this,[e]),this.linkModal.$subject.val(this.tiny.dom.getAttrib(e,"data-subject"))},getSubject:function(){return this.linkModal.$subject.val()},attributes:function(){var e=f.prototype.attributes.call(this);return e["data-subject"]=this.getSubject(),e}}),p=f.extend({init:function(){var e=this;f.prototype.init.call(e),e.$select=e.$el.find("select"),e.anchorNodes=[],e.anchorData=[],e.populate()},value:function(){var e=this,t=e.$select.select2("data");return t&&typeof t=="object"&&(t=t[0]),t},populate:function(){var t=this;t.$select.find("option").remove(),t.anchorNodes=[],t.anchorData=[];var n,r,i,s,o=t.tiny.dom.select("a.mceItemAnchor,img.mceItemAnchor,a.mce-item-anchor,img.mce-item-anchor");for(r=0;r<o.length;r+=1)n=o[r],i=t.tiny.dom.getAttrib(n,"name"),i||(i=t.tiny.dom.getAttrib(n,"id")),i!==""&&(t.anchorNodes.push(n),t.anchorData.push({name:i,title:i}));o=t.tiny.dom.select(t.linkModal.options.anchorSelector);if(o.length>0)for(r=0;r<o.length;r+=1){n=o[r],s=e(n).text().replace(/^\s+|\s+$/g,"");if(s==="")continue;i=s.toLowerCase().substring(0,1024),i=i.replace(/[^a-z0-9]/g,"-");var u=!1;for(r=0;r<t.anchorNodes.length;r+=1){var a=t.anchorData[r];if(a.name===i){u=!0,a.title=s;break}}u||(t.anchorData.push({name:i,title:s,newAnchor:!0}),t.anchorNodes.push(n))}if(t.anchorNodes.length>0)for(r=0;r<t.anchorData.length;r+=1){var f=t.anchorData[r];t.$select.append("<option value='"+r+"'>"+f.title+"</option>")}else t.$select.append("<option>No anchors found..</option>")},getIndex:function(e){var t=this;for(var n=0;n<t.anchorData.length;n+=1){var r=t.anchorData[n];if(r.name===e)return n}return 0},toUrl:function(){var e=this,t=e.value();if(t){var n=parseInt(t,10),r=e.anchorNodes[n],i=e.anchorData[n];return i.newAnchor&&(r.innerHTML='<a name="'+i.name+'" class="mce-item-anchor"></a>'+r.innerHTML),"#"+i.name}return null},set:function(e){var t=this.getIndex(e);this.$select.select2("data",""+t)}});s.PluginManager.add("plonelink",function(e){e.addButton("plonelink",{icon:"link",tooltip:"Insert/edit link",shortcut:"Ctrl+K",onclick:e.settings.addLinkClicked,stateSelector:"a[href]"}),e.addButton("unlink",{icon:"unlink",tooltip:"Remove link(s)",cmd:"unlink",stateSelector:"a[href]"}),e.addShortcut("Ctrl+K","",e.settings.addLinkClicked),e.addMenuItem("plonelink",{icon:"link",text:"Insert link",shortcut:"Ctrl+K",onclick:e.settings.addLinkClicked,stateSelector:"a[href]",context:"insert",prependToContext:!0})});var d=n.extend({name:"linkmodal",defaults:{anchorSelector:"h1,h2,h3",linkTypes:[],initialLinkType:"internal",text:{insertHeading:"Insert Link"},linkTypeClassMapping:{internal:l,external:f,email:h,anchor:p,image:c,externalImage:f}},linkTypeTemplateMapping:{internal:u,external:u,email:u,anchor:u,image:a,externalImage:a},template:function(e){return t.template(this.linkTypeTemplateMapping[this.linkType])(e)},init:function(){var e=this;e.tinypattern=e.options.tinypattern,e.tinypattern.options.anchorSelector&&(e.options.anchorSelector=e.tinypattern.options.anchorSelector),e.tiny=e.tinypattern.tiny,e.dom=e.tiny.dom,e.linkType=e.options.initialLinkType,e.linkTypes={},e.modal=new i(e.$el,{html:e.generateModalHtml(),content:null,buttons:".btn"}),e.modal.on("shown",function(t){e.modalShown.apply(e,[t])})},generateModalHtml:function(){var e=this;return e.template({text:e.options.text,insertHeading:e.options.text.insertHeading,linkTypes:e.options.linkTypes,externalText:e.options.text.external,emailText:e.options.text.email,subjectText:e.options.text.subject,targetList:e.options.targetList,titleText:e.options.text.title,externalImageText:e.options.text.externalImage,altText:e.options.text.alt,imageAlignText:e.options.text.imageAlign,scaleText:e.options.text.scale,scales:e.options.scales,cancelBtn:e.options.text.cancelBtn,insertBtn:e.options.text.insertBtn})},isImageMode:function(){return["image","externalImage"].indexOf(this.linkType)!==-1},initElements:function(){var n=this;n.$target=e('select[name="target"]',n.modal.$modal),n.$button=e('.modal-footer input[name="insert"]',n.modal.$modal),n.$title=e('input[name="title"]',n.modal.$modal),n.$subject=e('input[name="subject"]',n.modal.$modal),n.$alt=e('input[name="alt"]',n.modal.$modal),n.$align=e('select[name="align"]',n.modal.$modal),n.$scale=e('select[name="scale"]',n.modal.$modal),t.each(n.options.linkTypes,function(t){var r=e(".linkType."+t+" .main",n.modal.$modal);n.linkTypes[t]=new n.options.linkTypeClassMapping[t](r,{linkModal:n,tinypattern:n.tinypattern})}),n.$linkTypes=e(".linkTypes",n.modal.$modal);var r=n.$linkTypes.find('input[value="'+n.linkType+'"]');r.length>0&&(r[0].checked=!0)},getLinkUrl:function(){var e=this;return e.linkTypes[e.linkType].toUrl()},getValue:function(){return this.linkTypes[this.linkType].value()},updateAnchor:function(t){var n=this,r=n.$target.val(),i=n.$title.val(),s=e.extend(!0,{},{title:i?i:null,target:r?r:null,"data-linkType":n.linkType,href:t},n.linkTypes[n.linkType].attributes());n.tiny.execCommand("mceInsertLink",!1,s)},focusElement:function(e){var t=this;t.tiny.focus(),t.tiny.selection.select(e),t.tiny.nodeChanged()},updateImage:function(t){function i(e){e.onload=e.onerror=function(){e.onload=e.onerror=null,n.focusElement(e)}}var n=this,r=e.extend(!0,{},{src:t,alt:n.$alt.val(),"class":"image-"+n.$align.val(),"data-linkType":n.linkType,"data-scale":n.$scale.val()},n.linkTypes[n.linkType].attributes());n.imgElm&&!n.imgElm.getAttribute("data-mce-object")?(r.width=n.dom.getAttrib(n.imgElm,"width"),r.height=n.dom.getAttrib(n.imgElm,"height")):n.imgElm=null,n.imgElm?n.dom.setAttribs(n.imgElm,r):(r.id="__mcenew",n.tiny.insertContent(n.dom.createHTML("img",r)),n.imgElm=n.dom.get("__mcenew"),n.dom.setAttrib(n.imgElm,"id",null)),i(n.imgElm),n.imgElm.complete&&n.focusElement(n.imgElm)},modalShown:function(t){var n=this;n.initElements(),n.initData(),n.$button.off("click").on("click",function(e){e.preventDefault(),e.stopPropagation();var t=n.getLinkUrl();if(!t)return;n.isImageMode()?n.updateImage(t):n.updateAnchor(t),n.hide()}),e('.modal-footer input[name="cancel"]',n.modal.$modal).click(function(e){e.preventDefault(),n.hide()}),n.setupDropzone()},setupDropzone:function(){var t=this;t.options.uploadUrl&&(t.dropzone=new o(t.modal.$modal,{className:"tinymce-dropzone",clickable:!1,url:t.options.uploadUrl,wrap:"inner",autoCleanResults:!0,success:function(n,r){t.tinypattern.fileUploaded(e.parseJSON(r)),t.hide()}}))},show:function(){this.modal.show()},hide:function(){this.modal.hide()},initData:function(){var e=this;e.selection=e.tiny.selection,e.tiny.focus();var t=e.imgElm=e.selection.getNode();e.anchorElm=e.dom.getParent(t,"a[href]");var n;if(e.isImageMode()){if(e.imgElm.nodeName!=="IMG"&&e.anchorElm){var r=e.anchorElm.getElementsByTagName("img");r.length>0&&(e.imgElm=r[0],e.focusElement(e.imgElm))}e.imgElm.nodeName!=="IMG"&&(e.imgElm=null);if(e.imgElm){var i=e.dom.getAttrib(e.imgElm,"src");e.$alt.val(e.dom.getAttrib(e.imgElm,"alt")),n=e.dom.getAttrib(e.imgElm,"data-linktype");if(n){e.linkType=n,e.linkTypes[e.linkType].load(e.imgElm);var s=e.dom.getAttrib(e.imgElm,"data-scale");e.$scale.val(s)}else i&&e.guessImageLink(i);var o=e.dom.getAttrib(e.imgElm,"class"),u=o.split(" ");for(var a=0;a<u.length;a+=1){var f=u[a];f.indexOf("image-")!==-1&&e.$align.val(f.replace("image-",""))}}}else if(e.anchorElm){e.focusElement(e.anchorElm);var l="";l=e.dom.getAttrib(e.anchorElm,"href"),e.$target.val(e.dom.getAttrib(e.anchorElm,"target")),e.$title.val(e.dom.getAttrib(e.anchorElm,"title")),n=e.dom.getAttrib(e.anchorElm,"data-linktype"),n?(e.linkType=n,e.linkTypes[e.linkType].load(e.anchorElm)):l&&e.guessAnchorLink(l)}},guessImageLink:function(e){var t=this;e.indexOf(t.options.prependToScalePart)!==-1?(t.linkType="image",t.$scale.val(t.tinypattern.getScaleFromUrl(e)),t.linkTypes.image.set(t.tinypattern.stripGeneratedUrl(e))):(t.linkType="externalImage",t.linkTypes.externalImage.set(e))},guessAnchorLink:function(e){var t=this;if(t.options.prependToUrl&&e.indexOf(t.options.prependToUrl)!==-1)t.linkType="internal",t.linkTypes.internal.set(t.tinypattern.stripGeneratedUrl(e));else if(e.indexOf("mailto:")!==-1){t.linkType="email";var n=e.substring("mailto:".length,e.length),r=n.split("?subject=");t.linkTypes.email.set(r[0]),r.length>1&&t.$subject.val(decodeURIComponent(r[1]))}else e[0]==="#"?(t.linkType="anchor",t.linkTypes.anchor.setRaw(e.substring(1))):(t.linkType="external",t.linkTypes.external.setRaw(e))},setSelectElement:function(e,t){e.find("option:selected").attr("selected",""),t&&e.find('option[value="'+t+'"]').attr("selected","true")},reinitialize:function(){var e=this;e.modal.options.html=e.generateModalHtml()}});return d}),define("text!js/patterns/tinymce/templates/upload.xml",[],function(){return'<div>\n  <div class="linkModal">\n    <form method="POST" class="disableAutoSubmit"\n          action="<%- uploadUrl %>"\n          enctype="multipart/form-data">\n      <h1><%- uploadHeading %></h1>\n      <div class="">\n        <input type="text" name="location" />\n      </div>\n      <p><%- uploadLocationWarning %></p>\n      <div class="control-group">\n        <label><%- file %></label>\n        <div class="controls">\n          <input type=\'file\' name=\'file\' />\n        </div>\n      </div>\n      <input type="submit" class="btn btn-primary" name="upload"\n             value="<%- uploadBtn %>" />\n      <iframe id="upload_target" name="upload_target" src=""\n              style="width:0;height:0;border:0px solid #fff;"></iframe>\n    </form>\n  </div>\n</div>\n'}),define("js/patterns/tinymce/upload",["jquery","underscore","mockup-patterns-base","mockup-patterns-relateditems","mockup-patterns-modal","tinymce","text!js/patterns/tinymce/templates/upload.xml"],function(e,t,n,r,i,s,o){s.PluginManager.add("ploneimage",function(e){e.addButton("ploneimage",{icon:"image",tooltip:"Insert/edit image",onclick:e.settings.addImageClicked,stateSelector:"img:not([data-mce-object])"}),e.addMenuItem("ploneimage",{icon:"image",text:"Insert image",onclick:e.settings.addImageClicked,context:"insert",prependToContext:!0})}),s.PluginManager.add("ploneupload",function(e){e.addButton("ploneupload",{icon:"newdocument",tooltip:"Upload file",onclick:e.settings.uploadFileClicked}),e.addMenuItem("ploneupload",{icon:"newdocument",text:"Upload file",onclick:e.settings.uploadFileClicked,context:"insert",prependToContext:!0})});var u=n.extend({name:"uploadmodal",defaults:{text:{uploadHeading:"Upload file",file:"File",uploadBtn:"Upload",uploadLocationWarning:"If you do not select a folder to upload to, the file will be uploaded to the current folder."}},template:t.template(o),init:function(){var e=this;e.tinypattern=e.options.tinypattern,e.modal=new i(e.$el,{html:e.template({uploadUrl:e.options.uploadUrl,uploadHeading:e.options.text.uploadHeading,uploadLocationWarning:e.options.text.uploadLocationWarning,file:e.options.text.file,uploadBtn:e.options.text.uploadBtn}),content:null,buttons:".btn"}),e.modal.on("shown",function(t){e.modalShown.apply(e,[t])})},show:function(){this.modal.show()},hide:function(){this.modal.hide()},modalShown:function(){var t=this;t.$uploadBtn=e('.modal-footer input[type="submit"]',t.modal.$modal),t.$form=e("form",t.modal.$modal),t.$iframe=e("iframe",t.modal.$modal),t.$location=e('[name="location"]',t.modal.$modal),t.$location.addClass("pat-relateditems").patternRelateditems(t.options.relatedItems),t.$form.on("submit",function(n){var r=t.$location.select2("data");r.length>0&&t.$form.attr("action",r[0].getURL+"/"+t.options.rel_upload_path),t.modal.loading.show(),t.$iframe.on("load",function(){var n=t.$iframe.contents();t.modal.loading.hide(),t.hide(),(!n.length||!n[0].firstChild)&&t.tinypattern.fileUploadError(),n=e(n[0].body).text(),t.tinypattern.fileUploaded(e.parseJSON(n))}),t.$form[0].target="upload_target"}),t.$uploadBtn.on("click",function(e){e.preventDefault(),t.$form.trigger("submit")})},reinitialize:function(){}});return u}),define("mockup-patterns-tinymce",["jquery","underscore","mockup-patterns-base","mockup-patterns-relateditems","mockup-patterns-modal","tinymce","mockup-patterns-autotoc","mockup-patterns-dropzone","dropzone","text!js/patterns/tinymce/templates/result.xml","text!js/patterns/tinymce/templates/selection.xml","mockup-utils","js/patterns/tinymce/links","js/patterns/tinymce/upload"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d=n.extend({name:"tinymce",defaults:{relatedItems:{attributes:["UID","Title","Description","getURL","Type","path","ModificationDate"],batchSize:20,basePath:"/",vocabularyUrl:null,width:500,maximumSelectionSize:1,placeholder:"Search for item on site..."},text:{insertBtn:"Insert",cancelBtn:"Cancel",insertHeading:"Insert link",title:"Title",internal:"Internal",external:"External",email:"Email",anchor:"Anchor",subject:"Subject",image:"Image",imageAlign:"Align",scale:"Size",alt:"Alternative Text",externalImage:"External Image URI"},prependToUrl:"",appendToUrl:"",linkAttribute:"path",prependToScalePart:"/imagescale/",appendToScalePart:"",scales:"Listing (16x16):listing,Icon (32x32):icon,Tile (64x64):tile,Thumb (128x128):thumb,Mini (200x200):mini,Preview (400x400):preview,Large (768x768):large",targetList:[{text:"Open in this window / frame",value:""},{text:"Open in new window",value:"_blank"},{text:"Open in parent window / frame",value:"_parent"},{text:"Open in top frame (replaces all frames)",value:"_top"}],imageTypes:"Image",folderTypes:"Folder,Plone Site",linkableTypes:"Document,Event,File,Folder,Image,News Item,Topic",tiny:{plugins:["advlist autolink lists charmap print preview anchor ploneupload","searchreplace visualblocks code fullscreen autoresize","insertdatetime media table contextmenu paste plonelink ploneimage"],menubar:"edit table format tools view insert",toolbar:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | unlink plonelink ploneimage | ploneupload",autoresize_max_height:1500},rel_upload_path:null,folder_url:null},uploadFileClicked:function(){var t=this;if(t.uploadModal===null){var n=e("<div/>").insertAfter(t.$el);t.uploadModal=new p(n,e.extend(!0,{},t.options,{tinypattern:t,relatedItems:{baseCriteria:[{i:"Type",o:"plone.app.querystring.operation.list.contains",v:t.options.folderTypes.split(",")}],placeholder:"Select a folder to upload to..."}})),t.uploadModal.show()}else t.uploadModal.reinitialize(),t.uploadModal.show()},addLinkClicked:function(){var t=this;if(t.linkModal===null){var n=e("<div/>").insertAfter(t.$el);t.linkModal=new h(n,e.extend(!0,{},t.options,{tinypattern:t,linkTypes:["internal","external","email","anchor"]})),t.linkModal.show()}else t.linkModal.reinitialize(),t.linkModal.show()},addImageClicked:function(){var t=this;if(t.imageModal===null){var n=e.extend(!0,{},t.options,{tinypattern:t,linkTypes:["image","externalImage"],initialLinkType:"image",text:{insertHeading:"Insert Image"},relatedItems:{baseCriteria:[{i:"Type",o:"plone.app.querystring.operation.list.contains",v:t.options.imageTypes.split(",").concat(t.options.folderTypes.split(","))}],selectableTypes:t.options.imageTypes.split(","),resultTemplate:f,selectionTemplate:l}}),r=e("<div/>").insertAfter(t.$el);t.imageModal=new h(r,n),t.imageModal.show()}else t.imageModal.reinitialize(),t.imageModal.show()},generateUrl:function(e){var t=this,n=e[t.options.linkAttribute];return t.options.prependToUrl+n+t.options.appendToUrl},generateImageUrl:function(e,t){var n=this,r=n.generateUrl(e);return r+n.options.prependToScalePart+t+n.options.appendToScalePart},stripGeneratedUrl:function(e){var t=this;e=e.split(t.options.prependToScalePart,2)[0];if(t.options.prependToUrl){var n=e.split(t.options.prependToUrl,2);n.length===2&&(e=n[1])}return t.options.appendToUrl&&(e=e.split(t.options.appendToUrl)[0]),e},getScaleFromUrl:function(e){var t=this,n=e.split(t.options.prependToScalePart),r=n[0];return n.length!==2?null:(t.options.appendToScalePart?e=n[1].split(t.options.appendToScalePart)[0]:e=n[1],e.indexOf("/image_")!==-1&&(e=e.split("/image_")[1]),e)},fileUploaded:function(e){var t=this;if(e===null)return;var n=e.filename,r=n.split(".");r=r[r.length-1].toLowerCase();var i;if(["png","jpg","gif","jpeg"].indexOf(r)!==-1){i={src:t.generateImageUrl(e,"thumb"),"class":"image-inline"},i.id="__mcenew",t.tiny.insertContent(t.tiny.dom.createHTML("img",i));var s=t.tiny.dom.get("__mcenew");t.tiny.dom.setAttrib(s,"id",null)}else{i={id:"__mcenew"},t.tiny.insertContent(t.tiny.dom.createHTML("a",i));var o=t.tiny.dom.get("__mcenew");t.tiny.dom.setAttrib(o,"id",null),t.tiny.dom.setAttrib(o,"href",t.generateUrl(e)),t.tiny.dom.setHTML(o,n)}},fileUploadError:function(){alert("There was an error attempting to upload file. It is possible the file you are uploading is not allowed in the folder you are trying to add it to.")},init:function(){var e=this;e.linkModal=e.imageModal=e.uploadModal=null;var t=c.setId(e.$el),n=e.options.tiny;n.selector="#"+t,n.addLinkClicked=function(){e.addLinkClicked.apply(e,[])},n.addImageClicked=function(){e.addImageClicked.apply(e,[])},n.skin=!1,e.options.relatedItems.generateImageUrl=function(t,n){return e.generateImageUrl.apply(e,[t,n])},e.options.base_url||(e.options.base_url=window.location.href),e.options.rel_upload_path?e.options.uploadUrl=e.options.folder_url+"/"+e.options.rel_upload_path:e.options.uploadUrl=null,e.options.uploadUrl?n.uploadFileClicked=function(){e.uploadFileClicked.apply(e,[])}:(n.plugins[0]=n.plugins[0].replace("ploneupload",""),n.toolbar=n.toolbar.replace("ploneupload","")),s.init(n),e.tiny=s.get(t);var r=e.$el.parents("form");r.on("submit",function(){e.tiny.save()})}});return d}),define("mockup-patterns-toggle",["jquery","mockup-patterns-base"],function(e,t,n){var r=t.extend({name:"toggle",defaults:{attribute:"class",event:"click",targetScope:"global"},ensureBool:function(e){return typeof e=="string"?e==="true"?!0:!1:e},init:function(){var t=this;t.options.target?t.options.targetScope==="global"?t.$target=e(t.options.target):t.$target=t.$el.parents(t.options.targetScope).first().find(t.options.target):t.$target=t.$el,(!t.$target||t.$target.size()===0)&&e.error('No target found for "'+t.options.target+'".'),t.on(t.options.event,function(e){t.toggle(),e.stopPropagation(),e.preventDefault()})},isMarked:function(){var e=this,t=!1;for(var n=0;n<this.$target.length;n+=1)if(e.options.attribute==="class"){if(!this.$target.eq(n).hasClass(this.options.value)){t=!1;break}t=!0}else{if(this.$target.eq(n).attr(this.options.attribute)!==this.options.value){t=!1;break}t=!0}return t},toggle:function(){var e=this;e.isMarked()?e.remove():e.add()},remove:function(){var e=this;e.trigger("remove-attr"),e.options.attribute==="class"?e.$target.removeClass(e.options.value):e.$target.removeAttr(e.options.attribute),e.trigger("attr-removed")},add:function(){var e=this;e.trigger("add-attr"),e.options.attribute==="class"?e.$target.addClass(e.options.value):e.$target.attr(e.options.attribute,e.options.value),e.trigger("added-attr")}});return r}),define("mockup-patterns-livesearch",["jquery","underscore","mockup-patterns-base","mockup-patterns-toggle","mockup-patterns-select2","mockup-utils"],function(e,t,n,r,i,s){var o=n.extend({name:"livesearch",timeout:null,blurTimout:null,$results:null,$input:null,$toggle:null,cache:{},currentTerm:null,renderedTerm:"",results:"",index:null,testTarget:null,defaults:{url:null,delay:200,blurDelay:200,highlight:"pattern-livesearch-highlight",minimumInputLength:3,toggleTarget:".pattern-livesearch-container",toggleClass:"show",positionToggleWithInput:!0,resultsTarget:".pattern-livesearch-results",input:".pattern-livesearch-input",resultsContainerTemplate:"<ul></ul>",resultsContainerTemplateSelector:null,resultsAppendTo:"ul",resultSelector:".pattern-livesearch-result",resultTemplate:'<li class="pattern-livesearch-result pattern-livesearch-type-<%= Type %>"><a class="pattern-livesearch-result-title" href="<%= getURL %>"><%= Title %></a><p class="pattern-livesearch-result-desc"><%= Description %></p></li>',resultTemplateSelector:null,helpTemplate:'<div class="pattern-livesearch-help"><%= help %></div>',helpTemplateSelector:null,typeMoreTemplate:'Type <%= more %> more character<%= more === 1 ? "" : "s" %> to search.',typeMoreTemplateSelector:null,noResultsTemplate:"No results found.",noResultsTemplateSelector:null,searchingTemplate:"Searching...",searchingTemplateSelector:null,isTest:!1,setPosition:function(){var e=this;if(e.options.positionToggleWithInput){var t=e.$input.position().top+e.$input.outerHeight();e.$toggle.css({top:t+"px"})}}},init:function(){var t=this;t.query=new s.QueryHelper(e.extend(!0,{},t.options,{pattern:t})),this.$results=e(t.options.resultsTarget,t.$el),t.query.valid||e.error("No url provided for livesearch results "+t.$el),t.query.valid?t.options.ajax=t.query.selectAjax():t.options.tags=[],t.$input=e(t.options.input,t.$el),t.$input.length<1&&e.error("Input element not found "+t.$el),t.$input.on("focus.livesearch.patterns",function(e){window.clearInterval(t.blurTimeout),t.show()}),t.$input.on("blur.livesearch.patterns",function(e){t.blurTimeout=window.setInterval(function(){t.hide(),window.clearInterval(t.blurTimeout)},t.options.blurDelay)}),t.options.toggleTarget&&(t.$toggle=e(t.options.toggleTarget,t.$el),t.$toggle.length&&(e("html").on("click.livesearch.patterns",function(){t.hide()}),t.$toggle.on("click.livesearch.patterns",function(e){e.stopPropagation(),window.clearInterval(t.blurTimeout)}),t.$input.on("click.livesearch.patterns",function(e){e.stopPropagation()}))),t.$input.on("keyup keydown",function(e){return t._handler(e)}),t.on("showing.livesearch.patterns",function(e){t.render(e)}),t.on("searched.livesearch.patterns",function(e){t.render(e)}),t.on("render.livesearch.patterns",function(e){t.render(e)}),t.on("searching.livesearch.patterns",function(e){t.render(e)}),t.on("cachedresult.livesearch.patterns",function(e){t.render(e)})},search:function(){var t=this,n=t.currentTerm;t.trigger("searching");if(t.cache[n]!==undefined){t.trigger("cachedresult");return}var r=t.options.ajax.data(n,1);window.clearInterval(t.timeout),e.get(t.options.ajax.url,e.param(r),function(e){e.results!==undefined?t.cache[n]=e.results:console.log("error from server returning result"),t.trigger("searched")})},applyTemplate:function(n,r){var i=this,s;return i.options[n+"TemplateSelector"]?(s=e(i.options[n+"TemplateSelector"]).html(),s||(s=i.options[n+"Template"])):s=i.options[n+"Template"],t.template(s,r)},getCache:function(){var e=this,t=[];return e.currentTerm!==null&&e.currentTerm.length>=e.options.minimumInputLength&&e.cache[e.currentTerm]!==undefined&&(t=e.cache[e.currentTerm]),t},renderHelp:function(e,t){var n=this,r=n.applyTemplate(e,t);return n.applyTemplate("help",{help:r})},renderJsonResults:function(t){var n=this,r="";return t.length>0?e.each(t,function(e,t){r+=n.applyTemplate("result",t)}):r=n.renderHelp("noResults",{}),r},render:function(t){var n=this;if(n.currentTerm===n.renderedTerm)return;var r=e("<div />");if(t.type==="searching")r.html(n.renderHelp("searching",{}));else{n.renderedTerm=n.currentTerm;if(n.currentTerm===null||n.currentTerm.length<n.options.minimumInputLength){var i=n.currentTerm!==null?n.options.minimumInputLength-n.currentTerm.length:n.options.minimumInputLength;r.html(n.renderHelp("typeMore",{more:i}))}else{var s=n.getCache();r.html(n.applyTemplate("resultsContainer",n));var o=r.find(n.options.resultsAppendTo);o.length===0&&(o=r),s?o.append(n.renderJsonResults(s)):r.html(n.renderHelp("noResults",{}))}}n.options.setPosition.apply(n),n.$results.html(r),n.trigger("rendered")},show:function(){var e=this;e.trigger("showing"),e.$toggle&&e.$toggle.addClass(e.options.toggleClass),e.trigger("shown")},hide:function(){var t=this,n=t.options.highlight;t.trigger("hiding"),t.$toggle&&t.$toggle.removeClass(t.options.toggleClass),e("."+n,t.$results).removeClass(n),t.trigger("hidden")},items:function(){return this.$results.find(this.options.resultSelector)},_keyUp:function(){var t=this,n=t.options.highlight,r=e("."+n,t.$results);r.length>0&&r.prev().length>0&&(r.removeClass(n),r=r.prev().addClass(n))},_keyDown:function(){var t=this,n=t.options.highlight,r=e("."+n,t.$results);r.length===0?r=t.items().first().addClass(n):r.next().length>0&&(r.removeClass(n),r=r.next().addClass(n))},_keyEscape:function(){this.$input.trigger("blur.livesearch.patterns")},_keyEnter:function(){var e=this,t=e.options.highlight,n=e.$results.find("."+t).find("a").attr("href");if(e.options.isTest){e.testTarget=n;return}window.location=n},_handler:function(e){var t=this;window.clearTimeout(t.timeout);if(e.type==="keyup")switch(e.which){case 13:return t._keyEnter(),!1;case 27:t._keyEscape();break;case 38:break;case 40:break;case 37:break;case 39:break;default:t.currentTerm=t.$input.val(),t.$input.val().length>=t.options.minimumInputLength?t.timeout=window.setInterval(function(){try{t.search()}catch(e){console.log("error trying to search"),window.clearInterval(t.timeout)}},t.options.delay):t.trigger("render")}else if(e.type==="keydown")switch(e.which){case 38:return t._keyUp(),!1;case 40:return t._keyDown(),!1}}});return o}),function(e){typeof define=="function"&&define.amd?define("jquery.cookie",["jquery"],e):e(jQuery)}(function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function r(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function s(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{e=decodeURIComponent(e.replace(t," "))}catch(n){return}try{return u.json?JSON.parse(e):e}catch(n){}}function o(t,n){var r=u.raw?t:s(t);return e.isFunction(n)?n(r):r}var t=/\+/g,u=e.cookie=function(t,s,a){if(s!==undefined&&!e.isFunction(s)){a=e.extend({},u.defaults,a);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setDate(l.getDate()+f)}return document.cookie=[n(t),"=",i(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=t?undefined:{},h=document.cookie?document.cookie.split("; "):[];for(var p=0,d=h.length;p<d;p++){var v=h[p].split("="),m=r(v.shift()),g=v.join("=");if(t&&t===m){c=o(g,s);break}!t&&(g=o(g))!==undefined&&(c[m]=g)}return c};u.defaults={},e.removeCookie=function(t,n){return e.cookie(t)!==undefined?(e.cookie(t,"",e.extend({},n,{expires:-1})),!0):!1}}),define("mockup-patterns-accessibility",["jquery","mockup-patterns-base","jquery.cookie"],function(e,t){var n=t.extend({name:"accessibility",defaults:{smallbtn:null,normalbtn:null,largebtn:null},setBaseFontSize:function(t,n){n&&(this.$el.removeClass("smallText").removeClass("largeText").removeClass("mediumText"),e.cookie("fontsize",t,{expires:365,path:"/"})),this.$el.addClass(t)},initBtn:function(e){var t=this;e.el.click(function(n){n.preventDefault(),t.setBaseFontSize(e.name+"Text",1)})},init:function(){var t=this,n=e.cookie("fontsize");n&&t.setBaseFontSize(n,0);var r=["smallbtn","normalbtn","largebtn"];e.each(r,function(n,r){var i=r.replace("btn",""),s=t.options[r];if(s!==null){var o=e(s,t.$el);o&&(r={name:i,el:o},t[i]=r,t.initBtn(r))}})}});return n}),define("mockup-patterns-formunloadalert",["jquery","mockup-patterns-base"],function(e,t){var n=t.extend({name:"formunloadalert",_changed:!1,_suppressed:!1,defaults:{message:"Discard changes? If you click OK, any changes you have made will be lost.",changingEvents:"change keyup paste",changingFields:"input,select,textarea,fileupload"},init:function(){var t=this;if(!t.$el.is("form"))return;e(t.options.changingFields,t.$el).on(t.options.changingEvents,function(e){t._changed=!0});var n=t.$el.parents(".modal");n.size()!==0?n.data("pattern-modal").on("hide",function(e){var r=n.data("pattern-modal");r&&(r._suppressHide=t._handle_unload.apply(t,e))}):e(window).on("beforeunload",function(e){return t._handle_unload(e)}),t.$el.on("submit",function(e){t._suppressed=!0})},_handle_unload:function(t){var n=this;if(n._suppressed)return n._suppressed=!1,undefined;if(n._changed){var r=n.options.message;return n._handle_msg(t,r),e(window).trigger("messageset"),r}},_handle_msg:function(e,t){(e||window.event).returnValue=t}});return n}),define("mockup-patterns-preventdoublesubmit",["jquery","mockup-patterns-base"],function(e,t){var n=t.extend({name:"preventdoublesubmit",defaults:{message:"You already clicked the submit button. Do you really want to submit this form again?",guardClassName:"submitting",optOutClassName:"allowMultiSubmit"},init:function(){var t=this;if(!t.$el.is("form"))return;e(":submit",t.$el).click(function(n){e(":submit").removeAttr("clicked"),e(this).attr("clicked","clicked");if(e(this).hasClass(t.options.guardClassName)&&!e(this).hasClass(t.options.optOutClassName))return t._confirm.call(t);e(this).addClass(t.options.guardClassName)})},_confirm:function(e){return window.confirm(this.options.message)}});return n}),define("mockup-patterns-formautofocus",["jquery","mockup-patterns-base"],function(e,t,n){var r=t.extend({name:"formautofocus",defaults:{condition:"div.error",target:"div.error :input:not(.formTabs):visible:first",always:":input:not(.formTabs):visible:first"},init:function(){var t=this;e(t.options.condition,t.$el).size()!==0?e(t.options.target,t.$el).focus():e(t.options.always,t.$el).focus()}});return r}),define("js/ui/views/base",["underscore","backbone"],function(e,t){var n=t.View.extend({isUIView:!0,eventPrefix:"ui",template:null,appendInContainer:!0,initialize:function(e){this.options=e;for(var t in this.options)this[t]=this.options[t]},render:function(){return this.applyTemplate(),this.trigger("render",this),this.afterRender(),!this.$el.attr("id")&&this.options.id&&this.$el.attr("id","gen-"+this.options.id),this},afterRender:function(){},serializedModel:function(){return this.options},applyTemplate:function(){this.template!==null&&this.$el.html(e.template(this.template,this.serializedModel()))},propagateEvent:function(e){if(e.indexOf(":")>0){var t=e.split(":")[0];if(this.eventPrefix!=="")if(t===this.eventPrefix||t===this.eventPrefix+"."+this.id)return!0}return!1},uiEventTrigger:function(e){var n=[].slice.call(arguments,0);this.eventPrefix!==""&&(n[0]=this.eventPrefix+":"+e,t.View.prototype.trigger.apply(this,n),this.id&&(n[0]=this.eventPrefix+"."+this.id+":"+e,t.View.prototype.trigger.apply(this,n)))}});return n}),define("js/ui/views/container",["jquery","underscore","backbone","js/ui/views/base"],function(e,t,n,r){var i=r.extend({id:"",items:[],itemContainer:null,isOffsetParent:!0,render:function(){return this.applyTemplate(),this.renderItems(),this.bindEvents(),this.isOffsetParent&&this.$el.addClass("ui-offset-parent"),this.trigger("render",this),this.afterRender(),this},renderItems:function(){var n;if(this.itemContainer!==null){n=e(this.itemContainer,this.$el);if(n.length===0)throw"Item Container element not found."}else n=this.$el;t.each(this.items,function(e){e.appendInContainer===!0?n.append(e.render().$el):e.render()},this)},bindEvents:function(){var e=this;t.each(this.items,function(t){t.on("all",function(){var t=[].slice,n=arguments[0],r,i=e.id!==""?e.id+"."+n:n;arguments.length>1&&(r=arguments[1]);if(i!==n){var s=t.call(arguments,0);s[0]=i,e.trigger.apply(e,s)}r!==undefined&&r.isUIView===!0&&r.propagateEvent(n)===!0&&e.trigger.apply(e,arguments)})})},get:function(e){return t.findWhere(this.items,{id:e})},add:function(e){if(e.id!==undefined&&this.get(e.id))throw"Another item with the same `id` already exists.";this.items.push(e)}});return i}),define("js/ui/views/toolbar",["underscore","backbone","js/ui/views/container"],function(e,t,n){var r=n.extend({tagName:"div",className:"navbar"});return r}),define("js/ui/views/buttongroup",["underscore","backbone","js/ui/views/container"],function(e,t,n){var r=n.extend({tagName:"div",className:"btn-group",disable:function(){e.each(this.items,function(e){e.trigger("disable")})},enable:function(){e.each(this.items,function(e){e.trigger("enable")})}});return r}),+function(e){var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r);var i=this.options.trigger.split(" ");for(var s=i.length;s--;){var o=i[s];if(o=="click")this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if(o!="manual"){var u=o=="hover"?"mouseenter":"focusin",a=o=="hover"?"mouseleave":"focusout";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="in";if(!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(n.timeout),n.hoverState="out";if(!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this,r=this.tip();this.setContent(),this.options.animation&&r.addClass("fade");var i=typeof this.options.placement=="function"?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,s=/\s?auto?\s?/i,o=s.test(i);o&&(i=i.replace(s,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(i),this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element);var u=this.getPosition(),a=r[0].offsetWidth,f=r[0].offsetHeight;if(o){var l=this.$element.parent(),c=i,h=document.documentElement.scrollTop||document.body.scrollTop,p=this.options.container=="body"?window.innerWidth:l.outerWidth(),d=this.options.container=="body"?window.innerHeight:l.outerHeight(),v=this.options.container=="body"?0:l.offset().left;i=i=="bottom"&&u.top+u.height+f-h>d?"top":i=="top"&&u.top-h-f<0?"bottom":i=="right"&&u.right+a>p?"left":i=="left"&&u.left-a<v?"right":i,r.removeClass(c).addClass(i)}var m=this.getCalculatedOffset(i,u,a,f);this.applyPlacement(m,i),this.hoverState=null;var g=function(){n.$element.trigger("shown.bs."+n.type)};e.support.transition&&this.$tip.hasClass("fade")?r.one(e.support.transition.end,g).emulateTransitionEnd(150):g()}},t.prototype.applyPlacement=function(t,n){var r,i=this.tip(),s=i[0].offsetWidth,o=i[0].offsetHeight,u=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(u)&&(u=0),isNaN(a)&&(a=0),t.top=t.top+u,t.left=t.left+a,e.offset.setOffset(i[0],e.extend({using:function(e){i.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),i.addClass("in");var f=i[0].offsetWidth,l=i[0].offsetHeight;n=="top"&&l!=o&&(r=!0,t.top=t.top+o-l);if(/bottom|top/.test(n)){var c=0;t.left<0&&(c=t.left*-2,t.left=0,i.offset(t),f=i[0].offsetWidth,l=i[0].offsetHeight),this.replaceArrow(c-s+f,f,"left")}else this.replaceArrow(l-o,l,"top");r&&i.offset(t)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(){function i(){t.hoverState!="in"&&n.detach(),t.$element.trigger("hidden.bs."+t.type)}var t=this,n=this.tip(),r=e.Event("hide.bs."+this.type);this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?n.one(e.support.transition.end,i).emulateTransitionEnd(150):i(),this.hoverState=null,this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,r){return e=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-n/2}:e=="top"?{top:t.top-r,left:t.left+t.width/2-n/2}:e=="left"?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s=typeof n=="object"&&n;if(!i&&n=="destroy")return;i||r.data("bs.tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(jQuery),define("bootstrap-tooltip",["jquery"],function(){}),define("js/ui/views/button",["jquery","backbone","underscore","js/ui/views/base","bootstrap-tooltip"],function(e,t,n,r){var i=r.extend({tagName:"a",className:"btn",eventPrefix:"button",context:"default",attributes:{href:"#"},tooltip:null,template:'<% if (icon) { %><span class="glyphicon glyphicon-<%= icon %>"></span><% } %> <%= title %>',events:{click:"handleClick"},initialize:function(e){if(!e.id){var t=e.title||"";e.id=t!==""?t.toLowerCase().replace(" ","-"):this.cid}r.prototype.initialize.apply(this,[e]),this.on("disable",function(){this.disable()},this),this.on("enable",function(){this.enable()},this),this.on("render",function(){this.context!==null&&this.$el.addClass("btn-"+this.context),this.tooltip!==null&&(this.$el.tooltip({title:this.tooltip}),this.$el.on("hidden",function(e){e.type=="hidden"&&e.stopPropagation()}))},this)},handleClick:function(e){e.preventDefault(),this.$el.is(".disabled")||this.uiEventTrigger("click",this,e)},serializedModel:function(){return n.extend({icon:"",title:""},this.options)},disable:function(){this.options.disabled=!0,this.$el.addClass("disabled")},enable:function(){this.options.disabled=!1,this.$el.removeClass("disabled")}});return i}),define("text!js/patterns/structure/templates/tablerow.xml",[],function(){return'<td class="selection"><input type="checkbox" <% if(selected){ %> checked="checked" <% } %>/></td>\n<td class="title">\n  <a href="<%- getURL %>">\n    <% if([\'File\', \'Image\'].indexOf(attributes.Type) !== -1){ %>\n      <span class="glyphicon glyphicon-file"></span>\n    <% } %>\n    <% if(attributes.is_folderish) { %>\n      <span class="glyphicon glyphicon-folder-open"></span>\n    <% } %>\n    <% if(attributes.is_folderish) { %>\n      <span class="icon icon-folder-open"></span>\n    <% } %>\n    <%- Title %>\n  </a>\n</td>\n<% _.each(activeColumns, function(column){ %>\n  <% if(_.has(availableColumns, column)) { %>\n    <td class="<%- column %>"><%- attributes[column] %></td>\n  <% } %>\n<% }); %>\n<td>\n  <div class="btn-group">\n    <a class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" href="#">\n      <span class="glyphicon glyphicon-cog"></i>\n      <span class="caret"></span>\n    </a>\n    <ul class="dropdown-menu">\n      <li class="cutItem"><a href="#">Cut</a></li>\n      <li class="copyItem"><a href="#">Copy</a></li>\n      <% if(pasteAllowed && attributes.is_folderish){ %>\n        <li class="pasteItem"><a href="#">Paste</a></li>\n      <% } %>\n      <% if(!inQueryMode){ %>\n        <li class="move-top"><a href="#">Move to top of folder</a></li>\n        <li class="move-bottom"><a href="#">Move to bottom of folder</a></li>\n      <% } %>\n      <% if(!attributes.is_folderish && canSetDefaultPage){ %>\n        <li class="set-default-page"><a href="#">Set as default page</a></li>\n      <% } %>\n      <li class="openItem"><a href="#">Open</a></li>\n      <li class="editItem"><a href="#">Edit</a></li>\n    </ul>\n  </div>\n</td>\n'}),+function(e){function i(r){e(t).remove(),e(n).each(function(){var t=s(e(this)),n={relatedTarget:this};if(!t.hasClass("open"))return;t.trigger(r=e.Event("hide.bs.dropdown",n));if(r.isDefaultPrevented())return;t.removeClass("open").trigger("hidden.bs.dropdown",n)})}function s(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}var t=".dropdown-backdrop",n="[data-toggle=dropdown]",r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.prototype.toggle=function(t){var n=e(this);if(n.is(".disabled, :disabled"))return;var r=s(n),o=r.hasClass("open");i();if(!o){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",i);var u={relatedTarget:this};r.trigger(t=e.Event("show.bs.dropdown",u));if(t.isDefaultPrevented())return;r.toggleClass("open").trigger("shown.bs.dropdown",u),n.focus()}return!1},r.prototype.keydown=function(t){if(!/(38|40|27)/.test(t.keyCode))return;var r=e(this);t.preventDefault(),t.stopPropagation();if(r.is(".disabled, :disabled"))return;var i=s(r),o=i.hasClass("open");if(!o||o&&t.keyCode==27)return t.which==27&&i.find(n).focus(),r.click();var u=" li:not(.divider):visible a",a=i.find("[role=menu]"+u+", [role=listbox]"+u);if(!a.length)return;var f=a.index(a.filter(":focus"));t.keyCode==38&&f>0&&f--,t.keyCode==40&&f<a.length-1&&f++,~f||(f=0),a.eq(f).focus()};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})},e.fn.dropdown.Constructor=r,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n+", [role=menu], [role=listbox]",r.prototype.keydown)}(jQuery),define("bootstrap-dropdown",["jquery"],function(){}),define("js/patterns/structure/views/tablerow",["jquery","underscore","backbone","text!js/patterns/structure/templates/tablerow.xml","bootstrap-dropdown"],function(e,t,n,r){var i=n.View.extend({tagName:"tr",className:"itemRow",template:t.template(r),events:{"change input":"itemSelected","click td.title a":"itemClicked","click .cutItem a":"cutClicked","click .copyItem a":"copyClicked","click .pasteItem a":"pasteClicked","click .move-top a":"moveTopClicked","click .move-bottom a":"moveBottomClicked","click .set-default-page a":"setDefaultPageClicked","click .openItem a":"openClicked","click .editItem a":"editClicked"},initialize:function(e){this.options=e,this.app=e.app,this.selectedCollection=this.app.selectedCollection,this.table=this.options.table},render:function(){var e=this,t=this.model.toJSON();t.selected=!1,this.selectedCollection.findWhere({UID:t.UID})&&(t.selected=!0),t.attributes=e.model.attributes,t.activeColumns=e.app.activeColumns,t.availableColumns=e.app.availableColumns,t.pasteAllowed=e.app.pasteAllowed,t.canSetDefaultPage=e.app.setDefaultPageUrl,t.inQueryMode=e.app.inQueryMode(),e.$el.html(e.template(t));var n=e.model.attributes;return e.$el.addClass("state-"+n.review_state).addClass("type-"+n.Type),n.is_folderish&&e.$el.addClass("folder"),e.$el.attr("data-path",t.path),e.$el.attr("data-UID",t.UID),e.$el.attr("data-id",t.id),e.$el.attr("data-type",t.Type),e.$el.attr("data-folderish",t.is_folderish),e.el.model=this.model,e.$dropdown=e.$(".dropdown-toggle"),e.$dropdown.dropdown(),this},itemClicked:function(e){e.preventDefault();var t=this.app.keyEvent;if(t&&t.ctrlKey)this.openClicked(e);else if(this.model.attributes.is_folderish){this.app.queryHelper.currentPath=this.model.attributes.path;var n=this.app.collection;n.goTo(n.information.firstPage)}else this.openClicked(e)},itemSelected:function(){var t=this.$("input")[0];t.checked?this.app.selectedCollection.add(this.model):this.app.selectedCollection.removeResult(this.model);var n=this.selectedCollection,r=this.app.keyEvent;if(r&&r.shiftKey&&this.app.last_selected&&this.app.last_selected.parentNode!==null){var i=e(this.app.last_selected),s=i.index(),o=this.$el.index();this.app.tableView.$('input[type="checkbox"]').each(function(){i=e(this);var r=i.parents("tr").index();if(r>s&&r<o||r<s&&r>o){this.checked=t.checked;var u=e(this).closest("tr")[0].model,a=n.getByUID(u.attributes.UID);this.checked?a||n.add(u):a&&n.remove(a)}})}this.app.last_selected=this.el},cutClicked:function(e){e.preventDefault(),this.cutCopyClicked("cut"),this.app.collection.pager()},copyClicked:function(e){e.preventDefault(),this.cutCopyClicked("copy"),this.app.collection.pager()},cutCopyClicked:function(e){var t=this;t.app.pasteOperation=e,t.app.pasteSelection=new n.Collection,t.app.pasteSelection.add(this.model),t.app.setStatus(e+" 1 item"),t.app.pasteAllowed=!0,t.app.buttons.primary.get("paste").enable()},pasteClicked:function(e){e.preventDefault(),this.app.pasteEvent(this.app.buttons.primary.get("paste"),e,{folder:this.model.attributes.path}),this.app.collection.pager()},moveTopClicked:function(e){e.preventDefault(),this.app.moveItem(this.model.attributes.id,"top")},moveBottomClicked:function(e){e.preventDefault(),this.app.moveItem(this.model.attributes.id,"bottom")},setDefaultPageClicked:function(t){t.preventDefault();var n=this;e.ajax({url:n.app.getAjaxUrl(n.app.setDefaultPageUrl),type:"POST",data:{_authenticator:e('[name="_authenticator"]').val(),id:this.$active.attr("data-id")},success:function(e){n.app.ajaxSuccessResponse.apply(n.app,[e])},error:function(e){n.app.ajaxErrorResponse.apply(n.app,[e])}})},getSelectedBaseUrl:function(){var e=this;return e.model.attributes.getURL},getWindow:function(){var e=window;return e.parent!==window&&(e=e.parent),e},openUrl:function(e){var t=this,n=t.getWindow(),r=this.app.keyEvent;r&&r.ctrlKey?n.open(e):n.location=e},openClicked:function(e){e.preventDefault();var t=this;t.openUrl(t.getSelectedBaseUrl()+"/view")},editClicked:function(e){e.preventDefault();var t=this;t.openUrl(t.getSelectedBaseUrl()+"/edit")}});return i}),define("text!js/patterns/structure/templates/table.xml",[],function(){return'<div class="alert alert-<%= statusType %> status">\n    <%= status %>\n</div>\n<table class="table table-striped table-bordered">\n  <thead>\n    <tr class="breadcrumbs">\n        <td colspan="<%= activeColumns.length + 3 %>">\n          <a href="#" data-path="/">\n              <span class="icon icon-home"></span> /\n          </a>\n        <% _.each(pathParts, function(part, idx, list){\n          if(part){\n            if(idx > 0){ %>\n              /\n            <% } %>\n            <a href="#" class="crumb" data-path="<%- part %>"><%- part %></a>\n          <% }\n        }); %>\n      </td>\n    </tr>\n    <tr>\n      <th><input type="checkbox" class="select-all" /></th>\n      <th>Title</th>\n      <% _.each(activeColumns, function(column){ %>\n        <% if(_.has(availableColumns, column)) { %>\n          <th><%- availableColumns[column] %></th>\n        <% } %>\n      <% }); %>\n      <th>Actions</th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n'}),define("mockup-patterns-sortable",["jquery","mockup-patterns-base","jquery.event.drag","jquery.event.drop"],function(e,t,n,r){var i=t.extend({name:"sortable",defaults:{selector:"li",dragClass:"item-dragging",cloneClass:"dragging",drop:null},init:function(){var t=this,n=0;t.$el.find(t.options.selector).drag("start",function(i,s){var o=this;return e(o).addClass(t.options.dragClass),r({tolerance:function(n,r,i){if(e(i.elem).closest(t.$el).length===0)return;var s=n.pageY>i.top+i.height/2;return e.data(i.elem,"drop+reorder",s?"insertAfter":"insertBefore"),this.contains(i,[n.pageX,n.pageY])}}),n=e(this).index(),e(this).clone().addClass(t.options.cloneClass).css({opacity:.75,position:"absolute"}).appendTo(document.body)}).drag(function(t,n){e(n.proxy).css({top:n.offsetY,left:n.offsetX});var r=n.drop[0],i=e.data(r||{},"drop+reorder");i&&r&&(r!=n.current||i!=n.method)&&(e(this)[i](r),n.current=r,n.method=i,n.update())}).drag("end",function(r,i){var s=e(this);s.removeClass(t.options.dragClass),e(i.proxy).remove(),t.options.drop&&t.options.drop(s,s.index()-n)}).drop("init",function(e,t){return this==t.drag?!1:!0})}});return i}),function(e){function J(e,t){return function(n){return tt(e.call(this,n),t)}}function K(e,t){return function(n){return this.lang().ordinal(e.call(this,n),t)}}function Q(){}function G(e){pt(e),Z(this,e)}function Y(e){var t=ut(e),n=t.year||0,r=t.month||0,i=t.week||0,s=t.day||0,o=t.hour||0,u=t.minute||0,a=t.second||0,f=t.millisecond||0;this._milliseconds=+f+a*1e3+u*6e4+o*36e5,this._days=+s+i*7,this._months=+r+n*12,this._data={},this._bubble()}function Z(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function et(e){return e<0?Math.ceil(e):Math.floor(e)}function tt(e,t,n){var r=Math.abs(e)+"",i=e>=0;while(r.length<t)r="0"+r;return(i?n?"+":"":"-")+r}function nt(e,n,r,i){var s=n._milliseconds,o=n._days,u=n._months,a,f;s&&e._d.setTime(+e._d+s*r);if(o||u)a=e.minute(),f=e.hour();o&&e.date(e.date()+o*r),u&&e.month(e.month()+u*r),s&&!i&&t.updateOffset(e);if(o||u)e.minute(a),e.hour(f)}function rt(e){return Object.prototype.toString.call(e)==="[object Array]"}function it(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}function st(e,t,n){var r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0,o;for(o=0;o<r;o++)(n&&e[o]!==t[o]||!n&&ft(e[o])!==ft(t[o]))&&s++;return s+i}function ot(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=R[e]||U[t]||t}return e}function ut(e){var t={},n,r;for(r in e)e.hasOwnProperty(r)&&(n=ot(r),n&&(t[n]=e[r]));return t}function at(n){var r,i;if(n.indexOf("week")===0)r=7,i="day";else{if(n.indexOf("month")!==0)return;r=12,i="month"}t[n]=function(s,o){var u,a,f=t.fn._lang[n],l=[];typeof s=="number"&&(o=s,s=e),a=function(e){var n=t().utc().set(i,e);return f.call(t.fn._lang,n,s||"")};if(o!=null)return a(o);for(u=0;u<r;u++)l.push(a(u));return l}}function ft(e){var t=+e,n=0;return t!==0&&isFinite(t)&&(t>=0?n=Math.floor(t):n=Math.ceil(t)),n}function lt(e,t){return(new Date(Date.UTC(e,t+1,0))).getUTCDate()}function ct(e){return ht(e)?366:365}function ht(e){return e%4===0&&e%100!==0||e%400===0}function pt(e){var t;e._a&&e._pf.overflow===-2&&(t=e._a[u]<0||e._a[u]>11?u:e._a[a]<1||e._a[a]>lt(e._a[o],e._a[u])?a:e._a[f]<0||e._a[f]>23?f:e._a[l]<0||e._a[l]>59?l:e._a[c]<0||e._a[c]>59?c:e._a[h]<0||e._a[h]>999?h:-1,e._pf._overflowDayOfYear&&(t<o||t>a)&&(t=a),e._pf.overflow=t)}function dt(e){e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function vt(e){return e._isValid==null&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&e._pf.charsLeftOver===0&&e._pf.unusedTokens.length===0)),e._isValid}function mt(e){return e?e.toLowerCase().replace("_","-"):e}function gt(e,n){return n._isUTC?t(e).zone(n._offset||0):t(e).local()}function yt(e,t){return t.abbr=e,p[e]||(p[e]=new Q),p[e].set(t),p[e]}function bt(e){delete p[e]}function wt(e){var n=0,r,i,s,o,u=function(e){if(!p[e]&&d)try{require("./lang/"+e)}catch(t){}return p[e]};if(!e)return t.fn._lang;if(!rt(e)){i=u(e);if(i)return i;e=[e]}while(n<e.length){o=mt(e[n]).split("-"),r=o.length,s=mt(e[n+1]),s=s?s.split("-"):null;while(r>0){i=u(o.slice(0,r).join("-"));if(i)return i;if(s&&s.length>=r&&st(o,s,!0)>=r-1)break;r--}n++}return t.fn._lang}function Et(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function St(e){var t=e.match(y),n,r;for(n=0,r=t.length;n<r;n++)V[t[n]]?t[n]=V[t[n]]:t[n]=Et(t[n]);return function(i){var s="";for(n=0;n<r;n++)s+=t[n]instanceof Function?t[n].call(i,e):t[n];return s}}function xt(e,t){return e.isValid()?(t=Tt(t,e.lang()),z[t]||(z[t]=St(t)),z[t](e)):e.lang().invalidDate()}function Tt(e,t){function r(e){return t.longDateFormat(e)||e}var n=5;b.lastIndex=0;while(n>=0&&b.test(e))e=e.replace(b,r),b.lastIndex=0,n-=1;return e}function Nt(e,t){var n,r=t._strict;switch(e){case"DDDD":return M;case"YYYY":case"GGGG":case"gggg":return r?_:S;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return r?D:x;case"S":if(r)return A;case"SS":if(r)return O;case"SSS":case"DDD":return r?M:E;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return N;case"a":case"A":return wt(t._l)._meridiemParse;case"X":return L;case"Z":case"ZZ":return C;case"T":return k;case"SSSS":return T;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return r?O:w;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return r?A:w;default:return n=new RegExp(Dt(_t(e.replace("\\","")),"i")),n}}function Ct(e){e=e||"";var t=e.match(C)||[],n=t[t.length-1]||[],r=(n+"").match(F)||["-",0,0],i=+(r[1]*60)+ft(r[2]);return r[0]==="+"?-i:i}function kt(e,t,n){var r,i=n._a;switch(e){case"M":case"MM":t!=null&&(i[u]=ft(t)-1);break;case"MMM":case"MMMM":r=wt(n._l).monthsParse(t),r!=null?i[u]=r:n._pf.invalidMonth=t;break;case"D":case"DD":t!=null&&(i[a]=ft(t));break;case"DDD":case"DDDD":t!=null&&(n._dayOfYear=ft(t));break;case"YY":i[o]=ft(t)+(ft(t)>68?1900:2e3);break;case"YYYY":case"YYYYY":case"YYYYYY":i[o]=ft(t);break;case"a":case"A":n._isPm=wt(n._l).isPM(t);break;case"H":case"HH":case"h":case"hh":i[f]=ft(t);break;case"m":case"mm":i[l]=ft(t);break;case"s":case"ss":i[c]=ft(t);break;case"S":case"SS":case"SSS":case"SSSS":i[h]=ft(("0."+t)*1e3);break;case"X":n._d=new Date(parseFloat(t)*1e3);break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=Ct(t);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":e=e.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(n._w=n._w||{},n._w[e]=t)}}function Lt(e){var n,r,i=[],s,c,h,p,d,v,m,g;if(e._d)return;s=Ot(e),e._w&&e._a[a]==null&&e._a[u]==null&&(h=function(n){var r=parseInt(n,10);return n?n.length<3?r>68?1900+r:2e3+r:r:e._a[o]==null?t().weekYear():e._a[o]},p=e._w,p.GG!=null||p.W!=null||p.E!=null?d=zt(h(p.GG),p.W||1,p.E,4,1):(v=wt(e._l),m=p.d!=null?It(p.d,v):p.e!=null?parseInt(p.e,10)+v._week.dow:0,g=parseInt(p.w,10)||1,p.d!=null&&m<v._week.dow&&g++,d=zt(h(p.gg),g,m,v._week.doy,v._week.dow)),e._a[o]=d.year,e._dayOfYear=d.dayOfYear),e._dayOfYear&&(c=e._a[o]==null?s[o]:e._a[o],e._dayOfYear>ct(c)&&(e._pf._overflowDayOfYear=!0),r=Ft(c,0,e._dayOfYear),e._a[u]=r.getUTCMonth(),e._a[a]=r.getUTCDate());for(n=0;n<3&&e._a[n]==null;++n)e._a[n]=i[n]=s[n];for(;n<7;n++)e._a[n]=i[n]=e._a[n]==null?n===2?1:0:e._a[n];i[f]+=ft((e._tzm||0)/60),i[l]+=ft((e._tzm||0)%60),e._d=(e._useUTC?Ft:jt).apply(null,i)}function At(e){var t;if(e._d)return;t=ut(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],Lt(e)}function Ot(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Mt(e){e._a=[],e._pf.empty=!0;var t=wt(e._l),n=""+e._i,r,i,s,o,u,a=n.length,l=0;s=Tt(e._f,t).match(y)||[];for(r=0;r<s.length;r++)o=s[r],i=(n.match(Nt(o,e))||[])[0],i&&(u=n.substr(0,n.indexOf(i)),u.length>0&&e._pf.unusedInput.push(u),n=n.slice(n.indexOf(i)+i.length),l+=i.length),V[o]?(i?e._pf.empty=!1:e._pf.unusedTokens.push(o),kt(o,i,e)):e._strict&&!i&&e._pf.unusedTokens.push(o);e._pf.charsLeftOver=a-l,n.length>0&&e._pf.unusedInput.push(n),e._isPm&&e._a[f]<12&&(e._a[f]+=12),e._isPm===!1&&e._a[f]===12&&(e._a[f]=0),Lt(e),pt(e)}function _t(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i})}function Dt(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Pt(e){var t,n,r,i,s;if(e._f.length===0){e._pf.invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<e._f.length;i++){s=0,t=Z({},e),dt(t),t._f=e._f[i],Mt(t);if(!vt(t))continue;s+=t._pf.charsLeftOver,s+=t._pf.unusedTokens.length*10,t._pf.score=s;if(r==null||s<r)r=s,n=t}Z(e,n||t)}function Ht(e){var t,n=e._i,r=P.exec(n);if(r){e._pf.iso=!0;for(t=4;t>0;t--)if(r[t]){e._f=B[t-1]+(r[6]||" ");break}for(t=0;t<4;t++)if(j[t][1].exec(n)){e._f+=j[t][0];break}n.match(C)&&(e._f+="Z"),Mt(e)}else e._d=new Date(n)}function Bt(t){var n=t._i,r=v.exec(n);n===e?t._d=new Date:r?t._d=new Date(+r[1]):typeof n=="string"?Ht(t):rt(n)?(t._a=n.slice(0),Lt(t)):it(n)?t._d=new Date(+n):typeof n=="object"?At(t):t._d=new Date(n)}function jt(e,t,n,r,i,s,o){var u=new Date(e,t,n,r,i,s,o);return e<1970&&u.setFullYear(e),u}function Ft(e){var t=new Date(Date.UTC.apply(null,arguments));return e<1970&&t.setUTCFullYear(e),t}function It(e,t){if(typeof e=="string")if(!isNaN(e))e=parseInt(e,10);else{e=t.weekdaysParse(e);if(typeof e!="number")return null}return e}function qt(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function Rt(e,t,n){var r=i(Math.abs(e)/1e3),s=i(r/60),o=i(s/60),u=i(o/24),a=i(u/365),f=r<45&&["s",r]||s===1&&["m"]||s<45&&["mm",s]||o===1&&["h"]||o<22&&["hh",o]||u===1&&["d"]||u<=25&&["dd",u]||u<=45&&["M"]||u<345&&["MM",i(u/30)]||a===1&&["y"]||["yy",a];return f[2]=t,f[3]=e>0,f[4]=n,qt.apply({},f)}function Ut(e,n,r){var i=r-n,s=r-e.day(),o;return s>i&&(s-=7),s<i-7&&(s+=7),o=t(e).add("d",s),{week:Math.ceil(o.dayOfYear()/7),year:o.year()}}function zt(e,t,n,r,i){var s=(new Date(tt(e,6,!0)+"-01-01")).getUTCDay(),o,u;return n=n!=null?n:i,o=i-s+(s>r?7:0),u=7*(t-1)+(n-i)+o+1,{year:u>0?e:e-1,dayOfYear:u>0?u:ct(e-1)+u}}function Wt(e){var n=e._i,r=e._f;return typeof e._pf=="undefined"&&dt(e),n===null?t.invalid({nullInput:!0}):(typeof n=="string"&&(e._i=n=wt().preparse(n)),t.isMoment(n)?(e=Z({},n),e._d=new Date(+n._d)):r?rt(r)?Pt(e):Mt(e):Bt(e),new G(e))}function Xt(e,n){t.fn[e]=t.fn[e+"s"]=function(e){var r=this._isUTC?"UTC":"";return e!=null?(this._d["set"+r+n](e),t.updateOffset(this),this):this._d["get"+r+n]()}}function Vt(e){t.duration.fn[e]=function(){return this._data[e]}}function $t(e,n){t.duration.fn["as"+e]=function(){return+this/n}}function Jt(e){var n=!1,i=t;if(typeof ender!="undefined")return;e?(r.moment=function(){return!n&&console&&console.warn&&(n=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),i.apply(null,arguments)},Z(r.moment,i)):r.moment=t}var t,n="2.5.0",r=this,i=Math.round,s,o=0,u=1,a=2,f=3,l=4,c=5,h=6,p={},d=typeof module!="undefined"&&module.exports&&typeof require!="undefined",v=/^\/?Date\((\-?\d+)/i,m=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,g=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,y=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,b=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,w=/\d\d?/,E=/\d{1,3}/,S=/\d{1,4}/,x=/[+\-]?\d{1,6}/,T=/\d+/,N=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,C=/Z|[\+\-]\d\d:?\d\d/gi,k=/T/i,L=/[\+\-]?\d+(\.\d{1,3})?/,A=/\d/,O=/\d\d/,M=/\d{3}/,_=/\d{4}/,D=/[+\-]?\d{6}/,P=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,H="YYYY-MM-DDTHH:mm:ssZ",B=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],j=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],F=/([\+\-]|\d\d)/gi,I="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),q={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},R={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},U={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},z={},W="DDD w W M D d".split(" "),X="M D H h m s w W".split(" "),V={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return tt(this.year()%100,2)},YYYY:function(){return tt(this.year(),4)},YYYYY:function(){return tt(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+tt(Math.abs(e),6)},gg:function(){return tt(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return tt(this.weekYear(),5)},GG:function(){return tt(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return tt(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return ft(this.milliseconds()/100)},SS:function(){return tt(ft(this.milliseconds()/10),2)},SSS:function(){return tt(this.milliseconds(),3)},SSSS:function(){return tt(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+tt(ft(e/60),2)+":"+tt(ft(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+tt(ft(e/60),2)+tt(ft(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},$=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];while(W.length)s=W.pop(),V[s+"o"]=K(V[s],s);while(X.length)s=X.pop(),V[s+s]=J(V[s],2);V.DDDD=J(V.DDD,3),Z(Q.prototype,{set:function(e){var t,n;for(n in e)t=e[n],typeof t=="function"?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var n,r,i;this._monthsParse||(this._monthsParse=[]);for(n=0;n<12;n++){this._monthsParse[n]||(r=t.utc([2e3,n]),i="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i"));if(this._monthsParse[n].test(e))return n}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var n,r,i;this._weekdaysParse||(this._weekdaysParse=[]);for(n=0;n<7;n++){this._weekdaysParse[n]||(r=t([2e3,1]).day(n),i="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i"));if(this._weekdaysParse[n].test(e))return n}},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return(e+"").toLowerCase().charAt(0)==="p"},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return typeof n=="function"?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return typeof i=="function"?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return typeof n=="function"?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return Ut(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),t=function(t,n,r,i){return typeof r=="boolean"&&(i=r,r=e),Wt({_i:t,_f:n,_l:r,_strict:i,_isUTC:!1})},t.utc=function(t,n,r,i){var s;return typeof r=="boolean"&&(i=r,r=e),s=Wt({_useUTC:!0,_isUTC:!0,_l:r,_i:t,_f:n,_strict:i}).utc(),s},t.unix=function(e){return t(e*1e3)},t.duration=function(e,n){var r=e,i=null,s,o,u;return t.isDuration(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:typeof e=="number"?(r={},n?r[n]=e:r.milliseconds=e):(i=m.exec(e))?(s=i[1]==="-"?-1:1,r={y:0,d:ft(i[a])*s,h:ft(i[f])*s,m:ft(i[l])*s,s:ft(i[c])*s,ms:ft(i[h])*s}):!(i=g.exec(e))||(s=i[1]==="-"?-1:1,u=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*s},r={y:u(i[2]),M:u(i[3]),d:u(i[4]),h:u(i[5]),m:u(i[6]),s:u(i[7]),w:u(i[8])}),o=new Y(r),t.isDuration(e)&&e.hasOwnProperty("_lang")&&(o._lang=e._lang),o},t.version=n,t.defaultFormat=H,t.updateOffset=function(){},t.lang=function(e,n){var r;return e?(n?yt(mt(e),n):n===null?(bt(e),e="en"):p[e]||wt(e),r=t.duration.fn._lang=t.fn._lang=wt(e),r._abbr):t.fn._lang._abbr},t.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),wt(e)},t.isMoment=function(e){return e instanceof G},t.isDuration=function(e){return e instanceof Y};for(s=$.length-1;s>=0;--s)at($[s]);t.normalizeUnits=function(e){return ot(e)},t.invalid=function(e){var n=t.utc(NaN);return e!=null?Z(n._pf,e):n._pf.userInvalidated=!0,n},t.parseZone=function(e){return t(e).parseZone()},Z(t.fn=G.prototype,{clone:function(){return t(this)},valueOf:function(){return+this._d+(this._offset||0)*6e4},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=t(this).utc();return 0<e.year()&&e.year()<=9999?xt(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):xt(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return vt(this)},isDSTShifted:function(){return this._a?this.isValid()&&st(this._a,(this._isUTC?t.utc(this._a):t(this._a)).toArray())>0:!1},parsingFlags:function(){return Z({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var n=xt(this,e||t.defaultFormat);return this.lang().postformat(n)},add:function(e,n){var r;return typeof e=="string"?r=t.duration(+n,e):r=t.duration(e,n),nt(this,r,1),this},subtract:function(e,n){var r;return typeof e=="string"?r=t.duration(+n,e):r=t.duration(e,n),nt(this,r,-1),this},diff:function(e,n,r){var i=gt(e,this),s=(this.zone()-i.zone())*6e4,o,u;return n=ot(n),n==="year"||n==="month"?(o=(this.daysInMonth()+i.daysInMonth())*432e5,u=(this.year()-i.year())*12+(this.month()-i.month()),u+=(this-t(this).startOf("month")-(i-t(i).startOf("month")))/o,u-=(this.zone()-t(this).startOf("month").zone()-(i.zone()-t(i).startOf("month").zone()))*6e4/o,n==="year"&&(u/=12)):(o=this-i,u=n==="second"?o/1e3:n==="minute"?o/6e4:n==="hour"?o/36e5:n==="day"?(o-s)/864e5:n==="week"?(o-s)/6048e5:o),r?u:et(u)},from:function(e,n){return t.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!n)},fromNow:function(e){return this.from(t(),e)},calendar:function(){var e=gt(t(),this).startOf("day"),n=this.diff(e,"days",!0),r=n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(r,this))},isLeapYear:function(){return ht(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=It(e,this.lang()),this.add({d:e-t})):t},month:function(e){var n=this._isUTC?"UTC":"",r;if(e!=null){if(typeof e=="string"){e=this.lang().monthsParse(e);if(typeof e!="number")return this}return r=this.date(),this.date(1),this._d["set"+n+"Month"](e),this.date(Math.min(r,this.daysInMonth())),t.updateOffset(this),this}return this._d["get"+n+"Month"]()},startOf:function(e){e=ot(e);switch(e){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return e==="week"?this.weekday(0):e==="isoWeek"&&this.isoWeekday(1),this},endOf:function(e){return e=ot(e),this.startOf(e).add(e==="isoWeek"?"week":e,1).subtract("ms",1)},isAfter:function(e,n){return n=typeof n!="undefined"?n:"millisecond",+this.clone().startOf(n)>+t(e).startOf(n)},isBefore:function(e,n){return n=typeof n!="undefined"?n:"millisecond",+this.clone().startOf(n)<+t(e).startOf(n)},isSame:function(e,t){return t=t||"ms",+this.clone().startOf(t)===+gt(e,this).startOf(t)},min:function(e){return e=t.apply(null,arguments),e<this?this:e},max:function(e){return e=t.apply(null,arguments),e>this?this:e},zone:function(e){var n=this._offset||0;return e==null?this._isUTC?n:this._d.getTimezoneOffset():(typeof e=="string"&&(e=Ct(e)),Math.abs(e)<16&&(e*=60),this._offset=e,this._isUTC=!0,n!==e&&nt(this,t.duration(n-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):typeof this._i=="string"&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e?e=t(e).zone():e=0,(this.zone()-e)%60===0},daysInMonth:function(){return lt(this.year(),this.month())},dayOfYear:function(e){var n=i((t(this).startOf("day")-t(this).startOf("year"))/864e5)+1;return e==null?n:this.add("d",e-n)},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(e){var t=Ut(this,this.lang()._week.dow,this.lang()._week.doy).year;return e==null?t:this.add("y",e-t)},isoWeekYear:function(e){var t=Ut(this,1,4).year;return e==null?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return e==null?t:this.add("d",(e-t)*7)},isoWeek:function(e){var t=Ut(this,1,4).week;return e==null?t:this.add("d",(e-t)*7)},weekday:function(e){var t=(this.day()+7-this.lang()._week.dow)%7;return e==null?t:this.add("d",e-t)},isoWeekday:function(e){return e==null?this.day()||7:this.day(this.day()%7?e:e-7)},get:function(e){return e=ot(e),this[e]()},set:function(e,t){return e=ot(e),typeof this[e]=="function"&&this[e](t),this},lang:function(t){return t===e?this._lang:(this._lang=wt(t),this)}});for(s=0;s<I.length;s++)Xt(I[s].toLowerCase().replace(/s$/,""),I[s]);Xt("year","FullYear"),t.fn.days=t.fn.day,t.fn.months=t.fn.month,t.fn.weeks=t.fn.week,t.fn.isoWeeks=t.fn.isoWeek,t.fn.toJSON=t.fn.toISOString,Z(t.duration.fn=Y.prototype,{_bubble:function(){var e=this._milliseconds,t=this._days,n=this._months,r=this._data,i,s,o,u;r.milliseconds=e%1e3,i=et(e/1e3),r.seconds=i%60,s=et(i/60),r.minutes=s%60,o=et(s/60),r.hours=o%24,t+=et(o/24),r.days=t%30,n+=et(t/30),r.months=n%12,u=et(n/12),r.years=u},weeks:function(){return et(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+ft(this._months/12)*31536e6},humanize:function(e){var t=+this,n=Rt(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},add:function(e,n){var r=t.duration(e,n);return this._milliseconds+=r._milliseconds,this._days+=r._days,this._months+=r._months,this._bubble(),this},subtract:function(e,n){var r=t.duration(e,n);return this._milliseconds-=r._milliseconds,this._days-=r._days,this._months-=r._months,this._bubble(),this},get:function(e){return e=ot(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=ot(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:t.fn.lang,toIsoString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),r=Math.abs(this.hours()),i=Math.abs(this.minutes()),s=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(r||i||s?"T":"")+(r?r+"H":"")+(i?i+"M":"")+(s?s+"S":""):"P0D"}});for(s in q)q.hasOwnProperty(s)&&($t(s,q[s]),Vt(s.toLowerCase()));$t("Weeks",6048e5),t.duration.fn.asMonths=function(){return(+this-this.years()*31536e6)/2592e6+this.years()*12},t.lang("en",{ordinal:function(e){var t=e%10,n=ft(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+n}}),d?(module.exports=t,Jt(!0)):typeof define=="function"&&define.amd?define("moment",["require","exports","module"],function(n,r,i){return i.config&&i.config()&&i.config().noGlobal!==!0&&Jt(i.config().noGlobal===e),t}):Jt()}.call(this),define("mockup-patterns-moment",["jquery","mockup-patterns-base","moment"],function(e,t,n){var r=t.extend({name:"moment",defaults:{selector:null,format:"MMMM Do YYYY, h:mm:ss a"},convert:function(t){var r=this,i=t.attr("data-date");i||(i=e.trim(t.html())),i=n(i);if(!i.isValid())return;r.options.format==="relative"?i=i.fromNow():r.options.format==="calendar"?i=i.calendar():i=i.format(r.options.format),i&&t.html(i)},init:function(){var t=this;t.options.selector?t.$el.find(t.options.selector).each(function(){t.convert(e(this))}):t.convert(t.$el)}});return r}),define("js/patterns/structure/views/table",["jquery","underscore","backbone","js/patterns/structure/views/tablerow","text!js/patterns/structure/templates/table.xml","js/ui/views/base","mockup-patterns-sortable","mockup-patterns-moment"],function(e,t,n,r,i,s,o,u){var a=s.extend({tagName:"div",template:t.template(i),initialize:function(e){var n=this;s.prototype.initialize.apply(n,[e]),n.collection=n.app.collection,n.selectedCollection=n.app.selectedCollection,n.listenTo(n.collection,"sync",n.render),n.listenTo(n.selectedCollection,"remove",n.render),n.listenTo(n.selectedCollection,"reset",n.render),n.collection.pager(),n.subset_ids=[],n.app.on("context-info-loaded",function(e){var r=n.$('[data-id="'+e.defaultPage+'"]');r.length>0&&(r.find("td.title").prepend("<span>*</span> "),r.addClass("default-page"));var i=e.breadcrumbs;if(i&&i.length){var s=n.$(".breadcrumbs a.crumb");t.each(i,function(e,t){s.eq(t).html(e.title)})}})},events:{"click .breadcrumbs a":"breadcrumbClicked","change .select-all":"selectAll"},render:function(){var e=this;e.$el.html(e.template({pathParts:e.app.queryHelper.getCurrentPath().split("/").slice(1),status:e.app.status,statusType:e.app.statusType,activeColumns:e.app.activeColumns,availableColumns:e.app.availableColumns}));if(e.collection.length){var t=e.$("tbody");e.collection.each(function(n){var i=(new r({model:n,app:e.app,table:e})).render();t.append(i.el)})}return e.moment=new u(e.$el,{selector:".ModificationDate,.EffectiveDate,.CreationDate",format:"relative"}),e.addReordering(),e.storeOrder(),this},breadcrumbClicked:function(t){t.preventDefault();var n=e(t.target);n[0].tagName!=="A"&&(n=n.parent("a"));var r="";e(n.prevAll("a").get().reverse()).each(function(){var t=e(this).attr("data-path");r+=t,t!=="/"&&(r+="/")}),r+=n.attr("data-path"),this.app.queryHelper.currentPath=r,this.collection.pager()},selectAll:function(t){e(t.target).is(":checked")?e('input[type="checkbox"]',this.$("tbody")).attr("checked","checked").change():this.selectedCollection.remove(this.collection.models)},toggleSelectAll:function(t){var n=e(t.target);n.is(":checked")||this.$(".select-all").removeAttr("checked")},addReordering:function(){var e=this;if(e.app.inQueryMode()){e.app.setStatus("Can not order items while querying"),e.$el.removeClass("order-support");return}e.$el.addClass("order-support");var t=new o(e.$("tbody"),{selector:"tr",dragClass:"structure-dragging",drop:function(t,n){e.app.moveItem(t.attr("data-id"),n,e.subset_ids),e.storeOrder()}})},storeOrder:function(){var t=this,n=[];t.$("tbody tr.itemRow").each(function(t){n.push(e(this).attr("data-id"))}),t.subset_ids=n}});return a}),define("text!js/ui/templates/popover.xml",[],function(){return'<div class="arrow"></div>\n<div class="popover-title">\n</div>\n<div class="items popover-content">\n</div>\n\n'}),define("js/ui/views/popover",["jquery","underscore","backbone","js/ui/views/container","mockup-patterns-backdrop","text!js/ui/templates/popover.xml"],function(e,t,n,r,i,s){var o=r.extend({tagName:"div",className:"popover",eventPrefix:"popover",template:s,content:null,title:null,triggerView:null,triggerEvents:{"button:click":"toggle"},placement:"bottom",events:{},opened:!1,closeOnOutClick:!0,appendInContainer:!0,backdrop:undefined,$backdrop:null,useBackdrop:!0,backdropOptions:{zIndex:"1009",opacity:"0.4",className:"backdrop backdrop-popover",classActiveName:"backdrop-active",closeOnEsc:!1,closeOnClick:!0},afterRender:function(){var e=this;this.bindTriggerEvents(),this.$(".popover-title").append(this.title(this.options)),this.$(".popover-content").append(this.content(this.options))},bindTriggerEvents:function(){this.triggerView&&t.each(this.triggerEvents,function(t,n){var r=this[t];r||e.error("Function not found."),this.stopListening(this.triggerView,n),this.listenTo(this.triggerView,n,r)},this)},getPosition:function(){var t=this.triggerView.$el;return e.extend({},{width:t[0].offsetWidth,height:t[0].offsetHeight},t.offset())},show:function(){var e=this.getPosition(),t=this.$el,n,r,i,s;r=this.placement,t.css({top:0,left:0}).addClass("active"),i=t[0].offsetWidth,s=t[0].offsetHeight;switch(r){case"bottom":n={top:e.top+e.height,left:e.left+e.width/2-i/2};break;case"top":n={top:e.top-s,left:e.left+e.width/2-i/2};break;case"left":n={top:e.top+e.height/2-s/2,left:e.left-i};break;case"right":n={top:e.top+e.height/2-s/2,left:e.left+e.width}}this.applyPlacement(n,r),this.setBackdrop(),this.useBackdrop===!0&&this.backdrop.show(),this.opened=!0,this.triggerView&&this.triggerView.$el.addClass("active"),this.uiEventTrigger("show",this)},applyPlacement:function(e,t){var n=this.$el,r=this.$el,i=r[0].offsetWidth,s=r[0].offsetHeight,o,u,a,f;n.offset(e).addClass(t).addClass("active"),o=r[0].offsetWidth,u=r[0].offsetHeight,t==="top"&&u!==s&&(e.top=e.top+s-u,f=!0),t==="bottom"||t==="top"?(a=0,e.left<0&&(a=e.left*-2,e.left=0,n.offset(e),o=r[0].offsetWidth,u=r[0].offsetHeight),this.positionArrow(a-i+o,o,"left")):this.positionArrow(u-s,u,"top"),f&&n.offset(e)},positionArrow:function(e,t,n){var r=this.$(".arrow");r.css(n,e?50*(1-e/t)+"%":"")},hide:function(){this.opened=!1,this.$el.removeClass("active"),this.triggerView&&this.triggerView.$el.removeClass("active"),this.uiEventTrigger("hide",this)},toggle:function(e,t){this.opened?this.hide():this.show()},setBackdrop:function(){if(this.useBackdrop===!0&&this.backdrop===undefined){var t=this;this.$backdrop=this.$el.closest(".ui-backdrop-element"),this.$backdrop.length===0&&(this.$backdrop=e("body")),this.backdrop=new i(this.$backdrop,this.backdropOptions),this.backdrop.$el.on("hidden.backdrop.patterns",function(e){e.namespace==="backdrop.patterns"&&(e.stopPropagation(),t.opened===!0&&t.hide())}),this.on("popover:hide",function(){this.backdrop.hide()},this)}}});return o}),define("text!js/patterns/structure/templates/selection_item.xml",[],function(){return'<span class="selected-item">\r  <a href="#" data-uid="<%= UID %>" title="remove" class="remove">\r    <span class="glyphicon glyphicon-remove-circle"></span>\r  </a>\r  <%= Title %>\r</span>\r'}),define("js/patterns/structure/views/selectionwell",["jquery","underscore","backbone","js/ui/views/popover","text!js/patterns/structure/templates/selection_item.xml"],function(e,t,n,r,i){var s=r.extend({className:"popover selected",title:t.template('<input type="text" class="filter" placeholder="Filter" /><a href="#" class=" remove-all"><span class="glyphicon glyphicon-remove-circle"></span> remove all</a>'),content:t.template("<% collection.each(function(item){ %><%= item_template(item.toJSON()) %><% }); %>"),events:{"click a.remove":"itemRemoved","keyup input.filter":"filterSelected","click .remove-all":"removeAll"},initialize:function(e){r.prototype.initialize.apply(this,[e]),this.listenTo(this.collection,"reset all add remove",this.render),this.options.item_template=t.template(i)},render:function(){return r.prototype.render.call(this),this.collection.length===0&&this.$el.removeClass("active"),this},itemRemoved:function(t){t.preventDefault();var n=e(t.currentTarget).data("uid");this.collection.removeByUID(n),this.collection.length!==0&&this.show()},filterSelected:function(t){var n=e(t.target).val().toLowerCase();e(".selected-item",this.$el).each(function(){var t=e(this);t.text().toLowerCase().indexOf(n)===-1?t.hide():t.show()})},removeAll:function(e){e.preventDefault(),this.collection.reset(),this.hide()}});return s}),define("js/patterns/structure/views/tags",["jquery","underscore","backbone","js/ui/views/popover","mockup-patterns-select2"],function(e,t,n,r,i){var s=r.extend({title:t.template("Add/Remove tags"),content:t.template('<label>Tags to remove</label><div class="form-group"><select multiple class="toremove" style="width: 300px"></select></div><label>Tags to add</label><div class="form-group"><input class="toadd" style="width:300px" /></div><button class="btn btn-block btn-primary">Apply</button>'),events:{"click button":"applyButtonClicked"},initialize:function(e){this.app=e.app,this.removeSelect2=null,this.addSelect2=null,r.prototype.initialize.apply(this,[e])},render:function(){return r.prototype.render.call(this),this.$remove=this.$(".toremove"),this.$add=this.$(".toadd"),this.$remove.select2(),this.addSelect2=new i(this.$add,{multiple:!0,vocabularyUrl:this.app.options.tagsVocabularyUrl}),this},getSelect2Values:function(e){var n=[];return t.each(e.select2("data"),function(e){n.push(e.id)}),n},applyButtonClicked:function(e){this.app.defaultButtonClickEvent(this.triggerView,{remove:JSON.stringify(this.getSelect2Values(this.$remove)),add:JSON.stringify(this.getSelect2Values(this.$add))}),this.hide()},toggle:function(e,n){r.prototype.toggle.apply(this,[e,n]);var i=this;if(!this.opened)return;i.$remove.select2("destroy"),i.$remove.empty(),i.$add.select2("data",[]),i.app.selectedCollection.each(function(e){if(!e.attributes.Subject)return;t.each(e.attributes.Subject,function(e){i.$remove.find('[value="'+e+'"]').length===0&&i.$remove.append('<option value="'+e+'">'+e+"</option>")})}),i.$remove.select2()}});return s}),define("js/patterns/structure/views/properties",["jquery","underscore","backbone","js/ui/views/popover","mockup-patterns-pickadate","mockup-patterns-select2"],function(e,t,n,r,i,s){var o=r.extend({className:"popover properties",title:t.template("Modify properties on items"),content:t.template('<div class="form-group"><label>Publication Date</label><input class="form-control" name="effective" /></div><div class="form-group"><label>Expiration Date</label><input class="form-control" name="expiration" /></div><div class="form-group"><label>Copyright</label><textarea class="form-control" name="copyright"></textarea></div><label>Creators</label><div class="form-group"><input name="creators" style="width: 300px" /></div><label>Contributors</label><div class="form-group"><input name="contributors" style="width: 300px" /></div><label>Exclude from nav</label><div class="radio"><label><input type="radio" name="exclude-from-nav" value="yes" />Yes</label></div><div class="radio"><label><input type="radio" name="exclude-from-nav" value="no" />No</label></div><button class="btn btn-block btn-primary">Apply</button>'),events:{"click button":"applyButtonClicked"},initialize:function(e){this.app=e.app,r.prototype.initialize.apply(this,[e])},render:function(){return r.prototype.render.call(this),this.$effective=this.$('[name="effective"]'),this.$expiration=this.$('[name="expiration"]'),this.$copyright=this.$('[name="copyright"]'),this.$creators=this.$('[name="creators"]'),this.$contributors=this.$('[name="contributors"]'),this.$exclude=this.$('[name="exclude-from-nav"]'),this.creatorsSelect2=new s(this.$creators,{multiple:!0,vocabularyUrl:this.app.options.usersVocabularyUrl}),this.contributorsSelect2=new s(this.$contributors,{multiple:!0,vocabularyUrl:this.app.options.usersVocabularyUrl}),this.effectivePickADate=new i(this.$effective),this.expirationPickADate=new i(this.$expiration),this},applyButtonClicked:function(e){var t={effectiveDate:this.effectivePickADate.$date.attr("value"),effectiveTime:this.effectivePickADate.$time.attr("value"),expirationDate:this.expirationPickADate.$date.attr("value"),expirationTime:this.expirationPickADate.$time.attr("value"),copyright:this.$copyright.val(),contributors:JSON.stringify(this.$contributors.select2("data")),creators:JSON.stringify(this.$creators.select2("data"))};this.$('[name="exclude-from-nav"]:checked').length>0&&(t.exclude_from_nav=this.$('[name="exclude-from-nav"]:checked').val()),this.app.defaultButtonClickEvent(this.triggerView,t),this.hide()},toggle:function(e,t){r.prototype.toggle.apply(this,[e,t]);var n=this;if(!this.opened)return;this.$effective.attr("value",""),this.$expiration.attr("value",""),this.$copyright.html(""),this.$creators.select2("data",[]),this.$contributors.select2("data",[]),this.$exclude.each(function(){this.checked=!1})}});return o}),define("js/patterns/structure/views/workflow",["jquery","underscore","backbone","js/ui/views/popover"],function(e,t,n,r){var i=r.extend({className:"popover workflow",title:t.template("Modify dates on items"),content:t.template('<form><fieldset><div class="form-group"><label>Comments</label><textarea class="form-control" rows="4"></textarea><p class="help-block">Select the transition to be used for modifying the items state.</p></div><div class="form-group"><label>Change State</label><p class="help-block">Select the transition to be used for modifying the items state.</p><select class="form-control" name="transition"></select></div><div class="checkbox"><label><input type="checkbox" name="recurse" />Include contained items?</label><p class="help-block">If checked, this will attempt to modify the status of all content in any selected folders and their subfolders.</p></div></fieldset></form><button class="btn btn-block btn-primary">Apply</button>'),events:{"click button":"applyButtonClicked"},initialize:function(e){this.app=e.app,r.prototype.initialize.apply(this,[e])},render:function(){return r.prototype.render.call(this),this.$comments=this.$("textarea"),this.$transition=this.$("select"),this},applyButtonClicked:function(e){var t={comments:this.$comments.val(),transition:this.$transition.val()};this.$('[name="recurse"]')[0].checked&&(t.recurse="yes"),this.app.defaultButtonClickEvent(this.triggerView,t),this.hide()},toggle:function(n,i){r.prototype.toggle.apply(this,[n,i]);var s=this;if(!s.opened)return;s.$comments.val(""),s.$transition.empty(),e.ajax({url:s.triggerView.url,type:"GET",data:{selection:JSON.stringify(s.app.getSelectedUids()),transitions:!0},success:function(e){t.each(e.transitions,function(e){s.$transition.append('<option value="'+e.id+'">'+e.title+"</option>")})},error:function(e){window.alert("error getting transition data")}})}});return i}),define("js/patterns/structure/views/delete",["jquery","underscore","backbone","js/ui/views/popover"],function(e,t,n,r){var i=r.extend({className:"popover delete",title:t.template("Delete selected items"),content:t.template('<label>Are you certain you want to delete the selected items</label><button class="btn btn-block btn-danger">Yes</button>'),events:{"click button":"applyButtonClicked"},initialize:function(e){this.app=e.app,r.prototype.initialize.apply(this,[e])},render:function(){return r.prototype.render.call(this),this},applyButtonClicked:function(e){var t=this;this.app.defaultButtonClickEvent(this.triggerView,{},function(e){t.app.selectedCollection.reset()}),this.hide()}});return i}),define("js/patterns/structure/views/rename",["jquery","underscore","backbone","js/ui/views/popover"],function(e,t,n,r){var i=r.extend({className:"popover rename",title:t.template("Rename items"),content:t.template('<div class="itemstoremove"></div><button class="btn btn-block btn-primary">Apply</button>'),itemTemplate:t.template('<div class="item"><div class="form-group"><input name="UID" type="hidden" value="<%- UID %>" /><label>Title</label><input class="form-control" name="newtitle" value="<%= Title %>" /><label>Short name</label><input class="form-control" name="newid" value="<%= id %>" /></div></div>'),events:{"click button":"applyButtonClicked"},initialize:function(e){this.app=e.app,r.prototype.initialize.apply(this,[e])},render:function(){return r.prototype.render.call(this),this.$items=this.$(".itemstoremove"),this},applyButtonClicked:function(t){var n=[];this.$items.find(".item").each(function(){var t=e(this);n.push({UID:t.find('[name="UID"]').val(),newid:t.find('[name="newid"]').val(),newtitle:t.find('[name="newtitle"]').val()})});var r=this;this.app.defaultButtonClickEvent(this.triggerView,{torename:JSON.stringify(n)}),this.hide()},toggle:function(e,t){r.prototype.toggle.apply(this,[e,t]);var n=this;if(!n.opened)return;n.$items.empty(),n.app.selectedCollection.each(function(e){n.$items.append(n.itemTemplate(e.toJSON()))})}});return i}),define("js/patterns/structure/views/rearrange",["jquery","underscore","js/ui/views/popover"],function(e,t,n){var r=n.extend({className:"popover rearrange",title:t.template("Rearrange items in this folder"),content:t.template('<div class="form-group"><label>What to rearrange on</label><select name="rearrange_on" class="form-control"><% _.each(rearrangeProperties, function(title, property){ %><option value="<%- property %>"><%- title %></option><% }); %></select><p class="help-block">This permanently changes the order of items in this folder.This operation may take a long time depending on the size of the folder.</p></div><div class="checkbox"><label>Reverse <input type="checkbox" name="reversed" /></label></div><button class="btn btn-block btn-primary">Rearrange</button>'),events:{"click button":"rearrangeButtonClicked"},initialize:function(e){this.app=e.app,n.prototype.initialize.apply(this,[e]),this.options.rearrangeProperties=this.app.options.rearrange.properties},render:function(){return n.prototype.render.call(this),this.$rearrangeOn=this.$('[name="rearrange_on"]'),this.$reversed=this.$('[name="reversed"]'),this},rearrangeButtonClicked:function(){var e={rearrange_on:this.$rearrangeOn.val(),reversed:!1};this.$reversed[0].checked&&(e.reversed=!0),this.app.defaultButtonClickEvent(this.triggerView,e),this.hide()}});return r}),define("text!js/patterns/structure/templates/selection_button.xml",[],function(){return'<%= title %> \r<span class="label<% if (length > 0) { %> label-success<% } else { %> label-default<% } %>">\r  <%= length %>\r</span>\r'}),define("js/patterns/structure/views/selectionbutton",["jquery","backbone","underscore","js/ui/views/button","text!js/patterns/structure/templates/selection_button.xml"],function(e,t,n,r,i){var s=r.extend({collection:null,template:i,initialize:function(e){r.prototype.initialize.apply(this,[e]),this.collection!==null&&this.collection.on("add remove reset",function(){this.render(),this.collection.length===0&&this.$el.removeClass("active")},this)},serializedModel:function(){var e={icon:"",title:this.options.title,length:0};return this.collection!==null&&(e.length=this.collection.length),e}});return s}),define("text!js/patterns/structure/templates/paging.xml",[],function(){return'  <ul class="pagination pagination-sm pagination-centered">\n    <li class="<% if (currentPage === 1) { %>disabled<% } %>">\n      <a href="#" class="serverfirst">\n        &laquo;\n      </a>\n    </li>\n    <li class="<% if (currentPage === 1) { %>disabled<% } %>">\n      <a href="#" class="serverprevious">\n        &lt;\n      </a>\n    </li>\n    <% _.each(pages, function(p){ %>\n    <li class="<% if (currentPage == p) { %>active<% } %>">\n      <a href="#" class="page"><%= p %></a>\n    </li>\n    <% }); %>\n    <li class="<% if (currentPage === lastPage) { %>disabled<% } %>">\n      <a href="#" class="servernext">\n        &gt;\n      </a>\n    </li>\n    <li class="<% if (currentPage === lastPage) { %>disabled<% } %>">\n      <a href="#" class="serverlast">\n        &raquo;\n      </a>\n    </li>\n  </ul>\n\n  <ul class="pagination pagination-sm">\n    <li class="disabled"><a href="#">Show:</a></li>\n    <li class="serverhowmany serverhowmany15 <% if(perPage == 15){ %>disabled<% } %>">\n      <a href="#" class="">15</a>\n    </li>\n    <li class="serverhowmany serverhowmany30 <% if(perPage == 30){ %>disabled<% } %>">\n      <a href="#" class="">30</a>\n    </li>\n    <li class="serverhowmany serverhowmany50 <% if(perPage == 50){ %>disabled<% } %>">\n      <a href="#" class="">50</a>\n    </li>\n  </ul>\n\n  <ul class="pagination pagination-sm">\n    <li class="disabled">\n      <a href="#">\n        Page: <span class="current"><%= currentPage %></span>\n        of\n        <span class="total"><%= totalPages %></span>\n              shown\n      </a>\n    </li>\n  </ul>\n'}),define("js/patterns/structure/views/paging",["jquery","underscore","backbone","text!js/patterns/structure/templates/paging.xml"],function(e,t,n,r){var i=n.View.extend({events:{"click a.servernext":"nextResultPage","click a.serverprevious":"previousResultPage","click a.serverlast":"gotoLast","click a.page":"gotoPage","click a.serverfirst":"gotoFirst","click a.serverpage":"gotoPage","click .serverhowmany a":"changeCount"},tagName:"aside",template:t.template(r),maxPages:7,initialize:function(e){this.options=e,this.app=this.options.app,this.collection=this.app.collection,this.collection.on("reset",this.render,this),this.collection.on("sync",this.render,this),this.$el.appendTo("#pagination")},render:function(){var e=this.collection.info();e.pages=this.getPages(e);var t=this.template(e);return this.$el.html(t),this},getPages:function(e){var t=e.perPage,n=e.totalPages;if(!n)return[];var r=e.currentPage,i=1,s=n;n>this.maxPages&&(i=Math.max(1,Math.floor(r-this.maxPages/2)),s=Math.min(i+this.maxPages,n),s-i<this.maxPages&&(i-=Math.floor(this.maxPages/2)));var o=[];for(var u=i;u<=s;u+=1)o.push(u);return o[0]>1&&(o[0]>2&&(o=["..."].concat(o)),o=[1].concat(o)),o[o.length-1]<n-1&&(o[o.length-2]<n-2&&o.push("..."),o.push(n)),o},nextResultPage:function(e){e.preventDefault(),this.collection.requestNextPage()},previousResultPage:function(e){e.preventDefault(),this.collection.requestPreviousPage()},gotoFirst:function(e){e.preventDefault(),this.collection.goTo(this.collection.information.firstPage)},gotoLast:function(e){e.preventDefault(),this.collection.goTo(this.collection.information.totalPages)},gotoPage:function(t){t.preventDefault();var n=e(t.target).text();this.collection.goTo(n)},changeCount:function(t){t.preventDefault();var n=e(t.target).text();this.collection.howManyPer(n)}});return i}),define("js/patterns/structure/views/addmenu",["jquery","underscore","backbone","js/ui/views/buttongroup","js/ui/views/button","mockup-patterns-modal","mockup-utils","bootstrap-dropdown"],function(e,t,n,r,i,s,o){var u=r.extend({title:"Add",className:"btn-group addnew",events:{},initialize:function(n){var s=this;r.prototype.initialize.apply(s,[n]),s.app.on("context-info-loaded",function(n){s.$items.empty(),t.each(n.addButtons,function(t){var n=new i({id:t.id,title:t.title,url:t.action});n.render();var r=e("<li/>");n.$el.removeClass("btn"),r.append(n.el),s.$items.append(r),n.$el.click(function(e){return s.buttonClicked.apply(s,[e,n]),!1})})})},buttonClicked:function(t,n){var r=this;t.preventDefault(),r.app.loading.show(),e.ajax({url:n.url,type:"POST",data:{_authenticator:e('[name="_authenticator"]').val()},success:function(e){r.app.loading.hide();var t=new s(r.$el,{html:o.parseBodyTag(e),content:"#content",width:"80%",backdropOptions:{closeOnClick:!1},automaticallyAddButtonActions:!1,actionOptions:{displayInModal:!1,reloadWindowOnClose:!1},actions:{'input#form-buttons-save, .formControls input[name="form.button.save"]':{onSuccess:function(e,t,n,i,s){r.app.collection.pager(),r.$items.is(":visible")&&r.$dropdown.dropdown("toggle"),e.hide()},onError:function(){alert("error on form")}},'input#form-buttons-cancel, .formControls input[name="form.button.cancel"]':{modalFunction:"hide"}}});t.show()},error:function(){r.app.loading.hide()}})},render:function(){var e=this;return e.$el.empty(),e.$el.append('<a class="btn dropdown-toggle btn-success" data-toggle="dropdown" href="#">'+e.title+'<span class="caret"></span>'+"</a>"+'<ul class="dropdown-menu">'+"</ul>"+"</div>"),e.$items=e.$(".dropdown-menu"),e.$dropdown=e.$(".dropdown-toggle"),e.$dropdown.dropdown(),this}});return u}),define("js/patterns/structure/views/columns",["jquery","underscore","backbone","js/ui/views/popover","mockup-patterns-sortable"],function(e,t,n,r,i){var s=r.extend({className:"popover columns",title:t.template("Columns"),content:t.template('<label>Select columns to show, drag and drop to reorder</label><ul></ul><button class="btn btn-block btn-success">Save</button>'),itemTemplate:t.template('<li><label><input type="checkbox" value="<%- id %>"/><%- title %></label></li>'),events:{"click button":"applyButtonClicked"},initialize:function(e){this.app=e.app,r.prototype.initialize.apply(this,[e])},render:function(){var n=this;r.prototype.render.call(this),n.$container=n.$("ul"),t.each(n.app.activeColumns,function(t){var r=e(n.itemTemplate({title:n.app.availableColumns[t],id:t}));r.find("input")[0].checked=!0,n.$container.append(r)}),t.each(t.omit(n.app.availableColumns,n.app.activeColumns),function(t,r){var i=e(n.itemTemplate({title:t,id:r}));n.$container.append(i)});var s=new i(n.$container,{selector:"li"});return this},applyButtonClicked:function(){var t=this;this.hide(),t.app.activeColumns=[],t.$("input:checked").each(function(){t.app.activeColumns.push(e(this).val())}),t.app.setCookieSetting("activeColumns",this.app.activeColumns),t.app.tableView.render()}});return s}),define("js/patterns/structure/views/textfilter",["jquery","backbone","underscore","js/ui/views/base","js/ui/views/button","js/ui/views/popover","mockup-patterns-querystring"],function(e,t,n,r,i,s,o){var u=r.extend({tagName:"div",className:"navbar-search form-search ui-offset-parent",template:n.template('<div class="input-group"><input type="text" class="form-control search-query" placeholder="Filter"><span class="input-group-btn"></span></div>'),popoverContent:n.template('<input class="pat-querystring" />'),events:{"keyup .search-query":"filter"},term:null,timeoutId:null,keyupDelay:300,initialize:function(e){r.prototype.initialize.apply(this,[e]),this.app=this.options.app},render:function(){this.$el.html(this.template({})),this.button=new i({title:"Query"}),this.popover=new s({triggerView:this.button,title:n.template("Query"),content:this.popoverContent,placement:"left"}),this.$(".input-group-btn").append(this.button.render().el),this.$el.append(this.popover.render().el),this.popover.$el.addClass("query"),this.$queryString=this.popover.$("input.pat-querystring"),this.queryString=new o(this.$queryString,{indexOptionsUrl:this.app.options.indexOptionsUrl,showPreviews:!1});var t=this;return t.queryString.$el.on("change",function(){t.timeoutId&&clearTimeout(t.timeoutId),t.timeoutId=setTimeout(function(){var n=e.parseJSON(t.$queryString.val());t.app.additionalCriterias=n,t.app.collection.pager()},this.keyupDelay)}),t.queryString.$el.on("initialized",function(){t.queryString.$sortOn.on("change",function(){t.app.sort_on=t.queryString.$sortOn.val(),t.app.collection.pager()}),t.queryString.$sortOrder.change(function(){t.queryString.$sortOrder[0].checked?t.app.sort_order="reverse":t.app.sort_order="ascending",t.app.collection.pager()})}),this},filter:function(t){var n=this;n.timeoutId&&clearTimeout(n.timeoutId),n.timeoutId=setTimeout(function(){n.term=e(t.currentTarget).val(),n.app.collection.pager()},this.keyupDelay)}});return u}),define("js/patterns/structure/models/result",["backbone"],function(e){var t=e.Model.extend({defaults:function(){return{is_folderish:!1,review_state:""}},uid:function(){return this.attributes.UID}});return t}),Backbone.Paginator=function(e,t,n){var r=t.map(e.VERSION.split("."),function(e){return parseInt(e,10)}),i={};i.version="<%= pkg.version %>",i.clientPager=e.Collection.extend({useDiacriticsPlugin:!0,useLevenshteinPlugin:!0,sortColumn:"",sortDirection:"desc",lastSortColumn:"",fieldFilterRules:[],lastFieldFilterRules:[],filterFields:"",filterExpression:"",lastFilterExpression:"",defaults_ui:{firstPage:0,currentPage:1,perPage:5,totalPages:10,pagesInRange:4},initialize:function(){this.on("add",this.addModel,this),this.on("remove",this.removeModel,this),this.setDefaults()},setDefaults:function(){var e=t.defaults(this.paginator_ui,this.defaults_ui);t.defaults(this,e)},addModel:function(e){this.origModels.push(e)},removeModel:function(e){var n=t.indexOf(this.origModels,e);this.origModels.splice(n,1)},sync:function(i,s,o){var u=this;this.setDefaults();var a={};t.each(t.result(u,"server_api"),function(e,n){t.isFunction(e)&&(e=t.bind(e,u),e=e()),a[n]=e});var f=t.clone(u.paginator_core);t.each(f,function(e,n){t.isFunction(e)&&(e=t.bind(e,u),e=e()),f[n]=e}),f=t.defaults(f,{timeout:25e3,cache:!1,type:"GET",dataType:"jsonp"}),f=t.extend(f,{data:decodeURIComponent(n.param(a)),processData:!1,url:t.result(f,"url")},o);var l=r[0]!==0||r[1]!==9||r[2]!==10,c=f.success;f.success=function(e,t,n){c&&(l?c(e,t,n):c(s,e,f)),s&&s.trigger&&s.trigger("sync",s,e,f)};var h=f.error;f.error=function(e){h&&h(s,e,f),s&&s.trigger&&s.trigger("error",s,e,f)};var p=f.xhr=e.ajax(f);return s&&s.trigger&&s.trigger("request",s,p,f),p},nextPage:function(e){this.currentPage<this.information.totalPages&&(this.currentPage=++this.currentPage,this.pager(e))},previousPage:function(e){this.currentPage>1&&(this.currentPage=--this.currentPage,this.pager(e))},goTo:function(e,t){e!==undefined&&(this.currentPage=parseInt(e,10),this.pager(t))},howManyPer:function(e){if(e!==undefined){var t=this.perPage;this.perPage=parseInt(e,10),this.currentPage=Math.ceil((t*(this.currentPage-1)+1)/e),this.pager()}},setSort:function(e,t){e!==undefined&&t!==undefined&&(this.lastSortColumn=this.sortColumn,this.sortColumn=e,this.sortDirection=t,this.pager(),this.info())},setFieldFilter:function(e){t.isEmpty(e)?(this.lastFieldFilterRules=this.fieldFilterRules,this.fieldFilterRules="",this.pager(),this.info()):(this.lastFieldFilterRules=this.fieldFilterRules,this.fieldFilterRules=e,this.pager(),this.info())},doFakeFieldFilter:function(e){if(!t.isEmpty(e)){var n=this.origModels;return n===undefined&&(n=this.models),n=this._fieldFilter(n,e),this.filterExpression!==""&&(n=this._filter(n,this.filterFields,this.filterExpression)),n.length}},setFilter:function(e,t){e!==undefined&&t!==undefined&&(this.filterFields=e,this.lastFilterExpression=this.filterExpression,this.filterExpression=t,this.pager(),this.info())},doFakeFilter:function(e,n){if(e!==undefined&&n!==undefined){var r=this.origModels;return r===undefined&&(r=this.models),t.isEmpty(this.fieldFilterRules)||(r=this._fieldFilter(r,this.fieldFilterRules)),r=this._filter(r,e,n),r.length}},pager:function(e){var n=this,r=this.perPage,i=(n.currentPage-1)*r,s=i+r;n.origModels===undefined&&(n.origModels=n.models),n.models=n.origModels.slice(),this.sortColumn!==""&&(n.models=n._sort(n.models,this.sortColumn,this.sortDirection)),t.isEmpty(this.fieldFilterRules)||(n.models=n._fieldFilter(n.models,this.fieldFilterRules)),this.filterExpression!==""&&(n.models=n._filter(n.models,this.filterFields,this.filterExpression));if(this.lastSortColumn!==this.sortColumn||this.lastFilterExpression!==this.filterExpression||!t.isEqual(this.fieldFilterRules,this.lastFieldFilterRules))i=0,s=i+r,n.currentPage=1,this.lastSortColumn=this.sortColumn,this.lastFieldFilterRules=this.fieldFilterRules,this.lastFilterExpression=this.filterExpression;n.sortedAndFilteredModels=n.models.slice(),n.info(),n.reset(n.models.slice(i,s)),t.result(e,"success")},_sort:function(e,n,r){return e=e.sort(function(e,i){var s=e.get(n),o=i.get(n);if(t.isUndefined(s)||t.isUndefined(o)||s===null||o===null)return 0;s=s.toString().toLowerCase(),o=o.toString().toLowerCase();if(r==="desc")if(!s.match(/[^\-\d\.]/)&&s.match(/-?[\d\.]+/)&&!o.match(/[^\-\d\.]/)&&o.match(/-?[\d\.]+/)){if(s-0<o-0)return 1;if(s-0>o-0)return-1}else{if(s<o)return 1;if(s>o)return-1}else if(!s.match(/[^\-\d\.]/)&&s.match(/-?[\d\.]+/)&&!o.match(/[^\-\d\.]/)&&o.match(/-?[\d\.]+/)){if(s-0<o-0)return-1;if(s-0>o-0)return 1}else{if(s<o)return-1;if(s>o)return 1}if(e.cid&&i.cid){var u=e.cid,a=i.cid;if(u<a)return-1;if(u>a)return 1}return 0}),e},_fieldFilter:function(e,n){if(t.isEmpty(n))return e;var r=[];return t.each(e,function(e){var i=!0;t.each(n,function(n){if(!i)return!1;i=!1;if(n.type==="function"){var r=t.wrap(n.value,function(t){return t(e.get(n.field))});r()&&(i=!0)}else n.type==="required"?t.isEmpty(e.get(n.field).toString())||(i=!0):n.type==="min"?!t.isNaN(Number(e.get(n.field)))&&!t.isNaN(Number(n.value))&&Number(e.get(n.field))>=Number(n.value)&&(i=!0):n.type==="max"?!t.isNaN(Number(e.get(n.field)))&&!t.isNaN(Number(n.value))&&Number(e.get(n.field))<=Number(n.value)&&(i=!0):n.type==="range"?!t.isNaN(Number(e.get(n.field)))&&t.isObject(n.value)&&!t.isNaN(Number(n.value.min))&&!t.isNaN(Number(n.value.max))&&Number(e.get(n.field))>=Number(n.value.min)&&Number(e.get(n.field))<=Number(n.value.max)&&(i=!0):n.type==="minLength"?e.get(n.field).toString().length>=n.value&&(i=!0):n.type==="maxLength"?e.get(n.field).toString().length<=n.value&&(i=!0):n.type==="rangeLength"?t.isObject(n.value)&&!t.isNaN(Number(n.value.min))&&!t.isNaN(Number(n.value.max))&&e.get(n.field).toString().length>=n.value.min&&e.get(n.field).toString().length<=n.value.max&&(i=!0):n.type==="oneOf"?t.isArray(n.value)&&t.include(n.value,e.get(n.field))&&(i=!0):n.type==="equalTo"?n.value===e.get(n.field)&&(i=!0):n.type==="containsAllOf"?t.isArray(n.value)&&t.isArray(e.get(n.field))&&t.intersection(n.value,e.get(n.field)).length===n.value.length&&(i=!0):n.type==="pattern"?e.get(n.field).toString().match(n.value)&&(i=!0):i=!1}),i&&r.push(e)}),r},_filter:function(n,r,i){var s=this,o={};t.isString(r)?o[r]={cmp_method:"regexp"}:t.isArray(r)?t.each(r,function(e){o[e]={cmp_method:"regexp"}}):t.each(r,function(e,n){o[n]=t.defaults(e,{cmp_method:"regexp"})}),r=o,t.has(e.Paginator,"removeDiacritics")&&s.useDiacriticsPlugin&&(i=e.Paginator.removeDiacritics(i));if(i===""||!t.isString(i))return n;var u=t.map(i.match(/\w+/ig),function(e){return e.toLowerCase()}),a="("+t.uniq(u).join("|")+")",f=new RegExp(a,"igm"),l=[];return t.each(n,function(n){var o=[];t.each(r,function(r,a){var l=n.get(a);if(l){var c=[];t.has(e.Paginator,"removeDiacritics")&&s.useDiacriticsPlugin?l=e.Paginator.removeDiacritics(l.toString()):l=l.toString();if(r.cmp_method==="levenshtein"&&t.has(e.Paginator,"levenshtein")&&s.useLevenshteinPlugin){var h=e.Paginator.levenshtein(l,i);t.defaults(r,{max_distance:0}),h<=r.max_distance&&(c=t.uniq(u))}else c=l.match(f);c=t.map(c,function(e){return e.toString().toLowerCase()}),t.each(c,function(e){o.push(e)})}}),o=t.uniq(t.without(o,"")),t.isEmpty(t.difference(u,o))&&l.push(n)}),l},info:function(){var e=this,t={},n=e.sortedAndFilteredModels?e.sortedAndFilteredModels.length:e.length,r=Math.ceil(n/e.perPage);return t={totalUnfilteredRecords:e.origModels.length,totalRecords:n,currentPage:e.currentPage,perPage:this.perPage,totalPages:r,lastPage:r,previous:!1,next:!1,startRecord:n===0?0:(e.currentPage-1)*this.perPage+1,endRecord:Math.min(n,e.currentPage*this.perPage)},e.currentPage>1&&(t.previous=e.currentPage-1),e.currentPage<t.totalPages&&(t.next=e.currentPage+1),t.pageSet=e.setPagination(t),e.information=t,t},setPagination:function(e){var t=[],n=0,r=0,i=this.pagesInRange*2,s=Math.ceil(e.totalRecords/e.perPage);if(s>1)if(s<=1+i)for(n=1,r=s;n<=r;n++)t.push(n);else if(e.currentPage<=this.pagesInRange+1)for(n=1,r=2+i;n<r;n++)t.push(n);else if(s-this.pagesInRange>e.currentPage&&e.currentPage>this.pagesInRange)for(n=e.currentPage-this.pagesInRange;n<=e.currentPage+this.pagesInRange;n++)t.push(n);else for(n=s-i;n<=s;n++)t.push(n);return t},bootstrap:function(e){return t.extend(this,e),this.goTo(1),this.info(),this}}),i.clientPager.prototype.prevPage=i.clientPager.prototype.previousPage;var s=function(){var e=new n.Deferred;return e.reject(),e.promise()};return i.requestPager=e.Collection.extend({sync:function(i,s,o){var u=this;u.setDefaults();var a={};t.each(t.result(u,"server_api"),function(e,n){t.isFunction(e)&&(e=t.bind(e,u),e=e()),a[n]=e});var f=t.clone(u.paginator_core);t.each(f,function(e,n){t.isFunction(e)&&(e=t.bind(e,u),e=e()),f[n]=e}),f=t.defaults(f,{timeout:25e3,cache:!1,type:"GET",dataType:"jsonp"}),o.data?o.data=decodeURIComponent(n.param(t.extend(a,o.data))):o.data=decodeURIComponent(n.param(a)),f=t.extend(f,{data:decodeURIComponent(n.param(a)),processData:!1,url:t.result(f,"url")},o);var l=r[0]!==0||r[1]!==9||r[2]!==10,c=f.success;f.success=function(e,t,n){c&&(l?c(e,t,n):c(s,e,f)),r[0]<1&&s&&s.trigger&&s.trigger("sync",s,e,f)};var h=f.error;f.error=function(e){h&&h(e),s&&s.trigger&&s.trigger("error",s,e,f)};var p=f.xhr=e.ajax(f);return s&&s.trigger&&s.trigger("request",s,p,f),p},setDefaults:function(){var e=this;t.defaults(e.paginator_ui,{firstPage:0,currentPage:1,perPage:5,totalPages:10,pagesInRange:4}),t.each(e.paginator_ui,function(n,r){t.isUndefined(e[r])&&(e[r]=e.paginator_ui[r])})},requestNextPage:function(e){return this.currentPage!==undefined?(this.currentPage+=1,this.pager(e)):s()},requestPreviousPage:function(e){return this.currentPage!==undefined?(this.currentPage-=1,this.pager(e)):s()},updateOrder:function(e,t){return e!==undefined?(this.sortField=e,this.pager(t)):s()},goTo:function(e,t){return e!==undefined?(this.currentPage=parseInt(e,10),this.pager(t)):s()},howManyPer:function(e,t){return e!==undefined?(this.currentPage=this.firstPage,this.perPage=e,this.pager(t)):s()},info:function(){var e={totalRecords:this.totalRecords||0,currentPage:this.currentPage,firstPage:this.firstPage,totalPages:Math.ceil(this.totalRecords/this.perPage),lastPage:this.totalPages,perPage:this.perPage,previous:!1,next:!1};return this.currentPage>1&&(e.previous=this.currentPage-1),this.currentPage<e.totalPages&&(e.next=this.currentPage+1),e.hasNext=e.next,e.hasPrevious=e.next,e.pageSet=this.setPagination(e),this.information=e,e},setPagination:function(e){var t=[],n=0,r=0,i=this.pagesInRange*2,s=Math.ceil(e.totalRecords/e.perPage);if(s>1)if(s<=1+i)for(n=1,r=s;n<=r;n++)t.push(n);else if(e.currentPage<=this.pagesInRange+1)for(n=1,r=2+i;n<r;n++)t.push(n);else if(s-this.pagesInRange>e.currentPage&&e.currentPage>this.pagesInRange)for(n=e.currentPage-this.pagesInRange;n<=e.currentPage+this.pagesInRange;n++)t.push(n);else for(n=s-i;n<=s;n++)t.push(n);return t},pager:function(e){return t.isObject(e)||(e={}),this.fetch(e)},url:function(){return this.paginator_core!==undefined&&this.paginator_core.url!==undefined?this.paginator_core.url:null},bootstrap:function(e){return t.extend(this,e),this.setDefaults(),this.info(),this}}),i.requestPager.prototype.nextPage=i.requestPager.prototype.requestNextPage,i.requestPager.prototype.prevPage=i.requestPager.prototype.requestPreviousPage,i}(Backbone,_,jQuery),define("backbone.paginator",["backbone"],function(e){return function(){var t,n;return t||e.window.Backbone.Paginator}}(this)),define("js/patterns/structure/collections/result",["underscore","backbone","js/patterns/structure/models/result","backbone.paginator"],function(e,t,n){var r=t.Paginator.requestPager.extend({model:n,queryHelper:null,initialize:function(e,n){this.options=n,this.url=n.url,this.queryParser=n.queryParser,this.queryHelper=n.queryHelper,t.Paginator.requestPager.prototype.initialize.apply(this,[e,n])},pager:function(){this.trigger("pager"),t.Paginator.requestPager.prototype.pager.apply(this,[])},paginator_core:{type:"GET",dataType:"json",url:function(){return this.url}},paginator_ui:{firstPage:1,currentPage:1,perPage:15},server_api:{query:function(){return this.queryParser()},batch:function(){return this.queryHelper.options.batchSize=this.perPage,JSON.stringify(this.queryHelper.getBatch(this.currentPage))},attributes:function(){return JSON.stringify(this.queryHelper.options.attributes)}},parse:function(t){this.totalRecords=t.total;var n=t.results;return e.each(n,function(e,t){e._sort=t}),n},comparator:"_sort"});return r}),define("js/patterns/structure/collections/selected",["backbone","js/patterns/structure/models/result"],function(e,t){var n=e.Collection.extend({model:t,removeResult:function(e){return this.removeByUID(e.uid())},removeByUID:function(e){var t=this.getByUID(e);return t&&this.remove(t),t},getByUID:function(e){return this.findWhere({UID:e})}});return n}),define("js/patterns/structure/views/app",["jquery","underscore","backbone","js/ui/views/toolbar","js/ui/views/buttongroup","js/ui/views/button","js/ui/views/base","js/patterns/structure/views/table","js/patterns/structure/views/selectionwell","js/patterns/structure/views/tags","js/patterns/structure/views/properties","js/patterns/structure/views/workflow","js/patterns/structure/views/delete","js/patterns/structure/views/rename","js/patterns/structure/views/rearrange","js/patterns/structure/views/selectionbutton","js/patterns/structure/views/paging","js/patterns/structure/views/addmenu","js/patterns/structure/views/columns","js/patterns/structure/views/textfilter","js/patterns/structure/collections/result","js/patterns/structure/collections/selected","mockup-patterns-dropzone","mockup-utils","jquery.cookie"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){var T="DISABLE",N=o.extend({tagName:"div",buttonClickEvents:{cut:"cutCopyClickEvent",copy:"cutCopyClickEvent",paste:"pasteEvent",tags:T,properties:T,workflow:T,"delete":T,rename:T,rearrange:T},buttonViewMapping:{"secondary.tags":f,"secondary.properties":l,"secondary.workflow":c,"primary.delete":h,"secondary.rename":p},status:"",statusType:"warning",pasteOperation:null,sort_on:"getObjPositionInParent",sort_order:"ascending",additionalCriterias:[],pasteSelection:null,cookieSettingPrefix:"_fc_",initialize:function(n){var r=this;o.prototype.initialize.apply(r,[n]),r.setAllCookieSettings(),r.loading=new x.ProgressIndicator({container:r.$el}),r.loading.show(),r.collection=new w([],{url:r.options.collectionUrl,queryParser:function(){var e=null;r.toolbar&&(e=r.toolbar.get("filter").term);var t=r.sort_on;return t||(t="getObjPositionInParent"),JSON.stringify({criteria:r.queryHelper.getCriterias(e,{additionalCriterias:r.additionalCriterias}),sort_on:t,sort_order:r.sort_order})},queryHelper:r.options.queryHelper}),r.queryHelper=r.options.queryHelper,r.selectedCollection=new E,r.tableView=new u({app:r}),r.pagingView=new m({app:r}),r.pasteAllowed=r.options.pasteAllowed,r.setupButtons(),r.wellView=new a({collection:r.selectedCollection,triggerView:r.toolbar.get("selected"),app:r}),r.buttonViews={},t.map(r.buttonViewMapping,function(e,t,n){var i=t.split("."),s=i[0],o=i[1];r.buttonViews[t]=new e({triggerView:r.buttons[s].get(o),app:r})}),r.toolbar.get("selected").disable(),r.buttons.primary.disable(),r.buttons.secondary.disable(),r.selectedCollection.on("add remove reset",function(e,t){t.length?(r.toolbar.get("selected").enable(),r.buttons.primary.enable(),r.buttons.secondary.enable(),r.pasteAllowed||r.buttons.primary.get("paste").disable()):(this.toolbar.get("selected").disable(),r.buttons.primary.disable(),r.buttons.secondary.disable())},r),r.collection.on("sync",function(){if(r.selectedCollection.models.length>0){var n=[];r.selectedCollection.each(function(e){n.push(e.attributes.UID)}),r.queryHelper.search("UID","plone.app.querystring.operation.list.contains",n,function(e){t.each(e.results,function(e){var t=r.selectedCollection.getByUID(e.UID);t.attributes=e})},!1)}r.contextInfoUrl&&e.ajax({url:r.getAjaxUrl(r.contextInfoUrl),dataType:"json",success:function(e){r.trigger("context-info-loaded",e)},error:function(e){e.status===404&&console.log("context info url not found")}}),r.loading.hide()}),r.collection.on("pager",function(){r.loading.show()}),e(document).bind("keyup keydown",function(e){r.keyEvent=e})},inQueryMode:function(){return this.additionalCriterias.length>0?!0:this.sort_on&&this.sort_on!=="getObjPositionInParent"?!0:this.sort_order!=="ascending"?!0:!1},getSelectedUids:function(e){var t=this;e===undefined&&(e=t.selectedCollection);var n=[];return e.each(function(e){n.push(e.uid())}),n},getAjaxUrl:function(e){return e.replace("{path}",this.options.queryHelper.getCurrentPath())},defaultButtonClickEvent:function(t){var n=this,r=null,i=null;if(t.url){n.loading.show();if(arguments.length>1){var s=arguments[1];s.preventDefault||(r=s)}if(arguments.length>2){var o=arguments[2];typeof o=="function"&&(i=o)}r===null&&(r={}),r.selection===undefined&&(r.selection=JSON.stringify(n.getSelectedUids())),r._authenticator=e('input[name="_authenticator"]').val(),r.folder===undefined&&(r.folder=n.options.queryHelper.getCurrentPath());var u=n.getAjaxUrl(t.url);e.ajax({url:u,type:"POST",data:r,success:function(e){n.ajaxSuccessResponse.apply(n,[e,i]),n.loading.hide()},error:function(e){n.ajaxErrorResponse.apply(n,[e,u]),n.loading.hide()}},n)}},ajaxSuccessResponse:function(e,t){var n=this;e.status==="success"&&n.collection.reset(),e.msg&&n.setStatus(e.msg),t!==null&&t!==undefined&&t(e),n.collection.pager()},ajaxErrorResponse:function(e,t){var n=this;e.status===404?window.alert('operation url "'+t+'" is not valid'):window.alert("there was an error performing action")},pasteEvent:function(t,n,r){var i=this;r===undefined&&(r={}),r=e.extend(!0,{},{selection:JSON.stringify(i.getSelectedUids(i.pasteSelection)),pasteOperation:i.pasteOperation},r),i.defaultButtonClickEvent(t,r)},cutCopyClickEvent:function(e){var t=this,r;e.id==="cut"?(r="cut ",t.pasteOperation="cut"):(r="copied ",t.pasteOperation="copy"),t.pasteSelection=new n.Collection,t.selectedCollection.each(function(e){t.pasteSelection.add(e)}),r+="selection",t.setStatus(r),t.pasteAllowed=!0,t.buttons.primary.get("paste").enable()},setupButtons:function(){var e=this;e.buttons={};var n=[],o=new s({id:"columns",tooltip:"Configure displayed columns",icon:"align-justify"});e.columnsView=new y({app:e,triggerView:o}),n.push(o),n.push(new v({title:"Selected",id:"selected",collection:this.selectedCollection})),e.options.contextInfoUrl&&n.push(new g({contextInfoUrl:e.options.contextInfoUrl,app:e}));if(e.options.rearrange){var u=new s({id:"rearrange",title:"Rearrange",tooltip:"Rearrange folder contents",url:e.options.rearrange.url});e.rearrangeView=new d({triggerView:u,app:e}),n.push(u)}t.each(t.pairs(this.options.buttonGroups),function(r){var o=[];t.each(r[1],function(t){t=new s(t),o.push(t);var n=e.buttonClickEvents[t.id];n!==T&&(n===undefined&&(n="defaultButtonClickEvent"),t.on("button:click",e[n],e))}),e.buttons[r[0]]=new i({items:o,id:r[0],app:e}),n.push(e.buttons[r[0]])});if(e.options.uploadUrl){var a=new s({title:"Upload",context:"success",icon:"upload"});n.push(a),a.on("button:click",function(){e.dropzone.options.url=e.getAjaxUrl(e.options.uploadUrl),e.dropzone.hiddenFileInput.click()})}n.push(new b({id:"filter",app:this})),this.toolbar=new r({items:n})},moveItem:function(t,n,r){var i=this;e.ajax({url:this.getAjaxUrl(this.options.moveUrl),type:"POST",data:{delta:n,id:t,_authenticator:e('[name="_authenticator"]').val(),subset_ids:JSON.stringify(r)},dataType:"json",success:function(e){e.msg?i.setStatus(e.msg):e.status!=="success"&&i.setStatus("error moving item"),i.collection.pager()},error:function(e){i.setStatus("error moving item")}})},setStatus:function(e,t){this.status=e,t===undefined&&(t="warning"),this.statusType=t,this.$(".status").addClass(t).html(e)},render:function(){var n=this;return n.$el.append(n.toolbar.render().el),n.$el.append(n.wellView.render().el),n.$el.append(n.columnsView.render().el),n.rearrangeView&&n.$el.append(n.rearrangeView.render().el),t.each(n.buttonViews,function(e){n.$el.append(e.render().el)}),n.$el.append(n.tableView.render().el),n.$el.append(n.pagingView.render().el),n.options.uploadUrl&&(n.dropzone=(new S(n.$el,{className:"structure-dropzone",clickable:e("<div/>")[0],url:n.getAjaxUrl(n.options.uploadUrl),autoCleanResults:!0,useTus:n.options.useTus,success:function(){n.collection.pager()}})).dropzone,n.dropzone.on("drop",function(){n.dropzone.options.url=n.getAjaxUrl(n.options.uploadUrl)}),e(n.dropzone.hiddenFileInput).attr("multiple","true")),n.options.backdropSelector!==null?e(n.options.backdropSelector).addClass("ui-backdrop-element"):n.$el.addClass("ui-backdrop-element"),n},getCookieSetting:function(t,n){n===undefined&&(n=null);var r;try{r=e.cookie(this.cookieSettingPrefix+t),r=e.parseJSON(r).value}catch(i){return n}return r===undefined||r===null?n:r},setCookieSetting:function(t,n){e.cookie(this.cookieSettingPrefix+t,JSON.stringify({value:n}))},setAllCookieSettings:function(){this.activeColumns=this.getCookieSetting("activeColumns",this.activeColumns)}});return N}),define("mockup-patterns-structure",["jquery","mockup-patterns-base","mockup-utils","js/patterns/structure/views/app","text!js/patterns/structure/templates/paging.xml","text!js/patterns/structure/templates/selection_button.xml","text!js/patterns/structure/templates/selection_item.xml","text!js/patterns/structure/templates/tablerow.xml","text!js/patterns/structure/templates/table.xml","text!js/ui/templates/popover.xml"],function(e,t,n,r){var i=t.extend({name:"structure",defaults:{vocabularyUrl:null,tagsVocabularyUrl:null,usersVocabularyUrl:null,indexOptionsUrl:null,contextInfoUrl:null,setDefaultPageUrl:null,backdropSelector:".modal",attributes:["UID","Title","Type","path","review_state","ModificationDate","EffectiveDate","CreationDate","is_folderish","Subject","getURL","id","exclude_from_nav","getObjSize","last_comment_date","total_comments"],activeColumns:["ModificationDate","EffectiveDate","review_state"],availableColumns:{ModificationDate:"Last modified",EffectiveDate:"Published",CreationDate:"Created",review_state:"Review state",Subject:"Tags",Type:"Type",is_folderish:"Folder",exclude_from_nav:"Excluded from nav",getObjSize:"Object Size",last_comment_date:"Last comment date",total_comments:"Total comments"},rearrange:{properties:{id:"ID",sortable_title:"Title",modified:"Last Modified",created:"Created on",effective:"Publication Date",Type:"Type"},url:"/rearrange"},basePath:"/",uploadUrl:null,moveUrl:null,buttonGroups:{primary:[{title:"Cut",url:"/cut"},{title:"Copy",url:"/copy"},{title:"Paste",url:"/paste"},{title:"Delete",url:"/delete",context:"danger",icon:"trash"}],secondary:[{title:"Workflow",url:"/workflow"},{title:"Tags",url:"/tags"},{title:"Properties",url:"/properties"},{title:"Rename",url:"/rename"}]},useTus:!1},init:function(){var t=this;t.browsing=!0,t.options.collectionUrl=t.options.vocabularyUrl,t.options.queryHelper=new n.QueryHelper(e.extend(!0,{},t.options,{pattern:t})),delete t.options.attributes,t.view=new r(t.options),t.$el.append(t.view.render().$el)}});return i}),+function(e){var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},t.prototype.show=function(){if(this.transitioning||this.$element.hasClass("in"))return;var t=e.Event("show.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var r=n.data("bs.collapse");if(r&&r.transitioning)return;n.collapse("hide"),r||n.data("bs.collapse",null)}var i=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[i](0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[i]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var o=e.camelCase(["scroll",i].join("-"));this.$element.one(e.support.transition.end,e.proxy(s,this)).emulateTransitionEnd(350)[i](this.$element[0][o])},t.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass("in"))return;var t=e.Event("hide.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};if(!e.support.transition)return r.call(this);this.$element[n](0).one(e.support.transition.end,e.proxy(r,this)).emulateTransitionEnd(350)},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("bs.collapse"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n);!i&&s.toggle&&n=="show"&&(n=!n),i||r.data("bs.collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i),o=s.data("bs.collapse"),u=o?"toggle":n.data(),a=n.attr("data-parent"),f=a&&e(a);if(!o||!o.transitioning)f&&f.find('[data-toggle=collapse][data-parent="'+a+'"]').not(n).addClass("collapsed"),n[s.hasClass("in")?"addClass":"removeClass"]("collapsed");s.collapse(u)})}(jQuery),define("bootstrap-collapse",["jquery"],function(e){return function(){var t,n;return t||e.window.jQuery.fn.collapse.Constructor}}(this)),define("mockup-bundles-plone",["jquery","mockup-registry","mockup-patterns-base","mockup-patterns-select2","mockup-patterns-pickadate","mockup-patterns-relateditems","mockup-patterns-querystring","mockup-patterns-tinymce","mockup-patterns-livesearch","mockup-patterns-accessibility","mockup-patterns-autotoc","mockup-patterns-formunloadalert","mockup-patterns-preventdoublesubmit","mockup-patterns-formautofocus","mockup-patterns-modal","mockup-patterns-structure","bootstrap-dropdown","bootstrap-collapse","bootstrap-tooltip"],function(e,t,n){var r=n.extend({name:"plone",init:function(){var e=this}});return window.parent===window&&e(document).ready(function(){e("body").addClass("pat-plone"),t.scan(e("body"))}),r}),require(["mockup-bundles-plone"]);